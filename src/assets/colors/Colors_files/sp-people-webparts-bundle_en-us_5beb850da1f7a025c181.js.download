define("7f718435-ee4d-431c-bdbf-9c4ff326f46e_1.1.1",["tslib","@ms/sp-telemetry","@ms/sp-grid-layout","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={8:0,4:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{1:[{i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.1.1",m:"fglE"}],0:[{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.1.176",m:"K9kD"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"sp-orgchart-card-placeholder~sp-people-ca~e284ea82",1:"vendors~sp-orgchart-card-placeholder~sp-p~5353a5ed",3:"people-property-pane",6:"sp-people-card-placeholder",7:"sp-people-contact-card"}[e]||e)+"_"+(["en-us","none"])[{"0":0,"1":1,"3":0,"6":0,"7":0}[e]]+"_"+{0:"df965ed3a38b085c09d9",1:"7e831e57c49cde3a718c",3:"ad7cb31a93104aa8aa83",6:"dcbbcf084d8960bf5954",7:"cb3fb84b519ffeccf121"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_9956086cf62725f96461166eaa2c4d81=window.webpackJsonp_9956086cf62725f96461166eaa2c4d81||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-people-webparts-bundle_en-us_5beb850da1f7a025c181\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="+wm6")}({"+wm6":function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("KL1q"),s=n("7Awa"),c=n("UWqr"),d=n("ut3N"),l=n("br4S"),u=n("y88i"),f=n("hiL/"),p=n("2q6Q"),m=n("vlQI"),_=n("Pk8u"),h=n("X+PM"),b=n("BoHf"),g=function(){function e(e){var t=this;e.whenFinished(function(){t._graphHttpClient=e.consume(m._GraphHttpClient.serviceKey)}),this._sendBatchRequestDebounce=Object(_.debounce)(this._sendBatchRequest,1e3)}return e._trimStart=function(e,t){return 0===e.indexOf(t)?e.substr(t.length):e},e.prototype.get=function(t){var n=this;return new Promise(function(a,i){n._requests||(n._requests=[]),n._requests.push({method:"GET",url:e._trimStart(t,"v1.0"),attemptCount:1,resolve:a,reject:i}),20===n._requests.length?n._flush():n._sendBatchRequestDebounce()})},e.prototype.cancel=function(){this._sendBatchRequestDebounce.cancel()},e.prototype._sendBatchRequest=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,r=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!this._requests)return[2];e=this._requests,this._requests=void 0,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this._graphHttpClient.post("v1.0/$batch",m._GraphHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json","X-PeopleQuery-QuerySources":"Mailbox,Directory"},body:JSON.stringify({requests:e.map(function(e,t){return{id:t,method:e.method,url:e.url}})})})];case 2:return t=a.sent(),[3,4];case 3:return n=a.sent(),e.forEach(function(e){return e.reject(n)}),[2];case 4:if(!t.ok)return e.forEach(function(e){return e.resolve(t)}),[2];a.label=5;case 5:return a.trys.push([5,7,,8]),[4,t.json()];case 6:return a.sent().responses.sort(function(e,t){return Number(e.id)-Number(t.id)}).forEach(function(n,a){var i=e[a];429===n.status&&i.attemptCount<3?r._retry(i,n):r._resolve(i,n,t.correlationId)}),[3,8];case 7:return i=a.sent(),e.forEach(function(e){return e.reject(i)}),[2];case 8:return[2]}})})},e.prototype._flush=function(){this._sendBatchRequest().catch(function(){})},e.prototype._retry=function(e,t){var n=this,i=t.headers?Number(t.headers["Retry-After"]):1;setTimeout(function(){n._requests||(n._requests=[]),n._requests.push(Object(a.__assign)(Object(a.__assign)({},e),{attemptCount:e.attemptCount+1})),20===n._requests.length?n._flush():n._sendBatchRequestDebounce()},1e3*i)},e.prototype._resolve=function(e,t,n){e.resolve(new m._GraphHttpClientResponse(new Response(JSON.stringify(t.body),Object(a.__assign)(Object(a.__assign)({},t),{headers:Object(a.__assign)(Object(a.__assign)({},t.headers),{"request-id":(n||"").toString()})}))))},e.serviceKey=c.ServiceKey.create("PeopleWebPart.GraphHttpClientBatch",e),e}(),v=function(){function e(e){this._pageContext=e.consume(h.PageContext.serviceKey),this._spHttpClient=e.consume(m.SPHttpClient.serviceKey),this._graphHttpClientBatch=e.consume(g.serviceKey)}return e.prototype.getPeopleInfo=function(e){return Object(b.n)()?this._getPeopleInfo(e):this._getPeopleInfo(e).catch(function(e){throw void 0!==e&&e.message&&(e.message=e.message.replace(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi,"PIIInfo")),e})},e.prototype._getPeopleInfo=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){return t=e.id,this._startsWith(t,"i:0#.f|membership|")?[2,this._getPeopleInfoByUserPrincipalName(t)]:this._endsWith(t,".onmicrosoft.com")?[2,this._getPeopleInfoByUserPrincipalName("i:0#.f|membership|"+t)]:this._contains(t,"@")&&this._contains(t.substr(0,t.indexOf("@")),".")?[2,this._getPeopleInfoBySearchPeople(t)]:this._contains(t,"@")?[2,this._getPeopleInfoByAliasEmail(t)]:[2,this._getPeopleInfoBySearchPeople(t)]})})},e.prototype._getPeopleInfoByUserPrincipalName=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,i,r,o,s,c,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e._spHttpClientBatchGet||(n=this._spHttpClient.beginBatch(),i=Object(_.debounce)(function(){e._spHttpClientBatchGet=void 0,n.execute().catch(function(e){return d._TraceLogger.logError(d._LogSource.create("PeopleWebPart"),e,"GetPeopleInfoByUserPrincipalName")})},1e3),e._spHttpClientBatchGet=function(e){var t=n.get(e,m.SPHttpClientBatch.configurations.v1);return i(),t}),r=this._pageContext.web.absoluteUrl+"/_api/SP.UserProfiles.PeopleManager/GetPropertiesFor(AccountName=@v)?@v='"+encodeURIComponent(t)+"'&$select=AccountName,DisplayName,Email,Title",[4,e._spHttpClientBatchGet(r)];case 1:if(o=a.sent(),s=o.correlationId?o.correlationId.toString():"Unknown",!o.ok)throw new f.UnexpectedFailure("RequestFailed",new Error("The request is failed for user principal name "+t+"."),{correlationId:s,status:o.status});return[4,o.json()];case 2:if((c=a.sent())["@odata.null"])throw new f.ExpectedFailure("NoProfileReturned",new Error("No person returned for user principal name "+t+"."),{correlationId:s});return l=c.UserProfileProperties?c.UserProfileProperties.reduce(function(e,t){var n;return Object(_.extend)(e,((n={})[t.Key]=t.Value,n))},{}):{},[2,{id:c.AccountName,name:c.DisplayName||"",email:c.Email||"",role:c.Title||"",firstName:l.FirstName||"",lastName:l.LastName||"",upn:l["SPS-UserPrincipalName"]||"",phone:l.WorkPhone||"",sip:l["SPS-SipAddress"]||"",department:l.Department||""}]}})})},e.prototype._getPeopleInfoBySearchPeople=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t='v1.0/me/people?$search="'+encodeURIComponent(e)+'"&$top=1&$select=userPrincipalName,displayName,jobTitle,department,scoredEmailAddresses,personType',[4,this._graphHttpClientBatch.get(t)];case 1:return n=a.sent(),i=n.correlationId?n.correlationId.toString():"Unknown",n.ok?[3,3]:[4,this._getErrorMessage(n)];case 2:throw r=a.sent(),new f.UnexpectedFailure("RequestFailed",new Error("The request is failed for query string "+e+". Error message: "+r),{correlationId:i,status:n.status});case 3:return[4,n.json()];case 4:if(0===(o=a.sent()).value.length)throw new f.ExpectedFailure("NoProfileReturned",new Error("No person returned for query string "+e+"."),{correlationId:i});return[2,{id:(s=o.value[0]).userPrincipalName||s.scoredEmailAddresses[0].address,name:s.displayName||"",email:s.scoredEmailAddresses[0].address,role:s.jobTitle||"",department:s.department||""}]}})})},e.prototype._getPeopleInfoByAliasEmail=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,i,r,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t="v1.0/users/"+e,[4,this._graphHttpClientBatch.get(t)];case 1:return n=a.sent(),i=n.correlationId?n.correlationId.toString():"Unknown",n.ok?[3,3]:[4,this._getErrorMessage(n)];case 2:throw r=a.sent(),new f.UnexpectedFailure("RequestFailed",new Error("The request is failed for alias email "+e+". Error message: "+r),{correlationId:i,status:n.status});case 3:return[4,n.json()];case 4:return[2,{id:(o=a.sent()).userPrincipalName,name:o.displayName||"",email:o.mail||"",role:o.jobTitle||""}]}})})},e.prototype._getErrorMessage=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,e.json()];case 1:return[2,t.sent().error.message];case 2:return t.sent(),[2,"N/A"];case 3:return[2]}})})},e.prototype._startsWith=function(e,t){return 0===e.indexOf(t)},e.prototype._endsWith=function(e,t){return e.indexOf(t)+t.length===e.length},e.prototype._contains=function(e,t){return-1!==e.indexOf(t)},Object(a.__decorate)([o.autobind,Object(f.monitor)("PeopleDataProvider.GetPeopleInfo")],e.prototype,"getPeopleInfo",null),Object(a.__decorate)([Object(f.monitor)("PeopleDataProvider.GetPeopleInfoByUserPrincipalName")],e.prototype,"_getPeopleInfoByUserPrincipalName",null),Object(a.__decorate)([Object(f.monitor)("PeopleDataProvider.GetPeopleInfoBySearchPeople")],e.prototype,"_getPeopleInfoBySearchPeople",null),Object(a.__decorate)([Object(f.monitor)("PeopleDataProvider.GetPeopleInfoByAliasEmail")],e.prototype,"_getPeopleInfoByAliasEmail",null),e}(),y=n("U4ag"),S=n("6mGg"),D=n("jOlS");D.loadStyles('.f_e_a3a8085b{word-wrap:break-word;white-space:pre-wrap;color:"[theme:neutralPrimary, default: #323130]";font-weight:400;line-height:17px}.g_e_a3a8085b{padding:0;height:80px}',!0);var I=n("yRoY"),x=function(e){function t(t){var n=e.call(this,t)||this;return n._exceedLimitLogged=!1,n._maxCharactersNumber=n.props.maxCharactersNumber||255,n._descriptionCharactersMaxCountHint=u.StringHelper.formatWithLocalizedCountValue(I.a,I.i,n._maxCharactersNumber),n._handleChangeValue=function(e,t){var a=t||"";n.setState({value:a}),n.props.onChangeDescription(a)},n._validateLength=function(e){return e.length>n._maxCharactersNumber?(n._exceedLimitLogged||(p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleDescription.ExceedCharacterLimit",d._LogType.Event,{characterLength:e.length.toString(),UICulture:n.props.uiCulture||"undefined"})),n._exceedLimitLogged=!0),u.StringHelper.format(I.t,e.length,n._descriptionCharactersMaxCountHint)):""},n._handleKeyDown=function(e){if(n.props.isEditMode&&"TEXTAREA"===e.target.tagName){var t=e.target,a=t.value.length,i=t.selectionStart!==t.selectionEnd;switch(e.which){case o.KeyCodes.left:case o.KeyCodes.up:(i||0!==a&&0!==t.selectionStart)&&e.stopPropagation();break;case o.KeyCodes.right:case o.KeyCodes.down:(i||0!==a&&t.selectionStart!==a)&&e.stopPropagation();break;case o.KeyCodes.del:case o.KeyCodes.home:case o.KeyCodes.end:e.stopPropagation()}}},n.state={value:n.props.content},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isEditMode||p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleDescription.Mount",d._LogType.Event,{characterLength:this.props.content.length.toString(),UICulture:this.props.uiCulture||""}))},t.prototype.render=function(){var e=Boolean(this.props.content),t=u.StringHelper.format(I.e,e?I.n:I.r,this._descriptionCharactersMaxCountHint);return this.props.isEditMode?i.createElement(o.TextField,{ariaLabel:t,borderless:!0,className:Object(o.css)("f_e_a3a8085b",this.props.className),"data-automation-id":"peopleDescriptionTextField",deferredValidationTime:500,description:this._getDescription(this.state.value),inputClassName:"g_e_a3a8085b",multiline:!0,onChange:this._handleChangeValue,onGetErrorMessage:this._validateLength,onKeyDown:this._handleKeyDown,placeholder:I.r,resizable:!1,value:this.state.value}):e&&i.createElement("div",{className:this.props.className,"data-automation-id":"peopleDescriptionViewMode"},i.createElement(y.LessText,{className:"f_e_a3a8085b","data-automation-id":"peopleDescriptionLessText",lines:this.props.lines,omission:this.props.omission,onAfterTruncate:this.props.onAfterTruncate,autoShowTitle:!1,text:this.props.content}))},t.prototype._getDescription=function(e){return e.length<=this._maxCharactersNumber?u.StringHelper.format(I.t,e.length,this._descriptionCharactersMaxCountHint):""},Object(a.__decorate)([o.autobind],t.prototype,"_getDescription",null),t}(i.PureComponent),C=n("u2MZ"),O=n("wxLm"),w=function(e){function t(n){var a=e.call(this,n)||this;return a.state={contactCard:void 0},"ContactCard"===t.getHoverCardType()&&t.importContactCard().then(function(e){a.setState({contactCard:e})}).catch(function(){}),a}return Object(a.__extends)(t,e),t.getHoverCardType=function(){return this._isLivePersonaCardFlightEnabled()||c._BrowserUtilities.isMobileWebView()?"LivePersonaCard":"ContactCard"},t.importContactCard=function(){if(!t._contactCardBundle){var e=new p._QosMonitor("PeopleWebPart.ContactCard");t._contactCardBundle=n.e(7).then(n.bind(null,"Q7jw")).then(function(t){return e.writeSuccess(),t.ContactCard}).catch(function(t){throw e.writeUnexpectedFailure("BundleLoadFailure",t),t})}return t._contactCardBundle},t._isLivePersonaCardFlightEnabled=function(){return c._SPFlight.isEnabled(809)},t.prototype.render=function(){var e,n=this.props.person.email||this.props.person.upn||"";if(this.props.isDisabled)return i.Children.only(this.props.children);var a=this.props.layout===C.r.CompactCard?{host:{flex:"1 1 auto",minWidth:"0",display:"flex"}}:{host:{margin:"auto",alignSelf:"center"}};switch(t.getHoverCardType()){case"LivePersonaCard":var r=Object(o.css)(((e={})[O.e.persona]=this.props.layout===C.r.CompactCard,e[O.e.personaCoin]=this.props.layout===C.r.LargeCard,e[O.e.hoverCard]=!this.props.isDisabled,e));return i.createElement(y.LivePersonaCard,{className:r,clientScenario:"PeopleWebPart",disableHover:this.props.isEditMode,hostAppPersonaInfo:{PersonaType:"User",PersonaCoinName:this.props.person.name},displayName:this.props.person.name,serviceScope:this.props.serviceScope,upn:n,onCardOpen:this.props.onCardOpen,onCardClose:this.props.onCardClose},this.props.children);case"ContactCard":return this.state.contactCard?i.createElement(this.state.contactCard,{person:this.props.person,styles:a,onCardOpen:this.props.onCardOpen,onCardClose:this.props.onCardClose},this.props.children):i.Children.only(this.props.children);default:return i.Children.only(this.props.children)}},t}(i.Component),E=n("I6O9"),A=function(){function e(){}return e.loadPagePicker=function(){return e.loadModule().then(function(e){return e.PagePicker})},e.loadModule=function(){return e._loadedModulePromise||(e._loadedModulePromise=E.SPComponentLoader.loadComponentById("e795d530-8fb6-425c-b864-b86735dbae1d")),e._loadedModulePromise},e}();D.loadStyles(".z_g_a3a8085b{font-size:12px;max-width:100%;border:0;padding:0;height:auto}.z_g_a3a8085b .ms-Button-label{font-weight:400;margin:0;overflow:hidden;text-overflow:ellipsis;text-align:left;line-height:17px}.z_g_a3a8085b .ms-Button-icon{font-size:12px;margin:0}[dir=ltr] .z_g_a3a8085b .ms-Button-icon{margin-right:8px}[dir=rtl] .z_g_a3a8085b .ms-Button-icon{margin-left:8px}.z_g_a3a8085b .ms-Button-flexContainer{justify-content:flex-start}.z_g_a3a8085b,.z_g_a3a8085b:active,.z_g_a3a8085b:focus,.z_g_a3a8085b:hover{background-color:transparent;outline:0}.aa_g_a3a8085b{display:inline-block;font-size:12px;max-width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",!0);var L=n("/SYW"),k=function(e){function t(t){var n=e.call(this,t)||this;return n._openPagePicker=function(){p._EngagementLogger.logEvent("PeopleWebPart.PeopleLink.OpenPagePicker"),n._getPagePicker().then(function(e){e.open({title:n.state.linkName,url:n.state.linkUrl})}).catch(function(e){d._TraceLogger.logError(d._LogSource.create("PeopleWebPart"),e,"GetPagePicker")})},n._logOpenLink=function(){p._EngagementLogger.logEvent("PeopleWebPart.PeopleLink.OpenLink")},n.state={linkName:t.linkName,linkUrl:t.linkUrl},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e,t=this.state.linkName||this.state.linkUrl,n=Boolean(t),a=(this.props,{linkButton:{selectors:{"& .ms-Button-label":{color:(e=Object(o.getTheme)()).semanticColors.actionLink},"&:hover .ms-Button-label, &:focus .ms-Button-label, &:active .ms-Button-label":{color:e.semanticColors.actionLinkHovered+" !important"},"& .ms-Button-icon":{color:e.semanticColors.link},"&:hover .ms-Button-icon, &:focus .ms-Button-icon, &:active .ms-Button-icon":{color:e.semanticColors.linkHovered+" !important"}}},link:{color:e.semanticColors.link,selectors:{"&:hover, &:focus, &:active":{color:e.semanticColors.linkHovered}}}});return this.props.isEditMode?this._renderEditModeButton(t,a):n&&i.createElement(o.Link,{className:Object(o.mergeStyles)("aa_g_a3a8085b",a.link),"data-automation-id":"peopleLinkText",href:this.state.linkUrl,target:"_blank",onClick:this._logOpenLink},t)},t.prototype._getPagePicker=function(){var e=this;if(!this._pagePickerPromise){var t=new p._QosMonitor("PeopleWebPart.PeopleLink.InitializePagePicker");this._pagePickerPromise=A.loadPagePicker().then(function(n){return t.writeSuccess(),new n({compact:!0,onSelect:e._handleChangeLink,onUnlink:e._handleChangeLink,serviceScope:e.props.serviceScope})}).catch(function(e){return t.writeUnexpectedFailure("PeopleWebPart.PeopleLink.InitializePagePicker",e),Promise.reject(e)})}return this._pagePickerPromise},t.prototype._handleChangeLink=function(e){void 0===e&&(e={title:"",url:""}),p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleLink.ChangeLink",d._LogType.Event,{urlLength:e.url.length.toString()})),this.props.onChangeLink(e),this.setState({linkName:e.title,linkUrl:e.url})},t.prototype._renderEditModeButton=function(e,t){return e?i.createElement(o.Link,{className:Object(o.mergeStyles)("aa_g_a3a8085b",t.link),"data-automation-id":"peopleLinkEditButton",onClick:this._openPagePicker,title:L.t},e):i.createElement(o.ActionButton,{className:Object(o.mergeStyles)("z_g_a3a8085b",t.linkButton),"data-automation-id":"peopleLinkEditButton",iconProps:{iconName:"CalculatorAddition"},onClick:this._openPagePicker,text:L.e})},Object(a.__decorate)([o.autobind],t.prototype,"_getPagePicker",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeLink",null),t}(i.PureComponent),M=n("YDsL"),P=n("E8te"),T=function(e){function t(t){var n=e.call(this,t)||this;return n._focusZoneRef=i.createRef(),n._hoverTarget=null,n._restoreFocusToCard=!1,n._hasLoggedSeeMoreButton=!1,n._isSeeLessStateLogged=!1,n._UICulture=n.props.serviceScope.consume(h.PageContext.serviceKey).cultureInfo.currentUICultureName,n._onFocusNotification=function(){n.setState({isFocusedIn:!0})},n._onBlur=function(){n.setState({isFocusedIn:!1})},n._onCancelClick=function(){n.props.onDeletePerson("Mouse")},n._renderPersonaCoin=function(e,t,s){var d=n.props.layout!==C.r.CompactCard,l=c.Text.format(M.c,n.props.person.name,M.r),u=Object(o.mergeStyles)(!d&&O.e.hoverCard,O.e.personaCoin,t.photo);return i.createElement(o.PersonaCoin,Object(a.__assign)({},s,{"aria-label":l,coinProps:{className:u},tabIndex:-1,size:n.props.personaSize,imageUrl:e,imageShouldStartVisible:!0,text:n.props.person.name,componentRef:n.props.layout===C.r.LargeCard?function(e){return n._hoverTarget=r.findDOMNode(e)}:void 0}))},n._handleClickSeeMoreButton=function(){n.setState(function(e){return{isDescriptionExpanded:!e.isDescriptionExpanded}}),n.focus()},n._handleDescriptionTruncate=function(e){n.setState({isDescriptionTruncated:e}),n._hasLoggedSeeMoreButton||(n.props.serviceScope.whenFinished(function(){p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleCard.DisplaySeeMoreButton",d._LogType.Event,{characterLength:(n.props.person.description||"").length.toString(),hasSeeMore:e.toString(),UICulture:n._UICulture}))}),n._hasLoggedSeeMoreButton=!0),!n._isSeeLessStateLogged&&n.state.isDescriptionExpanded&&(n.props.serviceScope.whenFinished(function(){p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleCard.SeeLessState",d._LogType.Event,{characterLength:(n.props.person.description||"").length.toString(),isTruncated:e.toString(),UICulture:n._UICulture}))}),n._isSeeLessStateLogged=!0)},n._handleKeyDown=function(e){e.which===o.KeyCodes.enter&&n._hoverTarget&&e.target===r.findDOMNode(n._focusZoneRef.current)&&(n._restoreFocusToCard=!0,n._hoverTarget.click(),e.stopPropagation()),n.props.isEditMode&&e.which===o.KeyCodes.del&&(n.props.onDeletePerson("Keyboard"),e.stopPropagation())},n.state={isDescriptionExpanded:!1,isDescriptionTruncated:!1,isFocusedIn:!1},n}return Object(a.__extends)(t,e),t.prototype.focus=function(){this._focusZoneRef&&this._focusZoneRef.current&&this._focusZoneRef.current.focus()},t.prototype.componentDidMount=function(){var e=r.findDOMNode(this._focusZoneRef.current);if(e instanceof Element){var t=u.StringHelper.format(M.s,this.props.person.name,this.props.person.role,this.props.layout===C.r.LargeCard&&this.props.person.description||"",M.r,this.props.isEditMode?"left-right"===this.props.arrowKeyToInside?M.a:M.i:"");e.setAttribute("aria-label",t)}},t.prototype.render=function(){var e=Object(P.e)({isEditMode:this.props.isEditMode,isFocusWithin:this.state.isFocusedIn,layout:this.props.layout,variantTheme:this.props.variantTheme,width:this.props.width,isFluent:this.props.isFluent}),t=this.props.layout===C.r.CompactCard,n=Object(o.mergeStyles)(O.e.card,e.card,t&&O.e.compactLayout,this.props.layout===C.r.LargeCard&&O.e.largeLayout,this.state.isDescriptionExpanded&&!this.props.isEditMode&&O.e.hidePersona),a="up-down"===this.props.arrowKeyToInside?o.FocusZoneDirection.vertical:o.FocusZoneDirection.horizontal;return i.createElement(o.FocusZone,{className:n,componentRef:this._focusZoneRef,direction:a,isCircularNavigation:!0,onKeyDown:this._handleKeyDown,onFocusNotification:this._onFocusNotification,onBlur:this._onBlur,"data-is-focusable":!0,"data-drag-tag":"grid-layout-drag-leaf","data-automation-id":"people-card","data-layout":t?"compactLayout":"largeLayout",role:Object(b.t)()?"group":"listitem"},this._renderPeoplePersona(t,e),this.props.isEditMode&&this._renderButtons(e),!t&&this._renderPeopleDescription(),this._renderSeeMoreButton())},t.prototype._renderButtons=function(e){var t=this.props.layout===C.r.CompactCard&&this.props.variantTheme?this.props.variantTheme:Object(o.getTheme)(),n=Object(o.mergeStyles)(O.e.buttons,e.buttons);return i.createElement("div",{className:n},i.createElement(o.IconButton,{iconProps:{iconName:"Cancel"},className:O.e.deleteButton,"data-automation-id":"peopleCardDeleteButton",title:M.t,onClick:this._onCancelClick,theme:t}),i.createElement(o.IconButton,{iconProps:{iconName:"Move"},className:O.e.dragAndDropButton,title:M.n,theme:t,"data-drag-handle":"grid-layout-drag-handler"}))},t.prototype._renderPeopleDescription=function(){var e=this.state.isDescriptionExpanded&&this.state.isDescriptionTruncated?"…":"​";return i.createElement(x,{className:O.e.description,content:this.props.person.description||"",isEditMode:this.props.isEditMode,lines:this._descriptionLines,omission:e,onChangeDescription:this.props.onChangeDescription,onAfterTruncate:this._handleDescriptionTruncate,uiCulture:this._UICulture})},t.prototype._renderSeeMoreButton=function(){var e=c.Text.format(this.state.isDescriptionExpanded?M.d:M.u,this.props.person.name);return!this.props.isEditMode&&(this.state.isDescriptionExpanded||this.state.isDescriptionTruncated)&&i.createElement("div",{className:O.e.seeMoreButton},i.createElement(o.IconButton,{ariaLabel:e,onClick:this._handleClickSeeMoreButton,iconProps:{iconName:this.state.isDescriptionExpanded?"ChevronDown":"ChevronUp"},title:this.state.isDescriptionExpanded?M.l:M.f}))},t.prototype._handleCardOpen=function(){f.ScreenReaderAlert.read(c.Text.format(M.o,this.props.person.name),f.ReadingMode.ReadImmediately),p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleCard.OpenHoverCard",d._LogType.Event,{isEditMode:this.props.isEditMode.toString(),hoverCardType:w.getHoverCardType()}))},t.prototype._handleCardClose=function(){f.ScreenReaderAlert.read(c.Text.format(M.e,this.props.person.name),f.ReadingMode.ReadImmediately),p._EngagementLogger.logEvent("PeopleWebPart.PeopleCard.CloseHoverCard"),this._restoreFocusToCard&&(this._restoreFocusToCard=!1,setTimeout(this.focus))},t.prototype._renderPeoplePersona=function(e,t){var n=this,r={isEditMode:this.props.isEditMode,layout:this.props.layout,onCardOpen:this._handleCardOpen,onCardClose:this._handleCardClose,person:this.props.person,serviceScope:this.props.serviceScope},s=e,c=!e,d=Object(C.c)(this.props.person.email,this.props.layout),l=Object(o.mergeStyles)(O.e.primaryText,t.primaryText,this.props.isFluent&&O.e.fluent),u=Object(o.mergeStyles)(O.e.secondaryText,t.secondaryText,this.props.isFluent&&O.e.fluent);return i.createElement(w,Object(a.__assign)({},r,{isDisabled:!s}),i.createElement("div",{className:Object(o.mergeStyles)(O.e.persona,s&&O.e.hoverCard),tabIndex:-1,ref:s?function(e){return n._hoverTarget=e}:void 0},i.createElement(w,Object(a.__assign)({},r,{isDisabled:!c}),i.createElement(y.DoughboyDetector,{imageUrl:d,imageProps:t,renderImage:this._renderPersonaCoin,onDetectCompleted:this.props.onRenderCompleted,disableDelayDetect:!0})),i.createElement("div",{className:O.e.personaDetails},i.createElement("div",{className:l,title:this.props.person.name},this.props.person.name),i.createElement("div",{className:u,title:this.props.person.role},this.props.person.role||(e?"":" ")),!e&&this._renderPeopleLink())))},t.prototype._renderPeopleLink=function(){return i.createElement(k,{isEditMode:this.props.isEditMode,linkName:this.props.person.linkName||"",linkUrl:this.props.person.linkUrl||"",onChangeLink:this.props.onChangeLink,serviceScope:this.props.serviceScope})},Object.defineProperty(t.prototype,"_descriptionLines",{get:function(){if(this.state.isDescriptionExpanded){var e=C.t-Math.ceil((C.i-this.props.width)/16*9)-C.n-C.a;return Math.floor(e/C.e)}return this.state.isDescriptionTruncated?4:5},enumerable:!1,configurable:!0}),Object(a.__decorate)([o.autobind],t.prototype,"focus",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleCardOpen",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleCardClose",null),t}(i.PureComponent),U=n("clF1"),F=function(e){function t(t){var n=e.call(this,t)||this;n._focusIndex=void 0,n._focusZone=null,n._placeholderRef=i.createRef(),n._peopleCardList=[],n._peopleRenderPromiseResolver=[],n._renderPeopleItem=function(e,t){var a=n.props.layout===C.r.CompactCard?o.PersonaSize.regular:e.width<=243?o.PersonaSize.large:o.PersonaSize.extraLarge;return"placeholder"===e.item?n.state.peopleCardPlaceholderModule?i.createElement(n.state.peopleCardPlaceholderModule,{layout:n.props.layout,width:e.width,variantTheme:n.props.variantTheme,isFluent:n.props.isFluent,onAddPerson:n._handleAddPerson,personaSize:a,serviceScope:n.props.serviceScope,selectedPersons:n.props.selectedPersons,ref:n._placeholderRef}):i.createElement(i.Fragment,null):i.createElement(T,{isEditMode:n.props.isEditMode,layout:n.props.layout,serviceScope:n.props.serviceScope,person:e.item,personaSize:a,ref:function(a){return e.rootFocusRef(n._peopleCardList[t]=a)},width:e.width,variantTheme:n.props.variantTheme,isFluent:n.props.isFluent,arrowKeyToInside:e.isMultiItemPerRow?"up-down":"left-right",onMove:_.noop,onDeletePerson:function(e){return n._handleDeletePerson(t,e)},onChangeDescription:function(e){return n._handleChangeDescription(e,t)},onChangeLink:function(e){return n._handleChangeLink(t,e)},onRenderCompleted:function(){return n._handleRenderCompleted(t)}})},n._getGridLayoutAriaLabel=function(e,t){var a=u.StringHelper.formatWithLocalizedCountValue(t?U.i:U.o,U.r,n.props.selectedPersons.length),i=e?t?U.n:U.a:"";return u.StringHelper.format(U.t,a,i)},n._getPeopleKey=function(e){return"placeholder"===e?e:e.id},n._handleReorderPeopleItem=function(e,t){e<n.props.selectedPersons.length&&t<n.props.selectedPersons.length&&n.props.onChangeSelectedPersons(n._swapPerson(e,t))},n._handleAddPerson=function(e){var t=n.props.selectedPersons.concat([e]);n.props.onChangeSelectedPersons(t),n._focusIndex=t.length},n.state={peopleCardPlaceholderModule:void 0},n._peopleRenderPromiseResolver=[];var a=t.selectedPersons.map(function(e,t){return new Promise(function(e){return n._peopleRenderPromiseResolver[t]=e})});return Promise.all(a).then(t.onRenderCompleted).catch(function(e){d._TraceLogger.logError(d._LogSource.create("PeopleWebPart"),e,"ResolvePeopleRender")}),n.props.isEditMode&&n._loadCardPlaceholder().catch(function(e){d._TraceLogger.logError(d._LogSource.create("PeopleWebPart"),e,"LoadCardPlaceholderInConstructor")}),n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;if(this._listElement){var t=new d._QosMonitor("PeopleWall.createSortable",!0);f.SortableLoader.GetSortable().then(function(n){e._sortable=n.create(e._listElement,{forceFallback:c._BrowserDetection.getBrowserInformation().browser!==c._Browser.Chrome,handle:"."+O.e.dragAndDropButton,onEnd:e._handleReorder,animation:200}),t.writeSuccess()}).catch(function(e){throw t.writeUnexpectedFailure(void 0,e),e})}},t.prototype.componentWillUnmount=function(){this._sortable&&this._sortable.destroy()},t.prototype.componentDidUpdate=function(){if(void 0!==this._focusIndex){if(this._focusIndex<this.props.selectedPersons.length){var e=this._peopleCardList[this._focusIndex];e&&e.focus()}else this._placeholderRef&&this._placeholderRef.current&&this._placeholderRef.current.focus();this._focusIndex=void 0}},t.prototype.UNSAFE_componentWillReceiveProps=function(e){!0===e.isEditMode&&void 0===this.state.peopleCardPlaceholderModule&&this._loadCardPlaceholder().catch(function(e){d._TraceLogger.logError(d._LogSource.create("PeopleWebPart"),e,"LoadCardPlaceholderWhenReceiveProps")})},t.prototype.render=function(){var e=this.props.isEditMode?Object(a.__spreadArrays)(this.props.selectedPersons,["placeholder"]):this.props.selectedPersons,t=this.props.layout===C.r.CompactCard?10:20;return i.createElement(S.GridLayout,{width:this.props.width,items:e,onRenderItem:this._renderPeopleItem,displayMode:this.props.isEditMode?c.DisplayMode.Edit:c.DisplayMode.Read,getAriaLabel:this._getGridLayoutAriaLabel,getKey:this._getPeopleKey,onReorderItem:this._handleReorderPeopleItem,useSortable:!0,"data-automation-id":"people-list",verticalGutter:t})},t.prototype._loadCardPlaceholder=function(){var e=this;return Promise.all([n.e(1),n.e(0),n.e(6)]).then(n.bind(null,"6dH4")).then(function(t){e.setState({peopleCardPlaceholderModule:t.PeopleCardPlaceholder})})},t.prototype._handleRenderCompleted=function(e){this._peopleRenderPromiseResolver[e]&&this._peopleRenderPromiseResolver[e]()},t.prototype._handleChangeDescription=function(e,t){e.length<=255&&this.props.onChangeDescription(e,t)},t.prototype._handleChangeLink=function(e,t){this.props.onChangeLink(e,t)},t.prototype._handleDeletePerson=function(e,t){var n=this.props.selectedPersons[e];f.ScreenReaderAlert.read(u.StringHelper.format(U.e,n.name),f.ReadingMode.ReadImmediately);var i=Object(a.__spreadArrays)(this.props.selectedPersons);i.splice(e,1),this.props.onChangeSelectedPersons(i),this._focusIndex=e<this.props.selectedPersons.length-1?e:Math.max(0,e-1),p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleWall.DeletePerson",d._LogType.Event,{method:t}))},t.prototype._handleReorder=function(e){var t=e.oldIndex,n=e.newIndex;if(t!==n){var a=this._listElement;if(void 0!==a&&a instanceof Element){var i=e.item,r=t<n?t:t+1,o=a.children.item(r);a.insertBefore(i,o),this.props.onChangeSelectedPersons(this._swapPerson(t,n));var s=i.querySelector("[data-is-focusable]");if(s){var c=document.createEvent("MouseEvent");c.initEvent("blur",!0,!0),s.dispatchEvent(c)}this._logReorderEvent("Mouse",!0)}else this._logReorderEvent("Mouse",!1)}},Object.defineProperty(t.prototype,"_listElement",{get:function(){return this._focusZone?r.findDOMNode(this._focusZone):void 0},enumerable:!1,configurable:!0}),t.prototype._swapPerson=function(e,t){var n=[].concat(this.props.selectedPersons);return n.splice(e,1),n.splice(t,0,this.props.selectedPersons[e]),f.ScreenReaderAlert.read(u.StringHelper.format(U.s,this.props.selectedPersons[e].name,t+1),f.ReadingMode.ReadImmediately),n},t.prototype._logReorderEvent=function(e,t){p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","PeopleWall.ReorderPersons",d._LogType.Event,{method:e,success:t.toString()}))},Object(a.__decorate)([o.autobind],t.prototype,"UNSAFE_componentWillReceiveProps",null),Object(a.__decorate)([o.autobind,Object(f.monitor)("PeopleWebPart.LoadCardPlaceHolder")],t.prototype,"_loadCardPlaceholder",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeDescription",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeLink",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleDeletePerson",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleReorder",null),t}(i.PureComponent),H=n("Ym2g"),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement(o.Fabric,{className:Object(o.css)({"ms-people-edit":this.props.isEditMode})},i.createElement(y.WebPartTitle,{edit:this.props.isEditMode,title:this.props.title,placeholder:H.e,onTitleChange:this.props.onChangeTitle,marginBottomSize:"Large",theme:this.props.variantTheme}),i.createElement(F,{isEditMode:this.props.isEditMode,layout:this.props.layout,width:this.props.width,selectedPersons:this.props.selectedPersons,serviceScope:this.props.serviceScope,variantTheme:this.props.variantTheme,isFluent:this.props.isFluent,onChangeSelectedPersons:this.props.onChangeSelectedPersons,onChangeDescription:this.props.onChangeDescription,onChangeLink:this.props.onChangeLink,onRenderCompleted:this.props.renderCompleted}))},t}(i.PureComponent),N=n("8Inl"),B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._countEngagementLogged=!1,t._handleThemeChangedEvent=function(e){t._variantTheme=e.theme,t.render()},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=i.createElement(R,{isEditMode:this.displayMode===c.DisplayMode.Edit,serviceScope:this.context.serviceScope,selectedPersons:this.properties.persons,layout:this.properties.layout,title:this.properties.title,width:this.width,variantTheme:this._variantTheme,isFluent:!0,onChangeTitle:this._handleChangeTitle,onChangeSelectedPersons:this._handleChangeSelectPersons,renderCompleted:this.renderCompleted,onChangeDescription:this._handleChangeDescription,onChangeLink:this._handleChangeLink});r.render(e,this.domElement)},t.prototype.onDispose=function(){e.prototype.onDispose.call(this),r.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(s.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent)},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return this.properties.persons&&this.properties.persons.length>0},enumerable:!1,configurable:!0}),t.prototype.onInit=function(){return this._peopleDataProvider=new v(this.context.serviceScope),this.context._dataUpdatedEvent.add(this,this._handleWebPartPropertiesUpdated),this._getSectionBackgroundTheme(),p._PerformanceLogger.markComponent(this.context.webPartTag,""+p._PerformanceDataDimensions.Layout+C.r[this.properties.layout]),e.prototype.onInit.call(this)},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return c.Version.parse("1.3")},enumerable:!1,configurable:!0}),t.prototype.onBeforeSerialize=function(){this.properties.persons.forEach(function(e){return delete e.imageUrl})},t.prototype.onAfterDeserialize=function(e,t){return t.lessThan(c.Version.parse("1.1"))&&(e.layout=C.r.CompactCard),e},t.prototype.onDisplayModeChanged=function(t){e.prototype.onDisplayModeChanged.call(this,t),t===c.DisplayMode.Edit&&this._logCountEngagement()},t.prototype.loadPropertyPaneResources=function(){var e=this;return n.e(3).then(n.bind(null,"+mM2")).then(function(t){e._getPeopleWebPartProperty=t.getPeoplePropertyPane})},t.prototype.getPropertyPaneConfiguration=function(){return this._getPeopleWebPartProperty?this._getPeopleWebPartProperty(this.properties.layout):(d._TraceLogger.logError(C.o,new Error("Fail to get people property pane config.")),e.prototype.getPropertyPaneConfiguration.call(this))},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){var e,t=this.properties.title?u.StringHelper.format(N.o,this.properties.title):"",n=this.properties.persons?this.properties.persons.length:0,a=u.StringHelper.formatWithLocalizedCountValue(N.a,N.i,n);switch(this.properties.layout){case C.r.CompactCard:e=N.t;break;case C.r.LargeCard:e=N.n;break;default:e=N.t}var i=u.StringHelper.format(N.r,e);return u.StringHelper.format(N.e,t,a,i)},enumerable:!1,configurable:!0}),t.prototype.onAfterResize=function(e){this.render()},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{title:{isSearchablePlainText:!0},"persons[*].name":{isSearchablePlainText:!0},"persons[*].email":{isSearchablePlainText:!0},"persons[*].description":{isSearchablePlainText:!0},"persons[*].linkUrl":{isLink:!0}}},enumerable:!1,configurable:!0}),t.prototype.renderCompleted=function(){var n=this;e.prototype.renderCompleted.call(this),this._refreshCache().then(function(){n.isDisposed||n.render()}).catch(function(e){d._TraceLogger.logError(t._logSource,e,"UpdateInfoAfterRenderCompleted")})},t.prototype._handleChangeTitle=function(e){this.properties.title=e,this.render()},t.prototype._handleChangeSelectPersons=function(e){this.properties.persons=e,this.render()},t.prototype._handleChangeDescription=function(e,t){this.properties.persons[t].description=e},t.prototype._handleChangeLink=function(e,t){this.properties.persons[e].linkName=t.title,this.properties.persons[e].linkUrl=t.url},t.prototype._logCountEngagement=function(){var e=0,t=0;this.properties.persons&&this.properties.persons.forEach(function(n){n.linkUrl&&t++,n.description&&e++}),this._countEngagementLogged||this.displayMode!==c.DisplayMode.Read||(p._EngagementLogger.logEventWithLogEntry(new d._LogEntry("PeopleWebPart","CountOfPeople",d._LogType.Event,{count:String(this.properties.persons?this.properties.persons.length:0),LayoutName:C.r[this.properties.layout],PeopleWithDescription:e.toString(),PeopleWithLink:t.toString(),WebPartID:this.context.instanceId})),this._countEngagementLogged=!0)},t.prototype._handleWebPartPropertiesUpdated=function(){var e=this;this._refreshCache().then(function(){e.isDisposed||e.render()}).catch(function(e){d._TraceLogger.logError(t._logSource,e,"UpdateInfoAfterWebPartPropertiesUpdated")})},t.prototype._refreshCache=function(){var e=this,n=this.properties.persons.map(function(n,i){return Object(a.__awaiter)(e,void 0,void 0,function(){var e,r,o;return Object(a.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),e=this.properties.persons[i],[4,this._peopleDataProvider.getPeopleInfo(n)];case 1:return(r=s.sent()).linkName=e.linkName,r.linkUrl=e.linkUrl,r.description=e.description,(o=Object(a.__spreadArrays)(this.properties.persons)).splice(i,1,r),this.properties.persons=o,d._TraceLogger.logVerbose(t._logSource,"Update people info succeed: "+n.id,"UpdateCacheSucceed"),[3,3];case 2:return s.sent(),d._TraceLogger.logError(t._logSource,new Error("Update people info failed: "+n.id),"UpdateCacheFailed"),[3,3];case 3:return[2]}})})});return Promise.all(n).then(function(){})},t.prototype._getSectionBackgroundTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(s.ThemeProvider.serviceKey);e._variantTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},t._logSource=d._LogSource.create("PeopleWebPart"),Object(a.__decorate)([o.autobind],t.prototype,"onInit",null),Object(a.__decorate)([Object(f.monitor)("PeopleWebPart.LoadPropertyPane")],t.prototype,"loadPropertyPaneResources",null),Object(a.__decorate)([o.autobind],t.prototype,"onAfterResize",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeTitle",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeSelectPersons",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeDescription",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleChangeLink",null),Object(a.__decorate)([o.autobind],t.prototype,"_logCountEngagement",null),Object(a.__decorate)([o.autobind],t.prototype,"_handleWebPartPropertiesUpdated",null),t}(l.BaseClientSideWebPart);t.default=B},"/SYW":function(e){e.exports=JSON.parse('{"e":"Add a profile link","t":"Edit profile link"}')},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"6mGg":function(e,t){e.exports=i},"7Awa":function(e,t){e.exports=r},"8Inl":function(e){e.exports=JSON.parse('{"o":"Title {0}.","a":"There are {0} people profiles yet.||There is {0} people profile.||There are {0} people profiles.","i":"0||1||2-","t":"Compact","n":"Descriptive","r":"The layout of this web part is {0}.","e":"People web part. {0} {1} {2}"}')},BoHf:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o});var a=n("UWqr"),i=new(n("hiL/").KillSwitch)("0bf0ee5b-bd79-42f0-bc3f-816528146aa6");function r(){return a._SPKillSwitch.isActivated("bf2f9fc7-999a-481f-9884-56c75a530c6b")}function o(){return a._SPKillSwitch.isActivated("a89e1539-ac21-4c33-9a90-b8473eac628e")}},E8te:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var a=n("17wl"),i=n("KL1q"),r=n("BoHf"),o=n("u2MZ"),s=Math.random().toString().substr(2,5),c={keyboard:"ms-Fabric.is-focusVisible",notDrag:"sortable:not(.dragging)",editMode:"editMode-"+s,focusWithin:"focus-within-"+s,card:"card-"+s};function d(e){var t,n,s,d,l=Object(i.getTheme)(),u=e.variantTheme,f={display:"none",selectors:(t={},t[["."+c.keyboard+" ."+c.card+":focus &","."+c.keyboard+" ."+c.card+"."+c.focusWithin+" &","."+c.notDrag+" ."+c.card+"."+c.editMode+":hover &"].join(",")]={display:"flex",flexDirection:"column"},t)};switch(e.layout){case o.r.CompactCard:return{card:[c.card,e.isEditMode&&c.editMode,e.isFocusWithin&&c.focusWithin,{width:e.width,height:76,boxSizing:"border-box",border:e.isFluent?"1px solid transparent":void 0,selectors:(n={},n[["."+c.keyboard+" &:focus",!r.e.isActivated()&&"&."+c.focusWithin+":focus","."+c.notDrag+" &."+c.editMode+":hover"].join(",")]={outline:e.isFluent?void 0:"1px solid",outlineColor:e.isFluent?void 0:u&&u.semanticColors.focusBorder,borderColor:e.isFluent?u&&u.semanticColors.focusBorder:void 0,borderRadius:e.isFluent?l.effects.roundedCorner2:void 0,boxShadow:e.isFluent?l.effects.elevation4:void 0,backgroundColor:u&&u.semanticColors.bodyBackground},n)}],photo:void 0,primaryText:[{color:u&&u.semanticColors.actionLink,fontSize:e.isFluent?l.fonts.medium.fontSize:void 0,fontWeight:e.isFluent?600:void 0,selectors:(s={},s[["."+c.keyboard+" ."+c.card+":focus &","."+c.notDrag+" ."+c.card+"."+c.editMode+":hover &"].join(",")]={color:u&&u.semanticColors.actionLinkHovered},s)}],secondaryText:Object(a.__assign)({color:u&&u.semanticColors.bodySubtext},e.isFluent&&l.fonts.small),buttons:[f,{alignSelf:"stretch",justifyContent:"space-between"}]};case o.r.LargeCard:return{card:[c.card,e.isEditMode&&c.editMode,e.isFocusWithin&&c.focusWithin,{width:e.width,maxWidth:o.i,height:o.t-Math.ceil((o.i-e.width)/16*9),boxSizing:"border-box",backgroundColor:l.semanticColors.bodyBackground,outline:e.isFluent?void 0:"1px solid",outlineColor:e.isFluent?void 0:u&&u.semanticColors.variantBorder,border:e.isFluent?"1px solid":void 0,borderColor:e.isFluent?u&&u.semanticColors.variantBorder:void 0,borderRadius:e.isFluent?l.effects.roundedCorner2:void 0,boxShadow:e.isFluent?l.effects.elevation4:void 0,selectors:(d={},d[["."+c.keyboard+" &:focus",!r.e.isActivated()&&"&."+c.focusWithin+":focus","."+c.notDrag+" &."+c.editMode+":hover"].join(",")]={outline:e.isFluent?void 0:"1px solid",outlineColor:e.isFluent?void 0:u&&u.semanticColors.focusBorder,borderColor:u&&u.semanticColors.focusBorder,borderRadius:e.isFluent?l.effects.roundedCorner2:void 0,boxShadow:r.e.isActivated()&&e.isFluent?l.effects.elevation8:void 0},d["&:hover"]={boxShadow:!r.e.isActivated()&&e.isFluent?l.effects.elevation8:void 0},d)}],photo:{selectors:{"&:focus":{outline:"none"}}},primaryText:{color:l.semanticColors.bodyText,fontSize:e.isFluent?l.fonts.mediumPlus.fontSize:void 0,fontWeight:e.isFluent?600:void 0},secondaryText:Object(a.__assign)({color:l.semanticColors.bodySubtext},e.isFluent&&l.fonts.medium),buttons:[f,{position:"absolute",right:0,top:0}]};default:return{card:void 0,photo:void 0,primaryText:void 0,secondaryText:void 0,buttons:void 0}}}},I6O9:function(e,t){e.exports=o},KL1q:function(e,t){e.exports=s},Pk8u:function(e,t){e.exports=c},U4ag:function(e,t){e.exports=d},UWqr:function(e,t){e.exports=l},"X+PM":function(e,t){e.exports=u},YDsL:function(e){e.exports=JSON.parse('{"s":"{0} {1}. {2} {3} {4}","a":"Use the right arrow key to enter this card, and then use the left and right arrow keys to move between elements in the card. Press Delete to remove the profile.","i":"Use the down arrow key to enter this card, and then use the up and down arrow keys to move between elements in the card. Press Delete to remove the profile.","n":"Drag profile to a new location","t":"Remove profile","l":"See less","d":"Show image and link for {0}.","f":"See more","u":"Hide image and link for {0}.","o":"Open details for {0}. Press Escape to close details.","e":"Details for {0} closed.","c":"Image for {0}. {1}","r":"Press Enter to open details for this person."}')},Ym2g:function(e){e.exports=JSON.parse('{"e":"People profiles"}')},br4S:function(e,t){e.exports=f},cDcd:function(e,t){e.exports=p},clF1:function(e){e.exports=JSON.parse('{"i":"People profiles. There are {0} people profiles yet. Use left and right arrow keys to move between profiles.||People profiles. There is {0} people profile. Use left and right arrow keys to move between profiles.||People profiles. There are {0} people profiles. Use left and right arrow keys to move between profiles.","o":"People profiles. There are {0} people profiles yet. Use up and down arrow keys to move between profiles.||People profiles. There is {0} people profile. Use up and down arrow keys to move between profiles.||People profiles. There are {0} people profiles. Use up and down arrow keys to move between profiles.","r":"0||1||2-","n":"Use ctrl + left arrow or ctrl + right arrow to reorder people profiles.","a":"Use ctrl + up arrow or ctrl + down arrow to reorder people profiles.","t":"{0} {1}","e":"The profile for {0} has been removed.","s":"The position of the profile for {0} is now {1}."}')},faye:function(e,t){e.exports=m},"hiL/":function(e,t){e.exports=_},jOlS:function(e,t){e.exports=h},pVWH:function(e,t,n){"use strict";var a;!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(a||(a={})),t.e=a},u2MZ:function(e,t,n){"use strict";n.d(t,"i",function(){return l}),n.d(t,"t",function(){return u}),n.d(t,"n",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"o",function(){return _}),n.d(t,"r",function(){return a}),n.d(t,"l",function(){return h}),n.d(t,"s",function(){return b}),n.d(t,"d",function(){return g}),n.d(t,"c",function(){return v});var a,i=n("ut3N"),r=n("Pk8u"),o=n("pVWH"),s=n("hiL/"),c=/@/,d=/<.+@.+\..+>/,l=286,u=350,f=16,p=45,m=17,_=i._LogSource.create("PeopleWebPart");!function(e){e[e.CompactCard=1]="CompactCard",e[e.LargeCard=2]="LargeCard"}(a||(a={}));var h={allowEmailAddresses:!1,fallbackToEmailIfNoJob:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:o.e.user,useGraph:!0,resolveEmailIfNoResults:!1};function b(e){var t=Boolean(e.rawPersonData)&&e.rawPersonData.Description||"";return{email:e.email,id:e.userId,upn:t,name:e.name,role:e.job||e.department||"",department:e.department||"",phone:e.phone||"",sip:Object(r.get)(e,"rawPersonData.EntityData.SIPAddress","")}}function g(e){return d.exec(e)?"RFC5322":c.exec(e)?"Email":"Name"}function v(e,t){void 0===t&&(t=a.CompactCard);var n=t===a.CompactCard?2:3;return e?s.SPUtility.getUserPhotoUrl(e,n):""}},ut3N:function(e,t){e.exports=b},vlQI:function(e,t){e.exports=g},wxLm:function(e,t,n){"use strict";n("jOlS").loadStyles('.h_f_a3a8085b .i_f_a3a8085b:focus{outline:none}.h_f_a3a8085b .j_f_a3a8085b{cursor:pointer}.h_f_a3a8085b .k_f_a3a8085b.l_f_a3a8085b input{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]"}.m_f_a3a8085b .n_f_a3a8085b,.m_f_a3a8085b .o_f_a3a8085b{flex:none}.h_f_a3a8085b{display:flex}.p_f_a3a8085b{font-weight:400}.p_f_a3a8085b:not(.l_f_a3a8085b){font-size:12px}.q_f_a3a8085b,.p_f_a3a8085b{display:block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.r_f_a3a8085b.h_f_a3a8085b{align-items:center;justify-content:space-between;padding:0 0 0 5px}[dir=rtl] .r_f_a3a8085b.h_f_a3a8085b{padding:0 5px 0 0}.r_f_a3a8085b.h_f_a3a8085b .i_f_a3a8085b{display:inline-flex;flex:1 1 0%;min-width:0;align-items:center;height:76px}.r_f_a3a8085b.h_f_a3a8085b .s_f_a3a8085b,.r_f_a3a8085b.h_f_a3a8085b .t_f_a3a8085b{flex:0 0 auto}.r_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b{min-width:0;width:100%}[dir=ltr] .r_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b{padding-left:12px}[dir=ltr] .r_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b.u_f_a3a8085b,[dir=rtl] .r_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b{padding-right:12px}[dir=rtl] .r_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b.u_f_a3a8085b{padding-left:12px}.r_f_a3a8085b.h_f_a3a8085b .q_f_a3a8085b:not(.l_f_a3a8085b){font-weight:400;font-size:17px}.v_f_a3a8085b.h_f_a3a8085b{position:relative;flex-direction:column}.v_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b:not(.l_f_a3a8085b) input{font-size:17px}.v_f_a3a8085b.h_f_a3a8085b .i_f_a3a8085b{padding:0 16px;width:100%;box-sizing:border-box;height:calc(100% - 116px);display:flex;flex-direction:column}.v_f_a3a8085b.h_f_a3a8085b .i_f_a3a8085b button{min-width:0}.v_f_a3a8085b.h_f_a3a8085b .s_f_a3a8085b,.v_f_a3a8085b.h_f_a3a8085b .t_f_a3a8085b{align-self:center;margin:auto}.v_f_a3a8085b.h_f_a3a8085b .k_f_a3a8085b{height:78px}.v_f_a3a8085b.h_f_a3a8085b .q_f_a3a8085b:not(.l_f_a3a8085b){font-size:17px;font-weight:300}.v_f_a3a8085b.h_f_a3a8085b .q_f_a3a8085b,.v_f_a3a8085b.h_f_a3a8085b .p_f_a3a8085b{padding-bottom:8px}.v_f_a3a8085b.h_f_a3a8085b .f_f_a3a8085b{padding:0 16px;width:100%;flex:1 0 auto;margin-bottom:0;box-sizing:border-box}.v_f_a3a8085b.h_f_a3a8085b .w_f_a3a8085b{margin-bottom:5px;align-self:center}.v_f_a3a8085b.h_f_a3a8085b.x_f_a3a8085b .i_f_a3a8085b{display:none}.v_f_a3a8085b.h_f_a3a8085b.x_f_a3a8085b .f_f_a3a8085b{padding-top:16px}.y_f_a3a8085b{margin:auto}',!0),t.e={card:"h_f_a3a8085b",persona:"i_f_a3a8085b",hoverCard:"j_f_a3a8085b",personaDetails:"k_f_a3a8085b",fluent:"l_f_a3a8085b",buttons:"m_f_a3a8085b",deleteButton:"n_f_a3a8085b",dragAndDropButton:"o_f_a3a8085b",secondaryText:"p_f_a3a8085b",primaryText:"q_f_a3a8085b",compactLayout:"r_f_a3a8085b",livePersonaCard:"s_f_a3a8085b",personaCoin:"t_f_a3a8085b",placeholder:"u_f_a3a8085b",largeLayout:"v_f_a3a8085b",description:"f_f_a3a8085b",seeMoreButton:"w_f_a3a8085b",hidePersona:"x_f_a3a8085b",center:"y_f_a3a8085b"}},y88i:function(e,t){e.exports=v},yRoY:function(e){e.exports=JSON.parse('{"i":"0||1||2-","a":"{0} characters||{0} character||{0} characters","t":"{0} of {1}","e":"{0}. The description can contain up to {1}.","r":"Enter a description for this person","n":"Personal description"}')}})});