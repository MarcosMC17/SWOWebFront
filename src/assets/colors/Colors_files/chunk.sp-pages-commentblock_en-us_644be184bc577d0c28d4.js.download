(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[43],{"5Zgq":function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("y88i"),s=n("UWqr"),c=n("Pk8u"),d=n("QdXD");n("jOlS").loadStyles('.hz_af_ada2ac09{max-width:230px;max-height:450px}.hz_af_ada2ac09 .ia_af_ada2ac09{font-size:12px;font-weight:400;border:0;color:"[theme:neutralPrimary, default: #323130]";list-style:none;margin:0;padding:16px 25px;white-space:nowrap}.hz_af_ada2ac09 .ia_af_ada2ac09 .ib_af_ada2ac09{display:block;overflow:hidden;margin:0 0 20px;text-overflow:ellipsis}.hz_af_ada2ac09 .ia_af_ada2ac09 .ic_af_ada2ac09{margin:0}.hz_af_ada2ac09 .ia_af_ada2ac09 .ie_af_ada2ac09{margin:20px 0 0}',!0);var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.item.likedBy.slice(0,10),t=this.props.item.likeCount-e.length;return i.createElement("ul",{className:"ia_af_ada2ac09"},e.map(function(t,n){return n<e.length-1?i.createElement("li",{key:t.email,className:"ib_af_ada2ac09"},t.name):i.createElement("li",{key:t.email,className:"ic_af_ada2ac09"},t.name)}),Boolean(t)&&i.createElement("li",{key:"others",className:"ie_af_ada2ac09"},s.Text.format(d.i,t)))},t}(i.Component),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"finalProps",{get:function(){var e=this,t=this._likedByMessage(this.props.item),n={ariaLabel:this.props.item.likeCount?s.Text.format(d.e,t):t,"data-automation-id":"sp-likedbymessage",item:this.props.item,text:t,tooltipProps:{onRenderContent:function(){return i.createElement(l,{item:e.props.item})}}};return Object(c.merge)({},n,this.props)},enumerable:!1,configurable:!0}),t.prototype.render=function(){return this._includeTooltip(this.props.item)?i.createElement(r.TooltipHost,{className:"hz_af_ada2ac09",tooltipProps:this.finalProps.tooltipProps},i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))):i.createElement(r.ActionButton,Object(a.__assign)({},this.finalProps))},t.prototype._likedByMessage=function(e){var t=e.likeCount-Number(e.userLiked);return e.likeCount?s.Text.format(o.StringHelper.getLocalizedCountValue(e.userLiked?d.r:d.o,d.a,t),t):d.t},t.prototype._includeTooltip=function(e){return e.likedBy&&(e.likedBy.length>1||!e.userLiked&&1===e.likedBy.length)},t}(i.Component);t.e=u},"Bx+e":function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("Y7TA"),s=n("hiL/"),c=n("X+PM"),d=n("UWqr"),l=n("Ycni"),u=n("Yo/j"),f=n("RPce"),p=n("Rrln"),m=n("/OYS"),_=n("ECV1"),h=n("Pk8u"),b=n("F5rs");function g(e){var t={ariaLabel:b.b,className:"deleteAction"+e.comment.id,menuIconProps:{iconName:"More"},menuProps:{directionalHint:r.DirectionalHint.bottomRightEdge,items:[{key:"delete",iconProps:{iconName:"Trash"},name:b._,"data-automation-id":"comment-delete-button"}],isBeakVisible:!0}},n=Object(h.merge)({},t,e);return i.createElement(r.TooltipHost,{content:b.b,calloutProps:{gapSpace:0}},i.createElement(r.ActionButton,Object(a.__assign)({},n,{"data-automation-id":"comment-more-button"})))}var v=n("KOTo"),y=n("BP6t"),S=n("fPVX"),D=n("nSz9"),I=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isOpen:n.props.isOpen},n}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement(v.e,Object(a.__assign)({},this.props))},t.defaultProps={className:S.e.spLikesPanel,closeButtonAriaLabel:b.D,customWidth:"320px",headerText:b.L,isBlocking:!0,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},onRenderHeader:O,onRenderBody:w,type:y.e.custom},t}(r.BaseComponent);function x(e){var t=p.e.instance.serviceScope.consume(c.PageContext.serviceKey);return i.createElement(D.e,{pageContext:t,user:e,immediateLPC:!0})}function C(e){return i.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical},i.createElement(r.List,{className:S.e.spLikesList,items:e.comment.likedBy,onRenderCell:x}))}function O(){return i.createElement("div",{className:Object(r.css)("ms-Panel-header",S.e.spLikesPanelHeader)},i.createElement("p",{className:S.e.spLikesPanelHeaderText},b.L))}function w(e){return i.createElement("div",{className:Object(r.css)("ms-Panel-content",S.e.spLikesPanelContent)},i.createElement(C,Object(a.__assign)({},e)),e.comment.nextLikesLink&&i.createElement(r.ActionButton,{ariaLabel:b.y,onClick:function(){return u.e.getNextLikes(e.comment)},text:b.K}))}var E=n("xs0R"),A=n("QdXD");function L(e){var t,n={ariaLabel:(t=e.comment.userLiked,t?b.S:b.h),className:S.e.spActionLike,iconProps:{iconName:e.comment.userLiked?"LikeSolid":"Like"},text:e.comment.userLiked?A.n:A.t},o=Object(h.merge)({},n,e);return i.createElement(r.ActionButton,Object(a.__assign)({},o))}function k(e){var t={ariaLabel:d.Text.format(b.v,e.comment.author.name),className:S.e.spAction,iconProps:{iconName:"Reply"},text:b.g},n=Object(h.merge)({},t,e);return i.createElement(r.ActionButton,Object(a.__assign)({},n,{"data-automation-id":"comment-reply-button"}))}var M=n("5Zgq");function P(e){var t=p.e.instance.disableEditing,n=e.commentProps.data;return i.createElement("div",null,!t&&!n.isReply()&&n.isFromServer&&i.createElement(k,{comment:n,onClick:e.onReplyButtonClick}),!t&&n.isFromServer&&i.createElement(L,{comment:n,onClick:e.onLikeButtonClick}),!t&&n.likeCount-Number(n.userLiked)>0&&i.createElement(M.e,{item:n,onClick:n.likeCount?e.onLikedByMessageClick:e.onLikeButtonClick}))}var T=n("q+wp"),U=n("XdGY"),F=function(e){function t(n){var a=e.call(this,n)||this;return a._relativeTime=function(e){return e=a._forcePastDate(e),!a._mounted&&Object(U.l)()||!(null===l.LocaleFormat||void 0===l.LocaleFormat?void 0:l.LocaleFormat.formatRelativeTimeApproximate)?void 0:l.LocaleFormat.formatRelativeTimeApproximate(e)},a._assignComponentRef=function(e){a._componentRef=e},a._onDelete=function(){T.e.logUserEngagementForPage(E.t.fields,!0,"CommentDeleteOpenAction"),Object(s.DeferredDialogUtility)().then(function(e){e.showConfirmationDialog(b.x,void 0,function(){T.e.logUserEngagementForPage(E.t.fields,!0,"CommentDeleteConfirmAction"),u.e.deleteComment(a.props.data),T.e.alertScreenreader(b.p,b.f,a.props.replyCount),t._focusAfterDismiss(m.e.topLevelReply)},function(){T.e.logUserEngagementForPage(E.t.fields,!0,"CommentDeleteCancelAction"),t._focusAfterDismiss(a._moreActionsButton)},b.I,!0)})},a._onCloseLikedByPanel=function(){a.setState({isLikedByPanelVisible:!1})},a._onOpenLikedByPanel=function(){a._shouldGetLikes&&u.e.getNextLikes(a._comment),a.setState({isLikedByPanelVisible:!0})},a._onReply=function(){T.e.logUserEngagementForPage(E.t.fields,!0,"CommentReplyAction"),u.e.focusReply(a.props.parentCommentId||a._comment.id)},a._onToggleLikeButton=function(){a._comment&&a._sendToggleLikeAction(a._comment,p.e.instance.user)},a._onTimeClicked=function(){a._componentRef&&a._componentRef.scrollIntoView()},a._getAuthorUpn=function(e){return e.loginName?e.loginName.slice(e.loginName.lastIndexOf("|")+1):e.email},a._commentAnchorDisabled=!U.e.commentsTimeStampAriaLabel.isActivated(),a.state={isLikedByPanelVisible:!1,showReply:!1},a}return Object(a.__extends)(t,e),t._focusAfterDismiss=function(e){setTimeout(function(){e&&e.focus()},500)},t.prototype.componentDidMount=function(){this._mounted=!0},t.prototype.componentWillUnmount=function(){this._mounted=!1},t.prototype.render=function(){var e=p.e.instance.serviceScope.consume(c.PageContext.serviceKey),t=i.createElement(o.e,{personaType:"User",identifier:this._comment.author.email,lpcHoverTargetProps:{upn:this._getAuthorUpn(this._comment.author)},pageContext:e.legacyPageContext,moduleLoader:void 0,lpcCardBehavior:{disableHover:!0,onCardClose:void 0,onCardOpen:void 0}},this._authorComponent()),n=U.e.commentsTimeStampAriaLabel.isActivated()?b.t:d.Text.format(b.e,this._comment.author.name,this._relativeTime(this._comment.date)),s=i.createElement(P,{commentProps:this.props,onLikeButtonClick:this._onToggleLikeButton,onLikedByMessageClick:this._onOpenLikedByPanel,onReplyButtonClick:this._onReply});return i.createElement("div",{className:Object(r.css)(S.e.spContentRegion,r.AnimationClassNames.scaleUpIn100),ref:this._assignComponentRef},i.createElement(f.e,{disabled:!1,user:this._comment.author}),i.createElement("div",{className:S.e.spContent},t,i.createElement("div",{className:S.e.spMetadata},this._commentAnchorDisabled?i.createElement(r.Label,{"aria-label":n,title:n,className:Object(U.te)()?S.e.originalColor:void 0},this._relativeTime(this._comment.date)):i.createElement(r.Link,Object(a.__assign)({"aria-label":n,title:n,onClick:this._onTimeClicked},{href:this._link()}),this._relativeTime(this._comment.date))),i.createElement("div",{className:S.e.spText},i.createElement(_.e,{mentions:this._comment.mentions,pageContext:e,text:this._comment.text})),i.createElement("div",{className:Object(r.css)(S.e.spActions,this.props.data.isFromServer?r.AnimationClassNames.fadeIn500:S.e.spActionsHidden)},s,this._canDelete()&&!p.e.instance.disableEditing&&this._comment.isFromServer&&i.createElement(g,{comment:this._comment,componentRef:this._resolveRef("_moreActionsButton"),menuProps:{onItemClick:this._onDelete}}))),i.createElement(I,{comment:this._comment,isOpen:this.state.isLikedByPanelVisible,onDismiss:this._onCloseLikedByPanel}))},t.prototype._authorComponent=function(){return i.createElement("span",{className:S.e.spAuthor},this._comment.author.name)},t.prototype._canDelete=function(){return p.e.instance.deleteAllPermission||this._comment.author.email===p.e.instance.user.email},Object.defineProperty(t.prototype,"_comment",{get:function(){return this.props.data},enumerable:!1,configurable:!0}),t.prototype._forcePastDate=function(e){var t=new Date;return e<=t?e:t},t.prototype._sendToggleLikeAction=function(e,t){e.userLiked?u.e.unlikeComment(e,t):u.e.likeComment(e,t)},Object.defineProperty(t.prototype,"_shouldGetLikes",{get:function(){return this._comment.likedBy&&this._comment.likedBy.length<25&&Boolean(this._comment.nextLikesLink)},enumerable:!1,configurable:!0}),t.prototype._link=function(){return"#comment="+this._comment.id+(this._comment.isReply()?"&parentComment="+this._comment.parentId:"")},t}(r.BaseComponent),H=n("m9Fc"),R=n("PJr9"),N=function(e){function t(t){var n=e.call(this,t)||this;return n._onLoadMore=function(){T.e.logUserEngagementForPage(E.t.fields,!0,"LoadMoreCommentReplies"),u.e.getNextReplies(n.props.data.nextLink,n.props.data.id)},n._processActions=function(){var e=E.t.pageReduxStore.getState(),t=e.comments.focusedCommentId;e.slicesUpdated.indexOf(R.e.CommentStore)>-1&&e.slicesUpdated.indexOf(R.e.ActionStore)>-1&&(n.props.data.id===t||n.state.showReply)&&n.props.data&&(n.state.showReply&&n._replyBlock.focus(),n.setState({showReply:n.props.data.id===t}))},n._assignReplyBlockRef=function(e){n._replyBlock=e},n.state={showReply:!1},n}return Object(a.__extends)(t,e),t.prototype.componentDidMount=function(){this._addStoreListeners()},t.prototype.componentWillUnmount=function(){this._removeStoreListeners()},t.prototype.render=function(){var e=this;return i.createElement("div",{className:Object(r.css)(S.e.spComment,this.props.data.isDeleted()?r.AnimationClassNames.scaleDownOut98:""),"data-automation-id":this.props.data.isReply()?"sp-comment-block-reply":"sp-comment-block-root",id:"sp-comment-"+this.props.data.id},i.createElement(F,{data:this.props.data,disallowEdit:p.e.instance.disableEditing||!this.props.data.isFromServer,parentCommentId:this.props.parentCommentId,replyCount:this.props.data.replies.length}),this.props.data.replies&&(this.props.data.replies.length>0||this.state.showReply)&&i.createElement("div",{className:S.e.spComments},this._nextLinkElement(),this.props.data.replies.map(function(n){return i.createElement(t,{data:n,key:n.optimisticId||n.id,parentCommentId:e.props.data.id})}),this._replyElement()))},t.prototype._addStoreListeners=function(){this._unlisten=E.t.addListener(this._processActions)},t.prototype._nextLinkElement=function(){return this.props.data.nextLink&&i.createElement(r.Link,{className:[S.e.spMore,S.e.spMoreBlock].join(" "),onClick:this._onLoadMore},b.W)},t.prototype._removeStoreListeners=function(){this._unlisten&&this._unlisten()},t.prototype._replyElement=function(){return this.state.showReply?i.createElement(H.e,{autoFocus:!0,commentId:this.props.data.id,disabled:p.e.instance.disableEditing,ref:this._assignReplyBlockRef}):void 0},t}(i.Component);t.default=N},EIbq:function(e,t,n){"use strict";n.d(t,"e",function(){return p});var a,i=n("KL1q"),r=n("17wl"),o=n("cDcd"),s=n("faye"),c={},d=Object(i.classNamesFunction)(),l=function(e){function t(t){var n=e.call(this,t)||this;return n._rootRef=o.createRef(),n._createLayerElement=function(){var e=n.props.hostId,t=Object(i.getDocument)(n._rootRef.current),a=n._getHost();if(t&&a){n._removeLayerElement();var r=t.createElement("div"),o=n._getClassNames();r.className=o.root,Object(i.setPortalAttribute)(r),Object(i.setVirtualParent)(r,n._rootRef.current),n.props.insertFirst?a.insertBefore(r,a.firstChild):a.appendChild(r),n.setState({hostId:e,layerElement:r},function(){var e=n.props,t=e.onLayerDidMount,a=e.onLayerMounted;a&&a(),t&&t()})}},n.state={},n}return Object(r.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this.props.hostId;this._createLayerElement(),e&&function(e,t){c[e]||(c[e]=[]),c[e].push(t)}(e,this._createLayerElement)},t.prototype.render=function(){var e=this.state.layerElement,t=this._getClassNames(),n=this.props.eventBubblingEnabled;return o.createElement("span",{className:"ms-layer",ref:this._rootRef},e&&s.createPortal(o.createElement(i.Fabric,Object(r.__assign)({},!n&&(a||(a={},["onClick","onContextMenu","onDoubleClick","onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOver","onMouseOut","onMouseUp","onTouchMove","onTouchStart","onTouchCancel","onTouchEnd","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur","onChange","onInput","onInvalid","onSubmit"].forEach(function(e){return a[e]=u})),a),{className:t.content}),this.props.children),e))},t.prototype.componentDidUpdate=function(){this.props.hostId!==this.state.hostId&&this._createLayerElement()},t.prototype.componentWillUnmount=function(){var e=this.props.hostId;this._removeLayerElement(),e&&function(e,t){if(c[e]){var n=c[e].indexOf(t);n>=0&&(c[e].splice(n,1),0===c[e].length&&delete c[e])}}(e,this._createLayerElement)},t.prototype._removeLayerElement=function(){var e=this.props.onLayerWillUnmount,t=this.state.layerElement;if(t&&Object(i.setVirtualParent)(t,null),e&&e(),t&&t.parentNode){var n=t.parentNode;n&&n.removeChild(t)}},t.prototype._getClassNames=function(){var e=this.props,t=e.className,n=e.styles,a=e.theme;return d(n,{theme:a,className:t,isNotHost:!this.props.hostId})},t.prototype._getHost=function(){var e=this.props.hostId,t=Object(i.getDocument)(this._rootRef.current);if(t)return e?t.getElementById(e):t.body},t.defaultProps={onLayerDidMount:function(){},onLayerWillUnmount:function(){}},Object(r.__decorate)([Object(i.customizable)("Layer",["theme","hostId"])],t)}(o.Component),u=function(e){e.eventPhase===Event.BUBBLING_PHASE&&"mouseenter"!==e.type&&"mouseleave"!==e.type&&"touchstart"!==e.type&&"touchend"!==e.type&&e.stopPropagation()},f={root:"ms-Layer",rootNoHost:"ms-Layer--fixed",content:"ms-Layer-content"},p=Object(i.styled)(l,function(e){var t=e.className,n=e.isNotHost,a=e.theme,r=Object(i.getGlobalClassNames)(f,a);return{root:[r.root,a.fonts.medium,n&&[r.rootNoHost,{position:"fixed",zIndex:i.ZIndexes.Layer,top:0,left:0,bottom:0,right:0,visibility:"hidden"}],t],content:[r.content,{visibility:"visible"}]}},void 0,{scope:"Layer",fields:["hostId","theme","styles"]})},QdXD:function(e){e.exports=JSON.parse('{"e":"{0}, enter to see details.","t":"Like","n":"Unlike","i":"and {0} more...","r":"You liked this||You and {0} person liked this||You and {0} people liked this","o":"||{0} person liked this||{0} people liked this","a":"0||1||2-"}')},nSz9:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("Y7TA"),o=n("UWqr"),s=n("fiok"),c=n.n(s),d=n("hiL/"),l=n("q79n");n("jOlS").loadStyles('.fy_ac_ada2ac09{padding:7px 0;vertical-align:middle}.fy_ac_ada2ac09 .fz_ac_ada2ac09{border-radius:50%;vertical-align:middle}[dir=ltr] .fy_ac_ada2ac09 .fz_ac_ada2ac09{margin-right:10px}[dir=rtl] .fy_ac_ada2ac09 .fz_ac_ada2ac09{margin-left:10px}.fy_ac_ada2ac09 .ga_ac_ada2ac09{font-size:14px;font-weight:400;color:"[theme:bodyText, default: #323130]";vertical-align:middle}',!0);var u=function(e){function t(t){var n=e.call(this,t)||this;return n.state={},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.ariaLabel,n=e.user,a=e.lpcCardBehavior,o=e.immediateLPC;return i.createElement(r.e,{personaType:"User",identifier:n.email,pageContext:this.props.pageContext.legacyPageContext,lpcCardBehavior:a,ariaLabel:t,moduleLoader:void 0,forceLoad:o},this._renderPersonaCell())},t.prototype._renderPersonaCell=function(){var e=void 0===this.props.size?32:this.props.size;return i.createElement("div",{className:"fy_ac_ada2ac09","data-is-focusable":!0,"aria-label":this.props.user.name},i.createElement(c.a,{key:this.props.user.email,dimensions:{height:e,width:e},displayName:this.props.user.name},i.createElement("img",{alt:o.Text.format(l.e,this.props.user.name),className:"fz_ac_ada2ac09",src:d.SPUtility.getUserPhotoUrl(this.props.user.email)})),i.createElement("span",{className:"ga_ac_ada2ac09"},this.props.user.name))},t}(i.Component);t.e=u},q79n:function(e){e.exports=JSON.parse('{"e":"Photo of {0}"}')}}]);