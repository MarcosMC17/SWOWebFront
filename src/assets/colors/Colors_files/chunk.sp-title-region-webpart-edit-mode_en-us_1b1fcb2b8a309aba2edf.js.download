(window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee||[]).push([[19],{"1NDK":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("cDcd"),i=n("KL1q"),r=n("Pl8B"),o=n("ad5q"),s=a.createElement("div",{className:o.e.dropOverlayContainer},a.createElement(i.Icon,{className:Object(i.css)(o.e.dropOverlay,o.e.dropOverlayIcon),iconName:"Photo2"}),a.createElement("p",{className:Object(i.css)(o.e.dropOverlay,o.e.dropOverlayMessage)},r.b))},"3HEj":function(e,t,n){"use strict";var a,i,r,o,s,c;function d(e){var t=e.webAbsoluteUrl,n=e.webServerRelativeUrl;return"/"===n||""===n?t:t.substring(0,t.lastIndexOf(n))}function l(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl}n.d(t,"t",function(){return d}),n.d(t,"e",function(){return l}),n("K9kD"),n("NacN"),function(e){e[e.NoWarning=0]="NoWarning",e[e.Warning=1]="Warning",e[e.OverQuota=2]="OverQuota"}(a||(a={})),function(e){e[e.Default=0]="Default",e[e.AllPages=1]="AllPages",e[e.ModernOnly=2]="ModernOnly",e[e.Hidden=3]="Hidden"}(i||(i={})),function(e){e[e.None=0]="None",e[e.PrivateChannel=1]="PrivateChannel",e[e.SharedChannel=2]="SharedChannel",e[e.StandardChannel=3]="StandardChannel"}(r||(r={})),function(e){e[e.Open=0]="Open",e[e.Implicit=1]="Implicit",e[e.Explicit=2]="Explicit",e[e.OwnerModerated=3]="OwnerModerated",e[e.Inferred=4]="Inferred"}(o||(o={})),function(e){e[e.Default=0]="Default",e[e.Tenant=1]="Tenant",e[e.Hub=2]="Hub",e[e.Site=3]="Site"}(s||(s={})),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1",e[e.HideTitleInHeader=33554432]="HideTitleInHeader",e[e.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}(c||(c={}))},"6eUj":function(e,t,n){e.exports=n.p+"external_db10a8f3057309d3ee48b7ebeb2ef0a1.png"},"8oAD":function(e){e.exports=JSON.parse('{"n":"Add a name","e":"Page title: {0}. When finished editing, press Tab to go to the author field to change the author, or press Escape to edit page content.","t":"Title region. Page name area. Enter a name for the page. Press Tab to move into the page author area. Press Tab a second time followed by Enter to change settings on the Property Pane."}')},AoP7:function(e){e.exports=JSON.parse('{"i":"Can\\u0027t upload","o":"A file with this name already exists.","s":"You do not have permission to save to the folder where images are stored.","c":"We\\u0027re having trouble getting this image for you. Please select a different image, or try again later.","d":"Image uploaded.","u":"The image is uploading.","r":"Can\\u0027t upload the image. Some possible reasons are: an image with the same name already exists, the file name or type of the image is not supported, there\\u0027s an issue with your connection. Check for these issues and then try again.\\n  ","l":"We\\u0027re still uploading your image. It may get lost if you leave this page.","e":"This doesn\\u0027t seem like a supported image file. Please select a different image.","t":"The background image has been changed.","n":"The background image has been removed.","a":"The background image has been reset to the default image."}')},E3Wp:function(e){e.exports=JSON.parse('{"e":"Uploading..."}')},IHjQ:function(e){e.exports=JSON.parse('{"p":"Customize the title area of your page including layout, publish date, and topic header.","l":"Layout","n":"Alignment","_":"Show text block above title","s":"Show background gradient","c":"Disabling background gradient may affect legibility for some readers","g":"Text above title","S":"Yes","f":"No","m":"Show published date","t":"Left","e":"Center","i":"Alternative text","a":"Provide alternative text to describe the background image. Alternative text helps people with screen readers understand the content of the pictures.","y":"Learn more about alternative text","u":"Plain","r":"Color block","o":"Overlap","d":"Image and title","b":"40 character limit - {0} characters left||40 character limit - {0} character left||40 character limit - {0} characters left","h":"0||1||2-","v":"Enter text"}')},Pl8B:function(e){e.exports=JSON.parse('{"o":"Browse images","B":"Uploadingâ€¦","T":"Drag or paste an image here or browse for images","U":"Image","s":"Add a caption","N":"Image toolbar. Press up and down arrow keys to move between items.","_":"Rotate crop box","m":"Reset","f":"Aspect ratios","c":"Crop to 16/9 ratio","u":"Crop to 4/3 ratio","l":"Crop to 3/2 ratio","d":"Crop to 1/1 ratio","p":"Crop with free ratio","V":"Container for the Image Editor. Use control arrow keys to move the crop area and shift arrow key to resize","j":"Do more with your image","D":"Image has been {0} aligned","i":"left","e":"center","r":"right","h":"The selected area is at left {0} top {1} with the size of width {2} height {3}","v":"We\\u0027re having trouble getting this image for you. Try downloading the image from the source site and then upload it from your computer. ","y":"Source site.","S":"Image added.","x":"Click your image to show a toolbar for options like cropping and resizing. Use the Edit button on the left of the image for more options like adding a link and adding text over the image.","C":"Learn more","R":"Add your text here. You can add a total of {0} characters.","E":"Resize","O":"Alignment","w":"Change image","A":"Save","n":"Align left","t":"Align center","a":"Align right","g":"Enter resize mode.","F":"Use left or right arrow keys to change the size of the image.","H":"The image width is {0} pixels, and uses {1}% of the column.","M":"Image can\\u0027t be smaller. The minimum size is {0} pixels.","k":"Image can\\u0027t be larger. The maximum size is {0} pixels.","b":"Drag or paste here","L":"Image has been reset to default settings.","P":"Image changes have been saved.","I":"Image: {0}, {1}, {2}"}')},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},QhGY:function(e){e.exports=JSON.parse('{"i":"Edit web part","e":"Change image","n":"Remove image","a":"Reset to default image","t":"Set image focal point","r":"Title region toolbar. Press up and down arrow keys to move between items."}')},U4Ku:function(e){e.exports=JSON.parse('{"t":"Page author byline. Enter a name, alias, or email address. ","e":"The profile for {0} has been added."}')},Z4sK:function(e){e.exports=JSON.parse('{"i":"Name or email address","t":"No results found","e":"Enter more characters","n":"{0}. The person selected is {1}. {2}.","a":"People profiles showing. Press up or down arrow keys to move between profile."}')},ad5q:function(e,t,n){"use strict";var a=n("jOlS"),i=n("i69V"),r=n.n(i),o=n("6eUj"),s=n.n(o),c=r()(s.a);a.loadStyles('.g_c_9f38462c{position:relative;height:auto;text-align:left}.g_c_9f38462c,.g_c_9f38462c.h_c_9f38462c img{max-width:100%;max-height:100%}.g_c_9f38462c.h_c_9f38462c.i_c_9f38462c{margin:0 auto}.g_c_9f38462c.h_c_9f38462c.i_c_9f38462c img{width:100%;box-sizing:border-box}.g_c_9f38462c input{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.g_c_9f38462c .j_c_9f38462c{position:absolute;top:-48px;z-index:1;transition:all .3s ease-out}[dir=ltr] .g_c_9f38462c .j_c_9f38462c{left:-8px}[dir=rtl] .g_c_9f38462c .j_c_9f38462c{right:-8px}.g_c_9f38462c .k_c_9f38462c svg{width:16px;height:16px}.g_c_9f38462c .k_c_9f38462c .themeableSvgPath{fill:"[theme:bodyBackground, default: #ffffff]"}.g_c_9f38462c .k_c_9f38462c .l_c_9f38462c{z-index:2;display:block;position:absolute;transition:1s;width:34px;left:68px}.m_c_9f38462c{overflow:hidden;width:100%;height:100%;text-align:left}[dir=ltr] .n_c_9f38462c{margin-right:8px}[dir=rtl] .n_c_9f38462c{margin-left:8px}.o_c_9f38462c{width:100%;height:100%;text-align:left}.o_c_9f38462c::-moz-focus-inner{border:0}.o_c_9f38462c{outline:transparent;position:relative}.o_c_9f38462c.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .o_c_9f38462c:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.o_c_9f38462c .p_c_9f38462c{transition:opacity .3s ease;-webkit-user-select:none;-ms-user-select:none;user-select:none}.g_c_9f38462c.h_c_9f38462c{margin:0 auto}.q_c_9f38462c,.r_c_9f38462c{z-index:2}.q_c_9f38462c::-moz-focus-inner,.r_c_9f38462c::-moz-focus-inner{border:0}.q_c_9f38462c,.r_c_9f38462c{outline:transparent;position:relative}.q_c_9f38462c.ms-Fabric.is-focusVisible:focus:after,.r_c_9f38462c.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .q_c_9f38462c:focus:after,.ms-Fabric.is-focusVisible .r_c_9f38462c:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.q_c_9f38462c.p_c_9f38462c,.r_c_9f38462c.p_c_9f38462c{overflow:visible}.r_c_9f38462c img,.q_c_9f38462c img{max-width:100%}.r_c_9f38462c .cropper-crop-box:focus{outline:none}.r_c_9f38462c .cropper-point{width:12px;height:12px;opacity:.75;background-color:"[theme:bodyBackground, default: #ffffff]"}.r_c_9f38462c .point-se{width:12px!important;height:12px!important}.q_c_9f38462c .cropper-line,.q_c_9f38462c .cropper-point{display:none}.p_c_9f38462c{margin:0 auto;overflow:hidden;width:100%;max-width:100%}.p_c_9f38462c .s_c_9f38462c{min-height:100px}.p_c_9f38462c .s_c_9f38462c .t_c_9f38462c{position:absolute;top:50%;transform:translate(-50%,-50%);padding:10px;text-align:center;background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]"}[dir=ltr] .p_c_9f38462c .s_c_9f38462c .t_c_9f38462c{left:50%}[dir=rtl] .p_c_9f38462c .s_c_9f38462c .t_c_9f38462c{right:50%}.p_c_9f38462c .s_c_9f38462c .t_c_9f38462c .u_c_9f38462c{display:block;font-size:48px;margin:8px 0;color:#fff;animation:v_c_9f38462c 2s linear infinite}@keyframes v_c_9f38462c{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.p_c_9f38462c .w_c_9f38462c{opacity:.5}.p_c_9f38462c .x_c_9f38462c{opacity:1}.p_c_9f38462c .x_c_9f38462c.y_c_9f38462c{display:none}.p_c_9f38462c img{display:block;margin:0 auto;position:relative}.p_c_9f38462c img:not([src]){display:none}.z_c_9f38462c{width:100%;height:100%}.z_c_9f38462c img.aa_c_9f38462c{-o-object-fit:fill;object-fit:fill}.z_c_9f38462c img.ab_c_9f38462c{-o-object-fit:contain;object-fit:contain}.z_c_9f38462c img.ac_c_9f38462c{-o-object-fit:cover;object-fit:cover}.z_c_9f38462c img.ae_c_9f38462c{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);height:auto;width:100%}.z_c_9f38462c img.af_c_9f38462c{-o-object-fit:scale-down;object-fit:scale-down}.z_c_9f38462c img.ag_c_9f38462c{-o-object-fit:none;object-fit:none}.ah_c_9f38462c{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.ai_c_9f38462c{margin-right:-15px;margin-left:-15px}.aj_c_9f38462c{display:flex;flex-direction:column;align-items:center;max-width:300px;padding:10px}.ak_c_9f38462c{margin-top:10px}[dir=ltr] .al_c_9f38462c{float:right}[dir=rtl] .al_c_9f38462c{float:left}.am_c_9f38462c{background:transparent!important}.an_c_9f38462c{text-decoration:underline!important}.an_c_9f38462c:hover{text-decoration:none!important}.ao_c_9f38462c{z-index:3;pointer-events:none;position:absolute;width:100%;height:100%;background-color:"[theme:themeDarker, default: #004578]";opacity:.8;text-align:center}.ap_c_9f38462c{color:"[theme:white, default: #ffffff]";position:absolute;transform:translate(-50%,-50%)}.ap_c_9f38462c.aq_c_9f38462c{font-size:68px;top:calc(50% - 20px)}.ap_c_9f38462c.ar_c_9f38462c{display:inline-block;font-size:18px;top:calc(50% + 20px)}.as_c_9f38462c:hover:before{content:url('+c+');width:20px;height:20px;z-index:1;position:absolute;right:17px;top:12px}.as_c_9f38462c:hover:after{position:absolute;content:"";height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,rgba(0,0,0,.5),transparent 23.9%)}.at_c_9f38462c:hover{cursor:pointer}',!0),t.e={imageFrame:"g_c_9f38462c",isInline:"h_c_9f38462c",imageNone:"i_c_9f38462c",controlToolbar__above:"j_c_9f38462c",controlToolbar:"k_c_9f38462c",aspectRatioButtonGroup:"l_c_9f38462c",localFilePreviewFrame:"m_c_9f38462c",changeButton:"n_c_9f38462c",editFrame:"o_c_9f38462c",imageArea:"p_c_9f38462c",imageCropWrapper:"q_c_9f38462c",imageCropWrapperFree:"r_c_9f38462c",uploadingIconArea:"s_c_9f38462c",uploadingIcon:"t_c_9f38462c",uploadingSpinner:"u_c_9f38462c",spin:"v_c_9f38462c",imagePreview:"w_c_9f38462c",imageRender:"x_c_9f38462c",imageIsLoading:"y_c_9f38462c",objectFit:"z_c_9f38462c",objectFitFill:"aa_c_9f38462c",objectFitContain:"ab_c_9f38462c",objectFitCover:"ac_c_9f38462c",objectFitCoverIE11:"ae_c_9f38462c",objectFitScaleDown:"af_c_9f38462c",objectFitNone:"ag_c_9f38462c",screenReaderOnly:"ah_c_9f38462c",row:"ai_c_9f38462c",toolTip:"aj_c_9f38462c",altTextVerifyButton:"ak_c_9f38462c",dismissButtonContainer:"al_c_9f38462c",errorMessageBar:"am_c_9f38462c",errorMessageExternalSrcLink:"an_c_9f38462c",dropOverlayContainer:"ao_c_9f38462c",dropOverlay:"ap_c_9f38462c",dropOverlayIcon:"aq_c_9f38462c",dropOverlayMessage:"ar_c_9f38462c",linkImageContainer:"as_c_9f38462c",expandImageContainer:"at_c_9f38462c"}},dq6a:function(e,t,n){"use strict";var a=n("17wl"),i=n("K9kD"),r=function(){function e(e,t){var n=this._pageContext=t.pageContext,r=t.tokenProvider,o=t.dataRequestorType,s=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:r})||this}return Object(a.__extends)(t,e),t}(i.DataRequestor):o,c=e.dataSourceName,d=void 0===c?"DataSource":c;this.dataRequestor=new s({qosName:d})}return e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f){void 0===i&&(i="POST");var p=e(),m=a&&a(),_=this.needsRequestDigest(p);return this.dataRequestor.getData({url:p,parseResponse:t,qosName:n,additionalPostData:m,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:_,authToken:f})},e}();t.e=r},iZ1p:function(e){e.exports=JSON.parse('{"n":"Search Directory","t":"Remove {0}","e":"Suggested people"}')},r9Fm:function(e,t,n){"use strict";n.d(t,"e",function(){return i}),n.d(t,"t",function(){return a}),n.d(t,"n",function(){return r});var a,i={Square:"Square",Wide:"Wide",Tall:"Tall",All:"All"};!function(e){e[e.Documents=1]="Documents",e[e.Images=2]="Images",e[e.Pages=3]="Pages",e[e.Videos=4]="Videos",e[e.Audios=5]="Audios",e[e.Models=6]="Models",e[e.BasicDocuments=7]="BasicDocuments",e[e.Transcripts=8]="Transcripts",e[e.VideosWithWebm=9]="VideosWithWebm"}(a||(a={}));var r={Files:1,FoldersOnly:2,FoldersAndFiles:3}},rPhJ:function(e){e.exports=JSON.parse('{"n":"Focal point set at {0} percent from left and {1} percent from top.","t":"Drag to set a focal point.","a":"Use up, down, right, and left arrow keys to set focal point of image. Use Enter key to leave focal point mode.","e":"Focal point setting finished."}')},vHG5:function(e,t,n){"use strict";n.r(t),n.d(t,"FocalPoint",function(){return f}),n.d(t,"TitleInput",function(){return h}),n.d(t,"TitleRegionEditMode",function(){return B}),n.d(t,"TitleRegionPropertyPane",function(){return G}),n.d(t,"TitleToolbar",function(){return v}),n.d(t,"UploadSpinner",function(){return D}),n.d(t,"DefaultAuthorPopulator",function(){return Le}),n.d(t,"PeopleCardPlaceholder",function(){return nt});var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("KL1q"),s=n("UWqr"),c=n("hiL/"),d=n("LIhD"),l=n("jOlS");l.loadStyles('.ky_ak_9f38462c{width:100%;height:100%;position:relative;background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";transition:all .5s ease;opacity:0}.ks_ak_9f38462c .ky_ak_9f38462c{display:none}.ky_ak_9f38462c .kz_ak_9f38462c{position:absolute;pointer-events:none;-webkit-user-select:none;-ms-user-select:none;user-select:none;top:50%;left:50%;transform:translate(-50%,-50%);width:64px;height:64px;border:2px solid "[theme:yellowlight, default: #fff100]";border-radius:50%;background-color:"[theme:whiteTranslucent40, default: rgba(255,255,255,.4)]";display:flex;align-items:center;justify-content:center}.ky_ak_9f38462c .kz_ak_9f38462c .la_ak_9f38462c{color:#fff;position:relative;font-size:32px}.ky_ak_9f38462c .lb_ak_9f38462c{position:absolute;color:#fff;top:50%;left:50%;transform:translate(-50%,-50%);font-size:14px;margin-top:50px}.ky_ak_9f38462c.lc_ak_9f38462c{opacity:1;z-index:2}.ky_ak_9f38462c.le_ak_9f38462c{cursor:pointer}',!0);var u=n("rPhJ"),f=function(e){function t(t){var n=e.call(this,t)||this;return n._focalFrame=i.createRef(),n._onDragStart=function(e){e.stopPropagation(),e.preventDefault(),n.setState({isDragging:!0})},n._onDragMove=function(e){if(n._focalFrame.current&&n.state.isDragging){e.preventDefault(),e.stopPropagation();var t=n._focalFrame.current.clientWidth,a=n._focalFrame.current.clientHeight,i=Math.min(Math.max(e.nativeEvent.offsetX,0),t),r=Math.min(Math.max(e.nativeEvent.offsetY,0),a);n._onFocalPointMove({x:i/t*100,y:r/a*100})}},n._onDragEnd=function(e){e.stopPropagation(),e.preventDefault(),n.setState({isDragging:!1}),n._onFocalPointEnd("Mouse")},n._handleMouseLeave=function(e){n.state.isDragging&&(e.stopPropagation(),e.preventDefault(),n.setState({isDragging:!1}),n._onFocalPointEnd("Mouse"))},n._handleKeyDown=function(e){e.stopPropagation(),e.preventDefault();var t=Object(d.e)(n.props.position),a=t.x,i=t.y;n._isKey(o.KeyCodes.enter,e)?n._onFocalPointEnd("Keyboard"):(n._isKey(o.KeyCodes.escape,e)?(a=50,i=50):n._isKey(o.KeyCodes.left,e)?a--:n._isKey(o.KeyCodes.up,e)?i--:n._isKey(o.KeyCodes.right,e)?a++:n._isKey(o.KeyCodes.down,e)&&i++,n._onFocalPointMove({x:Math.min(Math.max(Math.round(a),0),100),y:Math.min(Math.max(Math.round(i),0),100)}))},n._debounceReadPosition=n._async.debounce(n._readPosition,500,{leading:!1}),n.state={isDragging:!1},n}return Object(a.__extends)(t,e),t.focus=function(e){setTimeout(function(){if(e){var t=r.findDOMNode(e);if(t instanceof Element){var n=t.classList.contains("ky_ak_9f38462c")?t:t.querySelector(".ky_ak_9f38462c");n instanceof HTMLElement&&(c.ScreenReaderAlert.read(u.a,c.ReadingMode.ReadImmediately),n.setAttribute("data-automation-id","focalFrameIsSetting"),n.focus())}}})},t.prototype.render=function(){var e=Object(d.e)(this.props.position),t=e.x,n=e.y,a=void 0===this.props.position&&i.createElement("div",{className:"lb_ak_9f38462c"},u.t),r=Object(o.css)("ky_ak_9f38462c","lc_ak_9f38462c",this.state.isDragging&&"le_ak_9f38462c"),s=Object(o.css)(Object(o.getIconClassName)("SIPMove"),"la_ak_9f38462c");return i.createElement("div",{className:r,tabIndex:0,role:"region",onMouseDown:this._onDragStart,onMouseMove:this._onDragMove,onMouseUp:this._onDragEnd,onMouseLeave:this._handleMouseLeave,onKeyDown:this._handleKeyDown,ref:this._focalFrame,"data-automation-id":this.state.isDragging?"focalFrameIsDragging":"","data-sp-a11y-skipkeys":"all"},i.createElement("div",{className:"kz_ak_9f38462c","data-automation-id":"titleRegionFocalCircle",style:{left:t+"%",top:n+"%"}},i.createElement("i",{className:s,"aria-hidden":!0})),a)},t.prototype._isKey=function(e,t){return t.keyCode===e&&!t.altKey&&!t.ctrlKey&&!t.shiftKey},t.prototype._onFocalPointEnd=function(e){c.ScreenReaderAlert.read(u.e,c.ReadingMode.ReadImmediately),this.props.onFocalPointEnd(e)},t.prototype._onFocalPointMove=function(e){this._debounceReadPosition(e),this.props.onFocalPointMove(e)},t.prototype._readPosition=function(e){var t=s.Text.format(u.n,e.x,e.y);c.ScreenReaderAlert.read(t,c.ReadingMode.ReadImmediately)},t.hideClassName="ks_ak_9f38462c",t}(o.BaseComponent),p=n("ut3N"),m=n("y88i");l.loadStyles('.kl_ag_9f38462c{overflow:hidden;overflow-y:hidden;text-overflow:ellipsis;resize:none}.km_ag_9f38462c{border-style:none;background-color:transparent}.kn_ag_9f38462c,.ko_ag_9f38462c{position:relative}.kn_ag_9f38462c{width:100%}.kp_ag_9f38462c{min-height:1.3em}.kq_ag_9f38462c{outline:none}.kq_ag_9f38462c:empty:not(:focus):before{content:attr(placeholder);color:"[theme:neutralTertiary, default: #a19f9d]"}.kq_ag_9f38462c:not(:focus):after{content:attr(hint-text);color:"[theme:neutralTertiary, default: #a19f9d]";font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}',!0);var _=n("8oAD"),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._inputRef=i.createRef(),t._handleKeyPress=function(e){if("Enter"===e.key){e.preventDefault(),t._inputRef.current&&t.props.onCommitTitle(t._inputRef.current.value);var n=document.querySelector(".ControlZone.ControlZone--edit"),a=n&&n.querySelector(".cke_editable"),i=void 0;a instanceof HTMLElement?(a.focus(),i="textWebPart"):n instanceof HTMLElement?(n.focus(),i="controlZone"):i="none";var r=new p._LogEntry("TitleRegionWebPart","PressEnterFocus",p._LogType.Event,{focusTarget:i.toString()});p._EngagementLogger.logEventWithLogEntry(r)}},t._handleBlur=function(){t._inputRef.current&&t.props.onCommitTitle(t._inputRef.current.value)},t._handleMultipleLineInputChange=function(){t._handleChange(),t._updateHeight()},t._handleSingleLineInputChange=function(){t._handleChange()},t._updateHeight=function(){if(t._inputRef.current&&!t._shouldRenderSingleLine){t._inputRef.current.style.height="auto";var e=t._inputRef.current.scrollHeight;e>0&&(t._inputRef.current.style.height=e+"px")}},t._handlePropertyPaneToggled=function(e){e&&e.origin===window.location.origin&&"Property pane toggled"===e.data&&t._updateHeight()},t}return Object(a.__extends)(t,e),t.focus=function(e,n){setTimeout(function(){if(e){var a=r.findDOMNode(e);if(a&&a instanceof Element){var i=a.classList.contains("km_ag_9f38462c")?a:a.querySelector(".km_ag_9f38462c");i instanceof HTMLElement&&(i.focus(),n&&(i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement)&&t.moveCaretToEnd(i))}}})},t.moveCaretToEnd=function(e){if(void 0!==e.setSelectionRange){var t=e.value?e.value.length:0;e.setSelectionRange(t,t)}},t.prototype.componentDidMount=function(){setTimeout(this._updateHeight),window.addEventListener("resize",this._updateHeight),window.addEventListener("message",this._handlePropertyPaneToggled)},t.prototype.componentDidUpdate=function(){this._inputRef.current&&this._inputRef.current.value!==this.props.title&&(this._inputRef.current.value=this.props.title,this._updateHeight())},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this._updateHeight),window.removeEventListener("message",this._handlePropertyPaneToggled)},t.prototype.render=function(){var e=this._shouldRenderSingleLine?this._renderSingleLine(this.props):this._renderMultiLine(this.props);return i.createElement("div",{className:"kn_ag_9f38462c"},e)},t.prototype._renderMultiLine=function(e){var t=e.maxLines?{maxHeight:43.2*e.maxLines+"px"}:{},n=Object(o.css)(e.className,"kl_ag_9f38462c","km_ag_9f38462c");return i.createElement(i.Fragment,null,i.createElement("textarea",{style:t,className:n,placeholder:_.n,defaultValue:e.title,onBlur:this._handleBlur,onKeyPress:this._handleKeyPress,onChange:this._handleMultipleLineInputChange,rows:1,maxLength:110,ref:this._inputRef,role:"textbox","aria-label":this._titleAriaLabel,"data-automation-id":"pageTitleInput"}),this._freDataIconForTitleInput)},t.prototype._renderSingleLine=function(e){return i.createElement(i.Fragment,null,i.createElement("input",{className:Object(o.css)(e.className,"km_ag_9f38462c"),placeholder:_.n,defaultValue:e.title,onBlur:this._handleBlur,onKeyPress:this._handleKeyPress,onChange:this._handleSingleLineInputChange,maxLength:110,ref:this._inputRef,role:"textbox","aria-label":this._titleAriaLabel,"data-automation-id":"pageTitleInput",type:"NoType"}),this._freDataIconForTitleInput)},Object.defineProperty(t.prototype,"_freDataIconForTitleInput",{get:function(){return i.createElement("div",{"data-sp-fre-id":"sp-fre-titleregion-2","data-offset-left":"296px","data-offset-top":"calc(50% - 12px)"})},enumerable:!1,configurable:!0}),t.prototype._handleChange=function(){this._inputRef.current&&(this.props.onChangeTitle(this._inputRef.current.value),c.SPFREUtility.dismissFRECallout("sp-fre-titleregion-2"))},Object.defineProperty(t.prototype,"_titleAriaLabel",{get:function(){return this.props.titleAriaLabel?this.props.titleAriaLabel:this.props.title?m.StringHelper.format(_.e,this.props.title):_.t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldRenderSingleLine",{get:function(){return 1===this.props.maxLines},enumerable:!1,configurable:!0}),t}(i.PureComponent),b=n("2q6Q");l.loadStyles(".kr_ah_9f38462c{width:34px;transition:all .3s ease-out}.ks_ah_9f38462c .kr_ah_9f38462c{display:none}.kt_ah_9f38462c{white-space:nowrap}.ah_ah_9f38462c{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}",!0);var g=n("QhGY"),v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._focusZoneRef=i.createRef(),t._handleSetDefaultImageClick=function(){p._EngagementLogger.logEvent("TitleRegionWebPart.SetDefaultImage.Click"),t.props.setDefaultImage&&t.props.setDefaultImage()},t}return Object(a.__extends)(t,e),t.prototype.focus=function(){var e=this;setTimeout(function(){e._focusZoneRef.current&&e._focusZoneRef.current.focus()})},t.prototype.render=function(){if(!(this.props.togglePropertyPane||this.props.editImage||this.props.removeImage||this.props.setDefaultImage||this.props.setFocalPoint))return!1;var e={doNotLayer:!0,className:"kt_ah_9f38462c"},t=o.DirectionalHint.rightCenter,n=o.DirectionalHint.leftCenter,a=this.props.togglePropertyPane&&i.createElement(c.ToolbarButton,{calloutProps:e,onClick:this.props.togglePropertyPane,title:g.i,key:"togglePropertyPane",fabricIconKey:"Edit",automationId:"titleToolbarTogglePropertyPaneButton",directionalHint:t,directionalHintForRTL:n}),r=this.props.editImage&&i.createElement(c.ToolbarButton,{calloutProps:e,onClick:this.props.editImage,title:g.e,key:"edit",fabricIconKey:"EditPhoto",automationId:"titleToolbarEditButton",directionalHint:t,directionalHintForRTL:n}),s=this.props.setFocalPoint&&i.createElement(c.ToolbarButton,{calloutProps:e,onClick:this.props.setFocalPoint,title:g.t,key:"focalpoint",fabricIconKey:"FocalPoint",automationId:"titleToolbarFocalPointButton",directionalHint:t,directionalHintForRTL:n}),d=this.props.removeImage&&i.createElement(c.ToolbarButton,{calloutProps:e,onClick:this.props.removeImage,title:g.n,key:"cancel",fabricIconKey:"Cancel",automationId:"titleToolbarRemoveButton",directionalHint:t,directionalHintForRTL:n}),l=this.props.setDefaultImage&&i.createElement(c.ToolbarButton,{calloutProps:e,onClick:this._handleSetDefaultImageClick,title:g.a,key:"undo",fabricIconKey:"Undo",automationId:"titleToolbarResetButton",directionalHint:t,directionalHintForRTL:n});return i.createElement(o.FocusZone,{isCircularNavigation:!0,componentRef:this._focusZoneRef},i.createElement("div",{className:Object(o.css)("kr_ah_9f38462c",this.props.className),"data-automation-id":"titleToolbar","aria-labelledby":"TitleRegionToolbar-focusZone"},i.createElement("div",{"data-sp-fre-id":"sp-fre-titleregion-3","data-offset-left":"5px","data-offset-top":"10px"}),a,r,s,d,l),i.createElement("div",{className:"ah_ah_9f38462c",id:"TitleRegionToolbar-focusZone","aria-hidden":!0},g.r))},t.hideClassName="ks_ah_9f38462c",t}(i.PureComponent);l.loadStyles('.ku_ai_9f38462c{width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]"}.ks_ai_9f38462c .ku_ai_9f38462c{display:none}.kv_ai_9f38462c .ku_ai_9f38462c{display:flex!important}@keyframes v_ai_9f38462c{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.kw_ai_9f38462c{margin:8px;font-size:48px;animation:v_ai_9f38462c 2s linear infinite}.fi_ai_9f38462c{font-size:21px;font-weight:100;font-weight:300}',!0);var y,S=n("E3Wp");function D(){return i.createElement("div",{className:"ku_ai_9f38462c"},i.createElement(o.Icon,{className:"kw_ai_9f38462c",iconName:"Sync"}),i.createElement("span",{className:"fi_ai_9f38462c","aria-live":"assertive","aria-atomic":!0},S.e))}(y=D||(D={})).hideClassName="ks_ai_9f38462c",y.showClassName="kv_ai_9f38462c";var I=n("8dK2"),x=n("X+PM"),C=n("9poL"),O=n("cgRt"),w=n("r5RM"),E=n("Ys63");function A(e){function t(t){return t.returnValue=e,e}return function(e,n,a){if(a.value){var i=a.value;a.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return window.addEventListener("beforeunload",t),i.apply(this,e).then(function(e){return window.removeEventListener("beforeunload",t),e},function(e){throw window.removeEventListener("beforeunload",t),e})}}}}var L=n("Pk8u"),k=n("r9Fm"),M=n("3qW+"),P=n("1NDK");function T(e,t,n){var a,i=t,r=e[t];L.assign(e,((a={})[i]=function(){n.apply(this,arguments),r.apply(this,arguments)},a))}function U(e,t){return!!e.errorCode&&String(e.errorCode).indexOf(t)>-1}l.loadStyles(".eh_av_9f38462c{position:relative}.eh_av_9f38462c.mm_av_9f38462c{z-index:0}.eh_av_9f38462c .ToolbarButton{opacity:0;transition:all .3s ease}.eh_av_9f38462c:focus .ToolbarButton,.eh_av_9f38462c:hover .ToolbarButton{opacity:1}.eh_av_9f38462c.mn_av_9f38462c:focus-within .ToolbarButton{opacity:1}.eh_av_9f38462c .mo_av_9f38462c{position:absolute;top:8px;z-index:1}[dir=ltr] .eh_av_9f38462c .mo_av_9f38462c{left:8px}[dir=rtl] .eh_av_9f38462c .mo_av_9f38462c{right:8px}",!0);var F,H=n("AoP7"),R=function(e){function t(t){var n=e.call(this,t)||this;return n._toolbarRef=i.createRef(),n._containerRef=i.createRef(),n._togglePropertyPane=function(){n.props.controller.togglePropertyPane()},n._editImage=function(){var e={onSelect:function(e){n._selectFile(e),b._EngagementLogger.logEvent("TitleRegion.EditImage","Select")},onCancel:function(){b._EngagementLogger.logEvent("TitleRegion.EditImage","Cancel")},selectionMode:M.SelectionMode.single,itemTypes:new Set([k.t.Images]),webImagesAspectRatio:k.e.Wide,callerName:"TitleRegion"};n._filePicker?n._filePicker=n._filePicker.then(function(e){return e}).catch(function(){return n._loadFilePicker(e)}):n._filePicker=n._loadFilePicker(e),c.SPFREUtility.dismissFRECallout("sp-fre-titleregion-3"),n._filePicker.then(function(e){return e.open()}).catch(L.noop)},n._setDefaultImage=function(){"EventNoImage"!==n.props.layout.type&&"Event"!==n.props.layout.type||n.props.controller.switchLayout("Event"),n.props.controller.updateImage(O.e.defaultImage),n.props.controller.updateAltText(""),c.ScreenReaderAlert.read(H.a,c.ReadingMode.ReadImmediately),h.focus(n._containerRef.current),b._EngagementLogger.logEvent("TitleRegion.ResetToDefault")},n._removeImage=function(){b._EngagementLogger.logEvent("TitleRegion.ImageRemoved",n.props.image.type.toString()),"Event"===n.props.layout.type?n.props.controller.switchLayout("EventNoImage"):n.props.controller.switchLayout("NoImage"),n.props.controller.updateImage(O.e.defaultImage),c.ScreenReaderAlert.read(H.n,c.ReadingMode.ReadImmediately)},n._setFocalPoint=function(){n.props.onShowFocalPointSetter("AdHoc")},n._selectFile=function(e){if(e.localFilesPickedToUpload||e.externalImagesPickedToUpload){var t=e.localFilesPickedToUpload&&e.localFilesPickedToUpload[0]&&e.localFilesPickedToUpload[0].file||void 0,a=e.externalImagesPickedToUpload&&e.externalImagesPickedToUpload.length>0&&e.externalImagesPickedToUpload[0]||void 0,i=t||a;i&&(b._EngagementLogger.logEvent("TitleRegion.FileSelected",t?"Upload":"ExternalImageSelection"),n.props.onUploadImage(i))}else if(e.selectedItems&&e.selectedItems[0]&&e.selectedItems[0].Link){var r=new m.Uri(e.selectedItems[0].Link),o=!s._SPKillSwitch.isActivated("7739d32a-f8a0-4eb2-88ae-613acabbe39a")&&e.selectedItems[0].ServerAbsoluteUrl?e.selectedItems[0].ServerAbsoluteUrl:r.getAuthority()===window.location.host?r.getPath():e.selectedItems[0].Link;n.props.onShowFocalPointSetter("FromNewFile"),"EventNoImage"!==n.props.layout.type&&"Event"!==n.props.layout.type||n.props.controller.switchLayout("Event"),n.props.controller.updateImage({id:o,type:"SharePointImage",source:o,listId:s.Guid.tryParse(e.selectedItems[0].ListId),siteId:s.Guid.tryParse(e.selectedItems[0].SiteId),webId:s.Guid.tryParse(e.selectedItems[0].WebId),uniqueId:s.Guid.tryParse(e.selectedItems[0].UniqueId)}),n.props.controller.updateAltText(""),c.ScreenReaderAlert.read(H.t,c.ReadingMode.ReadImmediately),b._EngagementLogger.logEvent("TitleRegion.FileSelected","ByReference")}},n._handlePaste=function(e){var t;if(null===(t=e.clipboardData)||void 0===t?void 0:t.items){e.stopPropagation();var a=e.clipboardData.items;n._handleNewDataTransferItems(a,"ClipboardDataPasted")}},n._handleDrop=function(e){var t;if(null===(t=e.dataTransfer)||void 0===t?void 0:t.items){e.preventDefault(),e.stopPropagation(),n.setState({isDragging:!1});var a=e.dataTransfer.items;n._handleNewDataTransferItems(a,"DataTransferDropped")}},n._handleDragOver=function(e){var t;if((null===(t=e.dataTransfer)||void 0===t?void 0:t.items)instanceof DataTransferItemList)for(var a=e.dataTransfer.items,i=0;i<a.length;i++)if("file"===a[i].kind&&a[i].type.match("^image/"))return e.preventDefault(),e.stopPropagation(),void(n.state.isDragging||n.setState({isDragging:!0}))},n._handleDragLeave=function(e){e.preventDefault(),e.stopPropagation(),n.state.isDragging&&n.setState({isDragging:!1})},n._handleNewDataTransferItems=function(e,t){if(e instanceof DataTransferItemList)for(var a=0;a<e.length;a++)if("file"===e[a].kind&&e[a].type.match("^image/")){var i=e[a].getAsFile();if(i)return void n.props.onUploadImage(i,t)}},n.state={isDragging:!1},T(n.props.controller,"setFocalPoint",function(e,t){"Keyboard"===t&&n._toolbarRef.current&&n._toolbarRef.current.focus()}),n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.state.isDragging,t=Object(o.css)(this.props.className,"eh_av_9f38462c","mn_av_9f38462c","mm_av_9f38462c");return i.createElement("div",{className:t,ref:this._containerRef,onPaste:this._handlePaste,onDrop:this._handleDrop,onDragOver:this._handleDragOver,onDragLeave:this._handleDragLeave},e&&P.e,i.createElement(this.props.layout.canvas,Object(a.__assign)({},this.props)),i.createElement(v,{className:"mo_av_9f38462c",ref:this._toolbarRef,togglePropertyPane:this._shouldShowPropertyPaneButton&&this._togglePropertyPane,editImage:this._shouldShowEditImageButton&&this._editImage,setFocalPoint:this._shouldShowFocalPointButton&&this._setFocalPoint,removeImage:this._shouldShowRemoveImageButton&&this._removeImage,setDefaultImage:this._shouldShowSetDefaultImageButton&&this._setDefaultImage}))},Object.defineProperty(t.prototype,"_shouldShowPropertyPaneButton",{get:function(){return this.props.layout.toolbar.enablePropertyPane},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldShowEditImageButton",{get:function(){return this.props.layout.toolbar.enableImageEditing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldShowFocalPointButton",{get:function(){return this.props.layout.toolbar.enableImageEditing&&"DefaultImage"!==this.props.image.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldShowSetDefaultImageButton",{get:function(){return this.props.layout.toolbar.enableImageEditing},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_shouldShowRemoveImageButton",{get:function(){return"Event"===this.props.layout.type},enumerable:!1,configurable:!0}),t.prototype._loadFilePicker=function(e){return C.FilePickerLoader.load(this.props.serviceScope,e)},Object(a.__decorate)([Object(c.monitor)("TitleRegion.LoadFilePicker")],t.prototype,"_loadFilePicker",null),t}(i.PureComponent),N=function(e){function t(n){var a=e.call(this,n)||this;return a._asyncCount=1,a.state={isUploading:Boolean(t.isUploadingMap.get(n.controller))},a._spFileHandler=new C.SPFileHandler({serviceScope:n.serviceScope,qosPrefix:"TitleRegion"}),a._pageContext=n.serviceScope.consume(x.PageContext.serviceKey),a._updateImage=a.props.controller.updateImage,T(a.props.controller,"updateImage",function(){a._asyncCount++,a._setUploading(!1)}),a}return Object(a.__extends)(t,e),t.prototype.componentWillUnmount=function(){this._asyncCount++},t.prototype.render=function(){var e=this.state.isUploading?Object(o.css)(this.props.className,w.e.hideClassName,E.e.hideClassName):Object(o.css)(this.props.className,D.hideClassName);return i.createElement(R,Object(a.__assign)({},this.props,{className:e,onUploadImage:this._uploadImage}))},t.prototype._uploadImage=function(e,t){var n=this,a=++this._asyncCount;if(!(e instanceof File||e instanceof Blob||I._ThumbnailProviderType.HubbleStock!==I._ThumbnailUrlGenerator.getThumbnailProvider(e.src))){var i={id:e.src,type:"ExternalImage",source:e.src};return this._updateImage(i),Promise.resolve()}this._setUploading(!0),this.props.controller.updateAltText("");var r=t?new p._QosMonitor("TitleRegion."+t,!0):void 0;return Promise.resolve().then(function(){var t=n._constructFileName(e),a=n._constructUploadLocation(t,n._pageContext&&n._pageContext.web&&n._pageContext.web.serverRelativeUrl);return"EventNoImage"!==n.props.layout.type&&"Event"!==n.props.layout.type||n.props.controller.switchLayout("Event"),n._updateImage(e instanceof Blob?{id:a,type:"LocalImage",file:e}:{id:a,type:"ExternalImage",source:e.src}),c.ScreenReaderAlert.read(H.u,c.ReadingMode.ReadImmediately),t}).then(function(t){return e instanceof File||e instanceof Blob?n._spFileHandler.uploadLocalFile(e,t):n._spFileHandler.uploadExternalFile(e.src,t)}).then(function(e){a===n._asyncCount?(c.ScreenReaderAlert.read(H.d,c.ReadingMode.ReadImmediately),n._setUploading(!1),n._updateImage({id:e.serverRelativeUrl,type:"SharePointImage",source:e.serverRelativeUrl,uniqueId:s.Guid.tryParse(e.uniqueId),listId:s.Guid.tryParse(e.listId),siteId:n._pageContext.site&&n._pageContext.site.id,webId:n._pageContext.web&&n._pageContext.web.id}),n.props.onShowFocalPointSetter("FromNewFile"),null==r||r.writeSuccess()):null==r||r.writeExpectedFailure("ActionCancelled")}).catch(function(e){if(c.ScreenReaderAlert.read(H.r,c.ReadingMode.ReadImmediately),a!==n._asyncCount)throw null==r||r.writeExpectedFailure("ActionCancelled"),new c.ExpectedFailure("ActionCancelled");n._setUploading(!1),n._updateImage(O.e.defaultImage);var t=n._getErrorInfo(e);Object(c.DeferredDialogUtility)().then(function(n){throw n.showError({title:H.i,message:t.errorMessage}),null==r||r.writeUnexpectedFailure("UploadFailure",e),t.failure}).catch(function(){return Promise.reject()})})},t.prototype._constructFileName=function(e){var t=Math.floor(1e5*Math.random()).toString();if(e instanceof File&&C.SPFileHandler.validateFileType(e,c.spConstants.imageExtensions))return t+"-"+C.SPFileHandler.replaceSpecialCharacters(e.name);if(e instanceof Blob&&this._spFileHandler.validateMimeType(e,c.spConstants.imageExtensions))return t+"."+e.type.split("/").pop();if(e instanceof Blob||!C.SPFileHandler.validateFileType(e.src,c.spConstants.imageExtensions))throw new c.ExpectedFailure("InvalidFileType",H.e);return t+"-"+C.SPFileHandler.replaceSpecialCharacters(e.name)},t.prototype._constructUploadLocation=function(e,t){void 0===t&&(t="/");var n=this._spFileHandler.getPageName(C.SPFileHandler.pagePathName);return m.Uri.concatenate(t,"/SiteAssets/SitePages/"+n+"/"+e)},t.prototype._getErrorInfo=function(e){var t,n;return e instanceof C.SPFileHandlerError?U(e,"-2147024891")?(t=H.s,n=new c.ExpectedFailure("PermissionAccessDenied",e)):U(e,"-2130575257")?(t=H.o,n=new c.ExpectedFailure("FileNameExisted",e)):(t=H.c,n=new c.UnexpectedFailure("FailedToUploadWithSPFileHandlerError",e,{errorCode:String(e.errorCode)})):(t=H.c,n=new c.UnexpectedFailure("FailedToUploadWithError",e)),{errorMessage:t,failure:n}},t.prototype._setUploading=function(e){t.isUploadingMap.set(this.props.controller,e),this.setState({isUploading:e})},t.isUploadingMap=new WeakMap,Object(a.__decorate)([o.autobind,Object(c.monitor)("TitleRegion.UploadImage"),A(H.l)],t.prototype,"_uploadImage",null),t}(i.PureComponent),B=function(e){function t(t){var n=e.call(this,t)||this;return n._titleRegionRef=i.createRef(),n._showFocalPointSetter=function(e){b._EngagementLogger.logEvent("TitleRegion.FocalPointSet",e),n.setState({isSettingFocalPoint:!0})},n.state={isSettingFocalPoint:!1},T(n.props.controller,"setFocalPoint",function(){n.setState({isSettingFocalPoint:!1})}),n}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.isSettingFocalPoint&&this.state.isSettingFocalPoint&&f.focus(this._titleRegionRef.current)},t.prototype.render=function(){var e=this.state.isSettingFocalPoint?Object(o.css)(this.props.className,v.hideClassName,D.hideClassName):Object(o.css)(this.props.className,f.hideClassName);return i.createElement(N,Object(a.__assign)({},this.props,{className:e,onShowFocalPointSetter:this._showFocalPointSetter,ref:this._titleRegionRef}))},t}(i.PureComponent),j=n("br4S"),V=n("ZgyI"),z=n("IHjQ"),G=function(){function e(){}return e.prototype.getConfiguration=function(e,t){var n={isCollapsed:!1,groupFields:[this._layoutChoiceGroup].concat(e.showAlignmentChoiceGroup?this._alignmentChoiceGroup:[]).concat(e.showTopicHeaderInput?[this._getTopicHeaderInput(t),this._getTopicHeaderToggle(t)]:[]).concat(e.showPublishDateVisibilityToggle?this._showPublishDateToggle:[]).concat("FullWidthImage"===t.layoutType&&Object(V.e)()?this._getGradientToggle(t):[]).concat(!1===t.enableGradientEffect&&Object(V.e)()?Object(j.PropertyPaneCustomField)({key:"title-region-disable-gradient-effect-message",onRender:function(e){var t=i.createElement(o.MessageBar,{messageBarType:o.MessageBarType.warning,isMultiline:!0},z.c);r.render(t,e)},onDispose:function(e){r.unmountComponentAtNode(e)}}):[]).concat(e.showAltTextInput?this._altTextFields:[])};return{pages:[{header:{description:z.p},groups:[n]}]}},Object.defineProperty(e.prototype,"_layoutChoiceGroup",{get:function(){var t=[{imageSize:e._layoutChoiceSize,imageSrc:e._fullWidthImageLayoutIcon,key:"FullWidthImage",text:z.d,themableSvg:this._getLayoutIcon("FullWidthImage")},{imageSize:e._layoutChoiceSize,imageSrc:e._noImageLayoutIcon,key:"NoImage",text:z.u,themableSvg:this._getLayoutIcon("NoImage")},{imageSize:e._layoutChoiceSize,imageSrc:e._colorBlockLayoutIcon,key:"ColorBlock",text:z.r,themableSvg:this._getLayoutIcon("ColorBlock")},{imageSize:e._layoutChoiceSize,imageSrc:e._cutInShapeLayoutIcon,key:"CutInShape",text:z.o,themableSvg:this._getLayoutIcon("CutInShape")}];return Object(j.PropertyPaneChoiceGroup)("layoutType",{label:z.l,options:t})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_alignmentChoiceGroup",{get:function(){var e=[{key:"Left",text:z.t},{key:"Center",text:z.e}];return Object(j.PropertyPaneChoiceGroup)("textAlignment",{options:e,label:z.n})},enumerable:!1,configurable:!0}),e.prototype._getTopicHeaderToggle=function(e){return e.topicHeader||(e.showTopicHeader=!1),Object(j.PropertyPaneToggle)("showTopicHeader",{label:z._,onText:z.S,offText:z.f,disabled:!e.topicHeader})},e.prototype._getGradientToggle=function(e){return Object(j.PropertyPaneToggle)("enableGradientEffect",{label:z.s,onText:z.S,offText:z.f})},e.prototype._getTopicHeaderInput=function(e){var t=e.topicHeader?e.topicHeader.length:0,n=40>=t?40-t:0,a=m.StringHelper.formatWithLocalizedCountValue(z.b,z.h,n);return n<=0&&c.ScreenReaderAlert.read(a,c.ReadingMode.ReadImmediately),Object(j.PropertyPaneTextField)("topicHeader",{label:z.g,maxLength:40,description:a,placeholder:z.v})},Object.defineProperty(e.prototype,"_showPublishDateToggle",{get:function(){return Object(j.PropertyPaneToggle)("showPublishDate",{label:z.m,onText:z.S,offText:z.f})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_altTextFields",{get:function(){return[Object(j.PropertyPaneTextField)("altText",{label:z.i}),Object(j.PropertyPaneLabel)("altTextLabel",Object(a.__assign)({text:z.a},Object(V.a)()&&{styles:{root:{fontWeight:o.FontWeights.regular}}})),Object(j.PropertyPaneLink)("webAIMLink",{text:z.y,target:"_blank",href:"https://go.microsoft.com/fwlink/?LinkId=734040"})]},enumerable:!1,configurable:!0}),e.prototype._getLayoutIcon=function(e){switch(e){case"ColorBlock":return i.createElement("svg",null,i.createElement("g",null,i.createElement("path",{className:"themeableSvgPath",d:"M0,0v32h32V0H0z M30,30H2V18h28V30z M17,14H5V4h12V14z M13,11H7V9h6V11z M25,22H7v1h18V22z M17,25H7v1h10V25z M15,8H7V6h8V8z"})));case"CutInShape":return i.createElement("svg",null,i.createElement("g",null,i.createElement("path",{className:"themeableSvgPath",d:"M0,0v32h32V0H0z M30,30H2V13h28V30z M27,13H5V4h22V13z M25,8H7V6h18V8z M15,11H7v-1h8V11z M25,16H7v1h18V16z M25,19H7v1h18V19z M25,22H7v1h18V22z M17,25H7v1h10V25z"})));case"FullWidthImage":return i.createElement("svg",null,i.createElement("g",null,i.createElement("path",{className:"themeableSvgPath",d:"M0,0v32h32V0H0z M30,30H2V13h28V30z M25,8H7V6h18V8z M15,11H7v-1h8V11z M25,16H7v1h18V16z M25,19H7v1h18V19z M25,22H7v1h18V22z M17,25H7v1h10V25z"})));case"NoImage":return i.createElement("svg",null,i.createElement("g",null,i.createElement("path",{className:"themeableSvgPath",d:"M0,0v32h32V0H0z M30,30H2V2h28V30z M25,7H7V5h18V7z M15,9H7v1h8V9z M25,16H7v1h18V16z M25,19H7v1h18V19z M25,22H7v1h18V22z M17,25H7v1h10V25z M25,13H7v1h18V13z"})));default:return}},e._noImageLayoutIcon="noImageLayout.svg",e._colorBlockLayoutIcon="colorBlockLayout.svg",e._cutInShapeLayoutIcon="cutInShapeLayout.svg",e._fullWidthImageLayoutIcon="fullWidthImageLayout.svg",e._layoutChoiceSize={width:32,height:32},e}();!function(e){e[e.none=0]="none",e[e.user=1]="user",e[e.distributionList=2]="distributionList",e[e.securityGroup=4]="securityGroup",e[e.sharePointGroup=8]="sharePointGroup",e[e.all=15]="all"}(F||(F={}));var K=F,W=n("3HEj"),q=n("K9kD"),Q=n("dq6a"),Y=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var n in this.message=t.message,this.innerError=e.innerError,this.stack=t.stack,this.name=t.name,this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var a=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,a),Object.setPrototypeOf)return Object.setPrototypeOf(t,a),t};Object.setPrototypeOf&&(Y.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(Y,Error));var J=function(e){function t(t,n){var i=this,r=n.response,o=(void 0===r?{}:r).error,s=(void 0===o?{}:o).innerError,c=(void 0===s?{}:s).stackTrace,d=void 0===c?"":c,l=n.response,u=n.request,f=n.status,p=n.code,m=void 0===p?$(l,f,function(e){return""+e})||"unhandled":p,_=Object(a.__assign)({innerError:t,code:m},n);return(i=e.call(this,_)||this).name="GraphError",i.response=l,i.status=f,i.serverStack=d,i.request=u,i.error=t,i}return Object(a.__extends)(t,e),t}(function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var i=t.innerError||void 0,r=i?Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},"string"==typeof i.correlationId?{correlationId:i.correlationId}:{}),"boolean"==typeof i.isExpected?{isExpected:i.isExpected}:{}),"string"==typeof i.name?{code:i.name}:{}),"string"==typeof i.code?{code:i.code}:{}),"object"==typeof i.extraData?{extraData:i.extraData}:{}):{},o=t.correlationId,s=void 0===o?r.correlationId:o,c=t.isExpected,d=void 0===c?r.isExpected:c,l=t.extraData;return n.correlationId=s,n.isExpected=!!d,n.code=t.code||r.code||"",n.extraData=Object(a.__assign)(Object(a.__assign)({},r.extraData||{}),l||{}),n}return Object(a.__extends)(t,e),t}(Y));function X(e){var t={};if(t.errorMessage=e.message,Z(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function Z(e){return e instanceof J}function $(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}var ee=window&&window.performance,te={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},ne=function(){function e(e,t){var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,o=t.apiEvent,s=void 0===o?m.Api:o,c=t.cookieOrigin,d=t.isOffline;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=s,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._apiBaseUrl=r?"function"==typeof r.getApiBaseUrl?r.getApiBaseUrl({}):r.getVroomApiBaseUrl():void 0,this._cookieOrigin=c,this._isOffline=d,this._encodingFixEnabled=!q.Killswitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!q.Features.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"})}return e.prototype.send=function(e){var t=this,n=e.headers,i=void 0===n?{}:n,r=e.path,o=e.endpoint,s=void 0===o?this._apiBaseUrl:o,c=e.driveUrl,d=e.apiName,l=e.disableLogging,u=void 0!==l&&l,f=e.timeout,p=e.onProgress,_=e.onUploadProgress,h=e.qosExtraData,b=e.apiVersion,g=void 0===b?"v2.0":b,v=e.needsAuthorization,y=void 0===v||v,S=e.useAuthorizationHeaders,D=void 0!==S&&S,I=e.accessToken,x=e.postProcessQos,C=e.breakCache,O=e.allowCookies,w=e.hasContentType,E=void 0===w||w,A=e.useMultiPart,L=void 0!==A&&A,k=e.getErrorAsMessage,M=void 0!==k&&k,P=e.expectedErrors,T=Object(a.__assign)(Object(a.__assign)({},te),e.expectedErrorCodes||{}),U=e.requestType,F=void 0===U?"GET":U,H=this._cookieOrigin,R=new m.SimpleUri(r).authority?r:""+s+r,N=function(n){var o,c="",l={};l=L?{"Content-Type":"multipart/form-data;boundary="+(c=q.Guid.generate())}:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&E?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),M?{prefer:"rich-error-as-message"}:{}),i),n.sessionToken&&n.sessionToken.tokenUrl&&0===r.indexOf("/drive/")?o=new q.Uri(n.sessionToken.tokenUrl+"/"+r.substring(7)):(o=new q.Uri(r),s&&!o.getScheme()&&(o=new q.Uri(s+r))),L&&(o.setQueryParameter("ump","1"),"POST"!==F&&(i["X-HTTP-Method-Override"]=F),F="POST");var b,g=o.toString();if(!L&&n.sessionToken){var v=n.sessionToken,y=v.accessToken,S=v.proofToken,I=v.wlidToken,O=v.isBadger;I?l=Object(a.__assign)(Object(a.__assign)({},l),{Authorization:"wlid1.1 "+I}):D?(y&&(l=O?Object(a.__assign)(Object(a.__assign)({},l),{Authorization:"badger "+y}):Object(a.__assign)(Object(a.__assign)({},l),{Authorization:"bearer "+y})),S&&(l=Object(a.__assign)(Object(a.__assign)({},l),{"X-PROOF_TOKEN":S}))):(y&&o.setQueryParameter("access_token",y),S&&o.setQueryParameter("prooftoken",S))}if(L){var w="";if(w+="--"+c+"\r\n",w+="Content-Disposition: form-data;name=data\r\n",i)for(var A=0,k=Object.keys(i);A<k.length;A++){var U=k[A];w+=U+": "+i[U]+"\r\n"}w+="Content-Type: application/json\r\n",w+="Authorization: bearer "+n.sessionToken.accessToken+"\r\n",M&&(w+="prefer: rich-error-as-message\r\n"),w+="\r\n",w+=(void 0!==e.postData?e.postData:"")+"\r\n",w+="--"+c+"--"}if(C&&o.setQueryParameter("r",Math.random().toFixed(8)),!u){var H=new m.SimpleUri(g),R={url:H.authority+"/{ length: "+H.path.length+", segments: "+H.segments.length+" }",name:t._apiName+"DataRequest."+d,extraData:h};b=new t._apiEvent(R)}var N=o.toString(),B=ee&&ee.now();return m.XHRPromise.start({url:N,headers:l,method:F,json:w||e.postData||"",requestTimeoutInMS:f,withCredentials:n.useCookies,onProgress:p,onUploadProgress:_}).then(function(t){var n=Object(m.getRequestEntryDurationMetrics)(N,B);if(b){var a=t.getAllResponseHeaders(),i={resultType:m.ResultTypeEnum.Success,extraData:{rawRequestDuration:n.duration,performanceEntry:JSON.stringify(n),requestId:a.indexOf("request-id")>=0?t.getResponseHeader("request-id"):a.indexOf("sprequestguid")>=0?t.getResponseHeader("sprequestguid"):null,MSCorrelationVector:a.indexOf("MS-CV")>=0?t.getResponseHeader("MS-CV"):null}};b.end(i)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var i,r=function(e,t){return x&&(e=x(e,t)),b&&b.end(e),q.Promise.reject(t)},s=Object(m.getRequestEntryDurationMetrics)(N,B);if(e instanceof Error){var c=q.Promise.isCanceled(e),d=c?m.ResultTypeEnum.ExpectedFailure:m.ResultTypeEnum.Failure,l={error:e.message,resultCode:c?"Canceled":"",resultType:d,extraData:{rawRequestDuration:s.duration,performanceEntry:JSON.stringify(s)}};return r(l,e)}if(e.responseText)try{i=JSON.parse(e.responseText)}catch(e){}if(M)try{var u=t._encodingFixEnabled?JSON.parse((f=i.error.message,decodeURIComponent(escape(atob(f))))):JSON.parse(atob(i.error.message));i={error:u}}catch(e){}var f,p=e.status,_=e.statusText,g=(i||{}).error,v=void 0===g?{}:g,y=v.message,S=void 0===y?"":y,D=v.innerError,I=void 0===D?{}:D,C=I.stackTrace,O=void 0===C?"":C,w=I.debugMessage,E=void 0===w?"":w;return(p||!t._isOffline?q.Promise.resolve(!1):t._isOffline()).then(function(t){var c=t?"Offline":"",d=e.getAllResponseHeaders(),l=d.indexOf("request-id")>=0&&e.getResponseHeader("request-id")||d.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid"),u=t||!!$(i,p,function(e){return T[e]}),f=new J(new Error(S||c),{response:i,status:p,request:e,correlationId:l,isExpected:u});P&&Object(q.isExpectedError)({code:f.code,message:S},P)&&(u=!0);var b={resultType:u?m.ResultTypeEnum.ExpectedFailure:m.ResultTypeEnum.Failure,error:S,resultCode:f.code,extraData:Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},h||{}),X(f)),{stack:O,httpStatus:p,httpStatusText:_,requestId:l,MSCorrelationVector:d.indexOf("MS-CV")>=0?e.getResponseHeader("MS-CV"):null,debugMessage:E,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:o.toString().length,useCookies:!!n.useCookies,isOffline:t,rawRequestDuration:s.duration,performanceEntry:JSON.stringify(s)})};return r(b,f)})})},B=this._sessionManagementProvider;if(y){if(I)return N({sessionToken:I});var j=new m.SimpleUri(R).authority;if(O&&j&&H&&j===H)return B&&B.getFormDigest&&"GET"!==F?B.getFormDigest().then(function(e){return N({digestValue:e,useCookies:!0})}):N({useCookies:!0});if(B&&B.getSessionToken){var V={apiVersion:g,endpoint:s,driveUrl:c,path:R};return q.Promise.resolve(B.getSessionToken(V)).then(function(e){return N({sessionToken:e}).catch(function(t){return e&&function(e){if(e instanceof J){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&"Bearer"===n.slice(0,"Bearer".length)&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?B.getSessionToken(Object(a.__assign)(Object(a.__assign)({},V),{claimsChallenge:{sessionToken:e,claims:ie(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?N({sessionToken:n}):q.Promise.reject(t)}):q.Promise.reject(t)})})}if(B&&B.getToken)return B.getToken(g,R).then(function(e){return N({sessionToken:e})})}return N({})},e}(),ae=ne;function ie(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate");if(t){var n=t.indexOf('claims="');if(n>-1){var a=t.indexOf('"',n+'claims="'.length);if(a>-1)return t.slice(n+'claims="'.length,a)}}}var re,oe,se={ODB:1286},ce=function(){function e(e,t){this._dataRequestor=new ne({},{}),this._pageContext=t.pageContext,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken),this.initializeDataStore()}return e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;return this._pageContext&&!this._pageContext.isSPO||this._pageContext&&this._pageContext.authToken||(this._pageContext&&this._oAuthTokenProvider&&q.FeatureOverrides.isFeatureEnabled(se)&&(e=!0),this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",q.DataStoreCachingType.session))),e},e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue("DisableSubstrateSearch",!0,q.DataStoreCachingType.session)},e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return q.Promise.resolve(this._substrateToken);if(this._oAuthTokenProvider){var t=new q.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken("https://outlook.office.com/search").then(function(e){return t.end({resultType:q.ResultTypeEnum.Success}),e},function(n){return q.Promise.isCanceled(n)?(t.end({resultType:q.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),q.Promise.reject(n)):(t.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:q.ResultTypeEnum.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableSubstrateCallsForPicker(),null)})}return null},e.prototype.init=function(e){this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:"https://outlook.office.com/search/api/v1/init?scenario=documentshare",headers:{Authorization:"Bearer "+e},needsAuthorization:!1})},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new q.DataStore("PeoplePicker",q.DataStoreCachingType.session))},e}(),de=n("ynV5");!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown"}(re||(re={})),function(e){e[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown"}(oe||(oe={}));var le=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,a=e.multiGeoInfo,i=e.options,r=void 0===i?{}:i,o=r.path,s=void 0===o?void 0:o,c=r.listUrl,d=void 0===c?void 0:c,l=r.webUrl,u=void 0===l?void 0:l,f=r.mayInferListUrl,p=void 0!==f&&f;this._rawPath=s||void 0,this._rawListUrl=d||void 0,this._rawWebUrl=u||void 0,this.defaultFullWebUrl=fe(t||void 0),this.defaultListUrl=fe(n||void 0),this.multiGeoInfo=a,this.mayInferListUrl=p}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return ue(this._getServerRelativeItemUrl())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return ue(this._getServerRelativeListUrl())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return ue(this._getNormalizedListUrl())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return ue(this._getNormalizedItemUrl())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullWebUrl",{get:function(){return this._getFullWebUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalizedWebUrl",{get:function(){return ue(this._getNormalizedWebUrl())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeWebUrl",{get:function(){return ue(this._getServerRelativeWebUrl())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"geoRelation",{get:function(){return this._getGeoRelation()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._getPath()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listUrl",{get:function(){return this._getListUrl()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webUrl",{get:function(){return this._getWebUrl()},enumerable:!0,configurable:!0}),e.prototype._getPath=function(){var e,t=this._rawPath;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=fe(t);else{var n=this._getListUrl()||this.defaultListUrl;n&&(e=n+"/"+t)}return this._getPath=function(){return e},e},e.prototype._getListUrl=function(){var e,t=this._rawListUrl;if(t)if("/"===t[0]||t.indexOf("://")>-1)e=fe(t);else{var n=this._getWebUrl()||this.defaultFullWebUrl;n&&(e=n+"/"+t)}return this._getListUrl=function(){return e},e},e.prototype._getWebUrl=function(){var e,t=this._rawWebUrl;return t&&(e="/"===t[0]||t.indexOf("://")>-1?fe(t):this.defaultFullWebUrl+"/"+t),this._getWebUrl=function(){return e},e},e.prototype._getCurrentAuthority=function(){var e=new m.SimpleUri(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e},e},e.prototype._getNormalizedWebUrl=function(){var e,t=this._getFullWebUrl(),n=this.defaultFullWebUrl;if(void 0!==t&&!Object(de.equalsCaseInsensitive)(t,n)){var a=new m.SimpleUri(t);e=Object(de.equalsCaseInsensitive)(a.authority,this._getCurrentAuthority())?a.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var n=new m.SimpleUri(t);e=Object(de.equalsCaseInsensitive)(n.authority,this._getCurrentAuthority())?n.path:t}return this._getNormalizedItemUrl=function(){return e},e},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),n=this._getDefaultListUrl();return void 0===t||Object(de.equalsCaseInsensitive)(t,n)||(e=Object(de.equalsCaseInsensitive)(new m.SimpleUri(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e},e},e.prototype._getServerUrl=function(){var e=this.path&&new m.SimpleUri(this.path).authority||this.listUrl&&new m.SimpleUri(this.listUrl).authority||this.webUrl&&new m.SimpleUri(this.webUrl).authority||this.defaultListUrl&&new m.SimpleUri(this.defaultListUrl).authority||new m.SimpleUri(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e},e},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new m.SimpleUri(this.listUrl).path;else{var t=this._getDefaultListUrl(),n=this.mayInferListUrl;if(void 0!==t||n){var a=this._getServerRelativePath(),i=new m.SimpleUri(t).path;if(void 0===a&&(void 0===this.webUrl||i&&_e(me(i),me(this._getServerRelativeWebUrl())))||i&&_e(me(a),me(i)))e=i;else if(void 0!==a&&(""===this.defaultListUrl||n)){var r=this._getServerRelativeWebUrl();if(_e(me(a),me(r))){var o=new m.SimpleUri(a).segments[new m.SimpleUri(r).segments.length];e=""+me(r)+o}}}}return this._getServerRelativeListUrl=function(){return e},e},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();return void 0!==n&&(e=""+t+n),e},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();return void 0!==n&&(e=""+t+n),this._getFullItemUrl=function(){return e},e},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new m.SimpleUri(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new m.SimpleUri(this.defaultFullWebUrl).path);else{var n=new m.SimpleUri(t);e=""+n.segments.slice(0,-1).join("/")}return this._getServerRelativeWebUrl=function(){return e},e},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new m.SimpleUri(this.path).path),this._getServerRelativePath=function(){return e},e},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path||this._rawPath?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e},e},e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==a&&_e(me(n),t=me(a))&&(e=n&&n.substring(t.length)),this._getListRelativeItemUrl=function(){return e},e},e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),a=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==a&&_e(me(n),t=me(a))&&(e=n&&n.substring(t.length)),this._getWebRelativeItemUrl=function(){return e},e},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new m.SimpleUri(this.defaultListUrl).authority?this.defaultListUrl:""+this._getCurrentAuthority()+this.defaultListUrl),this._getDefaultListUrl=function(){return e},e},e.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!Object(de.equalsCaseInsensitive)(new m.SimpleUri(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t},t},e.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!Object(de.equalsCaseInsensitive)(e,t);return this._getIsCrossList=function(){return n},n},e.prototype._getSiteRelation=function(){var e=re.unknown;if(this._getIsCrossDomain())e=re.crossSite;else if(void 0!==this.webUrl)e=Object(de.equalsCaseInsensitive)(pe(this.defaultFullWebUrl),pe(this._getFullWebUrl()))?re.sameSite:re.crossSite;else{var t=new m.SimpleUri(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(_e(me(n),me(t))){var a=new m.SimpleUri(pe(n)),i=new m.SimpleUri(pe(t));e=a.segments.length-1===i.segments.length||a.segments.length-2===i.segments.length&&"Lists"===a.segments[a.segments.length-2]?re.sameSite:re.unknown}else e=re.crossSite}return this._getSiteRelation=function(){return e},e},e.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();return void 0!==n&&(e=""+t+n),this._getFullWebUrl=function(){return e},e},e.prototype._getGeoRelation=function(){if(!this._getIsCrossDomain())return oe.sameGeo;var e=new m.SimpleUri(this._getServerUrl()).authority;if(!e)return oe.unknown;var t=this._getCurrentGeo();if(!t)return oe.unknown;var n=this._getGeoByAuthority()[e.toUpperCase()];return n?Object(de.equalsCaseInsensitive)(n,t)?oe.sameGeo:oe.crossGeo:oe.unknown},e.prototype._getGeoByAuthority=function(){var e={},t={};function n(n,a,i){var r=new m.SimpleUri(n).authority.toUpperCase();!i&&t[r]||(e[r]=a),i&&(t[r]=!0)}if(this.multiGeoInfo)for(var a=0,i=this.multiGeoInfo;a<i.length;a++){var r=i[a],o=r.InstanceId,s=r.IsDefaultDataLocation;if(n(r.MySiteHostUrl,o,s),n(r.PortalUrl,o,s),n(r.RootSiteUrl,o,s),n(r.TenantAdminUrl,o,s),r.AdditionalUrls)for(var c=0,d=r.AdditionalUrls;c<d.length;c++)n(d[c],o,s)}return this._getGeoByAuthority=function(){return e},e},e.prototype._getCurrentGeo=function(){var e=this._getCurrentAuthority();if(e){var t=this._getGeoByAuthority()[e.toUpperCase()];return this._getCurrentGeo=function(){return t},t}},e}();function ue(e){return""===e?"/":e}function fe(e){return"/"===e?"/":e}function pe(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e}function me(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:e+"/"}function _e(e,t){var n=e.toUpperCase(),a=t&&t.toUpperCase();return n.substring(0,a&&a.length||0)===a}var he,be=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,a=void 0===n?le:n;this.itemUrlPartsType=a,this.itemUrlContext=t}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,a=t.listUrl,i=t.multiGeoInfo;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:a,multiGeoInfo:i,options:e})},e}(),ge=function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,a=void 0===n||n;this._webAbsoluteUrl=t,this._encodeWebAbsoluteUrl=a,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?"+t.join("&"):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n;return""+Object(a.__spreadArrays)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments).join("/")+e},e.prototype.segment=function(e){return this._extend({segments:[e]})},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})},e.prototype.methodWithAliases=function(e,t){for(var n=this,a=[],i=0,r=Object.keys(t);i<r.length;i++){var o=r[i],s=t[o],c=n._autoParameter(s);n=c.apiUrl,a.push(o+"="+c.name)}return n.segment(e+"("+a.join(",")+")")},e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var a=this,i=[],r=0,o=t;r<o.length;r++){var s=o[r],c=a._autoParameter(s);a=c.apiUrl,i.push(c.name)}return a.segment(e+"("+i.join(",")+")")},e.prototype.parameter=function(e,t){return this._parameter(e,t)},e.prototype.parameters=function(e){for(var t=this,n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],r=e[i];t=t.parameter(i,r)}return t},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a"+t;return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}},e.prototype._parameter=function(e,t){var n;return n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?m.UriEncoding.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'"+t.guid+"'":function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t||"boolean"==typeof t?""+t:"'"+m.UriEncoding.encodeRestUriStringToken(t)+"'",this._extend({parameters:[{name:e,serializedValue:n}]})},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})},e.prototype._extend=function(e){var t,n,a,i,r,o;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(n=s._segments).push.apply(n,this._segments),(a=s._rawParameters).push.apply(a,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(r=s._rawParameters).push.apply(r,e.rawParameters),"segments"in e&&(o=s._segments).push.apply(o,e.segments),s},e}(),ve=function(){function e(e){this._apiUrlType=function(t){function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return Object(a.__extends)(n,t),n}(ge)}return e.prototype.build=function(){return new this._apiUrlType},e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var a=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>a?e.substring(0,i)+"_"+e.substring(i+1):e}return t+"/_api/contextinfo"},e}(),ye=function(e){function t(t,n){var a=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;return a._pageContext=n.pageContext,a._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl,a._itemUrlHelper=n.itemUrlHelper,a}return Object(a.__extends)(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,a=e.fullItemUrl,i=this;return(n||t===re.crossSite)&&(i=i.method("SP.RemoteWeb",a)),i.segment("web")},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})},t}(ge),Se=function(e){function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,r=n.itemUrlHelper,o=n.pageContext,s=n.encodeWebAbsoluteUrl,c=n.apiUrlType,d=void 0===c?function(e){function t(){return e.call(this,{},{itemUrlHelper:r,pageContext:o,encodeWebAbsoluteUrl:s})||this}return Object(a.__extends)(t,e),t}(ye):c;return i._apiUrlType=d,i}return Object(a.__extends)(t,e),t.prototype.build=function(){return new this._apiUrlType},t}(ve),De=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t}(le),Ie=function(e){function t(t,n){var a=n.itemUrlPartsType,i=void 0===a?De:a;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}return Object(a.__extends)(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)},t.prototype.getItemUrlParts=function(e){var t=Object(q.deserializeQuery)(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})},t}(be),xe=n("QVYh");function Ce(e,t){var n=Object(xe.getUserPhotoUrl)(t);if(!e||!n||n.startsWith("http"))return n;try{return new URL(e).origin+n}catch(e){return n}}!function(e){e.Small="S",e.Medium="M",e.Large="L"}(he||(he={}));var Oe={ODB:60307},we=function(e){function t(t,n){var a=this,i=Ee(t)?t:n.pageContext;a=e.call(this,{},{pageContext:i})||this;var r=Ee(t)?t.apiUrlHelper:n.apiUrlHelper;return a._apiUrlHelper=r||new Se({},{itemUrlHelper:new Ie({},{pageContext:i}),pageContext:i}),a._capabilities={supportsMruCaching:!0},n&&(a._dataRequestor=n.dataRequestor,a._graphPeoplePickerHelper=n.graphPeoplePickerHelper,a._substratePeoplePickerHelper=n.substratePeoplePickerHelper,a._livePeoplePickerHelper=n.livePeoplePickerHelper,a._getAuthToken=n.getAuthToken),a._invalidPeopleSubTypesKSActivated=q.Killswitch.isActivated("daa1be46-12ff-45a4-8c9f-9b3c0f174853","01/19/2021","Ignore invalid PeopleSubtypes."),a._userPhotoUrlKSActivated=q.Killswitch.isActivated("02c3bfd3-6cd8-4e3d-87fe-b47981aeed1e","06/04/2021","Fixing UserPhotoUrl in iframe."),a._webAbsoluteUrl=i.webAbsoluteUrl,a}return Object(a.__extends)(t,e),t.prototype.getCapabilities=function(){return this._capabilities},t.prototype.getPersonaDetails=function(e){var t=this;return q.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},a=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,i={personDetails:n(a.Primary),managerChain:a.ManagerChain.results.map(n),directReports:a.DirectReports.results.map(n)};return i.personDetails.profilePage=Object(W.t)(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(i.personDetails.sip)+"&origin=ProfileODBCard",i}})})},t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===K.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var a=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return q.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:a,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})},t.prototype.resolve=function(e,t){var n=this;return q.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:a,parseResponse:function(e){var a=JSON.parse(e),i=JSON.parse(a.d.ClientPeoplePickerResolveUser),r=[];r[0]=i,i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(r[0].DisplayText=i.Key);var o=(r=n._transformData(r,t.filterExternalUsers))[0];return t.filterExternalUsers&&o&&1===o.entityType?(o.isResolved=!1,o.entityType=0):t.blockViaPolicy&&!t.filterExternalUsers&&o&&!o.isResolved&&0===o.multipleMatches.length&&(o.isResolved=!0,o.isExternal=!0,o.entityType=1),t.isGraphDistributionList&&t.useGraph&&o.isExternal&&(o.entityType=2,o.principalType=K.distributionList),o}})})},t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();return t&&!this._dataRequestor&&(this._dataRequestor=new ae({},{})),t},t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();return t&&!this._dataRequestor&&(this._dataRequestor=new ae({},{})),t},t.prototype.getLivePersonaPickerHelper=function(){return this._livePeoplePickerHelper},t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)},t.prototype.sharePointSearch=function(e,t){var n=this;return t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1),q.Promise.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(a){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:a,parseResponse:function(a){var i=t.allowSharePointGroups,r=void 0===i||i,o=t.filterExternalUsers,s=JSON.parse(a),c=JSON.parse(s.d.ClientPeoplePickerSearchUser),d=n._transformData(c,o);if(o&&(d=d.filter(function(e){return 1!==e.entityType})),d=d.filter(function(e){return e.principalType===K.sharePointGroup?r:e.principalType===K.securityGroup?r||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)}),!1!==t.resolveEmailIfNoResults&&0===d.length&&n._isValidEmail(e,!1)){var l={Key:e,IsResolved:!1};d.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:l,rawPersonData:l,isExternal:!0})}return d}})})},t.prototype.subscribePresence=function(e,t){var n=this;try{if(this._ensureSkypePresence(),!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var a=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};return this._skypeIntegration.TrackPresence(e,a),{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,a)}catch(e){}}}}catch(e){}return null},t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"},t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,UseSubstrateSearch:t.useSubstrateSearch,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)},t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}},t.prototype._graphSearch=function(e,n){var a=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(i){if(!i)return a.sharePointSearch(e,n);var r=new q.Uri("https://graph.microsoft.com/v1.0/me/people");if(e)if(r.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName"}),q.Killswitch.isActivated("08c31a2f-5109-4dd9-b6ab-d6ea8fec0d9f","09/29/2020","Fix bug: Should correctly handle PrincipalType in Graph query filter."))!1!==n.filterPublicDistributionList&&r.setQueryParameter("$filter","personType/subclass ne 'PublicDistributionList'");else{var o=t._getPersonTypeFilter(n);o&&r.setQueryParameter("$filter",o)}return a._dataRequestor.send({apiName:"Graph.PeopleSearch",path:r.toString(),headers:{Authorization:"Bearer "+i,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(t){if(n.onToggleGetMoreResults&&n.onToggleGetMoreResults(!0),!t||!t.value||0===t.value.length)return a.sharePointSearch(e,n);var i=t.value,r=[];if(i.forEach(function(e){if(a._invalidPeopleSubTypesKSActivated||!e.personType.subclass||!a._isIgnorablePeopleSubType(e.personType.subclass)){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",i=e.userPrincipalName&&a._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,o={Key:i,IsResolved:!1},s="ImplicitContact"===e.personType.subclass,c="OrganizationUser"===e.personType.subclass,d="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,l="PublicDistributionList"===e.personType.subclass,u=a._userPhotoUrlKSActivated?Object(xe.getUserPhotoUrl)(t):Ce(a._webAbsoluteUrl,t),f={department:e.department,email:t,image:s?void 0:u,job:!1===n.fallbackToEmailIfNoJob?e.jobTitle:e.jobTitle||t,name:e.displayName,providerName:c?"Provider":void 0,userId:i,rawData:o,rawPersonData:o,isExternal:!c,aadObjectId:e.id};c?(f.entityType=0,f.principalType=K.user,f.isResolved=!0):d?(f.entityType=2,f.principalType=K.securityGroup,f.isResolved=!1,f.userId=e.id):(f.principalType=l?K.distributionList:K.none,f.entityType="Group"===e.personType.class?2:1,f.isResolved=!1,f.providerName=void 0),f.userId&&r.push(f)}}),!1!==n.resolveEmailIfNoResults&&0===r.length&&a._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};r.push({email:e,entityType:1,isResolved:!1,job:!1===n.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return r},function(t){if(Z(t))switch(t.status){case 400:case 401:case 403:case 404:return a._graphPeoplePickerHelper.disableGraphCallsForPicker(),a.sharePointSearch(e,n);default:return a.sharePointSearch(e,n)}else"Canceled"!==t.name&&a._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===t.name?null:a.sharePointSearch(e,n)})})},t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(a){if(!a)return n.sharePointSearch(e,t);var i=null;t.siteIBSegmentIDs&&t.siteIBSegmentIDs.length>0&&(i=t.siteIBSegmentIDs);var r,o=["Mailbox","Directory"],s={Authorization:"Bearer "+a};return r=q.FeatureOverrides.isFeatureEnabled(Oe)&&!q.Killswitch.isActivated("0576d3d3-42b4-4c60-a920-0e10e34a19a0","05/13/2021","Pass SiteIBMode to 3S.")?JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],InformationBarrierMode:t.siteIBMode,Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}):JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Default",Provenances:o,Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"],Filter:i?{Or:i.map(function(e){return{Term:{InformationBarrierSegment:e}}})}:null}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}}),n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:"https://outlook.office.com/search/api/v1/suggestions",headers:s,needsAuthorization:!1,requestType:"POST",postData:r}).then(function(a){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=a.Groups[0]?a.Groups[0].Suggestions:[],r=[];if(i.forEach(function(e){if(n._invalidPeopleSubTypesKSActivated||!e.PeopleSubtype||!n._isIgnorablePeopleSubType(e.PeopleSubtype)){var a=e.EmailAddresses[0]||e.QueryText||"",i=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:a,o={Key:i,IsResolved:!1},s="ImplicitContact"===e.PeopleSubtype,c="OrganizationUser"===e.PeopleSubtype,d="LinkedIn"===e.PeopleSubtype,l="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,u="PublicDistributionList"===e.PeopleSubtype,f=n._userPhotoUrlKSActivated?Object(xe.getUserPhotoUrl)(a):Ce(n._webAbsoluteUrl,a),p={department:e.Department,office:e.OfficeLocation,email:a,image:s?void 0:f,job:!1===t.fallbackToEmailIfNoJob?e.JobTitle:e.JobTitle||a,name:e.DisplayName,providerName:"Provider",userId:i,rawData:o,rawPersonData:o,isExternal:!c};c?(p.entityType=0,p.principalType=K.user,p.isResolved=!0):l?(p.entityType=2,p.principalType=K.securityGroup,p.isResolved=!1,p.providerName=void 0):d?p.entityType=4:(p.principalType=u?K.distributionList:K.none,p.entityType="Group"===e.PeopleType?2:1,p.isResolved=!1,p.providerName=void 0),p.userId&&r.push(p)}}),!1!==t.resolveEmailIfNoResults&&0===r.length&&n._isValidEmail(e,!1)){var o={Key:e,IsResolved:!1};r.push({email:e,entityType:1,isResolved:!1,job:!1===t.fallbackToEmailIfNoJob?void 0:e,name:e,userId:e,rawData:o,rawPersonData:o,isExternal:!0})}return r},function(a){return"Canceled"!==a.name&&(n._substratePeoplePickerHelper.disableSubstrateCallsForPicker(),n.sharePointSearch(e,t)),null})})},t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&m.EmailAddressParser.isValidEmailSyntax(e,!1):!t},t._getPersonTypeFilter=function(e){if(e.principalType===K.user)return"personType/class ne 'Group'";var t="";return e.principalType&K.distributionList||(t+="personType/subclass ne 'PublicDistributionList'"),e.principalType&K.securityGroup||(t&&(t+=" and "),t+="personType/subclass ne 'UnifiedGroup'"),t||(!1!==e.filterPublicDistributionList?"personType/subclass ne 'PublicDistributionList'":"")},t.prototype._isIgnorablePeopleSubType=function(e){return!!e&&["PersonalDistributionList","ImplicitGroup","Unknown"].some(function(t){return t===e})},t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var a=e.EntityData,i={name:e.DisplayText,email:a.Email,userId:e.Key,job:a.Title,department:a.Department,phone:a.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};i.multipleMatches.length>0&&(i.multipleMatches=n._transformData(i.multipleMatches,t),t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType})));var r=i.email;i.isResolved&&(i.image=r?n._userPhotoUrlKSActivated?Object(xe.getUserPhotoUrl)(r):Ce(n._webAbsoluteUrl,r):null);var o=a.PrincipalType||e.EntityType;switch(o){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1,i.principalType=K.user,i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2,i.principalType="SharePointGroup"===o?K.sharePointGroup:K.securityGroup;break;default:i.entityType=0,i.principalType=K.user}return i})},t}(Q.e);function Ee(e){return!!e.webAbsoluteUrl}var Ae={allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:1,principalSource:15,blockExternalUsers:!0,principalType:K.user},Le=function(){function e(e){this._serviceScope=e,this._dataSource=new we(e.consume(x.PageContext.serviceKey).legacyPageContext)}return e.prototype.populateDefaultAuthor=function(){var e=this._serviceScope.consume(x.PageContext.serviceKey).user;return this._dataSource.resolve(e.loginName,Ae).then(function(e){return e.rawData}).then(function(e){return{id:e.Key,upn:e.Description,email:e.EntityData.Email,name:e.DisplayText,role:e.EntityData.Title||e.EntityData.Department}})},e}(),ke=n("vlQI"),Me=function(){function e(e){var t=this;e.whenFinished(function(){t._oAuthTokenProvider=e.consume(ke.OAuthTokenProvider.serviceKey),t._pageContext=e.consume(x.PageContext.serviceKey)})}return e.prototype.getToken=function(e,t){if(this._oAuthTokenProvider){t&&this._oAuthTokenProvider.clearCachedToken(e);var n=this._pageContext&&this._pageContext.web&&this._pageContext.web.serverRelativeUrl;return this._oAuthTokenProvider.getOAuthToken(e,n).then(function(e){return e.token})}return q.Promise.wrap(void 0)},e.prototype.getInstrumentedToken=function(e,t){return q.Promise.wrap(void 0)},e}(),Pe={ODB:387},Te=function(){function e(e,t){this._pageContext=t.pageContext,this._sharingContextInformation=t.sharingContextInformation,this._oAuthTokenProvider=t.oAuthTokenProvider,this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken),this.initializeDataStore()}return e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&q.FeatureOverrides.isFeatureEnabled(Pe);return this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",q.DataStoreCachingType.session)),e},e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore(),this._dataStore.setValue("DisableGraph",!0,q.DataStoreCachingType.session)},e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return q.Promise.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new q.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){return t.end({resultType:q.ResultTypeEnum.Success}),e},function(n){return q.Promise.isCanceled(n)?(t.end({resultType:q.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}),q.Promise.reject(n)):(t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:q.ResultTypeEnum.Failure,extraData:{serverErrorCode:n._serverErrorCode,message:n.message}}),e.disableGraphCallsForPicker(),null)})}return null},e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new q.DataStore("PeoplePicker",q.DataStoreCachingType.session))},e}(),Ue=function(){function e(e){this._serviceScope=e}return Object.defineProperty(e.prototype,"peoplePickerDataSource",{get:function(){if(void 0===this._peoplePickerDataSource){var e=this._serviceScope.consume(x.PageContext.serviceKey),t=e&&e.legacyPageContext,n=new Me(this._serviceScope),a=new Te({},{pageContext:t,oAuthTokenProvider:n}),i=new ce({},{pageContext:t,oAuthTokenProvider:n});this._peoplePickerDataSource=new we({},{pageContext:t,graphPeoplePickerHelper:a,substratePeoplePickerHelper:i})}return this._peoplePickerDataSource},enumerable:!1,configurable:!0}),e.serviceKey=s.ServiceKey.create("sp-component-utilities:PeoplePickerDataSource",e),e}(),Fe=n("Mx5T"),He=function(e){function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;if(n._MaxItems=200,n._Version=5,n._buffer=n.getValue(t._StorageKey),n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer(),n._data={},Date.now()<n._buffer.lastCachePrune+6048e5)for(var a=0;a<n._buffer.dataArray.length;a++)n._data[n._buffer.dataArray[a].email]=n._buffer.dataArray[a];else n.initializeBuffer(),n.setValue(t._StorageKey,n._buffer);return n}return Object(a.__extends)(t,e),t.clear=function(){new q.DataStore(t._Key,t._DataStoreCachingType).remove(t._StorageKey)},t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone},t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var a=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[a]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++,this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email],this._buffer.dataArray[this._buffer.index]=e}else this._buffer.dataArray.push(e),this._buffer.index++;this._data[e.email]=e,this.setValue(t._StorageKey,this._buffer)},t.prototype.getItems=function(e,t){for(var n=[],a=0;a<this._buffer.dataArray.length;a++){var i=(this._buffer.index-a+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n},t.prototype.containsItem=function(e){return Boolean(this._data[e.email])},t.prototype.initializeBuffer=function(){this._buffer={},this._buffer.dataArray=[],this._buffer.index=-1,this._buffer.version=this._Version,this._buffer.lastCachePrune=Date.now()},t._Key="ClientPeoplePicker",t._StorageKey="MRU",t._DataStoreCachingType=q.DataStoreCachingType.local,t}(q.DataStore),Re=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new we({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper,graphPeoplePickerHelper:e.graphPeoplePickerHelper}),this._ppCapabilities=this._dataSource.getCapabilities(),this._ppCapabilities.supportsMruCaching?(this._mruCache=new He,this.MaxCacheSuggestions=5):this.MaxCacheSuggestions=0}return e.prototype.search=function(e,t){var n,a,i=this,r={cached:null,promise:null};return this._mruCache&&!t.groupID&&(a=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(r.cached=a),r.promise=new q.Promise(function(r,o){n=i._dataSource.search(e,t).then(function(e){if(e)if(a){a.length>0&&(a=i._removeStaleCacheResults(a,e));var t=a.map(function(e){return e.userId});r(e.filter(function(e){return t.indexOf(e.userId)<0}))}else r(e)},function(e){o(e)})},function(){n&&n.cancel()}),r},e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){return n._mruCache&&e.isResolved&&n.addToMruCache(e),e})},e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})},e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)},e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)},e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)},e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})},e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)},e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)},e.prototype.getLivePersonaPickerHelper=function(){return this._dataSource.getLivePersonaPickerHelper()},e.prototype.searchMruCache=function(e,t){var n=[],a=this._mruCache;if(a){n=a.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n},e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),a=[];return t.forEach(function(t){var i=n.indexOf(t.userId);if(i>-1){var r=e[i];He.isCacheEntryFresh(r,t)&&a.push(r)}}),a},e}(),Ne=n("nYTp");Object(l.loadStyles)([{rawString:"@media screen and (-ms-high-contrast: active){.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton:hover .ms-PeoplePicker-personaContent .ms-Persona-secondaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-primaryText,.ms-Suggestions-itemButton.is-suggested .ms-PeoplePicker-personaContent .ms-Persona-secondaryText{color:HighlightText}}.ms-PickerPersona-container{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#605e5c"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d2d0ce"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-webkit-box-flex:1;-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077b5}.itemContent_cceaac04{-webkit-box-flex:0;-ms-flex:0 1 auto;flex:0 1 auto;min-width:0;max-width:100%;overflow:hidden}.peoplePickerPill_cceaac04{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";height:24px;border-radius:12px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin:4px}.peoplePickerClose_cceaac04{border-radius:12px;height:24px;width:24px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.peoplePickerClose_cceaac04:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";border-radius:12px}\n"}]);var Be=n("iZ1p");function je(e,t){var n="3rem";if(t)switch(t){case o.PersonaSize.size24:n="1.5rem";break;case o.PersonaSize.size32:n="2rem";break;case o.PersonaSize.size40:n="2.5rem";break;case o.PersonaSize.extraSmall:n="1.75rem";break;default:n="3rem"}return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt,coinProps:{styles:{coin:{width:n,height:n,maxWidth:"75px",maxHeight:"75px"},image:{width:n+"!important",height:n+"!important",maxWidth:"75px",maxHeight:"75px"},imageArea:{width:n,height:n,maxWidth:"75px",maxHeight:"75px"},initials:{width:n,height:n,fontSize:"0.625rem",lineHeight:n}}},styles:{root:{height:n},primaryText:{fontSize:"0.875rem"},secondaryText:{fontSize:"0.75rem"}}}}var Ve,ze=function(e){var t=je(e,o.PersonaSize.size40);return i.createElement("div",{className:"ms-PeoplePicker-personaContent"},i.createElement(o.Persona,Object(a.__assign)({},t,{presence:o.PersonaPresence.none,size:o.PersonaSize.size40,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&i.createElement(Ne.Icon,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))},Ge=function(e){var t=e.item,n=e.onRemoveItem,r=e.index,s=e.selected,c=e.removeButtonAriaLabel,d=je(t,o.PersonaSize.extraSmall);return i.createElement("div",{className:Object(o.css)("ms-PickerPersona-container",{"is-selected":!!s}),"data-is-focusable":!0,"data-selection-index":r,key:r,role:"listitem"},i.createElement("div",{className:Object(o.css)("ms-PickerItem-content","itemContent_cceaac04")},i.createElement(o.Persona,Object(a.__assign)({},d,{presence:o.PersonaPresence.none,size:o.PersonaSize.extraSmall}))),i.createElement(o.IconButton,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:c}))},Ke=function(e){var t=e.item,n=e.onRemoveItem,r=e.index,s=e.selected,c=je(t,o.PersonaSize.size40),d="PickerPersonaId"+Math.floor(1e4*Math.random()),l=de.format(Be.t,t.name);return i.createElement("div",{className:Object(o.css)("ms-PickerPersona-container is-listbelow",{"is-selected":!!s}),"data-is-focusable":!0,"data-selection-index":r,key:r,"aria-labelledby":d,role:"listitem"},i.createElement("div",{className:"ms-PickerPersona-content"},i.createElement(o.Persona,Object(a.__assign)({id:d},c,{presence:o.PersonaPresence.none,size:o.PersonaSize.size40}))),i.createElement("div",{className:"ms-PickerItem-content"},i.createElement(o.IconButton,{onClick:n,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!0,ariaLabel:l})))};!function(e){e[e.normal=0]="normal",e[e.listBelow=1]="listBelow"}(Ve||(Ve={})),Object(l.loadStyles)([{rawString:".ms-Suggestions{width:260px}\n"}]);var We=Fe.e,qe=Fe.t,Qe=function(e){function t(t){var n=e.call(this,t)||this;if(n._onResolveSuggestions=function(e){if(n._peoplePickerSearchPromise&&(n._peoplePickerSearchPromise.cancel(),n._peoplePickerSearchPromise=void 0),(e=e.trim()).length<2)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var t=n._dataProvider.search(e.trim(),n._getPeoplePickerQueryParams());if(!t)return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions([],e):[];var a=t.cached?t.cached:[];return n._peoplePickerSearchPromise=t.promise,n._peoplePickerSearchPromise.then(function(e){return n._peoplePickerSearchPromise=void 0,e?a.concat(e):[]}).then(function(t){return n.props.onResolvedSuggestions?n.props.onResolvedSuggestions(t,e):t})},n._onGetMoreResults=function(e){var t;return n._onGetMoreResultsClicked&&n._onGetMoreResultsClicked(),n.props.peoplePickerQueryParams&&((t=Object(a.__assign)({},n.props.peoplePickerQueryParams)).useGraph=!1,t.useSubstrate=!1),n._dataProvider&&n._dataProvider.sharePointSearch&&t?q.Killswitch.isActivated("0710ffb7-9cb3-4e9d-8df2-1a413ac7b42b","03/19/2021","Add filter suggestions to show more results")?n._dataProvider.sharePointSearch(e,t):n._dataProvider.sharePointSearch(e,t).then(function(t){if(n.props.onResolvedSuggestions){var a=n.props.onResolvedSuggestions(t,e);if(a instanceof Array)return a}return t}):[]},t.dataProvider)n._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");n._dataProvider=new Re({pageContext:t.context,peoplePickerDataSource:t.dataSource})}return n._handleGetMoreResultsInBaseClass=!!(n._dataProvider.canUseGraph&&n.props.peoplePickerQueryParams&&n._dataProvider.canUseGraph(n.props.peoplePickerQueryParams))&&!n.props.onGetMoreResults,n.state={hasUnresolvedText:!1,searchForMoreText:n._getSearchForMoreText(n._handleGetMoreResultsInBaseClass)},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props,t=e.className,n=e.onRenderItem,r=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,s=e.onSelectedPersonasChange,c=e.suggestionsHeaderText,d=e.suggestionsClassName,l=e.noResultsFoundText,u=e.loadingText,f=e.inputProps,p=e.onSuggestionSelected,m=e.suggestionsAvailableAlertText,_=e.enableSelectedSuggestionAlert,h=e.selectedItems,b=e.itemLimit,g=e.onInputChange,v=e.onGetMoreResults,y=e.searchForMoreText,S=e.ariaLabel,D=void 0===S?"":S,I=e.pickerCalloutProps,x=e.pickerOverrideStyles,C=e.theme,O=e.disabled,w=e.onGetMoreResultsClicked,E=e.removeButtonAriaLabel;this._onGetMoreResultsClicked=w;var A={className:t,onRenderSuggestionsItem:r||ze,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:o,selectedItems:h,onChange:s,inputProps:f,enableSelectedSuggestionAlert:_,pickerSuggestionsProps:{suggestionsHeaderText:c,loadingText:u,noResultsFoundText:l,className:d,suggestionsAvailableAlertText:m,searchForMoreText:y||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0),suggestionsContainerAriaLabel:Be.e},onItemSelected:p,itemLimit:b,onInputChange:g,onGetMoreResults:v||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:I,styles:x,theme:C,"aria-label":D,disabled:O,removeButtonAriaLabel:E};switch(this.props.peoplePickerType){case Ve.listBelow:return A.onRenderItem=n||Ke,i.createElement(qe,Object(a.__assign)({},A,{componentRef:this._resolveRef("_peoplePicker")}));default:return A.onRenderItem=n||Ge,i.createElement(We,Object(a.__assign)({},A,{componentRef:this._resolveRef("_peoplePicker")}))}},t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()},t.prototype._getPeoplePickerQueryParams=function(){return this.props.peoplePickerQueryParams?(!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults),this.props.peoplePickerQueryParams):{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:K.user|K.securityGroup|K.sharePointGroup}},t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})},t.prototype._getSearchForMoreText=function(e){return e?Be.n:void 0},t}(o.BaseComponent),Ye=n("jPq8");function Je(e){return i.createElement("div",{className:Object(o.css)("ms-PeoplePicker-personaContent","mp_aw_9f38462c")},i.createElement(Ye.e,{imageUrl:e.image||"",imageProps:e,renderImage:Xe}))}function Xe(e,t){var n=t.job||t.email||t.department||"";return i.createElement(o.Persona,{text:t.name||"",tertiaryText:t.email||"",secondaryText:n,imageInitials:"",presence:o.PersonaPresence.none,size:o.PersonaSize.small,className:"ms-PeoplePicker-Persona",imageUrl:e})}l.loadStyles("[dir=ltr] .mp_aw_9f38462c .ms-Persona-details{padding-right:12px}[dir=rtl] .mp_aw_9f38462c .ms-Persona-details{padding-left:12px}",!0),l.loadStyles('.lw_ao_9f38462c input{background-color:"[theme:bodyBackground, default: #ffffff]";color:"[theme:neutralPrimary, default: #323130]"}.lw_ao_9f38462c input:-ms-input-placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}.lw_ao_9f38462c input::placeholder{color:"[theme:neutralSecondary, default: #605e5c]"}',!0);var Ze=n("Z4sK"),$e=function(e){function t(t){var n=e.call(this,t)||this;return n._pickerRef=i.createRef(),n._handleChangeSelectedPersons=function(e){var t=e?e.map(function(e){return{id:e.userId||e.email,upn:e.rawPersonData?e.rawPersonData.Description:"",email:e.email||"",name:e.name,role:e.job||e.department||""}}):[];n.props.onChangeSelectedPersons(t),n.setState(function(e){return Object(a.__assign)(Object(a.__assign)({},e),{key:1-e.key})})},n._handleFilterSuggestion=function(e,t){var a=t.length>=2;return n.setState({shouldResolveQuery:a}),n._alertResolvedSuggestionsDebounce(e[0],a),e},n._alertResolvedSuggestions=function(e,t){e?c.ScreenReaderAlert.read(m.StringHelper.format(Ze.n,Ze.a,e.name||"",e.job||e.department||"")):t&&c.ScreenReaderAlert.read(Ze.t)},n.state={shouldResolveQuery:!1,key:0},n._alertResolvedSuggestionsDebounce=Object(L.debounce)(n._alertResolvedSuggestions,1e3),n}return Object(a.__extends)(t,e),t.prototype.componentWillUnmount=function(){this._alertResolvedSuggestionsDebounce.cancel()},t.prototype.render=function(){var e={"aria-label":this.props.ariaLabel,placeholder:Ze.i},n=Object(o.css)(this.props.className,"lw_ao_9f38462c");return i.createElement(Qe,{className:n,context:this.props.serviceScope.consume(x.PageContext.serviceKey).legacyPageContext,onSelectedPersonasChange:this._handleChangeSelectedPersons,onRenderSuggestionsItem:Je,dataSource:this.props.dataSource,ref:this._pickerRef,inputProps:e,key:this.state.key,noResultsFoundText:this.state.shouldResolveQuery?Ze.t:Ze.e,onResolvedSuggestions:this._handleFilterSuggestion,peoplePickerQueryParams:t._peoplePickerQueryParams})},t.prototype.focus=function(){this._pickerRef.current&&this._pickerRef.current.focusInput()},t._peoplePickerQueryParams={useGraph:!0,allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,resolveEmailIfNoResults:!1,principalType:K.user,fallbackToEmailIfNoJob:!1},t}(i.PureComponent),et=n("vRzw");l.loadStyles(".kx_aj_9f38462c{border:1px solid transparent}.kx_aj_9f38462c input{width:100%;box-sizing:border-box;border:none}.kx_aj_9f38462c .ms-BasePicker-text{min-width:0}",!0);var tt=n("U4Ku"),nt=function(e){function t(t){var n=e.call(this,t)||this;return n._searcherRef=i.createRef(),n._handleAddPerson=function(e){if(1===e.length){var t=e[0];n.props.onAddPerson(t),c.ScreenReaderAlert.read(m.StringHelper.format(tt.e,t.name),c.ReadingMode.ReadImmediately)}},n._dataSource=n.props.serviceScope.consume(Ue.serviceKey).peoplePickerDataSource,n}return Object(a.__extends)(t,e),t.prototype.render=function(){return i.createElement("div",{className:Object(o.css)("kx_aj_9f38462c",et.e.card),role:"search"},i.createElement("div",{className:et.e.persona},i.createElement(o.PersonaCoin,{coinProps:{className:et.e.personaCoin},imageUrl:c.SPUtility.getUserPhotoUrl(),size:this.props.personaSize}),i.createElement("div",{className:et.e.personaDetails},i.createElement($e,{ariaLabel:tt.t,dataSource:this._dataSource,onChangeSelectedPersons:this._handleAddPerson,ref:this._searcherRef,serviceScope:this.props.serviceScope,selectedPersons:this.props.selectedPersons}))))},t.prototype.focus=function(){this._searcherRef.current&&this._searcherRef.current.focus()},t}(i.PureComponent)},ynV5:function(e,t,n){var a=n("K9kD");e.exports=a.StringHelper}}]);