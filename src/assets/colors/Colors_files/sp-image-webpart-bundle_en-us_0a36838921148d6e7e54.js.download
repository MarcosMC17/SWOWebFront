define("d1d91016-032f-456d-98a4-721247c305e8_1.1.3",["tslib","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/sp-loader","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@ms/sp-coachmark-utility","@microsoft/sp-webpart-base","react","react-dom","@ms/sp-component-utilities","@microsoft/load-themed-styles","@ms/sp-canvas-read","@ms/sp-rich-image","@microsoft/sp-diagnostics","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={13:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{29:[{i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.1.1",m:"fglE"}],15:[{i:"2c46c8f0-e214-4f49-951e-fd5b9d7b4ae1",v:"1.13.0",m:"8dK2"},{i:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",v:"1.13.0",m:"X+PM"},{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:"9poL"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"vendors~image-gallery-light-box~image-lig~2ba11974",7:"image-light-box",14:"sp-image-webpart-edit-mode",15:"sp-imageeditcontrol",16:"sp-light-box",29:"vendors~sp-imageeditcontrol"}[e]||e)+"_"+(["en-us","none"])[{"0":1,"7":0,"14":0,"15":0,"16":0,"29":1}[e]]+"_"+{0:"0ab9cf462099c3162b8a",7:"5e30e98d9fefb0d68ad1",14:"f85e9e7112c482f029fc",15:"64331c6a7b831dfe58a0",16:"e3b056b1a67f88b6f41a",29:"8477c826ceb4adfd0073"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee=window.webpackJsonp_8c4a6a562ec36ed6536c907cfb0e02ee||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-image-webpart-bundle_en-us_0a36838921148d6e7e54\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="zMuk")}({"17wl":function(e,t){e.exports=n},"1NDK":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("cDcd"),i=n("KL1q"),r=n("Pl8B"),o=n("ad5q"),s=a.createElement("div",{className:o.e.dropOverlayContainer},a.createElement(i.Icon,{className:Object(i.css)(o.e.dropOverlay,o.e.dropOverlayIcon),iconName:"Photo2"}),a.createElement("p",{className:Object(i.css)(o.e.dropOverlay,o.e.dropOverlayMessage)},r.b))},"2q6Q":function(e,t){e.exports=a},"5gqb":function(e){e.exports=JSON.parse('{"e":"Type text to display on top of image."}')},"6eUj":function(e,t,n){e.exports=n.p+"external_db10a8f3057309d3ee48b7ebeb2ef0a1.png"},"7Awa":function(e,t){e.exports=i},"EQ+f":function(e,t,n){"use strict";var a=n("UWqr"),i=function(){function e(){}return e.isInlineImageEnabled=function(){return a._SPFlight.isEnabled(60045)&&a._BrowserDetection.getBrowserInformation().browser!==a._Browser.IE},e}();t.e=i},EZEx:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("cDcd"),i=n("KL1q"),r=n("UWqr"),o=n("yCEm"),s=n("Pl8B");function c(e){var t,n,c;e.hostWidth<=1024?(n=20,t=16,c={top:8,bottom:8,left:16,right:16}):(n=28,t=32,c={top:18,bottom:18,left:24,right:24});var d=Object(i.mergeStyles)({margin:t,position:"absolute",bottom:0,maxWidth:"100%",width:"100%",left:e.offset,zIndex:1});return a.createElement("div",{className:d},a.createElement(o.e,{isEditMode:e.isEditMode,initialValue:e.initialValue||"",hostWidth:e.hostWidth-2*t,onChangeText:e.onChangeText,placeholder:r.Text.format(s.R,48),heightOption:"NoLimit",alignment:"Left",fontSize:n,padding:c,maximumCharacters:48,qosPrefix:e.qosPrefix,key:e.hostWidth-2*t}))}},"Hy/w":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("cDcd"),r=n("hiL/"),o=n("tGpx");n("jOlS").loadStyles('.fc_p_9f38462c{height:calc(100% - 60px);width:90%;align-content:center;position:relative;margin:30px auto}.fe_p_9f38462c{height:100%;margin:auto;position:relative}.ff_p_9f38462c{max-height:100%;max-width:100%;width:auto;height:auto;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.fb_p_9f38462c{color:#fff;padding:10px;text-align:center}.fb_p_9f38462c,.fb_p_9f38462c .be_p_9f38462c{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;word-wrap:normal}.fb_p_9f38462c .be_p_9f38462c{font-size:"[theme:xxLargeFontSize, default: 28px]";font-weight:"[theme:xxLargeFontWeight, default: 600]";margin:12px}.fb_p_9f38462c .cn_p_9f38462c{font-size:16px}',!0);var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._getImageHeightStyle=function(){var e=t.props.image,n=0;return(e.title||e.description)&&(e.title&&e.description?n=132:e.title?n=113:e.description&&(n=67)),{height:"calc(100% - "+n+"px)"}},t}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props.image;if(e&&e.imageUrl)return i.createElement("div",{className:"fc_p_9f38462c"},i.createElement("div",{className:"fe_p_9f38462c",style:this._getImageHeightStyle()},i.createElement(o.SPImg,{key:e.imageUrl,imageData:e,serviceScope:this.props.serviceScope,callerId:this.props.callerId,getDefaultImage:r.DefaultImageHelper.getDefaultImage,className:"ff_p_9f38462c",thumbnailWidth:2560})),i.createElement("div",{className:"fb_p_9f38462c"},i.createElement("div",{className:"be_p_9f38462c","data-automation-id":"lightBoxTitle"},e.title),i.createElement("span",{className:"cn_p_9f38462c"},e.description)))},t}(i.Component)},I6O9:function(e,t){e.exports=r},KL1q:function(e,t){e.exports=o},MS2Y:function(e,t,n){"use strict";function a(e,t){return i(e.cropData&&e.cropData.height||e.imageNaturalHeight,e.cropData&&e.cropData.width||e.imageNaturalWidth,t,e.resizeCoefficient,e.resizeDesiredWidth)}function i(e,t,n,a,i){return 0===t?{displayHeight:0,displayWidth:0}:(r=void 0!==a&&void 0!==i?Math.round(n*a):Math.min(n,t),void 0!==a&&void 0!==i&&r<i&&(r=Math.min(n,i)),{displayHeight:e/t*r,displayWidth:r});var r}n.d(t,"t",function(){return a}),n.d(t,"e",function(){return i})},MkPk:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"n",function(){return r}),n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("950bb6e1-4464-4889-945c-57e6c30dd183")}function r(){return a._SPKillSwitch.isActivated("3a2fd4b4-db1b-45f2-bc5d-1d563bc50c45")}function o(){return a._SPKillSwitch.isActivated("a7e8def0-0040-4a48-9c6f-87b9c6517eff")}function s(){return a._SPKillSwitch.isActivated("d01d6b5a-1eb6-4674-ac27-6f0002814062")}},PTFE:function(e,t,n){"use strict";n.d(t,"c",function(){return i}),n.d(t,"d",function(){return r}),n.d(t,"r",function(){return o}),n.d(t,"s",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"p",function(){return d}),n.d(t,"n",function(){return l}),n.d(t,"o",function(){return u}),n.d(t,"t",function(){return f}),n.d(t,"i",function(){return p}),n.d(t,"e",function(){return m}),n.d(t,"u",function(){return _}),n.d(t,"a",function(){return h}),n.d(t,"l",function(){return b});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("d653eb47-784c-4f26-86bb-fa06d6ef29b8")}function r(){return a._SPKillSwitch.isActivated("13e71393-3441-4ae6-90b9-318978c4af41")}function o(){return a._SPKillSwitch.isActivated("aa424a54-250e-4ecd-a90f-cd96ca55c6db")}function s(){return a._SPKillSwitch.isActivated("3c04212b-8027-4a81-9bc5-f298ac863b5f")}function c(){return a._SPKillSwitch.isActivated("016e1d17-e557-454d-8b7a-8890ba818704")}function d(){return a._SPKillSwitch.isActivated("29ae156c-3a23-4887-ad28-9b516ac98486")}function l(){return a._SPKillSwitch.isActivated("f6e05ff6-39b0-4e5f-a596-2570ab187e1d")}function u(){return a._SPKillSwitch.isActivated("ba0f13f2-ae26-4cd6-86b4-6c7b3a207f9b")}function f(){return a._SPKillSwitch.isActivated("aaf44f5e-2ac6-41ca-ac5b-4dfb8a263eeb")}function p(){return a._SPKillSwitch.isActivated("f3d2e690-e8a8-4634-b057-38b084d58de1")}function m(){return a._SPKillSwitch.isActivated("12b72a1d-da6c-4cb2-82b5-6f15eb77a5ee")}function _(){return a._SPKillSwitch.isActivated("3ac74375-d152-4c13-a90b-f60049a1d9d7")}function h(){return a._SPKillSwitch.isActivated("33c04aba-c9e3-4df1-b5a5-565dee4c126e")}function b(){return a._SPKillSwitch.isActivated("432cbccf-9cc3-4607-ab0e-f18f17efd5ee")}},Pk8u:function(e,t){e.exports=s},Pl8B:function(e){e.exports=JSON.parse('{"o":"Browse images","B":"Uploadingâ€¦","T":"Drag or paste an image here or browse for images","U":"Image","s":"Add a caption","N":"Image toolbar. Press up and down arrow keys to move between items.","_":"Rotate crop box","m":"Reset","f":"Aspect ratios","c":"Crop to 16/9 ratio","u":"Crop to 4/3 ratio","l":"Crop to 3/2 ratio","d":"Crop to 1/1 ratio","p":"Crop with free ratio","V":"Container for the Image Editor. Use control arrow keys to move the crop area and shift arrow key to resize","j":"Do more with your image","D":"Image has been {0} aligned","i":"left","e":"center","r":"right","h":"The selected area is at left {0} top {1} with the size of width {2} height {3}","v":"We\\u0027re having trouble getting this image for you. Try downloading the image from the source site and then upload it from your computer. ","y":"Source site.","S":"Image added.","x":"Click your image to show a toolbar for options like cropping and resizing. Use the Edit button on the left of the image for more options like adding a link and adding text over the image.","C":"Learn more","R":"Add your text here. You can add a total of {0} characters.","E":"Resize","O":"Alignment","w":"Change image","A":"Save","n":"Align left","t":"Align center","a":"Align right","g":"Enter resize mode.","F":"Use left or right arrow keys to change the size of the image.","H":"The image width is {0} pixels, and uses {1}% of the column.","M":"Image can\\u0027t be smaller. The minimum size is {0} pixels.","k":"Image can\\u0027t be larger. The maximum size is {0} pixels.","b":"Drag or paste here","L":"Image has been reset to default settings.","P":"Image changes have been saved.","I":"Image: {0}, {1}, {2}"}')},U4ag:function(e,t){e.exports=c},UWqr:function(e,t){e.exports=d},Vm4b:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"e",function(){return o});var a=n("sSDQ"),i=n("MS2Y");function r(e,t,n){void 0===n&&(n=!1);var a=e.cropWidth,r=e.cropHeight,o=e.imgHeight,s=e.imgWidth,c=e.resizeCoefficient,d=e.resizeDesiredWidth;if(a&&r||o&&s){var l=Object(i.e)(r||o,a||s,t,n?c:void 0,d),u=l.displayHeight;return l.displayWidth>=320&&u>=160}return!1}function o(e){return e.imageSourceType!==a.ImageSourceType.none&&!!e.imageSource}},ad5q:function(e,t,n){"use strict";var a=n("jOlS"),i=n("i69V"),r=n.n(i),o=n("6eUj"),s=n.n(o),c=r()(s.a);a.loadStyles('.g_c_9f38462c{position:relative;height:auto;text-align:left}.g_c_9f38462c,.g_c_9f38462c.h_c_9f38462c img{max-width:100%;max-height:100%}.g_c_9f38462c.h_c_9f38462c.i_c_9f38462c{margin:0 auto}.g_c_9f38462c.h_c_9f38462c.i_c_9f38462c img{width:100%;box-sizing:border-box}.g_c_9f38462c input{width:.1px;height:.1px;opacity:0;overflow:hidden;position:absolute;z-index:-1}.g_c_9f38462c .j_c_9f38462c{position:absolute;top:-48px;z-index:1;transition:all .3s ease-out}[dir=ltr] .g_c_9f38462c .j_c_9f38462c{left:-8px}[dir=rtl] .g_c_9f38462c .j_c_9f38462c{right:-8px}.g_c_9f38462c .k_c_9f38462c svg{width:16px;height:16px}.g_c_9f38462c .k_c_9f38462c .themeableSvgPath{fill:"[theme:bodyBackground, default: #ffffff]"}.g_c_9f38462c .k_c_9f38462c .l_c_9f38462c{z-index:2;display:block;position:absolute;transition:1s;width:34px;left:68px}.m_c_9f38462c{overflow:hidden;width:100%;height:100%;text-align:left}[dir=ltr] .n_c_9f38462c{margin-right:8px}[dir=rtl] .n_c_9f38462c{margin-left:8px}.o_c_9f38462c{width:100%;height:100%;text-align:left}.o_c_9f38462c::-moz-focus-inner{border:0}.o_c_9f38462c{outline:transparent;position:relative}.o_c_9f38462c.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .o_c_9f38462c:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.o_c_9f38462c .p_c_9f38462c{transition:opacity .3s ease;-webkit-user-select:none;-ms-user-select:none;user-select:none}.g_c_9f38462c.h_c_9f38462c{margin:0 auto}.q_c_9f38462c,.r_c_9f38462c{z-index:2}.q_c_9f38462c::-moz-focus-inner,.r_c_9f38462c::-moz-focus-inner{border:0}.q_c_9f38462c,.r_c_9f38462c{outline:transparent;position:relative}.q_c_9f38462c.ms-Fabric.is-focusVisible:focus:after,.r_c_9f38462c.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .q_c_9f38462c:focus:after,.ms-Fabric.is-focusVisible .r_c_9f38462c:focus:after{content:"";position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;pointer-events:none}.q_c_9f38462c.p_c_9f38462c,.r_c_9f38462c.p_c_9f38462c{overflow:visible}.r_c_9f38462c img,.q_c_9f38462c img{max-width:100%}.r_c_9f38462c .cropper-crop-box:focus{outline:none}.r_c_9f38462c .cropper-point{width:12px;height:12px;opacity:.75;background-color:"[theme:bodyBackground, default: #ffffff]"}.r_c_9f38462c .point-se{width:12px!important;height:12px!important}.q_c_9f38462c .cropper-line,.q_c_9f38462c .cropper-point{display:none}.p_c_9f38462c{margin:0 auto;overflow:hidden;width:100%;max-width:100%}.p_c_9f38462c .s_c_9f38462c{min-height:100px}.p_c_9f38462c .s_c_9f38462c .t_c_9f38462c{position:absolute;top:50%;transform:translate(-50%,-50%);padding:10px;text-align:center;background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]"}[dir=ltr] .p_c_9f38462c .s_c_9f38462c .t_c_9f38462c{left:50%}[dir=rtl] .p_c_9f38462c .s_c_9f38462c .t_c_9f38462c{right:50%}.p_c_9f38462c .s_c_9f38462c .t_c_9f38462c .u_c_9f38462c{display:block;font-size:48px;margin:8px 0;color:#fff;animation:v_c_9f38462c 2s linear infinite}@keyframes v_c_9f38462c{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.p_c_9f38462c .w_c_9f38462c{opacity:.5}.p_c_9f38462c .x_c_9f38462c{opacity:1}.p_c_9f38462c .x_c_9f38462c.y_c_9f38462c{display:none}.p_c_9f38462c img{display:block;margin:0 auto;position:relative}.p_c_9f38462c img:not([src]){display:none}.z_c_9f38462c{width:100%;height:100%}.z_c_9f38462c img.aa_c_9f38462c{-o-object-fit:fill;object-fit:fill}.z_c_9f38462c img.ab_c_9f38462c{-o-object-fit:contain;object-fit:contain}.z_c_9f38462c img.ac_c_9f38462c{-o-object-fit:cover;object-fit:cover}.z_c_9f38462c img.ae_c_9f38462c{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);height:auto;width:100%}.z_c_9f38462c img.af_c_9f38462c{-o-object-fit:scale-down;object-fit:scale-down}.z_c_9f38462c img.ag_c_9f38462c{-o-object-fit:none;object-fit:none}.ah_c_9f38462c{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.ai_c_9f38462c{margin-right:-15px;margin-left:-15px}.aj_c_9f38462c{display:flex;flex-direction:column;align-items:center;max-width:300px;padding:10px}.ak_c_9f38462c{margin-top:10px}[dir=ltr] .al_c_9f38462c{float:right}[dir=rtl] .al_c_9f38462c{float:left}.am_c_9f38462c{background:transparent!important}.an_c_9f38462c{text-decoration:underline!important}.an_c_9f38462c:hover{text-decoration:none!important}.ao_c_9f38462c{z-index:3;pointer-events:none;position:absolute;width:100%;height:100%;background-color:"[theme:themeDarker, default: #004578]";opacity:.8;text-align:center}.ap_c_9f38462c{color:"[theme:white, default: #ffffff]";position:absolute;transform:translate(-50%,-50%)}.ap_c_9f38462c.aq_c_9f38462c{font-size:68px;top:calc(50% - 20px)}.ap_c_9f38462c.ar_c_9f38462c{display:inline-block;font-size:18px;top:calc(50% + 20px)}.as_c_9f38462c:hover:before{content:url('+c+');width:20px;height:20px;z-index:1;position:absolute;right:17px;top:12px}.as_c_9f38462c:hover:after{position:absolute;content:"";height:100%;width:100%;top:0;left:0;background:linear-gradient(180deg,rgba(0,0,0,.5),transparent 23.9%)}.at_c_9f38462c:hover{cursor:pointer}',!0),t.e={imageFrame:"g_c_9f38462c",isInline:"h_c_9f38462c",imageNone:"i_c_9f38462c",controlToolbar__above:"j_c_9f38462c",controlToolbar:"k_c_9f38462c",aspectRatioButtonGroup:"l_c_9f38462c",localFilePreviewFrame:"m_c_9f38462c",changeButton:"n_c_9f38462c",editFrame:"o_c_9f38462c",imageArea:"p_c_9f38462c",imageCropWrapper:"q_c_9f38462c",imageCropWrapperFree:"r_c_9f38462c",uploadingIconArea:"s_c_9f38462c",uploadingIcon:"t_c_9f38462c",uploadingSpinner:"u_c_9f38462c",spin:"v_c_9f38462c",imagePreview:"w_c_9f38462c",imageRender:"x_c_9f38462c",imageIsLoading:"y_c_9f38462c",objectFit:"z_c_9f38462c",objectFitFill:"aa_c_9f38462c",objectFitContain:"ab_c_9f38462c",objectFitCover:"ac_c_9f38462c",objectFitCoverIE11:"ae_c_9f38462c",objectFitScaleDown:"af_c_9f38462c",objectFitNone:"ag_c_9f38462c",screenReaderOnly:"ah_c_9f38462c",row:"ai_c_9f38462c",toolTip:"aj_c_9f38462c",altTextVerifyButton:"ak_c_9f38462c",dismissButtonContainer:"al_c_9f38462c",errorMessageBar:"am_c_9f38462c",errorMessageExternalSrcLink:"an_c_9f38462c",dropOverlayContainer:"ao_c_9f38462c",dropOverlay:"ap_c_9f38462c",dropOverlayIcon:"aq_c_9f38462c",dropOverlayMessage:"ar_c_9f38462c",linkImageContainer:"as_c_9f38462c",expandImageContainer:"at_c_9f38462c"}},bXd7:function(e,t){e.exports=l},br4S:function(e,t){e.exports=u},cDcd:function(e,t){e.exports=f},cSeU:function(e,t,n){"use strict";var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("UWqr"),s=n("ut3N"),c=n("bXd7"),d=n("hiL/"),l=n("tGpx"),u=n("U4ag"),f=n("neDN"),p=n("MS2Y"),m=n("oAO0"),_=n("Pl8B"),h=n("ad5q"),b=function(e){function t(t){var n=e.call(this,t)||this;return n._imageArea=i.createRef(),n._onImageLoad=function(e,t){n._imageArea.current.style.opacity="1",n.setState({imageService:t}),n.props.onImageLoad&&n.props.onImageLoad(),n._addFPSCoachmark(),n._applyAlternateCrop()},n._imgRef=function(e){n._imageElement=e},n._isParallaxActive=!1,n._logSource=s._LogSource.create("ImageView"),n._isIE=o._BrowserDetection.getBrowserInformation().browser===o._Browser.IE,n.state={imageNaturalHeight:n.props.imageData.imageNaturalHeight||0,imageNaturalWidth:n.props.imageData.imageNaturalWidth||0,imageService:void 0},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"_isOptimalCropApplied",{get:function(){var e=this.state.imageService;return("cdn"===e||"vroom"===e||"vroomCrossGeo"===e||"optimalStaticImage"===e)&&this._isCropDataValid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isCropDataValid",{get:function(){var e=this.props.imageData.cropData;return void 0!==e&&e.x>=0&&e.y>=0&&e.width>0&&e.height>0&&!this._isCropFullImage},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isCropFullImage",{get:function(){var e=this.props.imageData,t=e.cropData,n=e.imageNaturalHeight,a=e.imageNaturalWidth;return void 0!==t&&0===t.x&&0===t.y&&t.width>0&&t.height>0&&t.width===a&&t.height===n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_originalImageUrl",{get:function(){return this.props.imageData.imageUrl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_useParallax",{get:function(){return Boolean(this.props.useParallax)&&!!this._imageElement},enumerable:!1,configurable:!0}),t.getImageSizeStyles=function(e,t,n,a){var i,r;if(a&&e.resizeDesiredWidth)i=e.resizeDesiredWidth;else{var o=Object(p.t)(e,t),s=o.displayHeight,c=o.displayWidth;if(n){var d=c/(e.cropData&&e.cropData.width||e.imageNaturalWidth);r=e.imageNaturalHeight*d,i=e.imageNaturalWidth*d}else r=s,i=c}return[void 0===r?void 0:r+"px",void 0===i?void 0:i+"px"]},t._isValidImage=function(e){return!(!e||!e.imageUrl&&!e.uniqueId)},t.prototype.componentDidMount=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:if(!this._imageElement)return[2];if(this._useParallax&&!this._isParallaxActive&&(this._isParallaxActive=u.Parallax.instance.tryAddParallax(this._imageElement)),this.state.imageNaturalWidth&&this.state.imageNaturalHeight)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,m.e.loadThumbnailImage({imageData:this.props.imageData,serviceScope:this.props.serviceScope,thumbnailWidth:f.e,callerId:this.props.callerId,getDefaultImage:d.DefaultImageHelper.getDefaultImage})];case 2:return e=n.sent(),this.setState({imageNaturalWidth:e.naturalWidth,imageNaturalHeight:e.naturalHeight}),[3,4];case 3:return t=n.sent(),s._TraceLogger.logError(s._LogSource.create("ImageWebPart"),t,"UpdateDimensions"),[3,4];case 4:return[2]}})})},t.prototype.componentWillUnmount=function(){this._useParallax&&this._isParallaxActive&&(this._imageElement&&u.Parallax.instance.removeParallax(this._imageElement),this._isParallaxActive=!1)},t.prototype.componentDidUpdate=function(){this._applyAlternateCrop()},t.prototype.render=function(){var e,n;if(!t._isValidImage(this.props.imageData))return!1;var o=this.props.objectFit?this._getObjectFit(this.props.objectFit):void 0,s=t.getImageSizeStyles(this.props.imageData,this.props.containerWidth,!this._isOptimalCropApplied,this.props.isInlineImage),c=s[0],u=s[1],f={alt:this.props.imageData.altText||"",callerId:this.props.callerId,className:Object(r.css)(o,(e={},e[h.e.objectFit]=!!this.props.objectFit,e)),height:this.props.fixAspectRatio?void 0:c,width:u,imageData:this.props.imageData,getDefaultImage:d.DefaultImageHelper.getDefaultImage,onImageLoad:this._onImageLoad,onImageLoadFailure:this.props.onImageLoadFailure,onInViewport:this.props.onInViewport,onLazyTimeout:this.props.onLazyTimeout,serviceScope:this.props.serviceScope,thumbnailWidth:this.props.containerWidth};return i.createElement("div",{className:Object(r.css)(h.e.imageArea,(n={},n[h.e.objectFit]=!!this.props.objectFit,n)),ref:this._imageArea,style:{opacity:0},onClick:this.props.onClick,role:this.props.onClick?"button":void 0},i.createElement(l.SPImg,Object(a.__assign)({"data-sp-originalimgsrc":this._originalImageUrl},f,{imgRef:this._imgRef})))},t.prototype._getObjectFit=function(e){if(this._isIE&&"cover"===e)return h.e.objectFitCoverIE11;switch(e){case"fill":return h.e.objectFitFill;case"contain":return h.e.objectFitContain;case"cover":return h.e.objectFitCover;case"none":return h.e.objectFitNone;case"scale-down":return h.e.objectFitScaleDown;default:return}},t.prototype._addFPSCoachmark=function(){var e=this;this._imageElement&&this.props.isEditMode&&this.props.serviceScope.consume(c.CoachmarkUtility.serviceKey).attachCoachmark({positioningContainerProps:{directionalHint:r.DirectionalHint.topLeftEdge,directionalHintForRTL:r.DirectionalHint.topRightEdge},localStorageKey:"DismissedImageEditControlCoachmark",featureGroupKey:"imageFPSCoachmark",target:this._imageElement,content:_.x,teachingBubbleProps:{headline:_.j,hasCondensedHeadline:!0,primaryButtonProps:{target:"_blank",text:_.C,href:"https://go.microsoft.com/fwlink/?linkid=2042231&clcid=0x409"}}}).catch(function(t){return s._TraceLogger.logError(e._logSource,t,"AttachCoachmark")})},t.prototype._applyAlternateCrop=function(){if(this._imageElement&&this._imageArea.current){var e=this._imageElement,t=this._imageArea.current,n=this.props,a=n.imageData,i=n.containerWidth;if(this._isOptimalCropApplied||void 0===this.props.containerWidth||void 0===a.cropData)t.style.width="",t.style.height="",e.style.left="",e.style.top="",e.style.maxWidth="100%";else{var r=Object(p.t)(a,i),o=r.displayHeight,s=r.displayWidth;t.style.width=s+"px",t.style.height=o+"px";var c=s/a.cropData.width;e.style.left=-Math.round(a.cropData.x*c)+"px",e.style.top=-Math.round(a.cropData.y*c)+"px",e.style.maxWidth=""}}},t}(i.PureComponent);t.e=b},eKFN:function(e,t,n){"use strict";var a=n("UWqr"),i=function(){function e(){}return e.isImageLightBoxFlightActivated=function(){return a._SPFlight.isEnabled(60038)},e}();t.e=i},faye:function(e,t){e.exports=p},"hiL/":function(e,t){e.exports=m},i69V:function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},ivTr:function(e){e.exports=JSON.parse('{"e":"Image web part, showing {0}. {1} {2}","t":"Now you can drag or paste an image right onto your page. Have an image web part or title area you want to change? Just select it first, and then drag or paste your image over it.","n":"Got it","a":"More ways to add images!","i":"Press enter to open the hyperlink."}')},jOlS:function(e,t){e.exports=_},neDN:function(e,t,n){"use strict";n.d(t,"e",function(){return a}),n("hiL/"),n("oAO0");var a=2560},oAO0:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("tGpx"),s=function(){function e(){}return e.loadImage=function(e){return new Promise(function(t,n){var a=document.createElement("img");a.onload=function(e){t(a)},a.onerror=function(e){n(e)},a.setAttribute("src",e)})},e.readImageRatio=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.loadImage(t)];case 1:return[2,(n=a.sent()).naturalWidth/n.naturalHeight]}})})},e.loadThumbnailImage=function(e){return new Promise(function(t,n){var s=document.createElement("div");e.disableBlobRevoke=!0,r.render(i.createElement(o.SPImg,Object(a.__assign)(Object(a.__assign)({},e),{onImageLoad:function(e){t(null==e?void 0:e.target),r.unmountComponentAtNode(s)},onImageLoadFailure:function(e,t){"stockImage"===e&&(n(e),r.unmountComponentAtNode(s))},renderedInDetachedDOM:!0})),s)})},e.readThumbnailImageRatio=function(t){return Object(a.__awaiter)(this,void 0,void 0,function(){var n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,e.loadThumbnailImage(t)];case 1:return[2,(n=a.sent()).naturalWidth/n.naturalHeight]}})})},e}()},sSDQ:function(e,t){e.exports=h},tGpx:function(e,t){e.exports=b},ut3N:function(e,t){e.exports=g},y88i:function(e,t){e.exports=v},yCEm:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("UWqr"),s=n("ut3N"),c=n("Pk8u"),d=n("U4ag"),l=n("5gqb"),u=function(e){function t(t){var n=e.call(this,t)||this;return n._overlayTextWrapperRef=i.createRef(),n._handleClick=function(e){e.stopPropagation(),n.props.onClick&&n.props.onClick()},n._handleTextChanged=function(e,t){void 0===t&&(t="");var a=n.props,i=a.maximumCharacters,r=a.onChangeText;if(i){t.length>i&&(t=t.substr(0,i));var o=/\n/g;(t.match(o)||[]).length>=i&&(t=t.replace(o," "))}r&&r(t),n.setState({text:t})},n._handleFocus=function(){n._initialValue=n.state.text},n._handleBlur=function(){var e;n._initialValue!==n.state.text&&n.props.qosPrefix&&(e=0===n.state.text.length?"Clear":0===n._initialValue.length?"Add":"Edit",s._EngagementLogger.logEventWithLogEntry(new s._LogEntry(n.props.qosPrefix,"OverlayText",s._LogType.Event,{action:e,length:n.state.text.length.toString()})))},n.state={text:t.initialValue||"",textFieldWidth:0,textFieldHeight:0},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.hostWidth,n=e.isEditMode,a=e.alignment,o=e.fontSize,s=e.padding,c=this.state.text,d=t-s.left-s.right,l=1.5*o,u=l+s.top+s.bottom;if(d<=0||!n&&!c)return!1;var f={fontSize:o,padding:s.top+"px "+s.right+"px "+s.bottom+"px "+s.left+"px",maxWidth:t,fontWeight:"600",color:"#fff",lineHeight:l,minHeight:u},p=Object(r.mergeStyleSets)({overlayTextContainer:{display:"flex",justifyContent:"Center"===a?"center":"Left"===a?"unset":"flex-end"}}),m=n?this._renderEditModeView(c,f):this._renderViewModeView(c,f);return i.createElement("div",{className:p.overlayTextContainer},m)},t.prototype.componentDidUpdate=function(e,t){(!Object(c.isEqual)(e,this.props)||!Object(c.isEqual)(t,this.state))&&this._updateTextFieldSizeBasedOnDisplayWidth()},t.prototype.componentDidMount=function(){this._updateTextFieldSizeBasedOnDisplayWidth()},Object.defineProperty(t.prototype,"_isMultiline",{get:function(){return"SquareHeight"===this.props.heightOption||"NoLimit"===this.props.heightOption},enumerable:!1,configurable:!0}),t.prototype._updateTextFieldSizeBasedOnDisplayWidth=function(){var e=this;requestAnimationFrame(function(){var t=e._overlayTextWrapperRef.current?e._overlayTextWrapperRef.current.clientWidth:0,n=e._overlayTextWrapperRef.current?e._overlayTextWrapperRef.current.clientHeight:0;t===e.state.textFieldWidth&&n===e.state.textFieldHeight||(e.setState({textFieldWidth:t,textFieldHeight:n}),e.props.onChangeSize&&e.props.onChangeSize(t,n))})},t.prototype._renderEditModeView=function(e,n){var o=this.props,s=o.hostWidth,c=o.placeholder,d=o.fontSize,u=o.padding,f=this.state,p=f.textFieldWidth,m=f.textFieldHeight,_=Object(r.mergeStyleSets)({textField:{width:t._isIE||t._isSafari?p+2+u.right:p+2,maxWidth:s,height:m,selectors:{"& div":{backgroundColor:"transparent"},"input[type=text], textarea":Object(a.__assign)({margin:"0 auto",backgroundColor:"rgba(0,0,0,0.88)",height:m,overflow:"hidden"},n),"input[type=text]::placeholder, textarea::placeholder":{fontSize:d,color:"#fff",fontWeight:"600"}}}}),h=0!==p&&i.createElement(r.TextField,{borderless:!0,multiline:this._isMultiline,resizable:!1,ariaLabel:l.e,className:_.textField,placeholder:c,value:e,onChange:this._handleTextChanged,onFocus:this._handleFocus,onBlur:this._handleBlur,onClick:this._handleClick,"data-automation-id":"image-overlay-text"});return i.createElement(i.Fragment,null,this._renderViewModeView(e||c,n,!1),h)},t.prototype._renderViewModeView=function(e,n,o){void 0===o&&(o=!0);var s,c=this.props,l=c.heightOption,u=c.padding,f=this.state.textFieldWidth,p=n.lineHeight,m=1;if(0!==p&&"SquareHeight"===l){var _=n.minHeight;f>_&&(_=f),m=Math.floor((_-u.top-u.bottom)/p),s=Object(d.truncateText)(m,p)}else"NoLimit"===l&&(m=-1);"\n"===e.slice(-1)&&(e+=" ");var h=Object(r.mergeStyleSets)({overlayTextWrapper:Object(a.__assign)({backgroundColor:"rgba(0,0,0, 0.88)",whiteSpace:this._isMultiline?"pre-wrap":"pre",wordWrap:t._isIE&&this._isMultiline?"break-word":void 0,overflow:t._isIE&&this._isMultiline?"hidden":void 0,wordBreak:this._isMultiline?"break-word":"unset",zIndex:o?1:0,position:o?"unset":"absolute",opacity:o?1:0,boxSizing:"border-box"},n),overlayText:s}),b=t._isIE?i.createElement("div",{className:h.overlayText,title:e},e):i.createElement(d.LessText,{className:"",text:e,lines:m,autoShowTitle:!1});return i.createElement("div",{className:h.overlayTextWrapper,ref:this._overlayTextWrapperRef,"data-automation-id":"overlay-text-wrapper"},b)},t._browser=o._BrowserDetection.getBrowserInformation().browser,t._isIE=t._browser===o._Browser.IE,t._isSafari=t._browser===o._Browser.Safari,t}(i.Component)},zMuk:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("faye"),o=n("7Awa"),s=n("UWqr"),c=n("ut3N"),d=n("Pk8u"),l=n("br4S"),u=n("y88i"),f=n("sSDQ"),p=n("hiL/"),m=n("tGpx"),_=n("2q6Q"),h=n("U4ag"),b=n("KL1q"),g=n("1NDK"),v=n("MS2Y"),y=n("Hy/w"),S=n("eKFN"),D=n("Pl8B");n("jOlS").loadStyles(".ei_g_9f38462c{position:relative;display:block}.ei_g_9f38462c .ej_g_9f38462c{position:absolute;max-width:100%;max-height:100%;width:100%;bottom:0}.ei_g_9f38462c .ej_g_9f38462c .ek_g_9f38462c{background-color:rgba(0,0,0,.72);margin:0 auto;color:#fff}.ei_g_9f38462c .ej_g_9f38462c .ek_g_9f38462c:-ms-input-placeholder{color:#fff}.ei_g_9f38462c .ej_g_9f38462c .ek_g_9f38462c::placeholder{color:#fff}.ei_g_9f38462c .ej_g_9f38462c div{background-color:transparent}.el_g_9f38462c{position:absolute;bottom:0;max-width:100%;white-space:pre-wrap;word-wrap:break-word;color:#fff;background-color:rgba(0,0,0,.72)}[dir=ltr] .el_g_9f38462c{left:0}[dir=rtl] .el_g_9f38462c{right:0}.em_g_9f38462c.el_g_9f38462c,.em_g_9f38462c.ej_g_9f38462c .ek_g_9f38462c{font-size:20px;padding:8px;margin-bottom:16px}.em_g_9f38462c textarea:-ms-input-placeholder{font-size:20px}.em_g_9f38462c textarea::placeholder{font-size:20px}.en_g_9f38462c.el_g_9f38462c,.en_g_9f38462c.ej_g_9f38462c .ek_g_9f38462c{font-size:24px;padding:16px;margin-bottom:32px}.en_g_9f38462c textarea:-ms-input-placeholder{font-size:24px}.en_g_9f38462c textarea::placeholder{font-size:24px}.eo_g_9f38462c.el_g_9f38462c,.eo_g_9f38462c.ej_g_9f38462c .ek_g_9f38462c{font-size:28px;padding:24px;margin-bottom:48px}.eo_g_9f38462c textarea:-ms-input-placeholder{font-size:28px}.eo_g_9f38462c textarea::placeholder{font-size:28px}",!0);var I=n("ad5q"),x=n("cSeU"),C=n("EZEx"),O=n("PTFE"),w=function(e){function t(t){var r=e.call(this,t)||this;return r._onImageWithoutLinkKeyPressed=function(e){e.charCode!==b.KeyCodes.enter&&e.charCode!==b.KeyCodes.space||(e.preventDefault(),r._showImageLightBox())},r._imageLoadedCallback=function(){r.setState({isImageLoaded:!0}),r.props.onImageLoad&&r.props.onImageLoad()},r._logClick=function(){c._EngagementLogger.logEvent("ImageWebPart.Link.Click")},r._getImageAriaLabel=function(){var e,t=r.props.imageData;return t.overlayText||t.captionText||t.altText?u.StringHelper.format(D.I,t.overlayText||"",t.captionText||"",t.altText||""):(null===(e=t.imageUrl)||void 0===e?void 0:e.split("/").pop())||""},r._showImageLightBox=function(){Object(O.p)()?Promise.all([n.e(0),n.e(7)]).then(n.bind(null,"IWHO")).then(function(e){e.LightBox.show({items:[Object(a.__assign)({title:r.props.imageData.overlayText,description:r.props.imageData.captionText},r.props.imageData)],startIndex:0,isShown:!0,onClose:void 0,onRenderItem:function(e){return i.createElement(y.e,{image:e,serviceScope:r.props.serviceScope,callerId:15})},getItemAriaLabel:r._getImageAriaLabel,showPagination:!1,callerId:15})}).catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageWebPart"),e,"LoadImageLightBoxChunk")}):Promise.all([n.e(0),n.e(16)]).then(n.bind(null,"PiBD")).then(function(e){e.LightBox.show({items:[Object(a.__assign)({title:r.props.imageData.overlayText,description:r.props.imageData.captionText},r.props.imageData)],startIndex:0,isShown:!0,onClose:void 0,onRenderItem:function(e){return i.createElement(y.e,{image:e,serviceScope:r.props.serviceScope,callerId:15})},getItemAriaLabel:r._getImageAriaLabel,showPagination:!1,callerId:15})}).catch(function(e){c._TraceLogger.logError(c._LogSource.create("ImageWebPart"),e,"LoadLibraryLightBoxChunk")})},r.state={isImageLoaded:Object(O.l)()},r}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=Object(O.u)()?void 0:this.props.imageData.altText;return this.props.imageData.linkUrl?i.createElement(b.Link,{href:this.props.imageData.linkUrl,target:Object(h.getUrlTarget)(this.props.imageData.linkUrl),className:this._linkImageStyle,onClick:this._logClick},this._imageView,this._overlayText):this.props.imageData.overlayText?S.e.isImageLightBoxFlightActivated()?i.createElement("div",{tabIndex:0,className:Object(b.mergeStyles)("ei_g_9f38462c",I.e.expandImageContainer),role:"img","aria-label":e,onClick:this._showImageLightBox,onKeyPress:this._onImageWithoutLinkKeyPressed},this._imageView,this.state.isImageLoaded&&this._overlayText):i.createElement("div",{className:"ei_g_9f38462c"},this._imageView,this.state.isImageLoaded&&this._overlayText):S.e.isImageLightBoxFlightActivated()?i.createElement("div",{role:"img","aria-label":e,onClick:this._showImageLightBox,className:I.e.expandImageContainer,tabIndex:0,onKeyPress:this._onImageWithoutLinkKeyPressed},this._imageView):this._imageView},Object.defineProperty(t.prototype,"_linkImageStyle",{get:function(){return Object(b.mergeStyles)("ei_g_9f38462c",S.e.isImageLightBoxFlightActivated()&&I.e.linkImageContainer)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_imageView",{get:function(){return i.createElement(x.e,Object(a.__assign)({},this.props,{onImageLoad:Object(O.l)()?this.props.onImageLoad:this._imageLoadedCallback,ref:void 0}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_overlayText",{get:function(){var e=this.props,t=e.imageData,n=e.containerWidth,a=Object(v.t)(t,n).displayWidth,r=i.createElement(C.e,{isEditMode:!1,initialValue:this.props.imageData.overlayText||"",offset:0,hostWidth:a,qosPrefix:"ImageWebPart"});return Boolean(this.props.isOverlayTextEnabled)?r:void 0},enumerable:!1,configurable:!0}),t}(i.PureComponent),E=function(e){var t=e.variantTheme;return t?{root:{color:t.semanticColors.bodyText+" !important",selectors:{textarea:{color:t.semanticColors.bodyText},"textarea::placeholder":{color:t.semanticColors.bodySubtext}}}}:{root:void 0}},A=Object(b.classNamesFunction)(),L=function(e){function t(t){var n=e.call(this,t)||this;return n._ref=i.createRef(),n._eventListenersAdded=!1,n.openFilePicker=function(){n._imageEditControlComponent&&n._imageEditControlComponent.openFilePicker()},n.handlePaste=function(e,t){n._handlePaste(e,t)},n._clearError=function(){(n.state.uploadError||n.state.uploadErrorSrc)&&n.setState({uploadError:void 0,uploadErrorSrc:void 0})},n._handleCaptionTextChange=function(e){n.props.onCaptionTextChange&&n.props.onCaptionTextChange(e)},n._handleUploadError=function(e,t){n.setState({uploadError:e,uploadErrorSrc:t})},n._handleClickSourceSite=function(e){var t=new c._LogEntry("Image","ErrorMessageSourceSiteLink.Click",c._LogType.Event);c._EngagementLogger.logEventWithLogEntry(t)},n._handlePaste=function(e,t){var a;n.props.isInEditMode&&(null===(a=n._imageEditControlComponent)||void 0===a?void 0:a.handleDataPaste)&&n._imageEditControlComponent.handleDataPaste(e,t)},n._handleDrop=function(e){var t;n.setState({isDragging:!1}),(null===(t=n._imageEditControlComponent)||void 0===t?void 0:t.handleDataDrop)&&n._imageEditControlComponent.handleDataDrop(e)},n._handleDragOver=function(e){var t;if((null===(t=e.dataTransfer)||void 0===t?void 0:t.items)instanceof DataTransferItemList)for(var a=e.dataTransfer.items,i=0;i<a.length;i++)if("file"===a[i].kind&&a[i].type.match("^image/"))return e.preventDefault(),void(n.state.isDragging||n.setState({isDragging:!0}))},n._handleDragLeave=function(e){e.preventDefault(),n.state.isDragging&&n.setState({isDragging:!1})},n._addDragAndDropListeners=function(){n._ref.current&&(n._eventListenersAdded=!0,n._ref.current.addEventListener("drop",n._handleDrop),n._ref.current.addEventListener("dragover",n._handleDragOver),n._ref.current.addEventListener("dragleave",n._handleDragLeave))},n._removeDragAndDropListeners=function(){n._ref.current&&(n._eventListenersAdded=!1,n._ref.current.removeEventListener("drop",n._handleDrop),n._ref.current.removeEventListener("dragover",n._handleDragOver),n._ref.current.removeEventListener("dragleave",n._handleDragLeave))},n.state={isEditControlLoaded:!1,uploadError:void 0,isDragging:!1},n}return Object(a.__extends)(t,e),t.prototype.UNSAFE_componentWillUpdate=function(e,t){e.isInEditMode&&!t.isEditControlLoaded&&this._ensureEditControl().catch(d.noop)},t.prototype.componentDidMount=function(){this.props.isInEditMode&&!this.state.isEditControlLoaded&&this._ensureEditControl().catch(d.noop),this.props.isInEditMode&&this._addDragAndDropListeners()},t.prototype.componentDidUpdate=function(){this.state.isDragging||(!this._eventListenersAdded&&this.props.isInEditMode?this._addDragAndDropListeners():this._eventListenersAdded&&!this.props.isInEditMode&&this._removeDragAndDropListeners())},t.prototype.componentWillUnmount=function(){this._eventListenersAdded&&this._removeDragAndDropListeners()},t.prototype.render=function(){var e,t=!(this.props.isCaptionHidden||this.props.isFullWidth||this.state.uploadError),n=this.props.isInEditMode?this.state.isEditControlLoaded?this._editControl:void 0:this._imageViewMode,a=Object(b.css)(this._classNames&&this._classNames.root),r=t&&i.createElement(h.CaptionElement,{useFigCaptionTag:!0,className:a,text:this.props.imageData.captionText,isEditMode:this.props.isInEditMode,onChange:this._handleCaptionTextChange,placeholder:D.s,moduleName:"ImageWebPart"}),o=Object(b.mergeStyles)({display:"flex",flexDirection:"Left"===this.props.imageData.alignment?"row":"row-reverse",justifyContent:"Center"===this.props.imageData.alignment?"center":"unset",height:"100%",width:"100%"}),s=i.createElement(i.Fragment,null,n,r,!!this.state.uploadError&&this._errorMessageBar),c=Object(v.t)(this.props.imageData,this.props.containerWidth).displayWidth,d="cover"===this.props.objectFit||"fill"===this.props.objectFit||"none"===this.props.objectFit,l=Object(b.mergeStyles)({height:d?"100%":"",width:d?"100%":this.props.isInEditMode?"":c,margin:0}),u=Object(b.mergeStyles)(o,Object(b.css)(I.e.imageFrame,((e={})[I.e.objectFit]=!!this.props.objectFit,e)));return i.createElement("div",{className:u,"data-automation-id":"imageFrame",onPaste:this._handlePaste,ref:this._ref},this.state.isDragging&&g.e,i.createElement("figure",{className:l},s))},Object.defineProperty(t.prototype,"_classNames",{get:function(){return Boolean(this.props.emphasisTheme)&&A(E,{variantTheme:this.props.emphasisTheme})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_imageViewMode",{get:function(){return i.createElement(w,{imageData:this.props.imageData,serviceScope:this.props.serviceScope,containerWidth:this.props.containerWidth,fixAspectRatio:this.props.isInlineImage,isFullWidth:this.props.isFullWidth,isOverlayTextEnabled:this.props.isOverlayTextEnabled,onImageLoad:this.props.onImageLoad,onImageLoadFailure:this.props.onImageLoadFailure,onInViewport:this.props.onInViewport,onLazyTimeout:this.props.onLazyTimeout,imageAspectRatio:this.props.imageAspectRatio,useParallax:!this.props.isInEditMode&&!!this.props.imageData&&this.props.imageData.useParallax,objectFit:this.props.objectFit,callerId:this.props.callerId})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_editControl",{get:function(){return this.state.isEditControlLoaded?i.createElement(this._imageEditControl,{clearUploadError:this._clearError,containerWidth:this.props.containerWidth,maxInlineWidth:this.props.maxInlineWidth,fixAspectRatio:this.props.isInlineImage,handleUploadError:this._handleUploadError,imageAspectRatio:this.props.imageAspectRatio,imageBlob:this.props.imageBlob,imageData:this.props.imageData,isCaptionHidden:this.props.isCaptionHidden,isFullWidth:this.props.isFullWidth,isOverlayTextEnabled:this.props.isOverlayTextEnabled,onEditComplete:this.props.onEditComplete,onImageLoad:this.props.onImageLoad,onImageLoadFailure:this.props.onImageLoadFailure,onVerifyAltText:this.props.onVerifyAltText,onOverlayTextChanged:this.props.onOverlayTextChanged,ref:this._resolveRef("_imageEditControlComponent"),renderedFromPersistedData:this.props.renderedFromPersistedData,serviceScope:this.props.serviceScope,isInEditMode:void 0,isInlineImage:this.props.isInlineImage,rteInlineIndentationLevels:this.props.rteInlineIndentationLevels,onInlineImageChangeButtonClick:this.props.onInlineImageChangeButtonClick,onCaptionTextChange:void 0,callerId:this.props.callerId,disableStockAssets:this.props.disableStockAssets}):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_errorMessageBar",{get:function(){var e;return e=this.state.uploadErrorSrc?i.createElement("span",null,D.v,i.createElement("br",null),i.createElement(b.Link,{className:I.e.errorMessageExternalSrcLink,href:this.state.uploadErrorSrc,onClick:this._handleClickSourceSite,target:"_blank"},D.y)):this.state.uploadError?i.createElement("span",null,this.state.uploadError.message):void 0,i.createElement(b.MessageBar,{className:I.e.errorMessageBar,messageBarType:b.MessageBarType.error},e)},enumerable:!1,configurable:!0}),t.prototype._ensureEditControl=function(){var e=this;return Promise.all([n.e(29),n.e(15)]).then(n.bind(null,"fK5Q")).then(function(t){e._imageEditControl=t.default,e.setState({isEditControlLoaded:!0})})},Object(a.__decorate)([Object(p.monitor)("ImageWebPart.LoadEditControl")],t.prototype,"_ensureEditControl",null),t}(b.BaseComponent),k=n("EQ+f"),M=n("MkPk"),P=n("ivTr"),T=n("Vm4b"),U=function(e){function t(){var t=e.call(this)||this;return t._isImageWebPartLoadLogged=!1,t._isInlineImageAutoCentered=!1,t.disableStockAssets=!1,t._shouldUpdateDesiredWidth=!1,t._onImageLoad=function(){var e,n;Object(M.e)()||null===(n=null===(e=t._functions)||void 0===e?void 0:e.onImageLoadResult)||void 0===n||n.call(e),t.renderCompleted()},t._onImageLoadFailure=function(){var e,n;Object(M.e)()||null===(n=null===(e=t._functions)||void 0===e?void 0:e.onImageLoadResult)||void 0===n||n.call(e,new Error("Image failed to load")),t.renderCompleted()},t._handleThemeChangedEvent=function(e){t._emphasisTheme=e.theme,t.render()},t._handleInlineImageChangeButtonClick=function(){var e=t.context.propertyPane;c._EngagementLogger.logEvent("InlineImageChangeSettings.Click"),e.isPropertyPaneOpen()?e.refresh():e.open()},t._addCustomEventHandlers=function(){t.domElement.addEventListener("PasteEvents",t._handleCustomPasteEvent)},t._removeCustomEventHandlers=function(){t.domElement.removeEventListener("PasteEvents",t._handleCustomPasteEvent)},t._handleCustomPasteEvent=function(e){var n,a=e.detail,i=a.event,r=a.instanceId,o=a.clipboardDataAsHtml;r===t.context.instanceId&&(null===(n=t._spImageComponent)||void 0===n||n.handlePaste(i,o))},t._handleEditComplete=t._handleEditComplete.bind(t),t}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){return Object(h.webPartPreviewThumbnail)({pageContext:this.context.pageContext,url:this.properties.imageSource,siteId:this.properties.siteId,webId:this.properties.webId,listId:this.properties.listId,uniqueId:this.properties.uniqueId,callerId:Object(m.callerIdToString)(this._isInlineImage?18:11),originalWidth:this.properties.imgWidth,originalHeight:this.properties.imgHeight})},enumerable:!1,configurable:!0}),t.prototype.render=function(){var e,n,a,o,l=this,u=this.displayMode===s.DisplayMode.Edit,f=this.properties,p=f.alignment,m=f.altText,h=f.captionText,b=f.cropHeight,g=f.cropWidth,v=f.cropX,y=f.cropY,S=f.fixAspectRatio,D=f.imgHeight,I=f.imgWidth,x=f.imageSource,C=f.isFullWidth,O=f.linkUrl,w=f.listId,E=f.overlayText,A=f.resizeDesiredWidth,k=f.rteInlineIndentationLevels,P=f.siteId,U=f.uniqueId,F=f.webId,H=this.width;if(this._isInlineImage){var R=k||"Left"!==p&&"Right"!==p?0:300,N=this._getCachedContainerWidth()||R;!Object(M.n)()&&k&&(N-=50*k+2);var B=A||I||N;(!B||B<359)&&(B=359),(o=N-R)<359&&(o=N),!u&&"Center"===p&&N-B<=56&&(B=N);var j=null===(e=this._functions)||void 0===e?void 0:e.updateInlineAlignment;N-B<R?(H=N,!u&&"Center"!==p&&j&&(this._isInlineImageAutoCentered=!0,j("Center"))):(H=B,!u&&this._isInlineImageAutoCentered&&j&&(j(p),this._isInlineImageAutoCentered=!1)),!Object(M.n)()&&H>o&&(H=o)}if(!u||this._editModeModule){c._TraceLogger.logVerbose(t.logSource,"render");var V={imageUrl:x,listId:w,siteId:P,webId:F,uniqueId:U,imageNaturalWidth:I,imageNaturalHeight:D,altText:m,linkUrl:O,overlayText:E,captionText:h,useParallax:C,resizeCoefficient:this._getImageResizeCoefficient(),alignment:!this._isInlineImageAutoCentered&&p||"Center",resizeDesiredWidth:this._getImageResizeDesiredWidth(o),cropData:isNaN(v)||isNaN(y)||isNaN(g)||isNaN(b)?void 0:{x:v,y:y,width:g,height:b,fixAspectRatio:S}};!Object(M.a)()&&this._isInlineImage&&this._shouldUpdateDesiredWidth&&(this.properties.resizeDesiredWidth=V.resizeDesiredWidth,this._shouldUpdateDesiredWidth=!1);var z,G=Object(T.t)(this.properties,H,!0);this.disableStockAssets=0===(null===(a=null===(n=this.context.pageContext.legacyPageContext)||void 0===n?void 0:n.farmSettings)||void 0===a?void 0:a.ExternalService_isstockimagesupported),z=this._isInlineImage?18:V.cropData?12:11;var K=i.createElement(L,{containerWidth:H,maxInlineWidth:o,imageBlob:this.properties.imageBlob,imageData:V,isFullWidth:this.properties.isFullWidth,isInEditMode:this.displayMode===s.DisplayMode.Edit,isInlineImage:this._isInlineImage,rteInlineIndentationLevels:this._rteInlineIndentationLevels,isOverlayTextEnabled:this.properties.isOverlayTextEnabled&&G,onCaptionTextChange:u?this._editMode.handleCaptionTextChange:d.noop,onEditComplete:u?this._handleEditComplete:d.noop,onImageLoad:this._onImageLoad,onImageLoadFailure:this._onImageLoadFailure,onLazyTimeout:this.renderCompleted,onVerifyAltText:u?this._editMode.handleVerifyAltText:d.noop,onOverlayTextChanged:u?this._editMode.handleTextOverlayChanged:d.noop,renderedFromPersistedData:this.renderedFromPersistedData,ref:function(e){l._spImageComponent=e},serviceScope:this.context.serviceScope,emphasisTheme:this._emphasisTheme,callerId:z,disableStockAssets:this.disableStockAssets,onInlineImageChangeButtonClick:this._handleInlineImageChangeButtonClick});r.render(K,this.domElement),this._logImageWebPartLoad(),this.displayMode===s.DisplayMode.Edit&&(this._editMode.ensureThumbnailMetadata(),this._coachMark.shouldAddCoachmark()&&this._coachMark.addCoachMarkForDragAndDrop()),1===_._SPPerfExperiment.getVariantAndTrackExperiment(_._PerformanceExperiment.StartDeferredDuringNetworkReq)&&this.onInitialRenderCompleted(),_._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,_._PerformanceExperiment.StartDeferredDuringNetworkReq)}},t.prototype.onDispose=function(){this._coachMark.isCoachmarkActive&&this._coachMark.closeCoachMark(),this._removeCustomEventHandlers(),r.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(o.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),e.prototype.onDispose.call(this)},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return s.Version.parse("1.9")},enumerable:!1,configurable:!0}),t.prototype.onBeforeSerialize=function(){delete this.properties.useParallax,this._isInlineImage&&delete this.properties.nonSerializedFunctions},t.prototype.onAfterDeserialize=function(e,t){return Object(f.migrateImageDataVersion)(e,t)},t.prototype.onInit=function(){var t=this;if(this._schemaUpgrade(),k.e.isInlineImageEnabled()){var n=this.properties,a=n.isInlineImage,i=n.rteInlineIndentationLevels;this._isInlineImage=!!a,!Object(M.n)()&&i&&(this._rteInlineIndentationLevels=Number(i))}if(this._isInlineImage&&(this._functions=this.properties.nonSerializedFunctions),this.properties.linkUrl){var r=this.properties.linkUrl,o=new p.SPResourcePath(r).authority;this.properties.linkUrl=o||"mailto"===new u.Uri(this.properties.linkUrl).getScheme()?r:u.Uri.concatenate(window.location.protocol+"//"+window.location.host,r)}return this._getEmphasisTheme(),this.displayMode===s.DisplayMode.Edit?this._initEditMode().then(function(){return e.prototype.onInit.call(t)}):e.prototype.onInit.call(this)},Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return Object(T.e)(this.properties)},enumerable:!1,configurable:!0}),t.prototype.onAfterResize=function(e){this._cachedContainerWidth=void 0,this.render()},t.prototype.onDisplayModeChanged=function(t){this.displayMode===s.DisplayMode.Edit&&this._initEditMode(),e.prototype.onDisplayModeChanged.call(this,t)},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){var e={linkUrl:{isLink:!0},captionText:{isSearchablePlainText:!0},imageSource:{isImageSource:!0}};return e.imageSource.customMetadata={siteId:"siteId",webId:"webId",listId:"listId",uniqueId:"uniqueId",width:"imgWidth",height:"imgHeight",cropX:"cropX",cropY:"cropY",cropWidth:"cropWidth",cropHeight:"cropHeight"},e},enumerable:!1,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){return this._editMode.getPropertyPaneConfiguration()},t.prototype.onPropertyPaneConfigurationComplete=function(){this._editMode.handlePropertyPaneConfigurationComplete(),e.prototype.onPropertyPaneConfigurationComplete.call(this)},t.prototype.onPropertyPaneFieldChanged=function(t,n,a){this._editMode.handlePropertyPaneFieldChanged(t,n,a),e.prototype.onPropertyPaneFieldChanged.call(this,t,n,a)},Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){var e=this.properties.altText||this.properties.captionText||this.properties.fileName;return e?u.StringHelper.format(P.e,e,this.properties.overlayText||"",this.properties.linkUrl?P.i:""):""},enumerable:!1,configurable:!0}),t.prototype._handleEditComplete=function(e){var t,n,a=e.alignment;!Object(M.a)()&&this._isInlineImage&&(this._shouldUpdateDesiredWidth="Center"===this.properties.alignment&&"Center"!==a),this._editMode.handleEditComplete(e),(null===(t=this._functions)||void 0===t?void 0:t.updateInlineAlignment)&&(null===(n=this._functions)||void 0===n||n.updateInlineAlignment(a),this.render())},t.prototype._getCachedContainerWidth=function(){var e,t;return this._cachedContainerWidth||(this._cachedContainerWidth=null===(t=null===(e=this._functions)||void 0===e?void 0:e.getContainerWidth)||void 0===t?void 0:t.call(e)),this._cachedContainerWidth},t.prototype._getImageResizeCoefficient=function(){return this.properties.isFullWidth?1:this.properties.resizeCoefficient},t.prototype._getImageResizeDesiredWidth=function(e){var t=this.properties.isFullWidth?1*this.width:this.properties.resizeDesiredWidth;return Object(M.n)()?!t||e&&t>e?e:t:t&&e&&t>e?e:t},t.prototype._logImageWebPartLoad=function(){if(!this._isImageWebPartLoadLogged){var e=p.ExtensionHelper.getExtension(new p.SPResourcePath(this.properties.imageSource))||"";c._EngagementLogger.logEventWithLogEntry(new c._LogEntry("ImageWebPart","Load",c._LogType.Event,{id:this.context.instanceId,captionLength:this.properties.captionText?this.properties.captionText.length.toString():"0",hasLink:this.properties.linkUrl?"true":"false",textOverlay:this.properties.overlayText?this.properties.overlayText.length.toString():"0",fileType:this.properties.imageSource?e:"null",cropped:!s._SPKillSwitch.isActivated("bc85c84c-d73c-4170-9aaf-e6fd43d8f1d9")&&this.properties.cropX&&this.properties.cropY&&this.properties.cropWidth&&this.properties.cropHeight?"true":"false",inline:!s._SPKillSwitch.isActivated("5ac78ee9-8e9f-4881-93b4-59d4bbc5a6c8")&&this._isInlineImage?"true":"false"})),this._isImageWebPartLoadLogged=!0}},t.prototype._schemaUpgrade=function(){for(var e=this.properties,t=0,n=["title","subTitle","imageWidth"];t<n.length;t++){var a=n[t];e.hasOwnProperty(a)&&delete e[a]}},t.prototype._getEmphasisTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(o.ThemeProvider.serviceKey);e._emphasisTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},t.prototype._initEditMode=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,i,r=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(this._editModeModule)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.e(14).then(n.bind(null,"kVJ9"))];case 2:return e=a.sent(),this._editModeModule=e,this._editMode=new this._editModeModule.ImageEditMode(function(){return r.properties},function(){return r.context},function(){return r.displayMode},function(){return r.render.bind(r)},function(){return r.width},function(){return r._spImageComponent}),this._coachMark=new this._editModeModule.ImageCoachMark(function(){return r.context},function(){return r.domElement},function(){return r._renderedFromPersistedData}),this.render(),[3,4];case 3:return i=a.sent(),c._TraceLogger.logError(t.logSource,i),[3,4];case 4:return this._addCustomEventHandlers(),[3,6];case 5:case 6:return[2]}})})},t.logSource=c._LogSource.create("ImageWebPart"),t}(l.BaseClientSideWebPart);t.default=U}})});