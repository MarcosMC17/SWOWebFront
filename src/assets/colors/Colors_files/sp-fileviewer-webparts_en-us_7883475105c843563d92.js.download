define("b7dd04e1-19ce-4b24-9132-b60a1c2b910d_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-component-base","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@ms/sp-webpart-shared","@microsoft/sp-core-library","@ms/i18n-utilities","@ms/sp-coachmark-utility","@microsoft/sp-webpart-base","react","react-dom","@ms/uifabric-styling-bundle","@ms/sp-component-utilities","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({0:"sp-fileviewer-edit"}[e]||e)+"_"+"none"+"_"+{0:"4035880dfa7e579c87aa"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonpb7dd04e1_19ce_4b24_9132_b60a1c2b910d_0_1_0=window.webpackJsonpb7dd04e1_19ce_4b24_9132_b60a1c2b910d_0_1_0||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-fileviewer-webparts_en-us_7883475105c843563d92\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="qArQ")}({"0pyH":function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s});var a=n("y88i"),i=n("hiL/");function r(){return window.location.protocol+"//"+window.location.hostname}function o(e){if(e){var t=e.getPathSegments();t.splice(t.length-1,1);var n="/"+t.join("/");return window.location.host===e.getHost()?n:a.Uri.concatenate(e.getLeftPart(1),n)}}function s(e,t){var n=e&&e.serverRelativePath,r=e&&e.serverRelativeUrl;if(r||n){if(n){if(new i.SPResourcePath(n).authority)return n;var o=d(e.wopiurl)||d(t);return a.Uri.concatenate(window.location.protocol+"//"+o,n)}return new a.Uri(r).getHost()?r:(o=c(e.wopiurl)||c(e.file)||window.location.host,a.Uri.concatenate(window.location.protocol+"//"+o,e.serverRelativeUrl))}}function c(e){return e&&new a.Uri(e).getHost()}function d(e){return e&&new i.SPResourcePath(e).domain}},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"3qW+":function(e,t,n){var a=n("fglE");e.exports=a._Utilities},"7Awa":function(e,t){e.exports=i},IWfk:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var a=n("hiL/"),i=n("TImI"),r=[["3gp",i.e.Video],["csv",i.e.Excel],["doc",i.e.Word],["docm",i.e.Word],["docx",i.e.Word],["dotx",i.e.Word],["m4v",i.e.Video],["mov",i.e.Video],["mp4",i.e.Video],["pot",i.e.PowerPoint],["potm",i.e.PowerPoint],["potx",i.e.PowerPoint],["pps",i.e.PowerPoint],["ppsx",i.e.PowerPoint],["ppt",i.e.PowerPoint],["pptm",i.e.PowerPoint],["pptx",i.e.PowerPoint],["vsd",i.e.Visio],["vsdm",i.e.Visio],["vsdx",i.e.Visio],["wmv",i.e.Video],["xls",i.e.Excel],["xlsb",i.e.Excel],["xlsm",i.e.Excel],["xlsx",i.e.Excel],["pdf",i.e.PDF]],o=new Map(r);function s(e){if(!o.size)for(var t=0,n=r;t<n.length;t++){var s=n[t];o.set(s[0],s[1])}var c=a.ExtensionHelper.getExtension(new a.SPResourcePath(e));return c&&o.has(c)?o.get(c):i.e.Other}},KL1q:function(e,t){e.exports=r},Pk8u:function(e,t){e.exports=o},TImI:function(e,t,n){"use strict";var a;n.d(t,"e",function(){return a}),function(e){e[e.Excel=0]="Excel",e[e.Other=1]="Other",e[e.PowerPoint=2]="PowerPoint",e[e.Video=3]="Video",e[e.Visio=4]="Visio",e[e.Word=5]="Word",e[e.PDF=6]="PDF"}(a||(a={}))},U4ag:function(e,t){e.exports=s},UWqr:function(e,t){e.exports=c},Ycni:function(e,t){e.exports=d},bXd7:function(e,t){e.exports=l},br4S:function(e,t){e.exports=u},cDcd:function(e,t){e.exports=f},faye:function(e,t){e.exports=p},fglE:function(e,t){e.exports=m},"hiL/":function(e,t){e.exports=_},jOlS:function(e,t){e.exports=h},mGD9:function(e){e.exports=JSON.parse('{"F":"Start page","h":"Entire workbook","r":"Chart","i":"Chart name","R":"Table","H":"Table name","k":"Range","L":"Starting cell","A":"Ending cell","M":"Sheet name","T":"Show grid lines","U":"Show row and column headers","P":"Allow sorting and filtering columns","l":".","_":"Press Enter key to enter the document web part.","C":"Couldn\\u0027t display the preview for this document.","y":"Can\\u0027t find your default document library. Use the Site tab to choose the document library and file you want to upload.","t":"Add file","a":"Change file","p":"Embed Office documents from your libraries, and people can read them without leaving your page.","m":"Document","D":"Embed Office documents or other files from your libraries, and people can view them without leaving your page.","I":"File viewer","B":"We embedded the document. Don\\u0027t forget to add a description.","n":"Add a description","d":"Modified on {0}","z":"Embedded document","e":"Document web part, showing {0}.","S":"This is not a supported document file. Please select a different document with one of the following extensions: {0}.","v":", ","j":"We\\u0027re still uploading your document. It may get lost if you leave this page.","V":"Uploading…","b":"You can display a specific chart, table, range or the entire workbook. To display a chart or a table, you\\u0027ll need to enter its name.","G":"Select the page you want people to see first.","g":"How do I find the name of a chart or table?","O":"Select the slide you want people to see first.","w":"Start slide","N":"Display a video from OneDrive and SharePoint for your team.","f":"This web part is connected to {0}. Select an item in {0} to view it here.","u":"Connect to a document library so that users can choose a file from the library to view. Select a document library to get data from.","x":"Add a file to view on your page. You can select from a variety of file types including Excel, Word, PowerPoint, Visio, PDFs, 3D models, and more. {0}","E":"You can also connect to a source to dynamically view files by selecting the ellipses (…) and Connect to source.","o":"Just drag a file onto the page, and we\\u0027ll do the rest.","s":"Got it!","c":"Adding files just got easier!"}')},nYTp:function(e,t,n){var a=n("KL1q");e.exports=a.workaround_Icon},qArQ:function(e,t,n){"use strict";n.r(t);var a,i=n("17wl"),r=n("2q6Q"),o=n("ut3N"),s=n("UWqr"),c=n("vlQI"),d=n("br4S"),l=n("y88i"),u=n("cDcd"),f=n("faye"),p=n("Pk8u"),m=n("bXd7"),_=n("hiL/"),h=n("U4ag"),b=n("KL1q"),g=n("3qW+");!function(e){e[e.Documents=1]="Documents",e[e.Images=2]="Images",e[e.Pages=3]="Pages",e[e.Videos=4]="Videos",e[e.Audios=5]="Audios",e[e.Models=6]="Models",e[e.BasicDocuments=7]="BasicDocuments",e[e.Transcripts=8]="Transcripts",e[e.VideosWithWebm=9]="VideosWithWebm"}(a||(a={}));var v,y=n("TImI"),S=n("0pyH"),D=n("IWfk");function I(e){var t;return e&&(t=parseInt(String(e),10)),(t=isNaN(t)||t<1?1:t)>1&&r._EngagementLogger.logEvent("DocumentEmbedWP.NonDefaultPage.Click"),t}function x(e){var t=_.spConstants.isPreviewableExtensionsEnabled();if(!e)return t;var n=Object(D.e)(e);if(n===y.e.Video||n===y.e.Other||n===y.e.PDF)return!0;if(!t)return!1;var a=new _.SPResourcePath(e);return n!==y.e.Word&&n!==y.e.PowerPoint&&n!==y.e.Excel&&n!==y.e.Visio&&(!a.authority||window.location.host===a.domain)}function C(e,t,n){return Object(i.__awaiter)(this,void 0,void 0,function(){var a,r,o,s,c,d,u,f,p,m,h,b,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return(a=Object(S.e)(e,t.web.absoluteUrl))?(r=new _.SPResourcePath(a),o="gltf"===_.ExtensionHelper.getExtension(r),s=e.startPage,c=void 0===s?1:s,d=e.uniqueId,u=e.webAbsoluteUrl||t.web.absoluteUrl,o?(p=new l.Uri(a),(f=new l.Uri(l.Uri.concatenate(u,_.spConstants.oneDrivePath))).setQueryParameter("p","16"),m=Object(S.n)(p),f.setQueryParameter("parent",m),f.setQueryParameter("listurl",m),h=p.getPath(),f.setQueryParameter("id",h)):(f=new l.Uri(l.Uri.concatenate(u,_.spConstants.embedPath)),d?f.setQueryParameter("UniqueId",d):(h=r.path,f.setQueryParameter("id",encodeURIComponent(h)))),f.setQueryParameter("client_id","FileViewerWebPart"),b=JSON.stringify({af:!1,id:d,o:Object(S.t)(),p:c,z:"width"}),f.setQueryParameter("embed",b),new URL(u).origin!==window.location.origin&&n?[4,n()]:[3,2]):[2,void 0];case 1:(g=i.sent())&&f.setQueryParameter("access_token",g),i.label=2;case 2:return[2,f.toString()]}})})}!function(e){e[e.normal=0]="normal",e[e.compact=1]="compact"}(v||(v={}));var O,w,E,A,L,k,M=Object(b.classNamesFunction)(),P=function(e){function t(t){var n=e.call(this,t)||this;return n._rootElement=u.createRef(),n._onClick=function(e){n._onAction(e)},n._onKeyDown=function(e){e.which!==b.KeyCodes.enter&&e.which!==b.KeyCodes.space||n._onAction(e)},n._onAction=function(e){var t=n.props,a=t.onClick,i=t.onClickHref,r=t.onClickTarget;a?a(e):!a&&i&&(r?window.open(i,r,"noreferrer noopener nofollow"):window.location.href=i,e.preventDefault(),e.stopPropagation())},Object(b.initializeComponentRef)(n),Object(b.warnDeprecations)("DocumentCard",t,{accentColor:void 0}),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t=this.props,n=t.onClick,a=t.onClickHref,r=t.children,o=t.type,s=t.accentColor,c=t.styles,d=t.theme,l=t.className,f=Object(b.getNativeProps)(this.props,b.divProperties,["className","onClick","type","role"]),p=!(!n&&!a);this._classNames=M(c,{theme:d,className:l,actionable:p,compact:o===v.compact}),o===v.compact&&s&&(e={borderBottomColor:s});var m=this.props.role||(p?n?"button":"link":void 0),_=p?0:void 0;return u.createElement("div",Object(i.__assign)({ref:this._rootElement,tabIndex:_,"data-is-focusable":p,role:m,className:this._classNames.root,onKeyDown:p?this._onKeyDown:void 0,onClick:p?this._onClick:void 0,style:e},f),r)},t.prototype.focus=function(){this._rootElement.current&&this._rootElement.current.focus()},t.defaultProps={type:v.normal},t}(u.Component),T={root:"ms-DocumentCardPreview",icon:"ms-DocumentCardPreview-icon",iconContainer:"ms-DocumentCardPreview-iconContainer"},U={root:"ms-DocumentCardActivity",multiplePeople:"ms-DocumentCardActivity--multiplePeople",details:"ms-DocumentCardActivity-details",name:"ms-DocumentCardActivity-name",activity:"ms-DocumentCardActivity-activity",avatars:"ms-DocumentCardActivity-avatars",avatar:"ms-DocumentCardActivity-avatar"},F={root:"ms-DocumentCardTitle"},H={root:"ms-DocumentCardLocation"},R={root:"ms-DocumentCard",rootActionable:"ms-DocumentCard--actionable",rootCompact:"ms-DocumentCard--compact"},N=Object(b.styled)(P,function(e){var t,n,a=e.className,i=e.theme,r=e.actionable,o=e.compact,s=i.palette,c=i.fonts,d=i.effects,l=Object(b.getGlobalClassNames)(R,i);return{root:[l.root,{WebkitFontSmoothing:"antialiased",backgroundColor:s.white,border:"1px solid "+s.neutralLight,maxWidth:"320px",minWidth:"206px",userSelect:"none",position:"relative",selectors:(t={":focus":{outline:"0px solid"}},t["."+b.IsFocusVisibleClassName+" &:focus"]=Object(b.getInputFocusStyle)(s.neutralSecondary,d.roundedCorner2),t["."+H.root+" + ."+F.root]={paddingTop:"4px"},t)},r&&[l.rootActionable,{selectors:{":hover":{cursor:"pointer",borderColor:s.neutralTertiaryAlt},":hover:after":{content:'" "',position:"absolute",top:0,right:0,bottom:0,left:0,border:"1px solid "+s.neutralTertiaryAlt,pointerEvents:"none"}}}],o&&[l.rootCompact,{display:"flex",maxWidth:"480px",height:"108px",selectors:(n={},n["."+T.root]={borderRight:"1px solid "+s.neutralLight,borderBottom:0,maxHeight:"106px",maxWidth:"144px"},n["."+T.icon]={maxHeight:"32px",maxWidth:"32px"},n["."+U.root]={paddingBottom:"12px"},n["."+F.root]={paddingBottom:"12px 16px 8px 16px",fontSize:c.mediumPlus.fontSize,lineHeight:"16px"},n)}],a]}},void 0,{scope:"DocumentCard"}),B=n("nYTp");!function(e){e[e.tiny=0]="tiny",e[e.extraExtraSmall=1]="extraExtraSmall",e[e.extraSmall=2]="extraSmall",e[e.small=3]="small",e[e.regular=4]="regular",e[e.large=5]="large",e[e.extraLarge=6]="extraLarge",e[e.size8=17]="size8",e[e.size10=9]="size10",e[e.size16=8]="size16",e[e.size24=10]="size24",e[e.size28=7]="size28",e[e.size32=11]="size32",e[e.size40=12]="size40",e[e.size48=13]="size48",e[e.size56=16]="size56",e[e.size72=14]="size72",e[e.size100=15]="size100",e[e.size120=18]="size120"}(O||(O={})),function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy"}(w||(w={})),function(e){e[e.lightBlue=0]="lightBlue",e[e.blue=1]="blue",e[e.darkBlue=2]="darkBlue",e[e.teal=3]="teal",e[e.lightGreen=4]="lightGreen",e[e.green=5]="green",e[e.darkGreen=6]="darkGreen",e[e.lightPink=7]="lightPink",e[e.pink=8]="pink",e[e.magenta=9]="magenta",e[e.purple=10]="purple",e[e.black=11]="black",e[e.orange=12]="orange",e[e.red=13]="red",e[e.darkRed=14]="darkRed",e[e.transparent=15]="transparent",e[e.violet=16]="violet",e[e.lightRed=17]="lightRed",e[e.gold=18]="gold",e[e.burgundy=19]="burgundy",e[e.warmGray=20]="warmGray",e[e.coolGray=21]="coolGray",e[e.gray=22]="gray",e[e.cyan=23]="cyan",e[e.rust=24]="rust"}(E||(E={})),function(e){e.size8="20px",e.size10="20px",e.size16="16px",e.size24="24px",e.size28="28px",e.size32="32px",e.size40="40px",e.size48="48px",e.size56="56px",e.size72="72px",e.size100="100px",e.size120="120px"}(L||(L={})),function(e){e.size6="6px",e.size8="8px",e.size12="12px",e.size16="16px",e.size20="20px",e.size28="28px",e.size32="32px",e.border="2px"}(k||(k={}));var j=function(e){return{isSize8:e===O.size8,isSize10:e===O.size10||e===O.tiny,isSize16:e===O.size16,isSize24:e===O.size24||e===O.extraExtraSmall,isSize28:e===O.size28||e===O.extraSmall,isSize32:e===O.size32,isSize40:e===O.size40||e===O.small,isSize48:e===O.size48||e===O.regular,isSize56:e===O.size56,isSize72:e===O.size72||e===O.large,isSize100:e===O.size100||e===O.extraLarge,isSize120:e===O.size120}},V=((A={})[O.tiny]=10,A[O.extraExtraSmall]=24,A[O.extraSmall]=28,A[O.small]=40,A[O.regular]=48,A[O.large]=72,A[O.extraLarge]=100,A[O.size8]=8,A[O.size10]=10,A[O.size16]=16,A[O.size24]=24,A[O.size28]=28,A[O.size32]=32,A[O.size40]=40,A[O.size48]=48,A[O.size56]=56,A[O.size72]=72,A[O.size100]=100,A[O.size120]=120,A),z=Object(b.classNamesFunction)({cacheSize:100}),G=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderIcon=function(e,t){return u.createElement(B.Icon,{className:e,iconName:K(n.props.presence,n.props.isOutOfOffice),style:t})},n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.coinSize,n=e.isOutOfOffice,a=e.styles,i=e.presence,r=e.theme,o=e.presenceTitle,s=e.presenceColors,c=j(this.props.size),d=!(c.isSize8||c.isSize10||c.isSize16||c.isSize24||c.isSize28||c.isSize32)&&(!t||t>32),l=t?t/3<40?t/3+"px":"40px":"",f=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:l}:void 0,p=t?{width:l,height:l}:void 0,m=z(a,{theme:r,presence:i,size:this.props.size,isOutOfOffice:n,presenceColors:s});return i===w.none?null:u.createElement("div",{role:"presentation",className:m.presence,style:p,title:o},d&&this._onRenderIcon(m.presenceIcon,f))},t}(u.Component);function K(e,t){if(e){switch(w[e]){case"online":return"SkypeCheck";case"away":return t?"SkypeArrow":"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?"SkypeArrow":""}return""}}var W={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};function q(e){return{color:e,borderColor:e}}function Q(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function Y(e){return{height:e,width:e}}function J(e){return{backgroundColor:e}}var X=Object(b.styled)(G,function(e){var t,n,a,r,o,s,c=e.theme,d=e.presenceColors,l=c.semanticColors,u=c.fonts,f=Object(b.getGlobalClassNames)(W,c),p=j(e.size),m=function(e){return{isAvailable:e===w.online,isAway:e===w.away,isBlocked:e===w.blocked,isBusy:e===w.busy,isDoNotDisturb:e===w.dnd,isOffline:e===w.offline}}(e.presence),_=d&&d.available||"#6BB700",h=d&&d.away||"#FFAA44",g=d&&d.busy||"#C43148",v=d&&d.dnd||"#C50F1F",y=d&&d.offline||"#8A8886",S=d&&d.oof||"#B4009E",D=d&&d.background||l.bodyBackground,I=m.isOffline||e.isOutOfOffice&&(m.isAvailable||m.isBusy||m.isAway||m.isDoNotDisturb),x=p.isSize72||p.isSize100?"2px":"1px";return{presence:[f.presence,Object(i.__assign)(Object(i.__assign)({position:"absolute",height:k.size12,width:k.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+D,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box"},Object(b.getHighContrastNoAdjustStyle)()),{selectors:(t={},t[b.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)}),(p.isSize8||p.isSize10)&&{right:"auto",top:"7px",left:0,border:0,selectors:(n={},n[b.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},n)},(p.isSize8||p.isSize10||p.isSize24||p.isSize28||p.isSize32)&&Y(k.size8),(p.isSize40||p.isSize48)&&Y(k.size12),p.isSize16&&{height:k.size6,width:k.size6,borderWidth:"1.5px"},p.isSize56&&Y(k.size16),p.isSize72&&Y(k.size20),p.isSize100&&Y(k.size28),p.isSize120&&Y(k.size32),m.isAvailable&&{backgroundColor:_,selectors:(a={},a[b.HighContrastSelector]=J("Highlight"),a)},m.isAway&&J(h),m.isBlocked&&[{selectors:(r={":after":p.isSize40||p.isSize48||p.isSize72||p.isSize100?{content:'""',width:"100%",height:x,backgroundColor:g,transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},r[b.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},r)}],m.isBusy&&J(g),m.isDoNotDisturb&&J(v),m.isOffline&&J(y),(I||m.isBlocked)&&[{backgroundColor:D,selectors:(o={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:x+" solid "+g,borderRadius:"50%",boxSizing:"border-box"}},o[b.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},o)}],I&&m.isAvailable&&Q(x,_),I&&m.isBusy&&Q(x,g),I&&m.isAway&&Q(x,S),I&&m.isDoNotDisturb&&Q(x,v),I&&m.isOffline&&Q(x,y),I&&m.isOffline&&e.isOutOfOffice&&Q(x,S)],presenceIcon:[f.presenceIcon,{color:D,fontSize:"6px",lineHeight:k.size12,verticalAlign:"top",selectors:(s={},s[b.HighContrastSelector]={color:"Window"},s)},p.isSize56&&{fontSize:"8px",lineHeight:k.size16},p.isSize72&&{fontSize:u.small.fontSize,lineHeight:k.size20},p.isSize100&&{fontSize:u.medium.fontSize,lineHeight:k.size28},p.isSize120&&{fontSize:u.medium.fontSize,lineHeight:k.size32},m.isAway&&{position:"relative",left:I?void 0:"1px"},I&&m.isAvailable&&q(_),I&&m.isBusy&&q(g),I&&m.isAway&&q(S),I&&m.isDoNotDisturb&&q(v),I&&m.isOffline&&q(y),I&&m.isOffline&&e.isOutOfOffice&&q(S)]}},void 0,{scope:"PersonaPresence"}),Z=[E.lightBlue,E.blue,E.darkBlue,E.teal,E.green,E.darkGreen,E.lightPink,E.pink,E.magenta,E.purple,E.orange,E.lightRed,E.darkRed,E.violet,E.gold,E.burgundy,E.warmGray,E.cyan,E.rust,E.coolGray],$=Z.length;function ee(e){var t=e.primaryText,n=e.text,a=e.initialsColor;return"string"==typeof a?a:function(e){switch(e){case E.lightBlue:return"#4F6BED";case E.blue:return"#0078D4";case E.darkBlue:return"#004E8C";case E.teal:return"#038387";case E.lightGreen:case E.green:return"#498205";case E.darkGreen:return"#0B6A0B";case E.lightPink:return"#C239B3";case E.pink:return"#E3008C";case E.magenta:return"#881798";case E.purple:return"#5C2E91";case E.orange:return"#CA5010";case E.red:return"#EE1111";case E.lightRed:return"#D13438";case E.darkRed:return"#A4262C";case E.transparent:return"transparent";case E.violet:return"#8764B8";case E.gold:return"#986F0B";case E.burgundy:return"#750B1C";case E.warmGray:return"#7A7574";case E.cyan:return"#005B70";case E.rust:return"#8E562E";case E.coolGray:return"#69797E";case E.black:return"#1D1D1D";case E.gray:return"#393939"}}(a=void 0!==a?a:function(e){var t=E.blue;if(!e)return t;for(var n=0,a=e.length-1;a>=0;a--){var i=e.charCodeAt(a),r=a%8;n^=(i<<r)+(i>>8-r)}return Z[n%$]}(n||t))}var te=Object(b.classNamesFunction)({cacheSize:100}),ne=Object(b.memoizeFunction)(function(e,t,n,a,i,r){return Object(b.mergeStyles)(e,!r&&{backgroundColor:ee({text:a,initialsColor:t,primaryText:i}),color:n})}),ae=function(e){function t(t){var n=e.call(this,t)||this;return n._onRenderCoin=function(e){var t=n.props,a=t.coinSize,i=t.styles,r=t.imageUrl,o=t.imageAlt,s=t.imageShouldFadeIn,c=t.imageShouldStartVisible,d=t.theme,l=t.showUnknownPersonaCoin;if(!r)return null;var f=n.props.size,p=te(i,{theme:d,size:f,showUnknownPersonaCoin:l}),m=a||V[f];return u.createElement(b.Image,{className:p.image,imageFit:b.ImageFit.cover,src:r,width:m,height:m,alt:o,shouldFadeIn:s,shouldStartVisible:c,onLoadingStateChange:n._onPhotoLoadingStateChange})},n._onRenderInitials=function(e){var t=e.imageInitials,a=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return u.createElement(B.Icon,{iconName:"Help"});var i=Object(b.getRTL)(n.props.theme);return""!==(t=t||Object(b.getInitials)(n._getText(),i,a))?u.createElement("span",null,t):u.createElement(B.Icon,{iconName:"Contact"})},n._onPhotoLoadingStateChange=function(e){n.setState({isImageLoaded:e===b.ImageLoadState.loaded,isImageError:e===b.ImageLoadState.error}),n.props.onPhotoLoadingStateChange&&n.props.onPhotoLoadingStateChange(e)},n.state={isImageLoaded:!1,isImageError:!1},n}return Object(i.__extends)(t,e),t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})},t.prototype.render=function(){var e=this.props,t=e.className,n=e.coinProps,a=e.showUnknownPersonaCoin,r=e.coinSize,o=e.styles,s=e.imageUrl,c=e.initialsColor,d=e.initialsTextColor,l=e.isOutOfOffice,f=e.onRenderCoin,p=void 0===f?this._onRenderCoin:f,m=e.onRenderPersonaCoin,_=void 0===m?p:m,h=e.onRenderInitials,g=void 0===h?this._onRenderInitials:h,v=e.presence,y=e.presenceTitle,S=e.presenceColors,D=e.primaryText,I=e.showInitialsUntilImageLoads,x=e.text,C=e.theme,w=this.props.size,E=Object(b.getNativeProps)(this.props,b.divProperties),A=Object(b.getNativeProps)(n||{},b.divProperties),L=r?{width:r,height:r}:void 0,k=a,M={coinSize:r,isOutOfOffice:l,presence:v,presenceTitle:y,presenceColors:S,size:w,theme:C},P=te(o,{theme:C,className:n&&n.className?n.className:t,size:w,coinSize:r,showUnknownPersonaCoin:a}),T=Boolean(!this.state.isImageLoaded&&(I&&s||!s||this.state.isImageError||k));return u.createElement("div",Object(i.__assign)({role:"presentation"},E,{className:P.coin}),w!==O.size8&&w!==O.size10&&w!==O.tiny?u.createElement("div",Object(i.__assign)({role:"presentation"},A,{className:P.imageArea,style:L}),T&&u.createElement("div",{className:ne(P.initials,c,d,x,D,a),style:L,"aria-hidden":"true"},g(this.props,this._onRenderInitials)),!k&&_(this.props,this._onRenderCoin),u.createElement(X,Object(i.__assign)({},M))):this.props.presence?u.createElement(X,Object(i.__assign)({},M)):u.createElement(B.Icon,{iconName:"Contact",className:P.size10WithoutPresenceIcon}),this.props.children)},t.prototype._getText=function(){return this.props.text||this.props.primaryText||""},t.defaultProps={size:O.size48,presence:w.none,imageAlt:""},t}(u.Component),ie={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size8:"ms-Persona--size8",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size56:"ms-Persona--size56",size72:"ms-Persona--size72",size100:"ms-Persona--size100",size120:"ms-Persona--size120"},re=Object(b.styled)(ae,function(e){var t,n=e.className,a=e.theme,r=e.coinSize,o=a.palette,s=a.fonts,c=j(e.size),d=Object(b.getGlobalClassNames)(ie,a),l=r||e.size&&V[e.size]||48;return{coin:[d.coin,s.medium,c.isSize8&&d.size8,c.isSize10&&d.size10,c.isSize16&&d.size16,c.isSize24&&d.size24,c.isSize28&&d.size28,c.isSize32&&d.size32,c.isSize40&&d.size40,c.isSize48&&d.size48,c.isSize56&&d.size56,c.isSize72&&d.size72,c.isSize100&&d.size100,c.isSize120&&d.size120,n],size10WithoutPresenceIcon:{fontSize:s.xSmall.fontSize,position:"absolute",top:"5px",right:"auto",left:0},imageArea:[d.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:l,width:l},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[d.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},l<=10&&{overflow:"visible",background:"transparent",height:0,width:0},l>10&&{height:l,width:l}],initials:[d.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":o.white,fontSize:s.large.fontSize,fontWeight:b.FontWeights.semibold,lineHeight:48===l?46:l,height:l,selectors:(t={},t[b.HighContrastSelector]=Object(i.__assign)(Object(i.__assign)({border:"1px solid WindowText"},Object(b.getHighContrastNoAdjustStyle)()),{color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"}),t.i={fontWeight:b.FontWeights.semibold},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},l<32&&{fontSize:s.xSmall.fontSize},l>=32&&l<40&&{fontSize:s.medium.fontSize},l>=40&&l<56&&{fontSize:s.mediumPlus.fontSize},l>=56&&l<72&&{fontSize:s.xLarge.fontSize},l>=72&&l<100&&{fontSize:s.xxLarge.fontSize},l>=100&&{fontSize:s.superLarge.fontSize}]}},void 0,{scope:"PersonaCoin"}),oe=Object(b.classNamesFunction)(),se=function(e){function t(t){var n=e.call(this,t)||this;return Object(b.initializeComponentRef)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.activity,n=e.people,a=e.styles,i=e.theme,r=e.className;return this._classNames=oe(a,{theme:i,className:r,multiplePeople:n.length>1}),n&&0!==n.length?u.createElement("div",{className:this._classNames.root},this._renderAvatars(n),u.createElement("div",{className:this._classNames.details},u.createElement("span",{className:this._classNames.name},this._getNameString(n)),u.createElement("span",{className:this._classNames.activity},t))):null},t.prototype._renderAvatars=function(e){return u.createElement("div",{className:this._classNames.avatars},e.length>1?this._renderAvatar(e[1]):null,this._renderAvatar(e[0]))},t.prototype._renderAvatar=function(e){return u.createElement("div",{className:this._classNames.avatar},u.createElement(re,{imageInitials:e.initials,text:e.name,imageUrl:e.profileImageSrc,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,role:"presentation",size:b.PersonaSize.size32}))},t.prototype._getNameString=function(e){var t=e[0].name;return e.length>=2&&(t+=" +"+(e.length-1)),t},t}(u.Component),ce=Object(b.styled)(se,function(e){var t=e.theme,n=e.className,a=e.multiplePeople,i=t.palette,r=t.fonts,o=Object(b.getGlobalClassNames)(U,t);return{root:[o.root,a&&o.multiplePeople,{padding:"8px 16px",position:"relative"},n],avatars:[o.avatars,{marginLeft:"-2px",height:"32px"}],avatar:[o.avatar,{display:"inline-block",verticalAlign:"top",position:"relative",textAlign:"center",width:32,height:32,selectors:{"&:after":{content:'" "',position:"absolute",left:"-1px",top:"-1px",right:"-1px",bottom:"-1px",border:"2px solid "+i.white,borderRadius:"50%"},":nth-of-type(2)":a&&{marginLeft:"-16px"}}}],details:[o.details,{left:a?"72px":"56px",height:32,position:"absolute",top:8,width:"calc(100% - 72px)"}],name:[o.name,{display:"block",fontSize:r.small.fontSize,lineHeight:"15px",height:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:i.neutralPrimary,fontWeight:b.FontWeights.semibold}],activity:[o.activity,{display:"block",fontSize:r.small.fontSize,lineHeight:"15px",height:"15px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:i.neutralSecondary}]}},void 0,{scope:"DocumentCardActivity"}),de=Object(b.classNamesFunction)(),le=function(e){function t(t){var n=e.call(this,t)||this;return n._renderPreviewList=function(e){var t=n.props.getOverflowDocumentCountText,a=e.length-3,r=a?t?t(a):"+"+a:null,o=e.slice(0,3).map(function(e,t){return u.createElement("li",{key:t},u.createElement(b.Image,{className:n._classNames.fileListIcon,src:e.iconSrc,role:"presentation",alt:"",width:"16px",height:"16px"}),u.createElement(b.Link,Object(i.__assign)({className:n._classNames.fileListLink},(e.linkProps,{href:e.linkProps&&e.linkProps.href||e.url})),e.name))});return u.createElement("div",null,u.createElement("ul",{className:n._classNames.fileList},o),r&&u.createElement("span",{className:n._classNames.fileListOverflowText},r))},Object(b.initializeComponentRef)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.previewImages,i=n.styles,r=n.theme,o=n.className,s=a.length>1;return this._classNames=de(i,{theme:r,className:o,isFileList:s}),a.length>1?t=this._renderPreviewList(a):1===a.length&&(t=this._renderPreviewImage(a[0]),a[0].accentColor&&(e={borderBottomColor:a[0].accentColor})),u.createElement("div",{className:this._classNames.root,style:e},t)},t.prototype._renderPreviewImage=function(e){var t=e.width,n=e.height,a=e.imageFit,r=e.previewIconProps,o=e.previewIconContainerClass;if(r)return u.createElement("div",{className:Object(b.css)(this._classNames.previewIcon,o),style:{width:t,height:n}},u.createElement(B.Icon,Object(i.__assign)({},r)));var s,c=u.createElement(b.Image,{width:t,height:n,imageFit:a,src:e.previewImageSrc,role:"presentation",alt:""});return e.iconSrc&&(s=u.createElement(b.Image,{className:this._classNames.icon,src:e.iconSrc,role:"presentation",alt:""})),u.createElement("div",null,c,s)},t}(u.Component),ue=Object(b.styled)(le,function(e){var t,n,a=e.theme,i=e.className,r=e.isFileList,o=a.palette,s=a.fonts,c=Object(b.getGlobalClassNames)(T,a);return{root:[c.root,s.small,{backgroundColor:r?o.white:o.neutralLighterAlt,borderBottom:"1px solid "+o.neutralLight,overflow:"hidden",position:"relative"},i],previewIcon:[c.iconContainer,{display:"flex",alignItems:"center",justifyContent:"center",height:"100%"}],icon:[c.icon,{left:"10px",bottom:"10px",position:"absolute"}],fileList:{padding:"16px 16px 0 16px",listStyleType:"none",margin:0,selectors:{li:{height:"16px",lineHeight:"16px",marginBottom:"8px",overflow:"hidden"}}},fileListIcon:{display:"inline-block",marginRight:"8px"},fileListLink:[Object(b.getFocusStyle)(a,{highContrastStyle:{border:"1px solid WindowText",outline:"none"}}),{boxSizing:"border-box",color:o.neutralDark,overflow:"hidden",display:"inline-block",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"calc(100% - 24px)",selectors:(t={":hover":{color:o.themePrimary}},t["."+b.IsFocusVisibleClassName+" &:focus"]={selectors:(n={},n[b.HighContrastSelector]={outline:"none"},n)},t)}],fileListOverflowText:{padding:"0px 16px 8px 16px",display:"block"}}},void 0,{scope:"DocumentCardPreview"}),fe=Object(b.classNamesFunction)(),pe=function(e){function t(t){var n=e.call(this,t)||this;return n._titleElement=u.createRef(),n._measureTitleElement=u.createRef(),n._truncateTitle=function(){n.state.needMeasurement&&n._async.requestAnimationFrame(n._truncateWhenInAnimation)},n._truncateWhenInAnimation=function(){var e=n.props.title,t=n._measureTitleElement.current;if(t){var a=getComputedStyle(t);if(a.width&&a.lineHeight&&a.height){var i=t.clientWidth,r=t.scrollWidth,o=Math.floor((parseInt(a.height,10)+5)/parseInt(a.lineHeight,10)),s=r/(parseInt(a.width,10)*o);if(s>1){var c=e.length/s-3;return n.setState({truncatedTitleFirstPiece:e.slice(0,c/2),truncatedTitleSecondPiece:e.slice(e.length-c/2),clientWidth:i,needMeasurement:!1})}}}return n.setState({needMeasurement:!1})},n._shrinkTitle=function(){var e=n.state,t=e.truncatedTitleFirstPiece,a=e.truncatedTitleSecondPiece;if(t&&a){var i=n._titleElement.current;if(!i)return;(i.scrollHeight>i.clientHeight+5||i.scrollWidth>i.clientWidth)&&n.setState({truncatedTitleFirstPiece:t.slice(0,t.length-1),truncatedTitleSecondPiece:a.slice(1)})}},Object(g.initializeComponentRef)(n),n._async=new b.Async(n),n._events=new b.EventGroup(n),n.state={truncatedTitleFirstPiece:"",truncatedTitleSecondPiece:"",previousTitle:t.title,needMeasurement:!!t.shouldTruncate},n}return Object(i.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.props.title!==this.state.previousTitle&&this.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0,clientWidth:void 0,previousTitle:this.props.title,needMeasurement:!!this.props.shouldTruncate}),this._events.off(window,"resize",this._updateTruncation),this.props.shouldTruncate&&(this._truncateTitle(),requestAnimationFrame(this._shrinkTitle),this._events.on(window,"resize",this._updateTruncation))},t.prototype.componentDidMount=function(){this.props.shouldTruncate&&(this._truncateTitle(),this._events.on(window,"resize",this._updateTruncation))},t.prototype.componentWillUnmount=function(){this._events.dispose(),this._async.dispose()},t.prototype.render=function(){var e=this.props,t=e.title,n=e.shouldTruncate,a=e.showAsSecondaryTitle,i=e.styles,r=e.theme,o=e.className,s=this.state,c=s.truncatedTitleFirstPiece,d=s.truncatedTitleSecondPiece,l=s.needMeasurement;return this._classNames=fe(i,{theme:r,className:o,showAsSecondaryTitle:a}),l?u.createElement("div",{className:this._classNames.root,ref:this._measureTitleElement,title:t,style:{whiteSpace:"nowrap"}},t):n&&c&&d?u.createElement("div",{className:this._classNames.root,ref:this._titleElement,title:t},c,"…",d):u.createElement("div",{className:this._classNames.root,ref:this._titleElement,title:t},t)},t.prototype._updateTruncation=function(){var e=this;this._async.requestAnimationFrame(function(){if(e._titleElement.current){var t=e._titleElement.current.clientWidth;clearTimeout(e._titleTruncationTimer),e.state.clientWidth!==t&&(e._titleTruncationTimer=e._async.setTimeout(function(){return e.setState({truncatedTitleFirstPiece:void 0,truncatedTitleSecondPiece:void 0,needMeasurement:!0})},250))}})},t}(u.Component),me=Object(b.styled)(pe,function(e){var t=e.theme,n=e.className,a=e.showAsSecondaryTitle,i=t.palette,r=t.fonts;return{root:[Object(b.getGlobalClassNames)(F,t).root,a?r.medium:r.large,{padding:"8px 16px",display:"block",overflow:"hidden",wordWrap:"break-word",height:a?"45px":"38px",lineHeight:a?"18px":"21px",color:a?i.neutralSecondary:i.neutralPrimary},n]}},void 0,{scope:"DocumentCardTitle"}),_e=Object(b.classNamesFunction)(),he=function(e){function t(t){var n=e.call(this,t)||this;return Object(b.initializeComponentRef)(n),n}return Object(i.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.location,n=e.locationHref,a=e.ariaLabel,i=e.onClick,r=e.styles,o=e.theme,s=e.className;return this._classNames=_e(r,{theme:o,className:s}),u.createElement("a",{className:this._classNames.root,href:n,onClick:i,"aria-label":a},t)},t}(u.Component),be=Object(b.styled)(he,function(e){var t=e.theme,n=e.className,a=t.palette,i=t.fonts;return{root:[Object(b.getGlobalClassNames)(H,t).root,i.small,{color:a.themePrimary,display:"block",fontWeight:b.FontWeights.semibold,overflow:"hidden",padding:"8px 16px",position:"relative",textDecoration:"none",textOverflow:"ellipsis",whiteSpace:"nowrap",selectors:{":hover":{color:a.themePrimary,cursor:"pointer"}}},n]}},void 0,{scope:"DocumentCardLocation"}),ge=n("Ycni");function ve(){return s._SPKillSwitch.isActivated("48e2c9fc-6d92-47cf-824f-12e5a67d4628")}function ye(){return s._SPKillSwitch.isActivated("8145dec0-27ae-4d1c-a82a-103bbd69f810")}var Se=n("mGD9"),De=function(e){function t(t){var n=e.call(this,t)||this;return n.state={previewUrl:void 0},n}return Object(i.__extends)(t,e),t.prototype.UNSAFE_componentWillMount=function(){_.FileTypeIconsLoader.loadIconsModule().catch(function(e){o._TraceLogger.logError(t._logSource,e,"LoadFileTypeIconsChunk")})},t.prototype.componentDidMount=function(){this._setPreviewUrlWithAuth()},t.prototype.componentDidUpdate=function(e){Object(p.isEqual)(this._constructThumbnailRequest(e),this._constructThumbnailRequest())||this._setPreviewUrlWithAuth()},t.prototype.componentWillUnmount=function(){this._revokePreviewUrl()},t.prototype.render=function(){var e,t=this.props,n=t.absoluteUrl,a=t.authorName,r=t.photoUrl,o=t.resolution,s=t.title,c=(null==n?void 0:n.split(".").pop())||"",d=_.Icons.getIconColorFromExtension(c),l=this._ShouldJumpToNative(),f=_.Icons.getIconUrl(c,this.state.previewUrl?32:64),p={borderBottomColor:d};e=o<=320?Math.min(Math.floor(140.625),250):Math.min(Math.floor(o*(9/16)),250);var m={previewImages:[{previewImageSrc:this.state.previewUrl,iconSrc:f,height:e,accentColor:d,imageFit:b.ImageFit.cover}]};return u.createElement("div",{"data-is-focusable":!0,"data-automation-id":"DocumentCard"},u.createElement(b.FocusZone,{direction:b.FocusZoneDirection.vertical},u.createElement(N,{onClick:l?void 0:this._onClick,onClickHref:l?this._wacPath:void 0},this.state.previewUrl?u.createElement(ue,Object(i.__assign)({},m)):u.createElement("div",{className:Object(b.css)("ms-DocumentCardPreview","iconWithoutPreview"),style:p},u.createElement("img",{src:f,alt:"",role:"presentation"})),u.createElement("div",null,u.createElement(be,{location:this._parent,locationHref:this._parentHref})),s?u.createElement("div",null,u.createElement(me,{title:s,shouldTruncate:!!s})):void 0,this._activity&&a&&r?u.createElement("div",null,u.createElement(ce,{activity:this._activity,people:[{name:a,profileImageSrc:r}]})):void 0)))},t.prototype._ShouldJumpToNative=function(){var e=this.props,t=e.absoluteUrl,n=e.appType,a=!!h.WebViewUtility.webViewActionRole,i=s._BrowserDetection.getBrowserInformation().os===s._OS.IOS,r=n===y.e.Video,o=location.hostname!==new URL(t).hostname,c=i&&r&&o;return s._SPKillSwitch.isActivated("fdf168f7-2f10-4fb7-a35c-0a6ab69e72bd")?a:a&&!c},t.prototype._setPreviewUrlWithAuth=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,n,a,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(e=this._getPreviewUrl()))return[2];if((n=new URL(e).origin)===window.location.origin)return this.setState({previewUrl:e}),[2];i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.props.getAuthToken(n)];case 2:return a=i.sent(),[4,this._fetchThumbnailImage(e,{method:"GET",headers:{Authorization:"Bearer "+a}})];case 3:return r=i.sent(),this.setState({previewUrl:r}),[2];case 4:return s=i.sent(),this.setState({previewUrl:e}),o._TraceLogger.logError(t._logSource,s),[3,5];case 5:return[2]}})})},t.prototype._getPreviewUrl=function(){var e=this._constructThumbnailRequest();return _.ThumbnailUrlGenerator.getThumbnailUrl(e)},t.prototype._constructThumbnailRequest=function(e){var t=e||this.props,n=t.absoluteUrl,a=t.listId,i=t.resolution,r=t.siteId;return{absoluteUrl:t.webAbsoluteUrl,siteId:r,webId:t.webId,listId:a,uniqueId:t.uniqueId,fileType:(null==n?void 0:n.split(".").pop())||"",width:i,callerId:"docEmbedCard"}},t.prototype._fetchThumbnailImage=function(e,t){return fetch(e,t).then(function(e){return e.blob()}).then(function(e){return URL.createObjectURL(e)})},t.prototype._revokePreviewUrl=function(){var e=this.state.previewUrl;e&&/^blob:/.test(e)&&URL.revokeObjectURL(e)},t.prototype._onClick=function(e){r._EngagementLogger.logEvent("DocumentCard.Click",e.type),window.open(this._wacPath,"_blank")},Object.defineProperty(t.prototype,"_parent",{get:function(){var e=this.props,t=e.absoluteUrl,n=e.webAbsoluteUrl;if(!t)return"";var a,i=new l.Uri(t).getPathSegments();return a=i.length>1?i[i.length-2]:n?n.split("/").pop():"",decodeURI(a)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_parentHref",{get:function(){var e=this.props.absoluteUrl;if(!e)return"";var t=e.split("/");return t.pop(),t.join("/")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_activity",{get:function(){var e=this.props.modifiedDate;if(e){var t=Date.parse(e);if("number"==typeof t){var n=new Date(t);if(n)return l.StringHelper.format(Se.d,ge.LocaleFormat.formatDate(n,{date:"medium"}))}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_wacPath",{get:function(){return _.SPUtility.getWebPathOfFile(this.props.absoluteUrl)},enumerable:!1,configurable:!0}),t._logSource=o._LogSource.create("DocumentEmbedCard"),Object(i.__decorate)([b.autobind],t.prototype,"_onClick",null),t}(b.BaseComponent);n("jOlS").loadStyles(".a_a_866d546b{display:none}.b_a_866d546b .c_a_866d546b{position:absolute;top:0;left:0;width:100%;height:100%;border:none}.b_a_866d546b .e_a_866d546b{position:relative;padding-top:56.25%}.b_a_866d546b .e_a_866d546b.f_a_866d546b{padding-top:calc(max(250px, 56.25%))}.b_a_866d546b .e_a_866d546b.g_a_866d546b{padding-top:calc(56.25% + 24px)}.b_a_866d546b .h_a_866d546b{display:flex;align-items:center;justify-content:center;height:100%;position:absolute;top:0;left:calc(50% - 62px)}.i_a_866d546b{position:absolute;top:0;transition:opacity 1s ease-in-out;z-index:1;height:100%;width:100%;border:none;-o-object-fit:cover;object-fit:cover}.j_a_866d546b{opacity:0}.k_a_866d546b{z-index:0}",!0);var Ie=function(e){function t(t){var n=e.call(this,t)||this;return n.handleFilePickerClick=function(){n._ensureFilePicker().then(function(){n._filePicker.open(),o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","Open")}).catch(function(e){o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebPart"),e,"LoadFilePickerChunk")})},n._onSuccessfulDocIFrameLoad=function(){o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","SuccessfulFileSelection"),n._documentLoadMonitor&&!n._isFastPreviewSupported&&(n._documentLoadMonitor.writeSuccess(n._eventData),n._resetDocMonitors(),n._removeHoverBorders()),n._thumbnailLoaded||n.props.renderCompleted(),n._removeThumbNail()},n._onFailedDocIFrameLoad=function(){o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","UnSuccessfulFileSelection"),n._documentLoadMonitor&&n._documentLoadMonitor.writeUnexpectedFailure("iframeLoadFailure",void 0,n._eventData),n.props.statusRender.renderError(n.props.statusRenderElement,new Error(Se.C)),n._resetDocMonitors(),n._thumbnailLoaded||n.props.renderCompleted()},n._onFailedImgLoad=function(){n.setState({iFrameVisibility:"visible",imgClass:Object(b.css)("i_a_866d546b",b.AnimationClassNames.fadeOut100)}),n._thumbnailLoaded=!1,n._logThumbnailStatus(n._previewUrl,!1)},n._onSuccessFullImgLoad=function(){n.props.edit&&n.setState({iFrameVisibility:"visible"}),n.props.renderCompleted(),n._thumbnailLoaded=!0,n._logThumbnailStatus(n._previewUrl,!0)},n._handleMouseOver=function(){n.props.edit||"hidden"!==n.state.iFrameVisibility||n.setState({iFrameVisibility:"visible"})},n._thumbnailLoaded=!1,n._isFastPreviewSupported=x(n.props.file),n.state={docIframeSrc:"",elementWidth:n.props.width,imgClass:"i_a_866d546b",iFrameVisibility:"hidden"},n}return Object(i.__extends)(t,e),t._isLogThumbnailStatusKSActivated=function(){return s._SPKillSwitch.isActivated("4c02c803-b408-4084-9759-0186b0007585")},t._isFullScreenAllowedKSActivated=function(){return s._SPKillSwitch.isActivated("5fb33a5b-cffb-46fa-a52d-f25fee60920d")},t.prototype.componentDidMount=function(){var e=this.props,t=e.edit,n=e.renderedFromPersistedData,a=e.canOpenPopupOnRender,i=e.isUploadedFromLocalFiles;t&&!n&&a&&!i&&this.handleFilePickerClick(),this._isFastPreviewSupported&&(this._oneUpMessageEventListener=this._onReceiveMessage,window.addEventListener("message",this._oneUpMessageEventListener));var r=this.props.absoluteUrl;r&&o._EngagementLogger.logEvent("DocumentEmbedWP.extension."+(t?"edit":"view"),r.split(".").pop()),this.props.edit||this._embedOverlay||(this._embedOverlay=Object(h.getEmbedOverlay)(this._getIconName(this.props.serverRelativeUrl)))},t.prototype.componentWillUnmount=function(){this._documentLoadMonitor&&this._documentLoadMonitor.writeExpectedFailure("DocumentEmbedWebPartUnmounted",void 0,this._eventData),this._resetDocMonitors(),this._isFastPreviewSupported&&(window.removeEventListener("message",this._oneUpMessageEventListener,!1),this._oneUpMessageEventListener=void 0)},t.prototype.render=function(){var e=this.props,n=e.absoluteUrl,a=e.authorName,i=e.authorPhotoUrl,r=e.dynamicSourceName,o=e.edit,c=e.isDocumentSelected,d=e.listId,l=e.modifiedAt,f=e.serverRelativeUrl,p=e.showPlaceHolder,m=e.siteId,g=e.title,v=e.uniqueId,S=e.uploadProgressMessage,I=e.webAbsoluteUrl,x=e.webId,C=e.emphasisTheme,O=e.getAuthToken;this._appType=Object(D.e)(f);var w="";if(n&&!this._shouldRenderAsCard){var E=n.split(".").pop(),A={absoluteUrl:I,siteId:m,webId:x,listId:d,width:this.props.width,uniqueId:v,fileType:E,callerId:"docEmbedCard"};w=_.ThumbnailUrlGenerator.getThumbnailUrl(A)}var L=!t._isFullScreenAllowedKSActivated()&&this._appType===y.e.Video||void 0,k=!this._shouldRenderAsCard,M=r?s.Text.format(Se.f,r):this._isFastPreviewSupported?Se.D:Se.p,P=this._isFastPreviewSupported?Se.I:Se.m,T=!!w,U=n?_.SPUtility.getWebPathOfFile(n):n;T||this._logThumbnailStatus(void 0,!1);var F=!this.props.edit&&T&&"hidden"===this.state.iFrameVisibility;return c||p||S?u.createElement("div",{className:"b_a_866d546b","data-automation-id":"DocumentEmbed"},u.createElement("button",{className:"a_a_866d546b"}),u.createElement("div",{role:k?"region":"button","aria-label":k?Se._:void 0,className:this._shouldRenderAsCard||p?"":Object(b.css)("e_a_866d546b",this._appType!==y.e.Word||s._SPKillSwitch.isActivated("4168b8a3-d064-4576-a09c-f04d0a91a80d")?void 0:"f_a_866d546b",this._appType===y.e.PowerPoint?"g_a_866d546b":void 0),"data-sp-action":this._shouldRenderAsCard?h.WebViewUtility.getOpenDocumentAction(U):void 0},p?u.createElement("div",null,u.createElement(h.Placeholder,{ref:this._resolveRef("_placeHolder"),icon:"Page",iconText:P,description:M,buttonLabel:o?Se.t:void 0,onAdd:this.handleFilePickerClick,webpartWidth:this.state.elementWidth})):S?u.createElement("div",{className:"h_a_866d546b"},u.createElement(b.Spinner,{type:b.SpinnerType.large,label:S})):this._shouldRenderAsCard?u.createElement(De,{absoluteUrl:n,webAbsoluteUrl:I,siteId:m,webId:x,listId:d,uniqueId:v,title:g,modifiedDate:l,authorName:a,photoUrl:i,resolution:this.state.elementWidth,getAuthToken:O,appType:this._appType}):u.createElement("div",{role:F?"row":void 0,onMouseOver:this._handleMouseOver},F&&this._embedOverlay,T&&(!ye()||"hidden"===this.state.iFrameVisibility)&&u.createElement("img",{src:w,className:this.state.imgClass,onError:this._onFailedImgLoad,onLoad:this._onSuccessFullImgLoad,alt:Se.l}),!F&&u.createElement("iframe",{ref:this._resolveRef("_dociFrame"),className:"c_a_866d546b",frameBorder:"0",allowFullScreen:L,tabIndex:0,src:this.state.docIframeSrc,title:Se.z,role:"document",style:{visibility:T?this.state.iFrameVisibility:"visible"},onLoad:this._onSuccessfulDocIFrameLoad,onError:this._onFailedDocIFrameLoad}))),c?u.createElement(h.CaptionElement,{ref:this._resolveRef("_captionElement"),isEditMode:o,placeholder:Se.n,text:this.props.annotation,onChange:this.props.onChangeCaptionText,className:s._SPKillSwitch.isActivated("cc9c4efd-bb86-48f4-a993-5188ad030987")?"":Object(b.mergeStyles)(this._getCaptionStyles(C))}):void 0):u.createElement("div",null)},t.prototype.setDocumentIFrameSrc=function(e){this._documentLoadMonitor||(this._documentLoadMonitor=new o._QosMonitor("DocEmbedWp.FileLoad")),this.setState({docIframeSrc:e})},t.prototype.onDocumentSelectionCancelled=function(){this._placeHolder&&this._placeHolder.focusOnPlaceHolderButton(),o._EngagementLogger.logEvent("DocumentEmbedWP.FilePicker","UserCancelled")},t.prototype.focusOnCaptionElement=function(){_.ScreenReaderAlert.read(Se.B,_.ReadingMode.ReadImmediately),this._captionElement&&this._captionElement.focusOnCaptionElement()},t.prototype.setContainerWidth=function(e){this.setState({elementWidth:e})},Object.defineProperty(t.prototype,"_shouldRenderAsCard",{get:function(){var e=s._BrowserDetection.getBrowserInformation();if(e.isMobile&&!e.isIpad||s._BrowserUtilities.isMobileWebView())return!0;var t=this._isFastPreviewSupported?355:320;return this.state.elementWidth<=t},enumerable:!1,configurable:!0}),t.prototype._getCaptionStyles=function(e){return Boolean(e)?{color:e.semanticColors.bodyText+" !important",selectors:{textarea:{color:e.semanticColors.bodyText},"textarea::placeholder":{color:e.semanticColors.bodySubtext}}}:void 0},t.prototype._ensureFilePicker=function(){var e=this;if(this._filePicker)return Promise.resolve();var t={onSelect:this.props.onSelect,onCancel:this.onDocumentSelectionCancelled,selectionMode:g.SelectionMode.single,itemTypes:new Set([a.Documents]),disableLocalUpload:this.props.disableUpload,callerName:"FileViewerWebPart"};return s._SPKillSwitch.isActivated("1d50eb18-0ce9-420f-9930-28cffc5d91ea")||(t.disableStockAssets=!0),h.EditModeUtilitiesLoader.GetUtilities().then(function(n){return n.FilePickerLoader.load(e.props.serviceScope,t).then(function(t){e._filePicker||(e._filePicker=t)})})},t.prototype._removeThumbNail=function(){var e=this;setTimeout(function(){e.setState({imgClass:Object(b.css)("i_a_866d546b",ye()?b.AnimationClassNames.fadeOut100:b.AnimationClassNames.fadeOut200)}),setTimeout(function(){e.setState({imgClass:Object(b.css)("i_a_866d546b","k_a_866d546b")})},ye()?1e3:200)},ye()?2e3:1e3)},t.prototype._removeHoverBorders=function(){if((this._appType===y.e.PowerPoint||this._appType===y.e.Word)&&this._dociFrame&&this._dociFrame.contentWindow&&s._BrowserDetection.getBrowserInformation().os!==s._OS.IOS)try{var e=this._dociFrame.contentWindow.document.getElementsByName("WebApplicationFrame"),t=e&&e.length>0?e.item(0):void 0;if(t){var n=!1,a=!1;switch(this._appType){case y.e.PowerPoint:this._dociFrame.style.height="calc(100% + 1px)",a=!0,n=!0;break;case y.e.Word:n=!0}if(n||a){var i=t.getBoundingClientRect();a&&(t.style.width="calc(100% + 2px)",t.style.height=i.height+2+"px"),n&&(t.style.top=i.top-1+"px",t.style.left=i.left-1+"px")}}}catch(e){}},t.prototype._resetDocMonitors=function(){this._documentLoadMonitor=void 0},t.prototype._onReceiveMessage=function(e){var t=this;if(this._isValidMessageOrigin(null==e?void 0:e.origin)&&e.data&&"string"==typeof e.data&&0===e.data.lastIndexOf(this._oneUpEmbedFromMessagePrefix,0)){var n=JSON.parse(e.data.substring(this._oneUpEmbedFromMessagePrefix.length));if(this._documentLoadMonitor){var a=this._eventData;switch(n.type){case"success":this._documentLoadMonitor.writeSuccess(a);break;case"error":var i=n.error||{},r=i.code,s=void 0===r?"Unspecified":r,c=i.message,d=new Error(c);n.isExpected?this._documentLoadMonitor.writeExpectedFailure(s,d,a):this._documentLoadMonitor.writeUnexpectedFailure(s,d,a);break;case"getToken":this.props.getAuthToken().then(function(e){t._postOneUpEmbedTokenResult(n.conversationId,e)}).catch(function(e){o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebpart"),e),t._postOneUpEmbedTokenResult(n.conversationId,"",e)})}}else o._TraceLogger.logError(o._LogSource.create("DocumentEmbedWebpart"),new Error("postMessage while monitor undefined"));this._resetDocMonitors(),this._thumbnailLoaded||this.props.renderCompleted(),window.postMessage(this._constructOneUpEmbedAcknowledgement(n),Object(S.t)())}},t.prototype._isValidMessageOrigin=function(e){if(e){var t=this.props.absoluteUrl?new URL(this.props.absoluteUrl).origin:void 0;return e.indexOf(Object(S.t)())>=0||t&&e.indexOf(t)>=0}return!1},Object.defineProperty(t.prototype,"_oneUpEmbedFromMessagePrefix",{get:function(){return s.Text.format("[OneDrive:From:Embed:{0}]",this.props.uniqueId)},enumerable:!1,configurable:!0}),t.prototype._constructOneUpEmbedAcknowledgement=function(e){return s.Text.format('[OneDrive:To:Embed:{0}]{"conversationId":{1},"type":"acknowledge"}',this.props.uniqueId,e.conversationId)},t.prototype._postOneUpEmbedTokenResult=function(e,t,n){var a,i=t?{type:"result",conversationId:e,data:{result:"success",token:t}}:{type:"result",conversationId:e,data:{result:"error",isExpected:!1,error:{message:null==n?void 0:n.message}}};if(this.props.absoluteUrl){var r=s.Text.format("[OneDrive:To:Embed:{0}]",this.props.uniqueId)+JSON.stringify(i);null===(a=this._dociFrame.contentWindow)||void 0===a||a.postMessage(r,new URL(this.props.absoluteUrl).origin)}},Object.defineProperty(t.prototype,"_eventData",{get:function(){return{appType:this._appType&&y.e[this._appType]||"unknown",extension:_.ExtensionHelper.getExtension(this.props.serverRelativeUrl),isCrossDomain:this.props.isCrossDomain,isCrossWeb:this.props.isCrossWeb}},enumerable:!1,configurable:!0}),t.prototype._logThumbnailStatus=function(e,n){if(!t._isLogThumbnailStatusKSActivated()&&this._previewUrl!==e){var a=this.props.edit?"Edit":"Read",i=new o._QosMonitor("EmbedWebpartThumbnail"),r={alias:"FileViewerWebPart",displayMode:a};void 0===e?i.writeExpectedFailure("Unavailable",void 0,r):!1===n?i.writeUnexpectedFailure("FailedToLoad",void 0,r):!0===n&&i.writeSuccess(r),this._previewUrl=e}},t.prototype._getIconName=function(e){return/(\.doc|\.docx)$/i.test(e)?"WordDocument":/(\.xls|\.xlsx)$/i.test(e)?"ExcelDocument":/(\.ppt|\.pptx|\.pot|\.potx)$/i.test(e)?"PowerPointDocument":/(\.vsd|\.vsdx|\.vsdm)$/i.test(e)?"VisioDocument":/(\.one)$/i.test(e)?"OneNoteLogo":/(\.pdf)$/i.test(e)?"PDF":_.spConstants.imageExtensions.map(function(t){return new RegExp("(\\."+t+")$").test(e)}).some(function(e){return e})?"Photo2":_.spConstants.videoExtensions.map(function(t){return new RegExp("(\\."+t+")$").test(e)}).some(function(e){return e})?"MSNVideos":"TextDocument"},Object(i.__decorate)([b.autobind],t.prototype,"onDocumentSelectionCancelled",null),Object(i.__decorate)([b.autobind],t.prototype,"setContainerWidth",null),Object(i.__decorate)([b.autobind],t.prototype,"_ensureFilePicker",null),Object(i.__decorate)([b.autobind],t.prototype,"_onReceiveMessage",null),t}(b.BaseComponent),xe={sourcedoc:"",file:"",action:"interactivepreview",defaultitemopen:1,wdembedcode:1,wdprint:1,wdstarton:1},Ce={sourcedoc:"",file:"",action:"interactivepreview",defaultitemopen:1,wdeaa:0,wdAr:1.7777777,wdslideindex:1},Oe={sourcedoc:"",file:"",action:"embedview",defaultitemopen:1,allowtyping:!1,wddownloadbutton:!0,wdhidegridlines:!0,wdhideheaders:!0,wdallowinteractivity:!0,item:""},we={sourcedoc:"",file:"",action:"EmbedView"},Ee=function(){function e(){}return e.getIframeUrl=function(t,n,a){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(i){switch(i.label){case 0:return x(t.file)?[4,C(t,n,a)]:[3,2];case 1:return[2,i.sent()];case 2:return[2,e._getUpdatedWopiUrl(t)]}})})},e._getUpdatedWopiUrl=function(t){var n=Object(D.e)(t.file);if(n===y.e.Other||n===y.e.Video)throw Se.S;var a=decodeURI(t.wopiurl),i=function(e){switch(e){case y.e.Word:return xe;case y.e.PowerPoint:return Ce;case y.e.Excel:return Oe;case y.e.Visio:return we}}(n);try{var r=Object.keys(t),o=a.split("?"),s=[];for(var c in i)if(i.hasOwnProperty(c)){var d="";"sourcedoc"===c&&o.length>1?d=c+"="+e._getQueryParamValue(a,c):"wdhidegridlines"===c||"wdhideheaders"===c?d=e._getQueryParameter(t,r,c,c,i,!0):"item"===c?t.hasOwnProperty("chart"+c)&&""!==t["chart"+c]?d=e._getQueryParameter(t,r,c,"chart"+c,i):t.hasOwnProperty("range"+c)&&""!==t["range"+c]?(d=e._getQueryParameter(t,r,c,"range"+c,i),d+="!"+t.startrange+":"+t.endrange):d=t.hasOwnProperty("table"+c)&&""!==t["table"+c]?e._getQueryParameter(t,r,c,"table"+c,i):e._getQueryParameter(t,r,c,c,i):d=e._getQueryParameter(t,r,c,c,i),s.push(d)}return[o[0],s.join("&")].join("?")}catch(e){throw Se.C}},e._getQueryParameter=function(e,t,n,a,i,r){return void 0===r&&(r=!1),"wdstarton"!==a&&"wdslideindex"!==a||(a="startPage"),a===n?r?t.indexOf(n)>=0?n+"="+encodeURIComponent((!e[a]).toString()):n+"="+encodeURIComponent(i[n]):t.indexOf(n)>=0?n+"="+encodeURIComponent(e[a]):n+"="+encodeURIComponent(i[n]):r?t.indexOf(a)>=0?n+"="+encodeURIComponent((!e[a]).toString()):n+"="+encodeURIComponent(i[n]):t.indexOf(a)>=0?n+"="+encodeURIComponent(e[a]):n+"="+encodeURIComponent(i[n])},e._getQueryParamValue=function(e,t){return new s.UrlQueryParameterCollection(e).getValue(t)||""},e}();function Ae(e,t){var n=!!new _.SPResourcePath(e.serverRelativeUrl).authority,a=n;if(!a){var i=s.Guid.tryParse(e.siteId);a=!!i&&!i.equals(t.site.id)}if(!a){var r=s.Guid.tryParse(e.webId);a=!!r&&!r.equals(t.web.id)}e.isCrossDomain=n,e.isCrossWeb=a}var Le=function(e){function t(n,a){var i=e.call(this,n)||this;return i.name="GraphError",i.code=a,i.__proto__=t.prototype,i}return Object(i.__extends)(t,e),t}(Error),ke=function(){function e(e){var t=this;e.whenFinished(function(){t._graphHttpClient=e.consume(c._GraphHttpClient.serviceKey)})}return e.prototype.getItemId=function(t,n){var a=this,i="sites/"+t+"/drive/root:/"+n;return this._graphHttpClient.get("v1.0/"+i+"??select=id",c._GraphHttpClient.configurations.v1).then(function(e){return a._checkResponseStatus(e)}).then(function(e){return e.id}).catch(function(t){throw o._TraceLogger.logError(e.LOG_SOURCE,t,"getItemId"),t})},e.prototype.getItemPreview=function(t,n){var a=this,i="sites/"+t+"/drive/items/"+n+"/preview";return this._graphHttpClient.post("v1.0/"+i,c._GraphHttpClient.configurations.v1,void 0).then(function(e){return a._checkResponseStatus(e)}).then(function(e){return new URL(e.getUrl)}).catch(function(t){throw o._TraceLogger.logError(e.LOG_SOURCE,t,"getItemPreview"),t})},e.prototype._checkResponseStatus=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),e.ok?n?e.arrayBuffer():e.json():!t||204!==e.status&&404!==e.status?e.json().then(function(e){var t=e.error;throw new Le(t.message,t.code)}):Promise.resolve(void 0)},e.serviceKey=s.ServiceKey.create("sp-fileviewer-webparts.GraphDataProvider",e),e.LOG_SOURCE=o._LogSource.create("GraphDataProvider"),e}(),Me=n("7Awa"),Pe=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n._handleThemeChangedEvent=function(e){n._emphasisTheme=e.theme,n.render()},n._closeCoachMark=function(){n._isCoachmarkActive=!1,n.context.serviceScope.consume(m.CoachmarkUtility.serviceKey).dismiss(t._dragAndDropCoachmarkLocalStorage)},n._acknowledgeCoachmarkAndLog=function(){n._closeCoachMark(),r._EngagementLogger.logEventWithLogEntry(new o._LogEntry("DocumentWebPart","DragAndDropCoachMarkAcknowledged",o._LogType.Event))},n._dismissCoachmarkAndLog=function(){n._closeCoachMark(),r._EngagementLogger.logEventWithLogEntry(new o._LogEntry("DocumentWebPart","DragAndDropCoachMarkDismissed",o._LogType.Event))},n._shouldAddCoachmark=function(){return n.displayMode===s.DisplayMode.Edit&&!n.renderedFromPersistedData},n._addCoachMarkForDragAndDrop=function(){n._isCoachmarkActive=!0,n.context.serviceScope.consume(m.CoachmarkUtility.serviceKey).attachCoachmark({positioningContainerProps:{directionalHint:b.DirectionalHint.leftTopEdge,directionalHintForRTL:b.DirectionalHint.rightTopEdge},localStorageKey:t._dragAndDropCoachmarkLocalStorage,featureGroupKey:"DocumentEmbedDragAndDropCoachmark",target:n.domElement,content:Se.o,onBeforeDismiss:n._dismissCoachmarkAndLog,teachingBubbleProps:{headline:Se.c,hasCondensedHeadline:!0,primaryButtonProps:{text:Se.s,onClick:n._acknowledgeCoachmarkAndLog}}})},n._setFileFromInit=function(){var e=n.properties.externalFile;if(e){n._isUploadedFromLocalFiles=!0;var t={file:e,src:e.name};n._setFileProperties({selectedItems:[],localFilesPickedToUpload:[t]})}},n._getProofToken=function(){return Object(i.__awaiter)(n,void 0,void 0,function(){var e,n,a,r,s,c,d,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),e=this.properties.siteId,n=Object(S.e)(this.properties,this.context.pageContext.web.absoluteUrl),a=this.properties.webAbsoluteUrl,e&&n&&a?(r=n.replace(a,""),s=r.split("/"),this._graphDataProvider&&s.length>=3?(c=s.splice(2).join("/"),[4,this._graphDataProvider.getItemId(e,c)]):[3,3]):[3,3];case 1:return d=i.sent(),[4,this._graphDataProvider.getItemPreview(e,d)];case 2:return[2,i.sent().searchParams.get("access_token")];case 3:return[2,void 0];case 4:return l=i.sent(),o._TraceLogger.logError(t._logSource,l),[3,5];case 5:return[2]}})})},n}return Object(i.__extends)(t,e),t._logSelectedAppType=function(e){var t=Object(D.e)(e);t===y.e.Other?r._EngagementLogger.logEvent("DocumentEmbedWP.NonOfficeAdd.Click"):t===y.e.Video&&r._EngagementLogger.logEvent("DocumentEmbedWP.TeamVideoAdd.Click")},t._isDynamicValueAFolder=function(e){var t,n;return!(0!==(null===(n=null===(t=null==e?void 0:e[0])||void 0===t?void 0:t.ContentTypeId)||void 0===n?void 0:n.indexOf("0x0120")))},Object.defineProperty(t.prototype,"previewImageUrl",{get:function(){return Object(h.webPartPreviewThumbnail)({pageContext:this.context.pageContext,url:this.properties.serverRelativeUrl,siteId:this.properties.siteId,webId:this.properties.webId,listId:this.properties.listId,uniqueId:this.properties.uniqueId})},enumerable:!1,configurable:!0}),t.prototype.render=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,r,o,c,d,l=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return(e=!!this.properties.requestedDynamicProperty)&&(this._lookupSourceFromDynamicData(),(n=this.properties.requestedDynamicProperty.tryGetSource())&&(t=n.metadata.title)),a=!this._isDocumentSelected&&(this.displayMode===s.DisplayMode.Edit&&!this._uploadProgressMessage||e),r=a&&this.renderedOnce,o=this.context.pageContext.web.absoluteUrl,c=u.createElement(Ie,Object(p.merge)({absoluteUrl:Object(S.e)(this.properties,o),annotation:this.properties.annotation,authorName:this.properties.authorName,authorPhotoUrl:this.properties.photoUrl,canOpenPopupOnRender:this.canOpenPopupOnRender,disableUpload:!this._uploadToSiteAssets&&!this._defaultDocLibName,edit:this.displayMode===s.DisplayMode.Edit,dynamicSourceName:e?t:void 0,isDocumentSelected:this._isDocumentSelected,isUploadedFromLocalFiles:this._isUploadedFromLocalFiles,modifiedAt:this.properties.modifiedAt,onSelect:this._setFileProperties,renderCompleted:this.renderCompleted.bind(this),renderedFromPersistedData:this.renderedFromPersistedData,serverRelativeUrl:this.properties.serverRelativeUrl,serviceScope:this.context.serviceScope,shouldGetPrefetchedRecentsData:r,showPlaceHolder:a,statusRender:this.context.statusRenderer,statusRenderElement:this.domElement,title:this.properties.title,uploadProgressMessage:this._uploadProgressMessage,webAbsoluteUrl:o,width:this.width,wopiurl:this.properties.wopiurl,emphasisTheme:this._emphasisTheme,onChangeCaptionText:function(e){return l.properties.annotation=e},getAuthToken:this._getToken.bind(this)},this.properties)),this._component=f.render(c,this.domElement),this._shouldAddCoachmark()&&this._addCoachMarkForDragAndDrop(),this._isDocumentSelected||this.displayMode===s.DisplayMode.Edit?this._isDocumentSelected?[4,Ee.getIframeUrl(this.properties,this.context.pageContext,s._SPKillSwitch.isActivated("3d3f0f27-5706-4ee2-a3c1-61ad42c8690e")?void 0:this._getProofToken)]:[3,2]:[2];case 1:d=i.sent(),this._component.setDocumentIFrameSrc(d),i.label=2;case 2:return[2]}})})},t.prototype.onInit=function(){var t=this;this._events=new l.EventGroup(this),this._updatedProperties={},this._setFileProperties=this._setFileProperties.bind(this),this._isCoachmarkActive=!1,this._isUploadedFromLocalFiles=!1,this._renderError=this._renderError.bind(this),this._uploadToSiteAssets=s._SPFlight.isEnabled(60040),this._initializeAadTokenConfiguration(),this.context.serviceScope.whenFinished(function(){t._graphDataProvider=t.context.serviceScope.consume(ke.serviceKey)}),this._getEmphasisTheme();var n=this.properties;return h.EditModeUtilitiesLoader.GetUtilities().then(function(a){var i=a.DocLibraryContext,r=a.SPFileHandler;return t._docLibContextDataProvider=new i(t.context.serviceScope),n.wopiurl?!n.webAbsoluteUrl&&n.serverRelativeUrl?t._fetchDocumentMetadata(!1).then(function(){return e.prototype.onInit.call(t)}):e.prototype.onInit.call(t):t._uploadToSiteAssets?(t._spFileHandler=new r({serviceScope:t.context.serviceScope,qosPrefix:"DocEmbedWp"}),t._setFileFromInit(),e.prototype.onInit.call(t)):t._docLibContextDataProvider.siteContext.then(function(n){return t._defaultDocLibName=n.libraryName,t._libraryServerRelativeUrl=l.Uri.concatenate(t.context.pageContext.web.serverRelativeUrl,t._defaultDocLibName),t._spFileHandler=new r({serviceScope:t.context.serviceScope,qosPrefix:"DocEmbedWp",containerUrl:t._libraryServerRelativeUrl}),t._setFileFromInit(),e.prototype.onInit.call(t)}).catch(function(n){return e.prototype.onInit.call(t)})})},Object.defineProperty(t.prototype,"propertiesMetadata",{get:function(){return{annotation:{isSearchablePlainText:!0},title:{isSearchablePlainText:!0},serverRelativeUrl:{isLink:!0},wopiurl:{isLink:!0}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRenderAsync",{get:function(){return this._isDocumentSelected},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataVersion",{get:function(){return s.Version.parse("1.4")},enumerable:!1,configurable:!0}),t.prototype.onAfterDeserialize=function(e,n){if(n.lessThan(s.Version.tryParse("1.1"))){var a=1;void 0!==e.wdslideindex&&(a=I(e.wdslideindex),delete e.wdslideindex);var i=1;void 0!==e.wdstarton&&(i=I(e.wdstarton),delete e.wdstarton),e.startPage=Math.max(a,i),e.modifiedBy&&(e.modifiedAt=e.modifiedBy,delete e.modifiedBy)}if(n.lessThan(s.Version.tryParse("1.3"))){if(e.dynamicSource&&(e.requestedDynamicProperty=e.dynamicSource,delete e.dynamicSource),!ve()&&!e.title&&e.file){var r="",c=/^.*\/(.*)\.\w+$/.exec(e.file);c&&c[1]&&(r=c[1]),e.title=r}if(!ve()&&!e.serverRelativePath&&!e.serverRelativeUrl)try{e.serverRelativeUrl=new URL(e.file).pathname}catch(e){o._TraceLogger.logError(t._logSource,e)}}if(Ae(e,this.context.pageContext),!e.webAbsoluteUrl){var d=s.Guid.tryParse(e.siteId),l=s.Guid.tryParse(e.webId),u=new _.SPResourcePath(e.serverRelativeUrl).authority,f=this.context.pageContext;!u&&d&&l&&d.equals(f.site.id)&&l.equals(f.web.id)&&(e.webAbsoluteUrl=f.web.absoluteUrl)}return e},t.prototype.onBeforeSerialize=function(){this.properties.startPage=I(this.properties.startPage),delete this.properties.isCrossDomain,delete this.properties.isCrossWeb,this.properties.serverRelativePath&&this.properties.serverRelativeUrl&&delete this.properties.serverRelativePath},t.prototype.onPropertyPaneFieldChanged=function(t,n,a){var i=a;"startPage"===t&&i?this.properties.startPage=I(i):e.prototype.onPropertyPaneFieldChanged.call(this,t,n,a)},t.prototype.onDispose=function(){this._isCoachmarkActive&&this._closeCoachMark(),this._documentEmbedDataProvider&&(this._documentEmbedDataProvider=void 0),this._events&&this._events.dispose&&this._events.dispose(),this.context.serviceScope.consume(Me.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),f.unmountComponentAtNode(this.domElement),this._component=void 0,e.prototype.onDispose.call(this)},t.prototype.loadPropertyPaneResources=function(){var e=this;return n.e(0).then(n.bind(null,"pbcy")).then(function(t){e._propertyPaneSettings=new t.PropertyPaneSettings})},t.prototype.getPropertyPaneConfiguration=function(){return this._propertyPaneSettings.getPropertyPaneSettings(this.properties,this._component.handleFilePickerClick,this._handleDynamicConnectionRemoved.bind(this))},t.prototype.onAfterResize=function(e){this._component&&this._component.setContainerWidth(e)},Object.defineProperty(t.prototype,"disableReactivePropertyChanges",{get:function(){return!this.properties.requestedDynamicProperty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessibleTitle",{get:function(){var e=this.properties.annotation||this.properties.title||this.properties.file;return e?l.StringHelper.format(Se.e,e):void 0},enumerable:!1,configurable:!0}),t.prototype._getEmphasisTheme=function(){var e=this;this.context.serviceScope.whenFinished(function(){var t=e.context.serviceScope.consume(Me.ThemeProvider.serviceKey);e._emphasisTheme=t.tryGetTheme(),t.themeChangedEvent.add(e,e._handleThemeChangedEvent)})},Object.defineProperty(t.prototype,"_isDocumentSelected",{get:function(){return!!this.properties.wopiurl||!!this.properties.serverRelativeUrl},enumerable:!1,configurable:!0}),t.prototype._clearDocumentSelection=function(){this.properties.wopiurl=this.properties.serverRelativeUrl=void 0},t.prototype._handleDynamicConnectionRemoved=function(){this.properties.requestedDynamicProperty=void 0,this._clearDocumentSelection(),this.render()},t.prototype._updateProperties=function(e){var t=!1;for(var n in e)if(e.hasOwnProperty(n)){var a=n;t=t||this._updatedProperties[a]!==e[a],this.properties[a]=this._updatedProperties[a]=e[a]}t&&(this.render(),(s._SPKillSwitch.isActivated(s.Guid.parse("4fdae1b1-935d-4a4e-8577-e5f8528beea1"),"1/23/2019","SOX_DocumentEmbedWebPartOnlyRefreshPropertyPaneIfOpen")||this.context.propertyPane.isPropertyPaneOpen())&&this.context.propertyPane.refresh())},t.prototype._loadDocumentDataProvider=function(){var e=this,t=this._documentEmbedDataProvider;return t||(t=n.e(0).then(n.bind(null,"eEG9")).then(function(t){return new t.default(e.context.serviceScope)}),this._documentEmbedDataProvider=t),t},t.prototype._fetchDocumentMetadata=function(e){var n=this;void 0===e&&(e=!1);var a=new r._QosMonitor("LoadDocument"),i=this.context.pageContext.web.absoluteUrl;return this._loadDocumentDataProvider().then(function(t){return t.getFileMetadata(a,n.properties,i,e)}).then(function(e){Ae(e,n.context.pageContext),a.writeSuccess(),n._updateProperties(e),n._component.focusOnCaptionElement(),t._logSelectedAppType(e.serverRelativeUrl)}).catch(function(e){"string"==typeof e?(e=new Error(e),a.writeUnexpectedFailure("FailedtoLoadDocument",e)):e.recorded||a.writeUnexpectedFailure("LoadDocumentCatchAll",e),n._handleDocumentSelectionError(e,e.resetSelection)})},t.prototype._handleDocumentSelectionError=function(e,t){void 0===t&&(t=!1),t&&this._clearDocumentSelection(),this.renderError(e)},t.prototype._setFileProperties=function(e){if(e&&e.localFilesPickedToUpload&&e.localFilesPickedToUpload.length>0&&e.localFilesPickedToUpload[0]&&e.localFilesPickedToUpload[0].file){var t=e.localFilesPickedToUpload[0].file;this._startUpload(t)}else if(e&&e.selectedItems&&e.selectedItems.length&&e.selectedItems[0]&&e.selectedItems[0].Link){var n=!s._SPKillSwitch.isActivated("7739d32a-f8a0-4eb2-88ae-613acabbe39a"),a=e.selectedItems[0],i=n?a.ServerAbsoluteUrl:a.Link;this.properties.listId=a.ListId,this.properties.siteId=a.SiteId,this.properties.uniqueId=a.UniqueId,this.properties.webId=a.WebId;var c=new _.SPResourcePath(i),d=!c.domain||c.domain===window.location.host;if(this.properties.serverRelativePath=d?c.path:i,-1!==c.path.toLowerCase().indexOf(_.spConstants.wacPath)){this.properties.wopiurl=this.properties.serverRelativePath,this.properties.serverRelativeUrl=this.properties.serverRelativePath;var u=new l.Uri(i);this.properties.file=u.getQueryParameter("file")||c.path}else this.properties.file=i;var f=new o._LogEntry("DocumentWebPart","DocumentSelection",o._LogType.Event,{fileType:y.e[Object(D.e)(this.properties.file)]});r._EngagementLogger.logEventWithLogEntry(f),this._fetchDocumentMetadata(!0),s._SPKillSwitch.isActivated("ceb208d8-093e-46d6-ac13-a029f93b3221")||this.resetStartPage()}else this._component.onDocumentSelectionCancelled()},t.prototype._renderError=function(e){this.renderError(e||new Error(Se.y))},t.prototype.resetStartPage=function(){this.properties.startPage=1},t.prototype._startUpload=function(e){var t=this;if(e){if(!this._uploadToSiteAssets&&!this._libraryServerRelativeUrl)return void this._renderError();var n=new r._QosMonitor("DocumentWebPartUpload");h.EditModeUtilitiesLoader.GetUtilities().then(function(a){var i=a.SPFileHandler;if(!i.validateFileType(e,_.spConstants.documentExtensions)){var c=_.spConstants.documentExtensions.join(Se.v);return t._renderError(new Error(l.StringHelper.format(Se.S,c))),void n.writeExpectedFailure("InvalidFileType")}t._uploadProgressMessage=Se.V,t.render();var d=Math.floor(1e5*Math.random()).toString(),u=e.name?e.name.split(".").pop():"",f=t._spFileHandler.removeExtension(e.name),p=s._SPKillSwitch.isActivated("9dada52d-6913-4d2a-8da2-c92a4e4cda0f")?i.replaceSpecialCharacters(f)+"_"+d+"."+u:i.replaceSpecialCharacters(f)+"."+u;if(!t._uploadToSiteAssets){var m=l.Uri.concatenate(t._libraryServerRelativeUrl,p);t.properties.serverRelativeUrl=m}window.addEventListener("beforeunload",t._promptUploadingWarning);var h=new o._LogEntry("DocumentWebPart","DocumentUpload",o._LogType.Event,{fileType:y.e[Object(D.e)(e.name)]});r._EngagementLogger.logEventWithLogEntry(h),t._spFileHandler.uploadLocalFile(e,p).then(function(e){t._onUploadComplete(e),n.writeSuccess()}).catch(function(e){n.writeUnexpectedFailure("FailedToUploadFile",e),t._onUploadError(e)})}).catch(function(e){throw n.writeUnexpectedFailure("EditModeUtilitiesLoaderError",e),e})}},t.prototype._onUploadComplete=function(e){window.removeEventListener("beforeunload",this._promptUploadingWarning),this._uploadProgressMessage=void 0,this.clearError(),this._setFileProperties({selectedItems:[{Link:e.serverRelativeUrl,UniqueId:e.uniqueId,ListId:e.listId,SiteId:this.context.pageContext.site&&this.context.pageContext.site.id&&this.context.pageContext.site.id.toString(),WebId:this.context.pageContext.web&&this.context.pageContext.web.id&&this.context.pageContext.web.id.toString(),ServerAbsoluteUrl:e.serverRelativeUrl}]})},t.prototype._onUploadError=function(e){throw window.removeEventListener("beforeunload",this._promptUploadingWarning),this._uploadProgressMessage=void 0,this._renderError(e),new Error(""+e.message)},t.prototype._promptUploadingWarning=function(e){var t=Se.j;return e.returnValue=t,t},t.prototype._lookupSourceFromDynamicData=function(){var e=this.properties,n=e.requestedDynamicProperty.tryGetValues(),a=n&&n[0]&&n[0].FileRef;if(a&&!t._isDynamicValueAFolder(n)){var i=a;if(e.serverRelativePath!==i){e.serverRelativePath=i,e.serverRelativeUrl=e.uniqueId=void 0;var r=n[0].ServerRedirectedEmbedUrl;e.wopiurl=r||void 0,this._fetchDocumentMetadata()}}else this._isDocumentSelected&&(e.serverRelativeUrl=e.serverRelativePath=e.wopiurl=void 0,s._SPKillSwitch.isActivated(s.Guid.parse("59d46f6c-9039-48d8-9543-a1f306de4a92"),"1/23/2019","SOX_DocumentEmbedWebPartClearUniqueIdOnDynamicDataChange")||(e.uniqueId=void 0))},t.prototype._initializeAadTokenConfiguration=function(){var e=this.context.pageContext.legacyPageContext,t=e.aadInstanceUrl,n=e.aadSessionId,a=e.aadTenantId,i=e.aadUserId,r=e.userPrincipalName;this._aadTokenConfiguration={aadInstanceUrl:t,aadSessionId:n,aadTenantId:a,aadUserId:i,redirectUri:window.location.origin+"/_forms/"+c._AadConstants.SPFX_SINGLE_SIGN_ON_REPLY_URL,servicePrincipalId:c._AadConstants.PRE_AUTHORIZED_APP_PRINCIPAL_ID,userPrincipalName:r}},t.prototype._getToken=function(e){var n=this,a=e||this.properties.webAbsoluteUrl&&new URL(this.properties.webAbsoluteUrl).origin;return a?this.context.aadTokenProviderFactory.getTokenProvider().then(function(e){return e._getTokenInternal(a,n._aadTokenConfiguration)}).catch(function(e){throw o._TraceLogger.logError(t._logSource,e),e}):Promise.reject(new Error("Failed to get spo-token: empty resource endpoint"))},t._dragAndDropCoachmarkLocalStorage="DismissedFileDragAndDropCoachmark",t._logSource=o._LogSource.create("DocumentEmbedWebPart"),t}(d.BaseClientSideWebPart);t.default=Pe},ut3N:function(e,t){e.exports=b},vlQI:function(e,t){e.exports=g},y88i:function(e,t){e.exports=v}})});