define("bdb0f5dd-3bb4-4b93-b12a-71aa9e20bb09_0.7.1",["tslib","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-core-library","react","@microsoft/load-themed-styles","@microsoft/sp-diagnostics","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({"17wl":function(e,t){e.exports=n},KL1q:function(e,t){e.exports=a},UWqr:function(e,t){e.exports=i},cDcd:function(e,t){e.exports=r},jOlS:function(e,t){e.exports=o},mGD9:function(e){e.exports=JSON.parse('{"e":"Permalink for {0}"}')},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"anchorServiceManager",function(){return c}),n.d(t,"AnchorZone",function(){return _});var a=n("ut3N"),i=n("17wl"),r=n("UWqr"),o=function(){function e(){var t=this;this._componentIdToAnchorDataMap=new Map,this._anchorIdToAnchorDataMap=new Map,this.register=function(n,o){r.Validate.isNonemptyString(n,"uniqueId"),r.Validate.isNotNullOrUndefined(o,"anchorList"),t._componentIdToAnchorDataMap.set(n,o.map(function(e){return Object(i.__assign)(Object(i.__assign)({},e),{anchorId:void 0})})),a._TraceLogger.logVerbose(e._logSource,"Component '"+n+"' registered with "+o.length+" anchors")},this.unregister=function(n){var i=t._componentIdToAnchorDataMap.get(n);i?(i.forEach(function(e){e.anchorId&&(e.onDisposeAnchorId&&e.onDisposeAnchorId(e.anchorTargetElement,e.anchorId),t._anchorIdToAnchorDataMap.delete(e.anchorId))}),t._componentIdToAnchorDataMap.delete(n),a._TraceLogger.logVerbose(e._logSource,"Successfully unregistered component '"+n+"'")):a._TraceLogger.logError(e._logSource,new Error("Trying to unregister a non-exists component '"+n+"'"))},this.finishRegistration=function(){a._TraceLogger.logVerbose(e._logSource,"finishRegistration invoked");var n=[];t._componentIdToAnchorDataMap.forEach(function(e){return n=n.concat(e)}),n.sort(e._compareAnchorLocation),t._anchorIdToAnchorDataMap.clear();var i=new Map,o={action:"AnchorsUpdated",sortedAnchors:n.map(function(n){var r=e.sanitizeAnchorId(n.suggestedAnchorId);return r||(r=e.DEFAULT_ANCHOR_NAME),r=t._handleCollision(r,i),n.anchorId=r,t._anchorIdToAnchorDataMap.set(r,n),n.onReceiveAnchorId&&n.onReceiveAnchorId(n.anchorTargetElement,r),a._TraceLogger.logVerbose(e._logSource,"Anchor ID '"+r+"' allocated"),{anchorText:n.suggestedAnchorId,anchoredElementTagName:n.anchorTargetElement.tagName,anchorId:r}})};r._SPEventManager.instance.raiseStickyEvent("anchorEvent",o)}}return e.sanitizeAnchorId=function(t){return t?t.trim().toLowerCase().replace(e._unsafeCharacters,"-").replace(/-{2,}/g,"-").replace(/^-+|-+$/g,"").substring(0,e.MAX_ID_LENGTH):""},e._compareAnchorLocation=function(e,t){return e.anchorTargetElement.compareDocumentPosition(t.anchorTargetElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1},e.prototype.getElementByAnchorId=function(e){var t=this._anchorIdToAnchorDataMap.get(e);return t&&t.anchorTargetElement},e.prototype.scrollTo=function(e){var t=this._anchorIdToAnchorDataMap.get(e);return!!t&&(t.anchorTargetElement.scrollIntoView(),!0)},e.prototype._handleCollision=function(e,t){for(var n=e,a=0;t.has(n);)n=(e=n)+"-"+(a=t.get(e)||0);return t.set(e,a+1),t.set(n,1),n},e._logSource=a._LogSource.create("AnchorService"),e._unsafeCharacters=/[`"'<>#%{}|\\^~\/\[\];?:@=&\s\0]/g,e.MAX_ID_LENGTH=128,e.DEFAULT_ANCHOR_NAME="anchor",e}(),s=function(){function e(){var e=this;this._register=function(t,n){e._anchorService.register(t,n),e._pendingRegistrations.delete(t),e._checkFinishRegistration()},this._unregister=function(t){e._anchorService.unregister(t),e._pendingRegistrations.delete(t),e._checkFinishRegistration()},this._refresh=function(t,n){e._anchorService.register(t,n),e._pendingRegistrations.delete(t),e._checkFinishRegistration()},this._pendingFinishRegistration=!1,this._pendingRegistrations=new Set,this._anchorService=new o}return e.prototype.initialize=function(e){var t=this;e.forEach(function(e){t.handleAnchorEvent(e)})},e.prototype.scrollTo=function(e){var t=this;return new Promise(function(n,a){var i=function(){t._anchorService.scrollTo(e)?n():a(new Error("Failed to find anchor to scroll"))};t._pendingFinishRegistration?t._resolveScroll=i:i()})},e.prototype.handleAnchorEvent=function(e){switch(e.action){case"ReserveRegistration":this._reserveRegistration(e.uniqueId);break;case"Register":this._register(e.uniqueId,e.anchorList);break;case"Unregister":this._unregister(e.uniqueId);break;case"Refresh":this._refresh(e.uniqueId,e.anchorList)}},e.prototype._reserveRegistration=function(e){this._pendingRegistrations.add(e)},e.prototype._checkFinishRegistration=function(){this._pendingRegistrations.size||(this._anchorService.finishRegistration(),this._pendingFinishRegistration=!1,this._resolveScroll&&(this._resolveScroll(),this._resolveScroll=void 0))},e}(),c=new(function(){function e(){var e=this;this.componentId="bdb0f5dd-3bb4-4b93-b12a-71aa9e20bb09",this.instanceId="e1163200-0719-4a64-9f9a-bc6592953704",this.isDisposed=!1,this._anchorServiceQueue=new s,this.reserve=function(t){e._anchorServiceQueue.handleAnchorEvent({action:"ReserveRegistration",uniqueId:t})},this.raiseAnchorEvent=function(t){e._anchorServiceQueue.handleAnchorEvent(t)},this._scroll=function(){if(e._anchorIdToScroll){var t=e._anchorServiceQueue.scrollTo(e._anchorIdToScroll);return e._anchorIdToScroll=void 0,t}return Promise.reject("AnchorId is undefined, multiple scroll Task planned")}}return e.prototype.scrollTo=function(e,t){var n=this;if(void 0===t&&(t=5e3),e||!(t<-1)){var i,r;this._anchorIdToScroll=e;var o=-1!==t?new Promise(function(e){setTimeout(function(){e("timeout")},t)}):void 0,s=new Promise(function(e,t){i=function(){return e("execute")},r=function(){return t("cancel")}}),c=new a._QosMonitor("AnchorService");return{execute:i,cancel:r,scrollPromise:Promise.race([o,s]).then(function(e){return n._scroll().then(function(){"timeout"===e?c.writeExpectedFailure("TimeoutTriggerScroll"):c.writeSuccess()},function(t){c.writeUnexpectedFailure("FailedToScroll",t,{message:e})})}).catch(function(e){c.writeExpectedFailure("CancelScroll",e)})}}},e}()),d=n("cDcd"),l=n("KL1q"),u=n("y88i"),f=n("mGD9");function p(){return r._SPKillSwitch.isActivated("1e317b4a-e7e4-4631-b2f1-c5b256df32ab")}function m(){return r._SPKillSwitch.isActivated("21a5c693-298f-4811-bfa7-2bde29fa2a82")}n("jOlS").loadStyles(".a_a_1310c973{opacity:0;text-decoration:none;outline:none;position:absolute}.a_a_1310c973:focus,:focus>.a_a_1310c973,:hover>.a_a_1310c973{transition:.1s linear;opacity:1}[dir=ltr] .a_a_1310c973.b_a_1310c973{margin-left:5px}[dir=rtl] .a_a_1310c973.b_a_1310c973{margin-right:5px}.a_a_1310c973.b_a_1310c973 .c_a_1310c973{font-style:normal;padding:3px;line-height:1}.a_a_1310c973.b_a_1310c973:focus:not(:active) .c_a_1310c973{border:1px solid #605e5c}[dir=ltr] .a_a_1310c973:not(.b_a_1310c973) .c_a_1310c973{margin-left:8px}[dir=rtl] .a_a_1310c973:not(.b_a_1310c973) .c_a_1310c973{margin-right:8px}.c_a_1310c973{font-style:normal;font-weight:400;font-size:16px}",!0);var _=function(e){function t(){var n=null!==e&&e.apply(this,arguments)||this;return n.instanceId="4e00f196-1bdc-4f2a-8581-6075c77437c6",n._addAnchorIcon=function(e,t,a){if(p()||!n.props.hideAnchorIcon){var i=n._insertAnchorIcon(e);try{n._updateAnchorTargetAttributes(e,i,t,a)}catch(e){}}},n._insertAnchorIcon=function(e){var a,i=void 0;if(m()){for(var r=e.childElementCount,o=0;o<r;o++){var s=e.children[o];if(t._isElementAnchorIcon(s)){i=s;break}if("BR"===s.tagName){i=t._anchorIconElement,e.insertBefore(i,s);break}}i||(i=t._anchorIconElement,e.appendChild(i))}else{var c=e.nextElementSibling;if(c&&t._isElementAnchorIcon(c))i=c;else{i=t._anchorIconElement;var d=document.createElement("div");null===(a=e.parentElement)||void 0===a||a.insertBefore(d,e),d.appendChild(e),d.appendChild(i);var l=document.createElement("span");l.className="a_a_1310c973",n._insertElementToAnchoredElement(l,e),d.onmouseover=function(){i.style.left=l.offsetLeft+"px",i.style.top=l.offsetTop+"px"}}}return i},n._insertElementToAnchoredElement=function(e,t){for(var n=t.childElementCount,a=0;a<n;a++){var i=t.children[a];if("BR"===i.tagName)return void t.insertBefore(e,i)}t.appendChild(e)},n._updateAnchorTargetAttributes=function(e,t,n,i){var o=new u.Uri(window.location.href);o.setFragment(encodeURIComponent(n));var s=o.toString();e.setAttribute("id",n),t.setAttribute("role","link"),t.setAttribute("aria-label",r.Text.format(f.e,i)),t.setAttribute("data-sp-anchor-id",n),t.setAttribute("href",s),t.setAttribute("target","_self"),t.onclick=function(){a._EngagementLogger.logEvent("AnchorZone.ClickAnchor")}},n._removeAnchorIcon=function(e,n){e.lastElementChild&&t._isElementAnchorIcon(e.lastElementChild)&&e.removeChild(e.lastElementChild)},n}return Object(i.__extends)(t,e),Object.defineProperty(t,"_anchorIconElement",{get:function(){if(!t._anchorIconElementCache){var e=document.createElement("i");e.className=Object(l.css)("c_a_1310c973",Object(l.getIconClassName)("Link")),e.setAttribute("aria-hidden","true"),t._anchorIconElementCache=document.createElement("a"),t._anchorIconElementCache.classList.add("a_a_1310c973","b_a_1310c973"),t._anchorIconElementCache.appendChild(e)}return t._anchorIconElementCache.cloneNode(!0)},enumerable:!1,configurable:!0}),t._isElementAnchorIcon=function(e){return e.hasAttribute("data-sp-anchor-id")&&e.classList.contains("a_a_1310c973")},t._isInlineImageEnabled=function(){return r._SPFlight.isEnabled(60045)&&r._BrowserDetection.getBrowserInformation().browser!==r._Browser.IE},t.prototype.componentDidMount=function(){this._registerAnchors()},t.prototype.componentDidUpdate=function(){this._registerAnchors(!0)},t.prototype.componentWillUnmount=function(){this._unregister(this.props.componentId)},t.prototype.render=function(){return t._isInlineImageEnabled()?(this.props.elementForSearch&&this._registerAnchors(!0),d.createElement(d.Fragment,null)):d.createElement("div",{ref:this._resolveRef("_wrapperElement")},this.props.children)},t.prototype._registerAnchors=function(e){var n=this;void 0===e&&(e=!1);var a=t._isInlineImageEnabled()&&this.props.elementForSearch||this._wrapperElement;if(a){var i=[].slice.call(a.querySelectorAll(this.props.anchorElementSelector));this._register(this.props.componentId,e,i.map(function(e,t){var a=n.props.suggestAnchorId?n.props.suggestAnchorId(e,t):e.textContent||"";return{suggestedAnchorId:a,anchorTargetElement:e,onReceiveAnchorId:function(e,t){return n._addAnchorIcon(e,t,a)},onDisposeAnchorId:n._removeAnchorIcon}}))}},t.prototype._register=function(e,t,n){var a={action:t?"Refresh":"Register",uniqueId:e,anchorList:n};c.raiseAnchorEvent(a)},t.prototype._unregister=function(e){var t={action:"Unregister",uniqueId:e};c.raiseAnchorEvent(t)},t}(l.BaseComponent)},ut3N:function(e,t){e.exports=s},y88i:function(e,t){e.exports=c}})});