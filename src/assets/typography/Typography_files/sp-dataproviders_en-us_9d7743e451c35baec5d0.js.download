define("1cea229f-b208-4202-8014-22503d92a019_0.1.0",["tslib","@ms/sp-telemetry","@microsoft/sp-image-helper","@ms/odsp-core-bundle","@microsoft/office-ui-fabric-react-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@ms/i18n-utilities","@ms/sp-component-utilities","@microsoft/sp-diagnostics","@microsoft/sp-http","@ms/odsp-utilities-bundle"],function(n,a,i,r,o,s,c,d,l,u,f,p,m){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,d=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);d.length;)d.shift()()}var n={},a={0:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(e){var t=[],n=a[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,i){n=a[e]=[t,i]});t.push(n[2]=r);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"chunk."+({1:"sp-queryablemanagedproperties",2:"sp-retrievablemanagedproperties"}[e]||e)+"_"+"none"+"_"+{1:"88fb403f91a1ec2e33d5",2:"734d05237288f4daf526"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(d);var n=a[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+r+")",c.name="ChunkLoadError",c.type=i,c.request=r,n[1](c)}a[e]=void 0}};var d=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0=window.webpackJsonp_1cea229f_b208_4202_8014_22503d92a019_0_1_0||[],o=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var c=o;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-dataproviders_en-us_9d7743e451c35baec5d0\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"0Res":function(e,t,n){e.exports=n.p+"icon_helpitemimg1_c0dba21d.png"},"13jQ":function(e,t){},"17wl":function(e,t){e.exports=n},"2q6Q":function(e,t){e.exports=a},"6DSs":function(e){e.exports=JSON.parse('{"e":"Can\\u0027t get data. {0}: {1} REST call failed. Status Code: {2} Status Message: {3}"}')},"6ZIT":function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"n",function(){return o}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return l}),n.d(t,"c",function(){return c}),n.d(t,"r",function(){return f}),n.d(t,"e",function(){return i.BaseDataSource}),n.d(t,"o",function(){return i.ODataQueryStringBuilder}),n.d(t,"s",function(){return i.SPDataSource});var a=n("17wl"),i=n("jnk8"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getListsForWeb=function(e,t){return this.get(e,"/_api/web/lists",t,"ListDataSource","getListsForWeb",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t.prototype.getListFromWeb=function(e,t,n){return this.get(e,"/_api/web/lists(guid'"+t+"')",n,"ListDataSource","getListFromWeb").then(function(e){return e})},t.prototype.getDefaultDocumentLibrary=function(e,t){return this.get(e,"/_api/web/DefaultDocumentLibrary",t,"ListDataSource","getDefaultDocumentLibrary").then(function(e){return e})},t}(i.SPDataSource),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getFieldsForList=function(e,t,n){return this.get(e,"/_api/web/lists('"+t+"')/Fields",n,"ListFieldDataSource","getFieldsForList",{headers:{accept:"application/json;odata.metadata=none"}}).then(function(e){return e.value})},t}(i.SPDataSource),s={Integer:1,Text:2,DateTime:4,Counter:5,Choice:6,Boolean:8,Number:9,Currency:10,MultiChoice:15,User:20},c={None:0,ContextInfo:1,ListData:2,ListSchema:4},d=n("R/pT"),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.getItemsForList=function(e,t,n,a,i,r,o,s,l,u,f){if(!a&&!t&&!n)throw d.e;var p;void 0===i&&(i=c.None),o?(0===o.indexOf("?")&&(o=o.substring(1)),0!==o.indexOf("&")&&(o="&"+o)):o="",a?p="DefaultDocumentLibrary":(p="Lists",p+=t?"(guid'"+t+"')":"/GetByTitle('"+n+"')");var m="/_api/web/"+p+"/RenderListDataAsStream?"+(f?"View="+f:"")+o,_={parameters:{__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:i}},h=new Headers;return h.append("Content-Type","application/json;odata=verbose"),h.append("Accept","application/json;odata=nometadata"),h.append("OData-Version","3.0"),r&&(_.parameters.ViewXml=r),l&&(_.parameters.ImageFieldsToTryRewriteToCdnUrls=l),void 0!==u&&(_.parameters.AudienceTarget=u),this.post(e,m,"",JSON.stringify(_),"ListItemDataSource","getItemsForList",h,s).then(function(e){return e.ListData.Row})},t}(i.SPDataSource),u=n("hiL/"),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.__extends)(t,e),t.prototype.addView=function(e,t){var n="/_api/web/lists('"+t+"')/Views/Add",a=JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},PersonalView:!1}});return this.post(e,n,void 0,a,"ListViewDataSource","addView",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},t.prototype.updateViewXml=function(e,t,n,a){var i="/_api/web/lists('"+t+"')/views('"+n+"')/SetViewXml()",r=JSON.stringify({viewXml:a});return this.post(e,i,void 0,r,"ListViewDataSource","updateViewXml",{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}).then(function(e){return e.d})},Object(a.__decorate)([Object(u.monitor)("ListViewDataSource.addView")],t.prototype,"addView",null),Object(a.__decorate)([Object(u.monitor)("ListViewDataSource.updateViewXml")],t.prototype,"updateViewXml",null),t}(i.SPDataSource)},"8dK2":function(e,t){e.exports=i},"9G/9":function(e){e.exports=JSON.parse('{"e":"Search"}')},CWUF:function(e,t,n){"use strict";n("n1Om"),n("MMs3"),n("o7e7")},G9eg:function(e,t,n){e.exports=n.p+"icon_helpitemimg2-2x_5a055172.png"},JEu8:function(e,t,n){"use strict";n.r(t);var a=n("13jQ");for(var i in a)["default","SeeAllPageLayoutWebparts"].indexOf(i)<0&&function(e){n.d(t,e,function(){return a[e]})}(i);var r=n("urBa");n.d(t,"SeeAllPageLayoutWebparts",function(){return r.e})},K2W7:function(e,t,n){e.exports=n.p+"Modernize_News_a3fe9f83e59c20415da4c571d192296b.svg"},K9kD:function(e,t){e.exports=r},KL1q:function(e,t){e.exports=o},LJjX:function(e,t,n){e.exports=n.p+"icon_helpitemimg2_4dca3af9.png"},M8Mv:function(e,t){},MMs3:function(e,t){},Pk8u:function(e,t){e.exports=s},QRxg:function(e){e.exports=JSON.parse('{"e":"Page"}')},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},"R/pT":function(e){e.exports=JSON.parse('{"e":"Can\\u0027t get data. A list identifier or title must be specified."}')},RSuL:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("UWqr"),i=function(){function e(e){this._pageContext=e.pageContext}return e.prototype.buildUrl=function(e,t,n){var i=a.UrlUtilities.removeEndSlash(e),r=0===t.indexOf("/")?"":"/",o=t.indexOf("?")>-1?"&":"?";return""+i+r+t+(n?o+n:"")},Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),e}()},"S/19":function(e,t,n){"use strict";n.r(t);var a=n("rOX9");n.d(t,"SearchAPIRequest",function(){return a.e});var i=n("zDft");n.d(t,"SearchAPISortDirection",function(){return i.e});var r=n("Y4yO");for(var o in r)["default","SearchAPIRequest","SearchAPISortDirection"].indexOf(o)<0&&function(e){n.d(t,e,function(){return r[e]})}(o);var s=n("YDBy");for(var o in s)["default","SearchAPIRequest","SearchAPISortDirection"].indexOf(o)<0&&function(e){n.d(t,e,function(){return s[e]})}(o);var c=n("M8Mv");for(var o in c)["default","SearchAPIRequest","SearchAPISortDirection"].indexOf(o)<0&&function(e){n.d(t,e,function(){return c[e]})}(o)},UWqr:function(e,t){e.exports=c},"X+PM":function(e,t){e.exports=d},Y2xY:function(e,t,n){e.exports=n.p+"icon_helpitemimg3-2x_ef307bcc.png"},Y4yO:function(e,t){},YDBy:function(e,t){},Ycni:function(e,t){e.exports=l},YkpB:function(e){e.exports=JSON.parse('{"t":"List","e":"Invalid ListRequestType value."}')},"e+fh":function(e,t,n){"use strict";n.d(t,"e",function(){return b}),n.d(t,"t",function(){return u});var a=n("17wl"),i=n("KL1q"),r=n("ut3N"),o=n("hiL/"),s=n("vlQI"),c=n("UWqr"),d=n("X+PM"),l=n("y88i"),u=function(e){this.name="SPHomeMicroserviceNotAvailableError",this.message="SPHome Microservice not available in this environment",this.message=e||this.message},f=function(e){function t(t){var n=e.call(this,t)||this;return n._requestUpdater=function(e){return Promise.resolve(e)},n}return Object(a.__extends)(t,e),Object.defineProperty(t.prototype,"requestUpdater",{set:function(e){this._requestUpdater=e},enumerable:!1,configurable:!0}),t.prototype._fetch=function(t,n,a){var i=this;return this._requestUpdater({url:t,options:a}).then(function(t){return e.prototype._fetch.call(i,t.url,n,t.options)})},t}(s.SPHttpClient),p=c.ServiceKey.create("sp-http:SPHttpMicroserviceClient",f),m=n("nJGZ"),_=n("evK2"),h=new o.KillSwitch("0306551a-b040-4e46-ae3d-98f35375764b"),b=function(){function e(e){var t=this;this._isServiceAvailable=void 0,this._hasPrefetchedToken=!1,this._requestUpdater=function(e){return t._fetchTokenIfExpired().then(function(){return{url:t._generateUrlVersionedPath(e.url),options:t._getRequestOptions(e.options)}})},this._isPrefetchTokenFlightEnabled&&(this._initializeFromPrefetchedToken=new Promise(function(e,n){var a=new i.Async;window._spHomeClientContextLoaded=function(){a.dispose();var i=new r._QosMonitor("SpHomeClientContextPrefetch");try{t._initializeWithPrefetchedToken(),t._hasPrefetchedToken?i.writeSuccess():i.writeUnexpectedFailure("NoPrefetchedToken")}catch(e){i.writeUnexpectedFailure("Unexpected",e),n(e)}e()},a.setTimeout(function(){return!t._hasPrefetchedToken&&n(new Error("Timeout"))},1e4)})),this._stopUsingSPHttpMSClient=Object(_.i)(),e.whenFinished(function(){t._spHttpClient=e.consume(s.SPHttpClient.serviceKey),t._stopUsingSPHttpMSClient||(t._spHttpMicroserviceClient=e.consume(p),t._spHttpMicroserviceClient.requestUpdater=t._requestUpdater),t._httpClient=e.consume(s.HttpClient.serviceKey),t._pageContext=e.consume(d.PageContext.serviceKey),t._isPrefetchTokenFlightEnabled&&t._initializeWithPrefetchedToken(),t._isUserSupportedBySubstrate=t._isSubtrateSupportedUser(e.consume(d.PageContext.serviceKey).user)})}return e.prototype.get=function(e,t,n,a){return a?this._get(e,t,n,a):this._get_deprecated(e,t,n)},e.prototype.post=function(e,t,n,a,i){return i?this._post(e,t,n,a,i):this._post_deprecated(e,t,n,a)},Object.defineProperty(e.prototype,"isServiceAvailable",{get:function(){var e=this;return void 0!==this._isServiceAvailable?Promise.resolve(this._isServiceAvailable):this._fetchTokenIfExpired().then(function(){return e._isServiceAvailable=!0,e._isServiceAvailable}).catch(function(t){return e._isServiceAvailable=!1,e._isServiceAvailable})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUserSupportedBySubstrate",{get:function(){return this._isUserSupportedBySubstrate},enumerable:!1,configurable:!0}),e.prototype._get=function(e,t,n,a){var i=this;if(!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var r=this._generateVersionedPath(e,t);return this._spHttpMicroserviceClient.get(r,new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),this._getRequestOptions({},n),this._getCacheConfiguration(a,r))}return this._fetchTokenIfExpired().then(function(){return i._spHttpClient.get(i._generateUrl(e,t),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),i._getRequestOptions({},n),a)})},e.prototype._get_deprecated=function(e,t,n){var a=this;return this._fetchTokenIfExpired().then(function(){return h.isActivated()?a._httpClient.get(a._generateUrl(e,t),s.HttpClient.configurations.v1,a._getRequestOptions({},n)):a._spHttpClient.get(a._generateUrl(e,t),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),a._getRequestOptions({},n))})},e.prototype._post=function(e,t,n,a,i){var r=this;if(void 0===t&&(t=""),!this._stopUsingSPHttpMSClient&&this._spHttpMicroserviceClient){var o=this._generateVersionedPath(e,n);return this._spHttpMicroserviceClient.fetch(o,new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),this._getRequestOptions({body:t},a,"POST"),this._getCacheConfiguration(i,o))}return this._fetchTokenIfExpired().then(function(){return r._spHttpClient.fetch(r._generateUrl(e,n),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),r._getRequestOptions({body:t},a,"POST"),i)})},e.prototype._post_deprecated=function(e,t,n,a){var i=this;return void 0===t&&(t=""),this._fetchTokenIfExpired().then(function(){return h.isActivated()?i._httpClient.post(i._generateUrl(e,n),s.HttpClient.configurations.v1,i._getRequestOptions({body:t},a)):i._spHttpClient.post(i._generateUrl(e,n),new s.SPHttpClientConfiguration(s.HttpClient.configurations.v1,{}),i._getRequestOptions({body:t},a))})},e.prototype._getCacheConfiguration=function(e,t){return e&&(e.extraProps||(e.extraProps=new Map),e.extraProps.set(m.e.parentKeyOverride,t)),e},e.prototype._generateUrl=function(t,n){return void 0===n&&(n=1),c.Text.format(e.MICROSERVICE_ENDPOINT,this._url,n,t)},e.prototype._generateUrlVersionedPath=function(t){return c.Text.format(e.MICROSERVICE_ENDPOINT_V,this._url,t)},e.prototype._generateVersionedPath=function(t,n){return void 0===n&&(n=1),c.Text.format(e.VERSIONED_PATH,n,t)},e.prototype._isTokenValid=function(){return!!(this._tokenExpiry&&this._tokenExpiry>new Date)},e.prototype._getTokenAndMicroserviceDetails=function(){var e,t=this,n=new r._QosMonitor("SPHomeHttpClient"),a=this._pageContext.web.absoluteUrl+"/_api/sphomeservice/context?$expand=Token,Payload";return this._spHttpClient.get(a,s.SPHttpClient.configurations.v1).then(function(t){if(e=t.correlationId?t.correlationId.toString():void 0,t.ok)return t.json();var a=new Error(t.statusText);throw n.writeUnexpectedFailure("FailedResponse",a,{correlationId:e,Status:t.status}),a}).then(function(e){if(!e.Token||!e.Token.access_token)throw t._isServiceAvailable=!1,new u;t._isServiceAvailable=!0,t._token=e.Token.access_token,t._tokenExpiry=new Date(1e3*Number(e.Token.expires_on)-15e3),t._payload=e.Payload,t._url=e.Urls[0],t._alreadyGettingTokenPromise=void 0,n.writeSuccess()}).catch(function(a){throw a instanceof u?n.writeExpectedFailure("NotAvailable",a,{correlationId:e}):n.writeUnexpectedFailure("SPHomeHttpClient",a,{correlationId:e}),t._alreadyGettingTokenPromise=void 0,a})},e.prototype._getRequestOptions=function(e,t,n){var i;void 0===e&&(e={});var r={};this._token&&(r.Authorization="Bearer "+this._token),this._payload&&(r["SPHome-ApiContext"]=this._payload),r["Content-Type"]="application/json",r["SPHome-ClientType"]="PagesWeb",(null===(i=this._pageContext)||void 0===i?void 0:i.legacyPageContext)&&(r.FarmLabel=this._pageContext.legacyPageContext.farmLabel);var o=l.SPAlternativeUrls.tryGetAlternativeUrl("AFDCDNEnabled");return o&&(r["client-on-afd-spo"]=("True"===o).toString()),n&&(r["X-HTTP-Method"]=n,e.method=n),t&&t.forEach(function(e,t){r[t]=e}),Object(a.__assign)(Object(a.__assign)({},e),{headers:Object(a.__assign)(Object(a.__assign)({},e.headers||{}),r)})},e.prototype._initializeWithPrefetchedToken=function(){var e,t=new r._QosMonitor("InitializeSpHomeClientContext");try{if(!this._hasPrefetchedToken)if(window._spHomeClientContext&&window._spHomeClientContext!==[]){var n=window._spHomeClientContext,a=n.Token;this._token=null==a?void 0:a.AccessToken,this._payload=n.Payload,this._url=null===(e=n.Urls)||void 0===e?void 0:e[0],this._tokenExpiry=(null==a?void 0:a.ExpiresOn)?new Date(1e3*Number(a.ExpiresOn)-15e3):void 0,this._hasPrefetchedToken=!0,t.writeSuccess()}else window._spHomeClientContext===[]?t.writeUnexpectedFailure("SPHomeClientContextNotAvailable",new Error("EmptyTokenReturned")):t.writeExpectedFailure("SPHomeClientContextNotAvailable",new Error("TokenNotAvailable"))}catch(e){this._hasPrefetchedToken=!1,t.writeUnexpectedFailure("InitializeSPHomeClientContextFailed",e.message)}return this._hasPrefetchedToken},e.prototype._fetchTokenIfExpired=function(){if(this._isTokenValid())return Promise.resolve();if(!this._alreadyGettingTokenPromise)if(this._initializeFromPrefetchedToken){var e=c.Guid.parse("928806ac-3e49-4e4e-9114-7c392215230f"),t=c.Guid.parse("5ff931f9-8682-4614-b4f1-9b8d1aa74942"),n=[{raceablePromise:this._initializeFromPrefetchedToken,raceId:e},{raceablePromise:this._getTokenAndMicroserviceDetails(),raceId:t}];this._alreadyGettingTokenPromise=o.SmartRace.race(n).then(function(e){return e.raceablePromise}).catch(function(e){throw e})}else this._alreadyGettingTokenPromise=this._getTokenAndMicroserviceDetails();return this._alreadyGettingTokenPromise},Object.defineProperty(e.prototype,"_isPrefetchTokenFlightEnabled",{get:function(){return c._SPFlight.isEnabled(1265)},enumerable:!1,configurable:!0}),e.prototype._isSubtrateSupportedUser=function(e){if(e){var t=e.isAnonymousGuestUser,n=e.isExternalGuestUser;return!t&&!n}return!0},e.serviceKey=c.ServiceKey.create("sp-component-utilities:SPHomeHttpClient",e),e.MICROSERVICE_ENDPOINT="{0}/api/v{1}/{2}",e.MICROSERVICE_ENDPOINT_V="{0}/api/{1}",e.VERSIONED_PATH="v{0}/{1}",e}()},evK2:function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"t",function(){return s}),n.d(t,"n",function(){return c});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("14b96c7e-3dcc-42e8-8a42-f56091d1f9f3")}function r(){return a._SPKillSwitch.isActivated("83c7fd57-b124-44b5-98c9-19fbfa5e8826")}function o(){return a._SPKillSwitch.isActivated("ac52d2d0-e041-4af4-9eaa-addeba264ba3")}function s(){return a._SPKillSwitch.isActivated("877ec1e9-752d-4af4-a970-5c22c24339cc")}function c(){return a._SPKillSwitch.isActivated("e7a8878e-98e5-447b-b462-bcbb1df03ac8")}},fP0x:function(e){e.exports=JSON.parse('{"t":"Unknown error happens.","e":"This Events list no longer exists. Try a different Events list."}')},g9eu:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("y88i"),i=function(){function e(){}return e.generateQueryString=function(e){var t=e.fields?e.fields.map(function(e){return a.UriEncoding.encodeURIComponent(e)}).join(","):void 0,n=new URLSearchParams(e.queryString);function i(e,t){var a="$"+e;t&&!n.has(a)&&n.set(a,t.toString())}return i("select",t),i("filter",e.filter),i("top",e.top),i("skip",e.skip),i("orderby",e.orderBy),i("expand",e.expand),n.toString()},e}()},hE4m:function(e){e.exports=JSON.parse('{"p":"Keep your team updated with news on your team site","f":"From the site home page you\\u0027ll be able to quickly author a news post â€“ a status update, trip report, or even just highlight a document with some additional context provided to the team.","m":"https://go.microsoft.com/fwlink/p/?linkid=827920","h":"What is a team site?","_":"A SharePoint team site connects you and your team to the content, information, and apps you rely on every day. For example, you can use a team site to store and collaborate on files or to create and manage lists of information. On a team site home page, you can view links to important team files, apps, and web pages and see recent site activity in the activity feed.","b":"https://go.microsoft.com/fwlink/p/?linkid=827918","v":"Add a page to a site","g":"Using pages is a great way to share ideas using images, Excel, Word and PowerPoint documents, video, and more. You can create and publish pages quickly and easily, and they look great on any device. When you create a page, you add and customize web parts with a toolbox available right in the editing pane. And, you can publish with just a click.","y":"https://go.microsoft.com/fwlink/p/?linkid=827919","I":"Welcome to the new team site experience","D":"Quickly author a new news post, a status update, or a trip report on the new team site home page.","S":"SharePoint","w":"News","x":"Hub News","O":"My News","C":"Multi-site News","n":"Create a news post","i":"No news posts are available right now","t":"Keep your audience engaged by sharing your latest updates.","a":"Check back later to see the latest News.","l":"Title of news post","d":"Preview that shows the first few lines of the article.","c":"Author name","u":"A few seconds ago","e":"Automatic","r":"Build successful portals","o":"Modern SharePoint branding","s":"SharePoint News reaches more users"}')},"hiL/":function(e,t){e.exports=u},j2UY:function(e,t,n){e.exports=n.p+"icon_helpitemimg1-2x_296a0ca6.png"},jnk8:function(e,t,n){"use strict";var a=n("RSuL");n.d(t,"BaseDataSource",function(){return a.e});var i=n("ukKy");n.d(t,"SPDataSource",function(){return i.e});var r=n("g9eu");n.d(t,"ODataQueryStringBuilder",function(){return r.e}),n("CWUF")},jrLr:function(e,t,n){"use strict";n.d(t,"t",function(){return o}),n.d(t,"a",function(){return d}),n.d(t,"U",function(){return C}),n.d(t,"de",function(){return O}),n.d(t,"_e",function(){return w}),n.d(t,"re",function(){return E}),n.d(t,"oe",function(){return A}),n.d(t,"ue",function(){return L}),n.d(t,"se",function(){return k}),n.d(t,"ce",function(){return M}),n.d(t,"pe",function(){return P}),n.d(t,"L",function(){return m}),n.d(t,"le",function(){return _}),n.d(t,"te",function(){return h}),n.d(t,"ne",function(){return b}),n.d(t,"ae",function(){return g}),n.d(t,"P",function(){return S}),n.d(t,"b",function(){return j}),n.d(t,"S",function(){return Q}),n.d(t,"O",function(){return K}),n.d(t,"A",function(){return ee}),n.d(t,"k",function(){return te}),n.d(t,"M",function(){return ne}),n.d(t,"T",function(){return ve}),n.d(t,"w",function(){return ye}),n.d(t,"E",function(){return Ie}),n.d(t,"me",function(){return D}),n.d(t,"p",function(){return se}),n.d(t,"g",function(){return ce}),n.d(t,"v",function(){return de}),n.d(t,"y",function(){return le}),n.d(t,"$",function(){return pe}),n.d(t,"J",function(){return me}),n.d(t,"Y",function(){return z.e}),n.d(t,"r",function(){return re}),n.d(t,"s",function(){return oe}),n.d(t,"l",function(){return xe}),n.d(t,"D",function(){return he}),n.d(t,"e",function(){return _e}),n.d(t,"C",function(){return ue.e}),n.d(t,"V",function(){return fe}),n.d(t,"j",function(){return ge}),n.d(t,"N",function(){return Ce}),n.d(t,"fe",function(){return Oe}),n.d(t,"i",function(){return Ee}),n.d(t,"x",function(){return Ae}),n.d(t,"I",function(){return Me}),n.d(t,"o",function(){return Pe}),n.d(t,"m",function(){return Xe}),n.d(t,"h",function(){return Ze}),n.d(t,"_",function(){return et}),n.d(t,"F",function(){return at}),n.d(t,"H",function(){return tt}),n.d(t,"ie",function(){return it}),n.d(t,"R",function(){return st}),n.d(t,"G",function(){return ct}),n.d(t,"Q",function(){return dt}),n.d(t,"q",function(){return lt}),n.d(t,"d",function(){return ut}),n.d(t,"f",function(){return ft}),n.d(t,"z",function(){return pt}),n.d(t,"W",function(){return mt}),n.d(t,"K",function(){return _t}),n.d(t,"c",function(){return ht}),n.d(t,"u",function(){return bt}),n.d(t,"B",function(){return gt}),n.d(t,"n",function(){return vt}),n.d(t,"X",function(){return Et}),n.d(t,"Z",function(){return Ct}),n.d(t,"ee",function(){return N});var a=n("X+PM"),i=n("vlQI"),r=n("UWqr"),o=function(){function e(e){return this._options=e,this._serviceScope=e.serviceScope,this}return e.prototype.requestData=function(e){var t=this;return this.resolveServices().then(function(){return t.getItems(e)})},e.prototype.resolveServices=function(){var e=this;return new Promise(function(t,n){e._serviceScope.whenFinished(function(){e._pageContext=e._serviceScope.consume(a.PageContext.serviceKey),e._baseEndPoint=r.UrlUtilities.removeEndSlash(e._pageContext.web.absoluteUrl),e._options.useHttpClient?e._httpClient=e._serviceScope.consume(i.HttpClient.serviceKey):e._spHttpClient=e._serviceScope.consume(i.SPHttpClient.serviceKey),e._options.requiresTokenProvider&&(e._tokenProvider=e._serviceScope.consume(i.OAuthTokenProvider.serviceKey)),t()})})},Object.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"httpClient",{get:function(){return this._httpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"spHttpClient",{get:function(){return this._spHttpClient},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this._pageContext},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tokenProvider",{get:function(){return this._tokenProvider},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"baseEndPoint",{get:function(){return this._baseEndPoint},enumerable:!1,configurable:!0}),e}(),s=n("ut3N"),c=n("e+fh"),d=function(){function e(e,t){var n=this;this._qosComponentName=e,t.whenFinished(function(){n._spHomeHttpClient=t.consume(c.e.serviceKey)})}return e.prototype.addBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+".AddBookmark"),n=e;return this._spHomeHttpClient.post("documents/followed/add",JSON.stringify(n)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("AddBookmark"),!1})},e.prototype.removeBookmark=function(e){var t=new s._QosMonitor(this._qosComponentName+".RemoveBookmark"),n=decodeURI(e);return this._spHomeHttpClient.post("documents/followed/remove",JSON.stringify(n)).then(function(e){return e.ok}).then(function(e){return t.writeSuccess(),e}).catch(function(e){return t.writeUnexpectedFailure("RemoveBookmark"),!1})},e.prototype.isBookmarked=function(e){var t=new s._QosMonitor(this._qosComponentName+".IsBookmarked");return this._spHomeHttpClient.isUserSupportedBySubstrate?this._isBookmarkedRequest(e).then(function(e){return t.writeSuccess(),e.json()}).then(function(e){return e.SavedForLater}).catch(function(e){return t.writeUnexpectedFailure("IsBookmarked"),!1}):(t.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve(!1))},e.prototype._isBookmarkedRequest=function(e){var t="document/metadata?siteId="+e.siteId+"&webId="+e.webId+"&listId="+e.listId+"&uniqueId="+e.listItemUniqueId+"&url="+e.url+(e.groupId?"&groupId="+e.groupId:"");return this._spHomeHttpClient.get(t)},e}(),l=n("8dK2"),u=n("y88i"),f=n("QVYh"),p=n("hiL/"),m={CurrentSite:1,Hub:2,ChooseSites:3,MyNews:4},_="newsDataSourceProp";function h(e){return e.audienceTargetingEnabled?"&filterByAudience=true":""}function b(e,t){void 0===t&&(t=!1);var n=e.languageOverride;return n?t?"&languageOverride='"+n+"'":"&languageOverride="+n:""}function g(e,t){var n="noFilter";e.serializedFilterQuery?n="filterCAMLQueryAdded":e.filterKQLQuery&&(n="filterKQLQueryAdded");var a={audienceTargetingEnabled:(!!e.audienceTargetingEnabled).toString(),isOnSeeAllPage:C.isOnSeeAllPage.toString(),isAdvanceMode:(!!e.languageOverride).toString(),alias:n};return t&&t.legacyPageContext&&t.legacyPageContext.isHubSite&&(a.service="HubSite"),a}var v=n("hE4m"),y=function(){function e(){}return e.getIconUrl=function(t){if(t===e._modernizedImageKey&&!e._assetIconsMap[this._modernizedImageKey]){var a=n("K2W7");e._assetIconsMap[this._modernizedImageKey]=[a,a]}var i=e._assetIconsMap[t];return i[window.devicePixelRatio>=2&&i.length>=2?1:0]},e._assetIconsMap={HelpImg1:[n("0Res"),n("j2UY")],HelpImg2:[n("LJjX"),n("G9eg")],HelpImg3:[n("mBwh"),n("Y2xY")]},e._modernizedImageKey="HelpImgModern",e}(),S={None:0,TeamSite:1,CommSite:2,Carousel:3};function D(e,t,n){if(e&&t&&n.legacyPageContext&&n.legacyPageContext.organizationNewsSiteReference){var a=r.Guid.tryParse(e),i=r.Guid.tryParse(t);if(a&&i&&n.legacyPageContext.organizationNewsSiteReference)for(var o=0,s=n.legacyPageContext.organizationNewsSiteReference;o<s.length;o++){var c=s[o];if(I(a,i,c))return c}}}function I(e,t,n){var a=r.Guid.tryParse(n.SiteId),i=r.Guid.tryParse(n.WebId);return!!(a&&i&&e.equals(a)&&t.equals(i))}var x=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},C=function(){function e(){}return e._isHaukShadowcallsKillSwitchActivated=function(){return r._SPKillSwitch.isActivated("79c0fa86-b3e9-44e2-988d-d3990317c384")},e.cacheViewCountsValue=function(t,n,a){var i=e.viewCountsDictionary[t+"/"+n];(void 0===i||i<a)&&(e.viewCountsDictionary[t+"/"+n]=a)},e._internalGetTeamSiteHelpItems=function(t,n){var i=void 0!==t&&t<=3?t:3,r=[],o=!1;n&&n.whenFinished(function(){var e=n.consume(a.PageContext.serviceKey);o=e.legacyPageContext.IsHomepageModernized});for(var s=[{description:o?v.D:v.f,title:o?v.I:v.p,url:o?e._mdrnHelpUrl:v.m},{description:v._,title:v.h,url:v.b},{description:v.g,title:v.v,url:v.y}],c=0;c<i;c++){var d="f7752afa-9c69-49c8-bc62-5b5b35d01775",l=o&&0===c?"Modern":""+(c+1);r.push({author:v.S,authorInitial:"SP",authorAccountName:"",description:s[c].description,email:"",image:y.getIconUrl("HelpImg"+l),publishedOn:new Date,publishedOnRelativeTime:"",title:s[c].title,url:s[c].url,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:d,siteId:d,webId:d})}return r},e.isValidNewsSource=function(e){return e===m.CurrentSite||e===m.Hub||e===m.ChooseSites||e===m.MyNews},e.getEmptyStateItems=function(t,n,a,i){switch(t){case S.CommSite:return e.getCommSiteHelpArticles(a);case S.TeamSite:return e._internalGetTeamSiteHelpItems(a,n);case S.Carousel:return e.getEmptyCarouselItems(a,i);default:return[]}},e.getCommSiteHelpArticles=function(e){for(var t=void 0!==e&&e<=3?e:3,n=[],a=0;a<t;a++){var i=r.Guid.newGuid().toString();n.push({author:v.c,authorAccountName:"",description:v.d,email:"",image:"",publishedOn:void 0,publishedOnRelativeTime:v.u,title:v.l,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:i,siteId:i,webId:i})}return n},e.getEmptyCarouselItems=function(e,t){for(var n=void 0!==e&&e<=3?e:3,a=[],i=[v.r,v.o,v.s],o=0;o<n;o++){var s=r.Guid.newGuid().toString(),c=p.DefaultImageHelper.getDefaultNewsCarouselImageById(o);c=l._ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:c,spResource:c,width:t,callerId:"EmptyCarouselItems"}),a.push({author:"",authorAccountName:"",description:"",email:"",image:c,publishedOn:void 0,publishedOnRelativeTime:"",title:i[o],url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:s,siteId:s,webId:s})}return a},Object.defineProperty(e,"autofillItem",{get:function(){var e=r.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:"",image:"",publishedOn:void 0,publishedOnRelativeTime:v.u,title:v.e,url:void 0,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:e,siteId:e,webId:e}},enumerable:!1,configurable:!0}),e.getTipActionNewsItem=function(e,t){var n=r.Guid.newGuid().toString();return{author:"",authorAccountName:"",description:e?v.t:v.a,image:"",isContributorActionCard:e,publishedOn:void 0,publishedOnRelativeTime:"",title:e?v.n:v.i,url:e?u.Uri.concatenate(t,"/_layouts/15/CreateSitePage.aspx?source=")+u.UriEncoding.encodeURIComponent(window.location.pathname)+"&promotedState=1":v.m,listItemId:"",viewCounts:void 0,isHelpArticle:!0,uniqueId:n,siteId:n,webId:n}},e.extractNewsItemsFromSearch=function(t,n){return t.map(function(t){var a=t.SiteID?r.Guid.parse(t.SiteID).toString():void 0,i=t.WebId?r.Guid.parse(t.WebId).toString():void 0,o=t.ListId?r.Guid.parse(t.ListId).toString():void 0,s=t.UniqueID?r.Guid.parse(t.UniqueID).toString():void 0,c=t.ViewCountLifetime,d="number"==typeof c?c:void 0,l=D(a,i,n),u=t.SPWebUrl,f=e._handleDefaultBanner(t.PictureThumbnailURL);return{author:e._getUserDisplayNameFromSearch(t.CreatedBy),authorAccountName:t.AuthorOWSUSER,description:t.Description||"",email:e._getAuthorEmail(t.AuthorOWSUSER),isAuthoritative:!!l,image:f||"",publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:e.encodeSegments(t.Path),listItemId:t.ListItemId,originalSourceItemId:void 0,originalSourceUrl:e.encodeSegments(t.OriginalPath),path:t.Path,siteTitle:e._getSiteTitle(t,a,i,n),siteUrl:u,viewCounts:d,isHelpArticle:!1,uniqueId:s,siteId:a,webId:i,listId:o}})},e.extractNewsItems=function(t,n){var a=this;return t.map(function(t){var i,o,s,c,d,l=function(e){return r.Guid.parse(e).toString()},f=t.SiteID?l(t.SiteID):n.site.id.toString(),p=t.WebId?l(t.WebId):n.web.id.toString(),m=t.ListId?l(t.ListId):null===(o=null===(i=n.list)||void 0===i?void 0:i.id)||void 0===o?void 0:o.toString(),_=t.UniqueId?l(t.UniqueId):null===(c=null===(s=n.listItem)||void 0===s?void 0:s.id)||void 0===c?void 0:c.toString(),h=D(f,p,n),b=t.BannerImageUrl,g=t.BannerThumbnailUrl;d=r._SPFlight.isEnabled(1047)&&b&&b.toUpperCase().indexOf("/_LAYOUTS/IMAGES/")>-1?e._handleDefaultBanner(b):e._handleDefaultBanner(g||b);var v=!a._isUseRedirectPageUrlKillSwitchActivated()&&n.web&&n.web.absoluteUrl&&t.Path&&t.Path.DecodedUrl?u.Uri.concatenate(n.web.absoluteUrl,"/",t.Path.DecodedUrl):t.AbsoluteUrl;return{author:t.CreatedBy.Name,authorAccountName:t.CreatedBy.AccountName,description:t.Description?t.Description:"",email:e._getAuthorEmail(t.CreatedBy.AccountName),isAuthoritative:!!h,image:d||"",publishedOn:new Date(t.FirstPublished),publishedOnRelativeTime:"",title:t.Title||t.FileName,url:e.encodeSegments(v),listItemId:t.Id,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:e.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,siteTitle:h?e._getSiteTitle(t,f,p,n):void 0,siteUrl:n.web.absoluteUrl,viewCounts:void 0,isHelpArticle:!1,uniqueId:_,siteId:f,webId:p,listId:m}})},e.extractMicroserviceNewsItems=function(t,n,a){return t.map(function(t){var i,o,s,c=t.Site&&t.Site.ItemReference,d=t.Library,l=r.Guid.tryParse(c&&c.SiteId);i=(null==l?void 0:l.toString())||(a?n.site.id.toString():void 0);var u=r.Guid.tryParse(c&&c.WebId);o=(null==u?void 0:u.toString())||(a?n.web.id.toString():void 0);var f=r.Guid.tryParse(d&&d.ListId);s=f&&f.toString();var p=t.UniqueId?r.Guid.parse(t.UniqueId).toString():void 0,m=D(i,o,n),_=t.Site&&t.Site.Url?t.Site.Url:t.SiteUrl||n.site.absoluteUrl,h=e._handleDefaultBanner(t.ImageUrl);return{author:t.Author&&t.Author.Title?t.Author.Title:"",authorAccountName:t.Author&&t.Author.AccountName?t.Author.AccountName:"",description:t.Description,email:e._getAuthorEmail(t.Author&&t.Author.AccountName?t.Author.AccountName:""),isAuthoritative:t.IsAuthoritativeNews||!!m,image:h||"",publishedOn:new Date(t.FirstPublishedDate),publishedOnRelativeTime:"",title:t.Title,url:e.encodeSegments(t.Url),viewCounts:void 0,isHelpArticle:!1,siteTitle:e._getSiteTitle(t,i,o,n),siteUrl:_,listItemId:t.ListItemId,originalSourceItemId:t.OriginalSourceItemId,originalSourceUrl:e.encodeSegments(t.OriginalSourceUrl),path:t.Path&&t.Path.DecodedUrl,uniqueId:p,siteId:i,webId:o,listId:s}})},e.extractVroomNewsItems=function(t,n){return t.map(function(t){var a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v=(null===(a=t.sharepointIds)||void 0===a?void 0:a.siteUrl)||n.site.absoluteUrl,y=(null===(i=t.sharepointIds)||void 0===i?void 0:i.siteId)||n.site.id.toString(),S=(null===(r=t.sharepointIds)||void 0===r?void 0:r.webId)||n.web.id.toString(),I=D(y,S,n),x=t.thumbnails?t.thumbnails[0]:void 0,C=x?e._handleDefaultBanner(x.source.url):void 0;return{author:(null===(s=null===(o=t.createdBy)||void 0===o?void 0:o.user)||void 0===s?void 0:s.displayName)||"",authorAccountName:"",description:t.description,email:null===(d=null===(c=t.createdBy)||void 0===c?void 0:c.user)||void 0===d?void 0:d.email,isAuthoritative:!!I,image:C||"",publishedOn:new Date(t.firstPublishedDate),publishedOnRelativeTime:"",title:t.title,url:e.encodeSegments(t.webUrl),viewCounts:null===(f=null===(u=null===(l=t.analytics)||void 0===l?void 0:l.allTime)||void 0===u?void 0:u.access)||void 0===f?void 0:f.actionCount,isHelpArticle:!1,siteTitle:(null===(p=t.parentReference)||void 0===p?void 0:p.siteTitle)||e._getSiteTitle(t,y,S,n),siteUrl:v,listItemId:null===(m=t.sharepointIds)||void 0===m?void 0:m.listItemId,originalSourceItemId:null===(_=t.originalSourceIds)||void 0===_?void 0:_.listItemUniqueId,originalSourceUrl:e.encodeSegments(null===(h=t.originalSourceIds)||void 0===h?void 0:h.url),uniqueId:null===(b=t.sharepointIds)||void 0===b?void 0:b.listItemUniqueId,siteId:y,webId:S,listId:null===(g=t.sharepointIds)||void 0===g?void 0:g.listId}})},e.processBannerImageUrlPart=function(t,n,a,i,r,o,c){try{return e._processBannerImageUrlPartCore(t,n,a,i,r,o,c)}catch(e){var d={defaultUniqueId:n,imageWidth:i};return r&&(d.siteId=r),o&&(d.webId=r),new s._QosMonitor("News.processBannerImageUrlPart").writeExpectedFailure("UrlError",e,d),""}},e.getResourceFromPrivateCDNUrl=function(e){return l._ThumbnailUrlGenerator.getThumbnailProvider(e)===l._ThumbnailProviderType.PrivateCDN&&(e=(e="https:/"+new l._SPResourcePath(e).path).split("?")[0]),e},e.isPrefetchStale=function(e){return void 0!==this._initialUrl||(this._initialUrl=e,!1)},e.extractParamFromUrl=function(e,t){var n=new RegExp("[?&]"+e+"=([^?&]+)(&|$)").exec(t);return n?decodeURIComponent(n[1]):void 0},e.isNewsItemInList=function(t,n){return!(!t||!n)&&t.some(function(t,a){return t&&e.getNewsItemKey(t,""+a)===e.getNewsItemKey(n,""+a)})},e.getPaddingCount=function(e,t){var n=0;return e.emptyItemType&&(n=e.count-t,n=e.emptyItemsCount?Math.min(e.emptyItemsCount,n):n),n},e.hasSameSetOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;var n=!0;return e.every(function(e){return n=n&&t.some(function(t){return e.url===t.url})}),n},e.hasSameOrderOfPosts=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0},e.removeQueryParam=function(e,t){if(e&&t){var n=new u.Uri(e);return n.removeQueryParameter(t),n.toString()}return e},e.didRenderedPropertiesChange=function(e,t){return e&&t&&(e.description!==t.description||e.image!==t.image||e.title!==t.title)},e.getNewsItemKey=function(e,t){return e.isHelpArticle?t:e.siteId+"-"+e.webId+"-"+e.listId+"-"+e.uniqueId},Object.defineProperty(e,"isOnSeeAllPage",{get:function(){var e=new u.Uri(window.location.href);return u.StringHelper.doesStringEndWith(e.getPath(!0).toLowerCase(),"/_layouts/15/news.aspx")},enumerable:!1,configurable:!0}),e.getFilterQueryBody=function(e){return void 0===e&&(e=""),JSON.stringify(e)},e.encodeSegments=function(e){if(!e)return e;var t="/"===e.substring(e.length-1)?"/":"",n=new l._SPResourcePath(e);if(!n.authority&&!n.domain)return e;var a=new RegExp(".+.aspx"),i=new RegExp("^(?:[^%]|%[0-9A-Fa-f]{2})+$"),r=n.segments.filter(function(e){return!!e}).map(function(e){try{var t=a.exec(i.test(e)?decodeURIComponent(e):e);if(t){var n=t[0];return e.replace(a,encodeURIComponent(n))}return e}catch(t){return e}});return u.Uri.concatenate.apply(u.Uri,[n.authority].concat(r))+t+n.searchParamString},e._shouldDeprecateDocViz=function(){return l._ThumbnailUrlGenerator.isVROOMThumbnailEnabled()},e._getSiteTitle=function(e,t,n,a){var i=e.SiteTitle;if(!i){var o=r.Guid.tryParse(t),s=r.Guid.tryParse(n);(null==o?void 0:o.equals(a.site.id))&&(null==s?void 0:s.equals(a.web.id))&&(i=a.web.title)}return i},e._getUserDisplayNameFromSearch=function(e){var t=e,n=null==e?void 0:e.split("|");return n&&n.length>1&&(t=n[1]),t||""},e._handleDefaultBanner=function(t){return e._isDefaultBannerImage(t)?"":t},e._extractImageFromBanner=function(e){var t=e.split(", ");return t[t.length>1?1:0].trim()},e._isDefaultBannerImage=function(t){return!t||u.StringHelper.doesStringEndWith(e._extractImageFromBanner(t),"/images/sitepagethumbnail.png")},e._isUseRedirectPageUrlKillSwitchActivated=function(){return r._SPKillSwitch.isActivated("5a9dc530-5eb2-4032-b8b9-b6d4222ad8ad")},e._processBannerImageUrlPartCore=function(t,n,a,i,r,o,c){var d=e._extractImageFromBanner(t),m=c||a.web.absoluteUrl,_=e._tryGetExternalBanner(a,d,"newsProcessBannerImageUrl:");if(_)return _;if(e._isDefaultBannerImage(d))return"";var h=l._ThumbnailUrlGenerator.getThumbnailProvider(d);h!==l._ThumbnailProviderType.PrivateCDN||Object(f.isAlterantiveUrlFresh)(d)||(d=(d="https:/"+new l._SPResourcePath(d).path).split("?")[0],h=l._ThumbnailProviderType.Original);var b=new l._SPResourcePath(d),g=b.path.toLowerCase();if(h===l._ThumbnailProviderType.Stock)return d;if(h===l._ThumbnailProviderType.VROOMMeTACache||h===l._ThumbnailProviderType.PrivateCDN||h===l._ThumbnailProviderType.PublicCDN||h===l._ThumbnailProviderType.MeTA)return l._ThumbnailUrlGenerator.updateThumbnailWidth(d,i);if(h===l._ThumbnailProviderType.DocViz){if(s._TraceLogger.logVerbose(e._logSource,"newsProcessBannerImageUrl: already from GetPreview"),e._shouldDeprecateDocViz()){var v=l._ThumbnailUrlGenerator.fromGetPreview(d,"newsProcessBannerImageUrl",i);if(v)return v}var y=l._PreviewUtility.normalizeWidthToResolution(i),S=new u.Uri(d);return S.setQueryParameter(l._PreviewHelper.RESOLUTION,y.toString()),S.toString()}var D=h!==l._ThumbnailProviderType.SharePointHost&&h!==l._ThumbnailProviderType.MySite;if(h!==l._ThumbnailProviderType.Unknown&&D)return l._ThumbnailUrlGenerator.updateThumbnailWidth(d,i);var I={absoluteUrl:b.authority||m,fileType:l._PreviewUtility.getFileExtension(b),spResource:g,width:i,callerId:"newsProcessBannerImageUrl"};return l._ThumbnailUrlGenerator.getThumbnailUrl(I,p.DefaultImageHelper.getDefaultImage(b))},e._tryGetExternalBanner=function(t,n,a){var i=new l._SPResourcePath(n),r="";if(i&&(r=i.authority),r&&!p.UrlUtility.isInternalResource(n,t))return s._TraceLogger.logVerbose(e._logSource,a+" external host"),n},e._getAuthorEmail=function(e){var t;if(e){var n=e.split("|");t=n[n.length-1]}return t},e.aliasPrefix="FirstParty_NewsWebPart_",e.viewCountsDictionary={},e._logSource=s._LogSource.create("NewsUtilities"),e._mdrnHelpUrl=" https://go.microsoft.com/fwlink/?linkid=2103711",e}(),O="news",w="viewCounts",E="currentViewCounts",A="hubNews",L="newsDigest",k="multiSiteNews",M="myNews",P="staleViewCounts",T=n("2q6Q");function U(e,t){return!(r._BrowserDetection.getBrowserInformation().browser!==r._Browser.IE&&!t||!e)}function F(e,t){return t?H(e)?"ThrottledResponse":"ResponseNotOk":"AzureFrontDoorHeadersMissing"}function H(e){return 429===e||503===e}var R,N=function(){function e(e){var t=this;e.whenFinished(function(){t._sphomeHttpClient=e.consume(c.e.serviceKey)})}return e.prototype.getViewCounts=function(e){var t=this;if(0===e.length)return Promise.resolve([]);var n=new T._QosMonitor("ExchangeViewCountsFetch");if(!this._sphomeHttpClient.isUserSupportedBySubstrate)return n.writeExpectedFailure("SubstrateUnsupportedUser"),Promise.resolve([]);var a=this._requestForItem(e);return this._sphomeHttpClient.post("documents/metadata",JSON.stringify(a)).then(function(e){if(e.ok)return e.json();var t=function(e){var t=e.headers.get("MS-CV"),n=U(t,e.url);return{MSCV:t,responseStatus:e.status.toString(),errorCode:F(e.status,n)}}(e),a=t.errorCode,i=new Error(a);throw n.writeUnexpectedFailure(a,i,t),i}).then(function(a){return n.writeSuccess(),e.map(function(e){return t._addMicroserviceViewCount(e,a.Items)})}).catch(function(e){return n.hasEnded||n.writeUnexpectedFailure("ExchangeViewCountsFetchSearchFallback",e),[]})},e.prototype._addMicroserviceViewCount=function(e,t){var n=this,a=t.filter(function(t){return n._guidEquals(t.Site.ItemReference.SiteId,e.siteId)&&n._guidEquals(t.Site.ItemReference.WebId,e.webId)&&n._guidEquals(t.UniqueId,e.uniqueId)})[0];return a&&void 0!==a.Views&&(e.viewCount=a.Views),e},e.prototype._guidEquals=function(e,t){var n=r.Guid.tryParse(e),a=r.Guid.tryParse(t);return!(!n||!a)&&n.equals(a)},e.prototype._requestForItem=function(e){return[].concat.apply([],e.map(function(e){return[{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"},{Site:{ItemReference:{SiteId:e.siteId,WebId:e.webId,Type:"GroupReference"},Type:"Site"},Library:{ListId:e.listId,Type:"Library"},UniqueId:e.uniqueId,Type:"Document"}]}))},e.serviceKey=r.ServiceKey.create("sp-dataproviders:ViewCountDataProvider",e),e}(),B=n("Pk8u"),j=function(){function e(e){var t=this;this.id="ExchangeViewCounts",this.title="",this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._viewCountDataSource=t.options.serviceScope.consume(N.serviceKey)})}return e._getViewCountFromCacheIfAvailable=function(e){this._viewCountCache.hasOwnProperty(e.uniqueId)&&(e.viewCounts=this._viewCountCache[e.uniqueId])},e._cacheViewCounts=function(e){var t=this;e.forEach(function(e){void 0!==e.uniqueId&&(t._viewCountCache[e.uniqueId]=e.viewCounts)})},e.prototype.requestData=function(e){var t=Object(B.chunk)(e,10);return Promise.all(t.map(this._createRequestForItems.bind(this))).then(function(){return e})},e.prototype._addViewCountsToItems=function(e,t){return e.filter(this._needsViewCount).map(function(e){var n=t.filter(function(t){return t.uniqueId===e.uniqueId||t.siteId===e.siteId&&t.webId===e.webId&&t.listItemId===Number(e.listItemId)})[0];return e.viewCounts=void 0!==n?Number(n.viewCount):void 0,e})},e.prototype._createRequestForItems=function(t){var n=this;return this._viewCountDataSource.getViewCounts(this._buildRequest(t)).then(function(a){return t=n._addViewCountsToItems(t,a),e._cacheViewCounts(t),t})},e.prototype._buildRequest=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return e.filter(this._needsViewCount).map(function(e){return{listItemId:Number(e.listItemId)||0,uniqueId:e.uniqueId,siteId:e.siteId||t,webId:e.webId||n,listId:e.listId}})},e.prototype._needsViewCount=function(t){e._getViewCountFromCacheIfAvailable(t);var n=t.viewCounts;return null==n||"number"!=typeof n},e._viewCountCache={},e}(),V=n("17wl"),z=n("nJGZ"),G=n("evK2"),K=function(){function e(e){var t=this;this._maxRetryCount=3,this.parsedResponseCount=0,this.canCompare=!1,this._extraData={},this._retryCount=0,this._processMicroserviceServiceResponse=function(e,n,a){var i;if(C._isHaukShadowcallsKillSwitchActivated())i=e;else{t.canCompare=!!e.clone;var r=t.parsedResponseCount>0&&t.canCompare;t.parsedResponseCount++,i=r?e.clone():e}return i.json().then(function(i){var r=g(n,t._pageContext);return r.retryCount=t._retryCount,t._processMicroserviceServiceResponseCore(i,n,r,a,e)})},this._onCacheThenNetworkServerDataNotReturned=function(e,n){t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?"Cache":"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?"Server":"";t._writeToEmptyResultsMonitor(t._extraData,n,""+r+o+"EmptyResponse")}}).catch(function(e){t._writeToEmptyResultsMonitor(t._extraData,n,r+"Server_Response_Parse_Error",e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.Items)},this._parseHttpClientResponse=function(e,n,a){var i=g(n);i.responseStatus=e.status.toString();var r=U(i.MSCV,i.URL),o=F(e.status,r);return e.ok?e.json().then(function(e){var r=t._processRawData(e,n,a);return a.writeSuccess(i),r}).catch(function(e){throw a.writeUnexpectedFailure(o,e,i),e}):(a.writeUnexpectedFailure(o,new Error("UnexpectedError"),i),Promise.reject())},this._processRawData=function(e,n,a){var i=C.getPaddingCount(n,e.Items?e.Items.length:0),r=!e.Items||0===e.Items.length;t._logEmptyResultToQos(t._extraData,r,e);var o=r?[]:t.extractMicroserviceNewsItems(e.Items);return o=o.concat(C.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,i,n.webpartWidth)),a.writeSuccess(t._extraData),o},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._sphomeHttpClient=t.options.serviceScope.consume(c.e.serviceKey),t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey)})}return Object.defineProperty(e.prototype,"isMicroserviceUnavailable",{get:function(){return this._sphomeHttpClient.isServiceAvailable},enumerable:!1,configurable:!0}),e.prototype.requestData=function(t){var n=this;this._retryCount=0;var a=e._requestCount++;return this._addPageUsageStartData(a),this._requestData(t).then(function(e){return n._addPageUsageEndData(a),e}).catch(function(e){if(++n._retryCount<n._maxRetryCount&&n.shouldRetryDataFetch(e))return n._requestData(t).then(function(e){return n._addPageUsageEndData(a),e});throw n._addPageUsageEndData(a,!0),e})},e.prototype.extractMicroserviceNewsItems=function(e){return C.extractMicroserviceNewsItems(e,this._pageContext)},e.prototype.shouldRetryDataFetch=function(e){return"UnexpectedRetryableError"===e.message},e.prototype._processHttpClientResponsePromise=function(e,t,n,a,i){var r,o=this;return e.then(function(e){if(C._isHaukShadowcallsKillSwitchActivated())r=e;else{o.canCompare=!!e.clone;var t=(!!i||o.parsedResponseCount>0)&&o.canCompare;o.parsedResponseCount++,r=t?e.clone():e}return r.json()}).then(function(e){return o._processMicroserviceServiceResponseCore(e,t,n,a,r)})},e.prototype._applyCacheAndNetwork=function(e,t,n,a){var i=this;if(e.serverResponse&&e.cachedResponse){var o=new s._QosMonitor(this.qosMonitorLabel+".getNewsItemsInSmartRace"),c=this._processHttpClientResponsePromise(e.serverResponse,t,n,o).then(function(e){var n=i._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),d=new s._QosMonitor(this.qosMonitorLabel+".getCachedNewsItemsInSmartRace"),l=z.e.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,d).then(function(e){var n=i._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw d.writeUnexpectedFailure("ParseCacheResultsFailed",e),t.onCacheResponseFailed(e),e}),u=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),f=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),m=[{raceablePromise:l,raceId:u},{raceablePromise:c,raceId:f}];return p.SmartRace.race(m).then(function(e){return e.raceId===u&&c.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),a.writeSuccess({cacheStatus:e.raceId===u?"WonRace":"LostRace"}),e.raceablePromise}).catch(function(e){throw a.writeUnexpectedFailure("SmartRaceFailed",e),e})}},e.prototype._addPageUsageStartData=function(e){var t=T._PageUsageAdapter.getInstance(),n=t.elapsedTime();t.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-StartTime-"+e,n.toFixed(2))},e.prototype._addPageUsageEndData=function(e,t){var n=T._PageUsageAdapter.getInstance(),a=n.elapsedTime();n.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-EndTime-"+e+"-"+this._retryCount,a.toFixed(2)),t&&n.markFeature("MicroServiceNews-"+this.qosMonitorLabel+"-"+e+"-"+this._retryCount+"-Failure")},e.prototype._addMoreAdditionalFields=function(e,t){t.spHomeServer=e.headers.get("sphome-server");var n=e.headers.get("sphome-sharepointid");n&&(t.spHomeSharepointId=n)},e.prototype._addCacheAndServerEmptyStateLogs=function(e,t,n,a,i){var r=this,o=n&&a,s=o?"Cache":"";return e.then(function(e){var a=r._isEmptyResponse(e);if(i.onServerResponseResolved(a),a||o){var c=a?"Server":"";r._writeToEmptyResultsMonitor(t,n,""+s+c+"EmptyResponse")}return e}).catch(function(e){throw r._writeToEmptyResultsMonitor(t,n,s+"Server_Response_Parse_Error",e),i.onServerResponseFailed(e),e})},e.prototype._getIsExpectedError=function(e){return e>=400&&e<500&&!H(e)},e.prototype._getIsUnExpectedRetryableError=function(e){return e>=500&&e<600&&!H(e)},e.prototype._logEmptyResultToQos=function(e,t,n){var a=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems.EmptyResults");t?a.writeUnexpectedFailure("EmptyResponse",new Error("200 "+(n.Items?"0 Items":"No Items")),e):a.writeSuccess(e)},e.prototype._logThrottledResultToQos=function(e,t){if(H(t)){var n=new s._QosMonitor("GetNewsItems.ThrottledResult");e.dataProvider=this.qosMonitorLabel,n.writeSuccess(e)}},e.prototype._parseClientCachableResponse=function(e,t,n,a){var i=this,r=e.cachedResponse?z.e.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData,t,a):void 0,o=e.serverResponse?this._processHttpClientResponsePromise(e.serverResponse,t,n,a):void 0;return r?(r.then(function(e){var a=i._isEmptyResponse(e);if(t.onCacheResponseResolved(a),o)i._addCacheAndServerEmptyStateLogs(o,n,!0,a,t).then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){});else{var r=a?"Cache":"";a&&i._writeToEmptyResultsMonitor(n,!0,r+"EmptyResponse")}}).catch(function(e){t.onCacheResponseFailed(e)}),r):(a.writeSuccess(n),this._addCacheAndServerEmptyStateLogs(o,n,!1,!0,t))},e.prototype._processMicroserviceServiceResponseCore=function(e,t,n,a,i){n.URL=C.removeQueryParam(i.url,"mainSiteUrl"),n.MSCV=i.headers.get("MS-CV"),this._extraData=n,this._addMoreAdditionalFields(i,n);var r=U(n.MSCV,n.URL);if(i.ok&&r)return this._processRawData(e,t,a);var o=i.status,s=F(o,r);n.statusCode=o.toString(),n.responseStatus=i.statusText;var c=void 0,d=e;throw this._getIsExpectedError(o)?(c=new Error("ExpectedError"),n.id=d.ErrorLabel,a.writeExpectedFailure(s,c,n)):(this._getIsUnExpectedRetryableError(o)?c=new Error("UnexpectedRetryableError"):(c=new Error("UnexpectedError"),this._logThrottledResultToQos(n,o)),n.id=d.ErrorLabel,a.writeUnexpectedFailure(s,c,n)),c},e.prototype._requestData=function(e){var t=this;if(!Object(G.e)()){var n={parseHttpClientResponse:this._processMicroserviceServiceResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:this._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:this._onCacheThenNetworkServerDataNotReturned};return z.e.executeCacheStrategy(n,this.executeRequest,e)}var a=new s._QosMonitor(this.qosMonitorLabel+".getNewsItems"),r=g(e,this._pageContext);return r.retryCount=this._retryCount,this.executeRequest(e).then(function(n){if(n instanceof i.HttpClientResponse)return t._parseHttpClientResponse(n,e,a);var o=n,s=t._applyCacheAndNetwork(o,e,r,a);if(s)return s;var c=n;return t._parseClientCachableResponse(c,e,r,a)}).catch(function(e){if(!a.hasEnded&&0===r.retryCount)if(e instanceof c.t)a.writeUnexpectedFailure("TokenNotAvailable",e,r);else{var t=e.message;e=new Error("UnexpectedError"),a.writeUnexpectedFailure(t,e,r)}throw e})},e.prototype._writeToEmptyResultsMonitor=function(e,t,n,a){var i=new s._QosMonitor("GetNewsItems.ZeroResult");e.mySiteCacheHit=t,e.dataProvider=this.qosMonitorLabel,e.source=n,a?i.writeUnexpectedFailure(n,a,e):t&&"CacheServerEmptyResponse"===n?i.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),e):i.writeSuccess(e)},e._requestCount=0,e}(),W=function(e){function t(t){var n=e.call(this,t)||this;return n.paginationCompleted=!1,n.getRawItems=function(e){return e["@odata.nextLink"]?n.nextLink=e["@odata.nextLink"]:n.paginationCompleted=!0,e.value},n.isRawData=function(e){return!!e.value},n.isPaginationRequest=function(e){return!!e.isPaginationRequest&&!!n.nextLink},n.extractNewsItemsCallback=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return C.extractVroomNewsItems(e,t)},n.options.serviceScope.whenFinished(function(){n.httpClient=n.options.serviceScope.consume(i.SPHttpClient.serviceKey)}),n}return Object(V.__extends)(t,e),Object.defineProperty(t.prototype,"httpMethod",{get:function(){return"POST"},enumerable:!1,configurable:!0}),t}(function(e){var t=this;this._extraData={},this.requestData=function(e){return t._requestData(e)},this.executeRequest=function(e){var n=void 0;return"POST"===t.httpMethod&&(n={body:JSON.stringify(t.getRequestBody(e)),headers:new x("POST"),method:"POST"}),t.httpClient instanceof i.HttpClient?t.httpClient.fetch(t.getAPIPath(e),i.HttpClient.configurations.v1,n,t.getRequestCacheOptions(e)):t.httpClient.fetch(t.getAPIPath(e),i.SPHttpClient.configurations.v1,n,t.getRequestCacheOptions(e))},this.getCacheProps=function(e){return{parseHttpClientResponse:t.parseHttpClientResponse,isEmptyResponse:t._isEmptyResponse,isRawData:t.isRawData,processRawData:t.processRawData,qosMonitorLabel:t.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed,onCacheThenNetworkServerDataReturned:t._onCacheThenNetworkServerDataReturned,onCacheThenNetworkServerDataNotReturned:t._onCacheThenNetworkServerDataNotReturned}},this.getRequestBody=function(e){return{}},this.getRequestCacheOptions=function(e){var n={alias:C.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[z.e.useStalePropName,!0]])};return e.canCacheRequest&&!t.isPaginationRequest(e)||(n.cacheStrategy=i._CacheStrategy.NetworkOnly),n},this.parseHttpClientResponse=function(e,n,a){t._extraData=g(n),t._extraData.responseStatus=""+e.status;var i=""+e.correlationId,r=""+e.statusMessage,o=""+e.statusText;if(t._extraData.correlationId=i,t._extraData.message=r,t._extraData.statusText=o,e.ok)return e.json().then(function(e){return t.processRawData(e,n,a)}).catch(function(e){throw a.writeUnexpectedFailure("Unexpected",e,t._extraData),e});var s=new Error(r||o);return a.writeUnexpectedFailure("Unexpected",s,t._extraData),Promise.reject(s)},this.processRawData=function(e,n,a){var i=t.getRawItems(e),r=C.getPaddingCount(n,i?i.length:0),o=!i||0===i.length;t._logEmptyResultToQos(o,e);var s=o?[]:t._extractNewsItems(i);return s=s.concat(C.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,r,n.webpartWidth)),a.writeSuccess(t._extraData),s},this._extractNewsItems=function(e){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];return t.extractNewsItemsCallback(e,t._pageContext,n)},this._onCacheThenNetworkServerDataNotReturned=function(e,n){t._onCacheThenNetworkServerDataReturned(Promise.resolve([]),e,n)},this._onCacheThenNetworkServerDataReturned=function(e,n,a){var i=n&&a,r=i?"Cache":"";e.then(function(e){var a=t._isEmptyResponse(e);if(a||i){var o=a?"Server":"";t._writeToEmptyResultsMonitor(n,""+r+o+"EmptyResponse")}}).catch(function(e){t._writeToEmptyResultsMonitor(n,r+"Server_Response_Parse_Error",e)})},this._isEmptyResponse=function(e){var t=e&&e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._logEmptyResultToQos=function(e,n){var a=new s._QosMonitor(t.qosMonitorLabel+".getNewsItems.EmptyResults");e?a.writeUnexpectedFailure("EmptyResponse",new Error("200 "+(t.getRawItems(n)?"0 Items":"No Items")),t._extraData):a.writeSuccess(t._extraData)},this._requestData=function(e){return z.e.executeCacheStrategy(t.getCacheProps(e),t.executeRequest,e)},this._writeToEmptyResultsMonitor=function(e,n,a){var i=new s._QosMonitor("GetNewsItems.ZeroResult");t._extraData.mySiteCacheHit=e,t._extraData.dataProvider=t.qosMonitorLabel,t._extraData.source=n,a?i.writeUnexpectedFailure(n,a,t._extraData):e&&"CacheServerEmptyResponse"===n?i.writeExpectedFailure(n,new Error("Expected Cache and Server Empty Result"),t._extraData):i.writeSuccess(t._extraData)},this.options=e,this.options.serviceScope.whenFinished(function(){t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey)})}),q=function(e,t,n){var a=this;this.newsApiPromises=new Map,this.newsApiResults=new Map,this.newsDataProviderIndex=new Map,this.addApiPromise=function(e,t,n){a.newsApiPromises.set(t,n),a.newsDataProviderIndex.set(t,e),n.then(function(e){a.addApiResult(t,e)}).catch(function(e){})},this.handleRacing=function(){var e=new s._QosMonitor("NewsAPIComparer.handleRacing"),t=[],n=[],i={};a.newsApiPromises.forEach(function(e,r){var o=1;i["dataProvider-"+o++]=a.newsDataProviderIndex.get(r),t.push(e),n.push({raceablePromise:e,raceId:r})}),p.SmartRace.race(n).then(function(n){var r=function(t){i=Object(V.__assign)(Object(V.__assign)({},i),{fasterAPI:a.newsDataProviderIndex.get(n.raceId),"error.name":null==t?void 0:t.name,"error.message":null==t?void 0:t.message,"error.stack":null==t?void 0:t.stack}),e.writeSuccess(i)};Promise.all(t).then(function(){i=a.compareNewsItemsArray(i),r()}).catch(function(e){r(e)})}).catch(function(t){throw e.writeUnexpectedFailure("SmartRaceFailed",t,i),t})},this.addApiResult=function(e,t){a.newsApiResults.set(e,t)},this.compareNewsItemsArray=function(e){var t,n=a.newsApiResults.get(a.baseApiGuid)||[],i=(null===(t=a.newsApiResults.get(a.baseApiGuid))||void 0===t?void 0:t.length)||0;return a.newsApiResults.forEach(function(t,r){if(a.baseApiGuid!==r){var o=a.newsDataProviderIndex.get(r),c={baseDataProvider:a.newsDataProviderIndex.get(a.baseApiGuid),compareToDataProvider:o};a.baseApiPromiseStringified!==JSON.stringify(t)?(c["baseDataProvider.length"]=""+i,c["compareToDataProvider.length"]=""+t.length,c=a.compareNewsItems(n,t,c),s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","DifferentArrays_Base",s._LogType.Event,e)),s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","DifferentArrays_Details",s._LogType.Event,c))):(s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","SameResults_Base",s._LogType.Event,e)),s._EngagementLogger.logEventWithLogEntry(new s._LogEntry("NewsComparer","SameResults_Details",s._LogType.Event,c)))}}),e},this.compareNewsItems=function(e,t,n){for(var i=Array.from(Array(2),function(){return new Array(Math.max(e.length,t.length))}),r=0;r<e.length;r++)if(!i[0][r])for(var o=0;o<t.length;o++)i[0][o]||(a._compareEqualItem(e[r],t[o])?(i[0][r]=i[1][o]=!0,n["itemsEqualAtIndex-"+r+"-"+o]=""+!0,n=a._logFieldMismatch(e[r],t[o],n,r,o),++r):(n["itemsEqualAtIndex-"+r+"-"+o]=""+!1,e[r].isHelpArticle||t[o].isHelpArticle?(e[r].isHelpArticle&&(n["baseItemStartsHelpArticlesAt-"+r+"-"+o]=""+!0,r=e.length),t[o].isHelpArticle&&(n["compareToItemStartsHelpArticlesAt-"+r+"-"+o]=""+!0,o=t.length)):e[r].publishedOn>t[o].publishedOn?n["baseItemNewerAtIndex-"+r+"-"+o]=""+!0:n["baseItemNewerAtIndex-"+r+"-"+o]=""+!1));return n},this._logFieldMismatch=function(e,t,n,a,i){return["author","description","email","isAuthoritative","image","publishedOn","title","url","siteTitle","siteUrl","listItemId","originalSourceItemId","originalSourceUrl","uniqueId","siteId","webId","listId"].forEach(function(r){e[r]&&t[r]&&e[r].toString()!==t[r].toString()&&(n["fieldisEqual-"+r+"-"+a+"-"+i]=""+!1)}),n},this._getItemKeyCallback=function(e){return C.getNewsItemKey(e,e.siteId+"-"+e.webId+"-"+e.uniqueId)},this._compareEqualItem=function(e,t){var n=a._getItemKeyCallback;return n(e)===n(t)&&e.siteUrl==e.siteUrl},this.baseApiGuid=t,this.addApiPromise(e,t,n),n.then(function(e){a.addApiResult(t,e),a.baseApiPromiseStringified=JSON.stringify(e)})};!function(e){function t(){return r._SPFlight.isEnabled(60465)}e.isNewsHaukAPIFlightEnabled=t,e.isNewsHaukAPIModelEnabled=function(){return 1===T._SPPerfExperiment.getVariantAndTrackExperiment(T._PerformanceExperiment.NewsHaukAPIExperiment)||t()}}(R||(R={}));var Q=function(){function e(e){return this.id="hubNews",this.title=v.x,R.isNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this.instance=new Y(e):this.instance=new J(e),this.instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this.instance.requestData(e)},e}(),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=v.x,t.getRequestBody=function(e){return{hubs:[""+e.hubId],filterByAudience:!!e.audienceTargetingEnabled,preferredLanguage:e.languageOverride}},t.getAPIPath=function(e){var n=u.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="?$expand=analytics($expand=allTime),thumbnails&$top="+e.count;return t.isPaginationRequest(e)?t.nextLink:n+"/_api/v2.1/getMultiHubNews"+a},t}return Object(V.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomHubNewsDataProvider"},enumerable:!1,configurable:!0}),t}(W),J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="hubNews",t.title=v.x,t.executeRequest=function(e){var n={alias:C.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[z.e.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=i._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),C.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n);return C._isHaukShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(V.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"HubNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.extractMicroserviceNewsItems=function(e){return C.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="departmentId="+e.hubId+"&start="+e.skip+"&count="+e.count;return"news/hub/filtered?"+((t+=h(e))+b(e))},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var a=e.then(function(e){if(!(e instanceof i.HttpClientResponse)&&e.serverResponse){var a=new s._QosMonitor("SPHomeQualityTest.getHubProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new q("SPHomeMicroservice",r.Guid.parse("92d60991-5b57-4828-9f5f-da94e71c6257"),a),c=t;c.canCacheRequest=!1;var d=new s._QosMonitor("News.HubsiteVroom"),l=new Y(n.options).requestData(c).then(function(e){return d.writeSuccess(),e}).catch(function(e){return d.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",r.Guid.parse("4a609117-4832-4b81-a400-c222a06d25be"),l),o.handleRacing()}},3e3)},t}(K);function X(){return r._SPFlight.isEnabled(60218)||1===T._SPPerfExperiment.getVariantAndTrackExperiment(T._PerformanceExperiment.SOXEventUpdate)}function Z(){return r._SPFlight.isEnabled(60278)}function $(){return r._SPFlight.isEnabled(60373)}var ee=function(){function e(e){var t=this;return this.id="News",this.title=v.w,this.qosMonitorLabel="NewsreelDataSource",this._executeRequest=function(e){var n={metadataFilter:e.serializedFilterQuery,languageOverride:e.languageOverride},a={body:JSON.stringify(n),headers:new x("POST"),method:"POST"},r={alias:C.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[z.e.useStalePropName,!0]])};return e.canCacheRequest||(r.cacheStrategy=i._CacheStrategy.NetworkOnly),t._spHttpClient.fetch(t._getNewsItemsUrl(e),i.SPHttpClient.configurations.v1,a,r)},this._isEmptyResponse=function(e){var t=null==e?void 0:e.filter(function(e){return!(null==e?void 0:e.isHelpArticle)});return!(null==t?void 0:t.length)},this._isRawData=function(e){var t;return null===(t=e)||void 0===t?void 0:t.value},this._parseSPHttpClientResponse=function(e,n,a){var i=g(n),r=t._isInSmartRace?"NewsreelDataSource.getNewsItemsInSmartRace":"NewsreelDataSource.getNewsItems",o=a||new T._QosMonitor(r);if(i.correlationId=""+e.correlationId,i.responseStatus=""+e.status,i.message=e.statusMessage,e.ok)return e.json().then(function(e){var a=t._processRawData(e,n);return o.writeSuccess(i),a}).catch(function(e){throw o.writeUnexpectedFailure("Unexpected",e,i),e});var s=new Error(e.statusMessage);return o.writeUnexpectedFailure("Unexpected",s,i),Promise.reject(s)},this._processRawData=function(e,n){var a=C.getPaddingCount(n,e.value?e.value.length:0);return(e.value&&e.value.length>0?C.extractNewsItems(e.value,t._pageContext):[]).concat(C.getEmptyStateItems(n.emptyItemType,t.options.serviceScope,a,n.webpartWidth))},this.options=e,this.options.serviceScope.whenFinished(function(){var e;t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._absoluteUrl=null===(e=t._pageContext)||void 0===e?void 0:e.web.absoluteUrl}),u.Locale.language||(u.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t=this;if(!Object(G.e)()){var n={parseHttpClientResponse:this._parseSPHttpClientResponse,isEmptyResponse:this._isEmptyResponse,isRawData:this._isRawData,processRawData:this._processRawData,qosMonitorLabel:this.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed};return z.e.executeCacheStrategy(n,this._executeRequest,e)}return this._executeRequest(e).then(function(n){if(n instanceof i.SPHttpClientResponse)return t._parseSPHttpClientResponse(n,e);var a=n;return t._applyCacheAndNetwork(a,e)||t._parseClientCachableResponse(n,e)})},e.prototype._applyCacheAndNetwork=function(e,t){var n=this;if(e.serverResponse&&e.cachedResponse){this._isInSmartRace=!0;var a=e.serverResponse.then(function(e){return n._parseSPHttpClientResponse(e,t)}).then(function(e){var a=n._isEmptyResponse(e);return t.onServerResponseResolved(a),e}).catch(function(e){throw t.onServerResponseFailed(e),e}),i=z.e.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var a=n._isEmptyResponse(e);return t.onCacheResponseResolved(a),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e}),o=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),s=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),c=[{raceablePromise:i,raceId:o},{raceablePromise:a,raceId:s}];return p.SmartRace.race(c).then(function(e){return e.raceId===o&&a.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),e.raceablePromise})}},e.prototype._getNewsItemsUrl=function(e){var t=u.UriEncoding.escapeUrlForCallback(this._absoluteUrl),n="/_api/sitepages/pages/"+(e.audienceTargetingEnabled?"FeedTargeted":"feed")+"?promotedstate=2&published=true",a="&$skip="+(e.skip?e.skip.toString():"0"),i="&$top="+(e.count>0?e.count.toString():""),r="";return $()&&(r="&$filter=not startswith(ContentTypeId ,'0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB')"),t+n+r+a+i+"&$expand=CreatedBy&$select=Description,BannerImageUrl,BannerThumbnailUrl,AbsoluteUrl,FirstPublished,Title,FileName,Id,UniqueId,ListId,OriginalSourceItemId,OriginalSourceUrl,Path"},e.prototype._parseClientCachableResponse=function(e,t){var n,a=this,i=null===(n=e.serverResponse)||void 0===n?void 0:n.then(function(e){return a._parseSPHttpClientResponse(e,t)}).then(function(e){var n=a._isEmptyResponse(e);return t.onServerResponseResolved(n),e}).catch(function(e){throw t.onServerResponseFailed(e),e});return e.cachedResponse?(i&&i.then(function(e){t.onServerResponseResolvedWithCache(e)}).catch(function(){}),z.e.processResponseRawData(e.cachedResponse,this._isRawData,this._processRawData.bind(this),t).then(function(e){var n=a._isEmptyResponse(e);return t.onCacheResponseResolved(n),e||[]}).catch(function(e){throw t.onCacheResponseFailed(e),e})):i},e}(),te=function(){function e(e){this.id=L,this.title="NewsDigest",this.options=e}return e.prototype.requestData=function(e){var t=this.options.newsItems||[];return Promise.resolve(t)},e}(),ne=function(){function e(e,t,n){return r.Validate.isNotNullOrUndefined(e,"pageContext"),this._pageContext=e,this._spHttpClient=t,this._newsDigestBubbleType=n,this._absoluteUrl=this._pageContext.web.absoluteUrl,this}return Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestApiUrl",{get:function(){return this._absoluteUrl+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+u.UriEncoding.encodeURIComponent(this._pageContext.user.loginName)+"')"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_newsDigestFirstExperienceBitRestUrl",{get:function(){return this._newsDigestFirstExperienceBitRestApiUrl+"?$select="+this._newsDigestBubbleType},enumerable:!1,configurable:!0}),e.readCachedFirstRunExperience=function(e){var t=window.localStorage.getItem(e);if(t)return"true"===t},e.prototype.writeCachedFirstRunExperience=function(t){var n=this._newsDigestBubbleType,a=window.localStorage.getItem(n),i=String(t);if(a!==i)try{window.localStorage.setItem(n,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e.prototype.showFirstRun=function(){var t=e.readCachedFirstRunExperience(this._newsDigestBubbleType);return!0===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is true in the local storage"),Promise.resolve(!1)):!1===t?(s._TraceLogger.logVerbose(e._logSource,this._newsDigestBubbleType+" is false in the local storage"),Promise.resolve(!0)):this.getFirstRunBitApi()},e.prototype.setFirstRunSeen=function(t){var n=this,a=new T._QosMonitor("SetNewsDigestFirstRunExperienceAPI"),r={};r[this._newsDigestBubbleType]=Boolean(t);var o="application/json; odata=minimalmetadata",c=new Headers;return c.append("Accept","*/*, "+o),c.append("Content-Type",o),c.append("X-HTTP-Method","PATCH"),c.append("X-ClientType","NewsDigest_SetFirstRunBit"),this._spHttpClient.post(this._newsDigestFirstExperienceBitRestApiUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(r),headers:c}).then(function(i){s._TraceLogger.logVerbose(e._logSource,"Set news digest first run bit to API: "+t),a.writeSuccess(),n.writeCachedFirstRunExperience(t)}).catch(function(t){throw s._TraceLogger.logError(e._logSource,t),a.writeUnexpectedFailure("SetNewsDigestFirstRunExperienceAPI",t),t})},e.prototype.getFirstRunBitApi=function(){var t=this,n=new T._QosMonitor("GetNewsDigestFirstRunExperienceAPI"),a=new Headers;return a.append("X-ClientType","NewsDigest_GetFirstRunBit"),this._spHttpClient.get(this._newsDigestFirstExperienceBitRestUrl,i.SPHttpClient.configurations.v1,{headers:a}).then(function(e){return e.json()}).then(function(a){var i=a[t._newsDigestBubbleType];return s._TraceLogger.logVerbose(e._logSource,"Get news digest first run bit from API, status: "+i),n.writeSuccess(),t.writeCachedFirstRunExperience(i),!i}).catch(function(t){return s._TraceLogger.logError(e._logSource,t),n.writeUnexpectedFailure("FailedToGetNewsDigestFirstExperienceError",t),!1})},e._logSource=s._LogSource.create("NewsDigestFirstRunDataProvider"),e}(),ae=n("zDft"),ie=n("S/19"),re={CurrentSite:1,CurrentSiteCollection:2,AllSites:3,CurrentSiteDocumentLibrary:4,AllSitesInTheHub:5,CurrentSitePageLibrary:6,CurrentSiteEventsList:7,SelectedSites:99},oe={Document:1,Page:2,Video:3,Event:4,Issue:5,Task:6,Link:7,Contact:8,Image:9,News:10,All:99},se={Word:1,Excel:2,PowerPoint:3,OneNote:4,Visio:5,PDF:10,Video:11,Any:99},ce={Equals:1,NotEqual:2,BeginsWith:3,EndsWith:4,Contains:5,DoesNotContain:6,LessThan:7,GreaterThan:8,Between:9,GreaterThanOrEqualTo:10,LessThanOrEqualTo:11,IsNull:12},de={Today:1,Yesterday:2,ThisWeek:3,ThisMonth:4,LastMonth:5,ThisYear:6,LastYear:7},le={TitleContaining:1,AnyTextContaining:2,TaggedWith:3,CreatedBy:4,ModifiedBy:5,Field:6,RecentlyChanged:7,RecentlyAdded:8,PageAuthorByline:9},ue=n("ui8f"),fe={MostRecent:1,MostViewed:2,Trending:3,FieldAscending:4,FieldDescending:5},pe={CurrentUser:1,SpecificUser:2},me=function(){function e(){}return e.isValidMeToken=function(e){return new RegExp("^\\[me\\]$","i").test(e)},e.isValidTodayToken=function(e){return new RegExp("^\\[today\\]([\\+|\\-]\\d+$)?$","i").test(e)},e}(),_e="(ModernAudienceAadObjectIds:{User.Audiences} OR NOT IsAudienceTargeted:true)",he=function(){function e(){}return e.generateKqlFromFilters=function(e){var t="",n=!1;if(!e||!e.query||!e.query.filters)return{expr:t,isFilteringByDate:n};for(var a=Object(B.clone)(e.query.filters),i=a.length;i--;)void 0!==a[i].value&&""!==a[i].value||void 0!==a[i].userType&&a[i].userType!==pe.SpecificUser||a.splice(i,1);a=a.sort(function(e,t){return e.filterType-t.filterType});for(var r=!1,o=0;o<a.length;o++){o>0&&(t+=" "+(r?"OR":"AND")+" ");var s=a[o],c=o<a.length-1?a[o+1]:void 0;r||void 0===(null==c?void 0:c.value)||s.filterType!==c.filterType||(t+="(",r=!0);var d=this._kqlFilter(s,e.queryableManagedProperties);t+=d.expr,n=n||d.isFilteringByDate,r&&s.filterType!==(null==c?void 0:c.filterType)&&(t+=")",r=!1)}return t.length>0&&(t+=" AND"),{expr:t,isFilteringByDate:n}},e.generateKqlFromFilterGroup=function(e){if(!e||!e.query||!e.query.filterGroup)return{expr:"",isFilteringByDate:!1};var t=this._buildFilterGroupExpr(e.query.filterGroup,e.queryableManagedProperties);return t.expr.length>0&&(t.expr+=" AND"),t},e.generateQuery=function(e,t){var n="";if(!e||!e.query)return{queryTemplate:n};var a=e,i=!1,r=!1;if(a.query.advancedQueryText)n=a.query.advancedQueryText;else if(a.query.filterGroup)n=(o=this.generateKqlFromFilterGroup(a)).expr,i=o.isFilteringByDate;else if(a.query.filters){var o;n=(o=this.generateKqlFromFilters(a)).expr,i=o.isFilteringByDate}n.length>0&&(r=!0),n+=" "+this.generateContentLocationKqlQuery(a),n+=this._generateContentKql(a,r);var s=void 0;return(i||!Object(G.t)()&&a.query.advancedQueryText)&&(s=t.user.preferUserTimeZone?t.user.timeZoneInfo.id:t.web.timeZoneInfo.id),a.audienceTarget&&(n=n.trim()+" "+_e),{queryTemplate:n.trim(),timeZoneId:s}},e.generateContentLocationKqlQuery=function(e){var t=this;switch(e.query.contentLocation){case re.AllSitesInTheHub:return""+this._siteCriteria(e.hubSiteId,"DepartmentId");case re.CurrentSite:return this._generateSiteIdCriteria(e.siteId,e.webId);case re.CurrentSiteCollection:return"("+this._siteCriteria(e.siteId,"NormSiteID")+")";case re.SelectedSites:if(e.siteIds&&e.siteIds.length>0)return"("+e.siteIds.map(function(e){return t._generateSiteIdCriteria(e.siteId,e.webId)}).join(" OR ")+")"}return""},e.generateSearchAPIQueryOptions=function(e,t,n){var a=n.isPrivateGroup;!a&&n.query&&(a=n.query.contentLocation===re.AllSites||n.query.contentLocation===re.AllSitesInTheHub);var i=a?"True":"False",r=n.enableMultiGeoSearch?"True":"False",o={ClientType:n.clientType,QueryTemplate:e,TimeZoneId:t,SelectProperties:["ContentType","ContentTypeId","Title","EditorOwsUser","ModifiedBy","LastModifiedBy","FileExtension","FileType","Path","SiteName","SiteTitle","PictureThumbnailURL","DefaultEncodingURL","LastModifiedTime","ListID","ListItemID","SiteID","WebId","UniqueID"],Properties:[{Name:"TrimSelectProperties",Value:{StrVal:"1",QueryPropertyValueTypeIndex:1}},{Name:"EnableDynamicGroups",Value:{BoolVal:i,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:r,QueryPropertyValueTypeIndex:3}}],SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",TrimDuplicates:!1};if(e.indexOf("ContentTypeId:0x0106*")>-1&&o.SelectProperties.push("UserName","WorkEmail","OrgNames","JobTitle","WorkPhone","MobilePhone"),n.query&&n.query.filters){for(var s=n.query.filters,c=!1,d=!1,l=0;l<s.length;l++)switch(s[l].filterType){case le.RecentlyAdded:c=!0;break;case le.RecentlyChanged:d=!0}c&&o.SelectProperties.push("Created"),d&&o.SelectProperties.push("LastModifiedTime")}if(n.selectProperties){var u={};for(l=0;l<o.SelectProperties.length;l++)u[o.SelectProperties[l]]=!0;for(l=0;l<n.selectProperties.length;l++)this._addSelectField(o.SelectProperties,n.selectProperties[l],u)}if(n.maxItemsPerPage&&(o.RowLimit=n.maxItemsPerPage,o.RowsPerPage=n.maxItemsPerPage),n.startRow&&(o.StartRow=n.startRow),n.query)switch(n.query.sortType){case fe.MostRecent:o.SortList=[{Property:"LastModifiedTime",Direction:ae.e.descending}];break;case fe.MostViewed:o.SortList=[{Property:"ViewsLifeTime",Direction:ae.e.descending}];break;case fe.Trending:o.SortList=[{Property:"ViewsRecent",Direction:ae.e.descending}];break;case fe.FieldAscending:case fe.FieldDescending:n.query.sortField&&(o.SortList=[{Property:n.query.sortField,Direction:n.query.sortType===fe.FieldAscending?ae.e.ascending:ae.e.descending}])}return o},e.generateSearchAPIQueryOptionsForManagedProperties=function(e){var t,n=e.query,a=n.managedPropertiesRefinerOptions,i=isNaN(a.limit)?5e4:a.limit,r=a.managedPropertyMatchText?"*"+a.managedPropertyMatchText+"*":"*",o=btoa(Object(B.unescape)(encodeURIComponent(r)));switch(n.contentLocation){case re.CurrentSite:t=e.webAbsoluteUrl;break;case re.CurrentSiteCollection:t=e.siteAbsoluteUrl;break;case re.AllSites:default:t=new URL(e.webAbsoluteUrl).origin}var s='path:"'+t+'" '+this._generateContentKql(e,!1);return{ClientType:e.clientType,SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89",Querytext:s,Refiners:"ManagedProperties(filter3i="+i+"/0/"+o+",sort=name/ascending)",EnableQueryRules:!1,ProcessBestBets:!1,ProcessPersonalFavorites:!1,Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:"False",QueryPropertyValueTypeIndex:3}},{Name:"ClientFunction",Value:{StrVal:"SchemaLookup",QueryPropertyValueTypeIndex:1}}]}},e._buildFilterGroupExpr=function(e,t){var n=this,a="",i=!1;return e.filters&&e.filters.forEach(function(r){if(void 0!==r.value&&""!==r.value||void 0!==r.userType&&r.userType!==pe.SpecificUser){var o=n._kqlFilter(r,t);i=i||o.isFilteringByDate,a=n._chainKqlFilterExpr(a,o,e.logicalOperator)}}),e.filterGroups&&e.filterGroups.forEach(function(r){var o=n._buildFilterGroupExpr(r,t);i=i||o.isFilteringByDate,a=n._chainKqlFilterExpr(a,o,e.logicalOperator)}),a&&(a+=")"),{expr:a,isFilteringByDate:i}},e._chainKqlFilterExpr=function(e,t,n){var a=e;return t.expr&&(a?a+=" "+n+" ":a="(",a+=t.expr),a},e._generateContentKql=function(e,t){var n=e.query,a=e.languageCode,i="",o=$()?"(ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState=2 AND NOT ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB*)":"(ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState=2)",s="(FileType="+p.spConstants.imageExtensions.join(" OR FileType=")+")",c=n.contentTypes||[oe.Document],d=!1;c.indexOf(oe.All)>-1&&(d=!0,n.contentLocation!==re.AllSites||t||(i+="*"));var l=!1,u=!1;if(!d)for(var f="",m=0;m<c.length;++m)switch(1===m&&(f=" OR"),c[m]){case oe.Document:i=this._appendCriteriaUniquely(i,f,"IsDocument:1"),l||(i+=" AND NOT (FileType:aspx OR FileType:html OR FileType:htm OR FileType:mhtml)"),l=!0;break;case oe.Page:i=this._appendCriteriaUniquely(i,f,"(ContentTypeId:0x010108* OR ContentTypeId:0x01010901* OR ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* OR ContentTypeId:0x010100C568DB52D9D0A14D9B2FDCC96666E9F2007948130EC3DB064584E219954237AF39*)",a),u||(i+=" AND NOT (FileType:one OR FileType:onepkg OR FileType:ms-one-stub OR FileType:onetoc OR FileType:onetoc2)"),u=!0;break;case oe.News:i=this._appendCriteriaUniquely(i,f,o,a);break;case oe.Event:i=this._appendCriteriaUniquely(i,f,"ContentTypeId:0x0102*");break;case oe.Issue:i=this._appendCriteriaUniquely(i,f,"ContentTypeId:0x0103*");break;case oe.Task:i=this._appendCriteriaUniquely(i,f,"ContentTypeId:0x0108*");break;case oe.Link:i=this._appendCriteriaUniquely(i,f,"ContentTypeId:0x0105*");break;case oe.Contact:i=this._appendCriteriaUniquely(i,f,"ContentTypeId:0x0106*");break;case oe.Video:i=this._appendCriteriaUniquely(i,f,"ContentTypeId:0x010100F3754F12A9B6490D9622A01FE9D8F012*"),r._SPFlight.isEnabled(1538)&&(""===f&&(i+=" OR "),i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(Object(V.__spreadArrays)(p.spConstants.videoExtensions))));break;case oe.Image:i=this._appendCriteriaUniquely(i,f,s)}if(a&&d&&(i+=(Object(G.a)()?" AND":"")+" (SPTranslationLanguage:"+a+" OR (NOT SPTranslatedLanguages:"+a+" AND NOT SPIsTranslation:true))"),l||d){var _=n.documentTypes||[se.Any];if(-1===_.indexOf(se.Any))for(f="",m=0;m<_.length;++m)switch(1===m&&(f=" OR"),_[m]){case se.Word:i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(["doc","docm","docx"]));break;case se.Excel:i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case se.PowerPoint:i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case se.OneNote:i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(["one","onepkg","ms-one-stub","onetoc","onetoc2"]));break;case se.Visio:i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case se.PDF:i=this._appendCriteriaUniquely(i,f,this._documentTypeCriteria(["pdf"]))}}return i&&" ("+i.trim()+")"},e._addSelectField=function(e,t,n){n[t]||(n[t]=!0,e.push(t))},e._generateSiteIdCriteria=function(e,t){return"("+this._siteCriteria(e,"NormSiteID")+" AND "+this._siteCriteria(t,"NormWebId")+")"},e._siteCriteria=function(e,t){return"DepartmentId"===t?"("+t+":"+e+" OR "+t+":{"+e+"})":t+":"+e},e._appendCriteriaUniquely=function(e,t,n,a){return-1===e.indexOf(n)&&(a&&(n+=(Object(G.a)()?" AND ":"")+" (SPTranslationLanguage:"+a+" OR (NOT SPTranslatedLanguages:"+a+" AND NOT SPIsTranslation:true))"),e+=t+" "+n),e},e._kqlFilter=function(e,t){var n=" ",a=!1;if(e&&(void 0!==e.value||void 0!==e.userType)){var i=void 0!==e.value?e.value.toString():"",r=void 0;switch(e.filterType){case le.TitleContaining:n+=i?'title:"'+i+'"':"";break;case le.AnyTextContaining:n+=i?'"'+i+'"':"";break;case le.TaggedWith:n+=i?'tags:"'+i+'"':"";break;case le.CreatedBy:e.userType===pe.CurrentUser?n+="createdby:{User}":i&&(me.isValidMeToken(i)?n+="createdby:{User}":n+='createdby:"'+i+'"');break;case le.ModifiedBy:e.userType===pe.CurrentUser?n+="modifiedby:{User}":i&&(me.isValidMeToken(i)?n+="modifiedby:{User}":n+='modifiedby:"'+i+'"');break;case le.RecentlyAdded:r="Created";break;case le.RecentlyChanged:r="LastModifiedTime";break;case le.Field:if(t){var o=this._managedPropertyFilter(e,t);n+=o.expr,a=o.isFilteringByDate}}if(r)switch(a=!0,this._filterSince(i)){case de.Today:n+=r+"=today";break;case de.Yesterday:n+="("+r+"=today OR "+r+"=yesterday)";break;case de.ThisWeek:n+=r+'="this week"';break;case de.ThisMonth:n+=r+'="this month"';break;case de.LastMonth:n+="("+r+'="this month" OR '+r+'="last month")';break;case de.ThisYear:n+=r+'="this year"';break;case de.LastYear:n+="("+r+'="this year" OR '+r+'="last year")'}}return{expr:n.trim(),isFilteringByDate:a}},e._filterSince=function(e){try{return parseInt(e,10)}catch(e){return de.ThisMonth}},e._documentTypeCriteria=function(e){return"(FileType:"+e.join(" OR FileType:")+")"},e._managedPropertyFilter=function(e,t){var n=e.fieldInfo||t[e.fieldname];n=n||ue.e.Text;var a=this._parseManagedFieldValue(e.value,n),i="",r=n===ue.e.DateTime;if(""===a.trim()&&e.op!==ce.Equals&&e.op!==ce.NotEqual&&e.op!==ce.Between)return{expr:"",isFilteringByDate:!1};switch(e.op){case ce.BeginsWith:var o=a.substr(1,a.length-2);i=e.fieldname+'="'+o+'*"';break;case ce.Between:var s=this._parseManagedFieldValue(e.value2,n);""!==a.trim()&&""!==s.trim()?i=e.fieldname+">="+a+" AND "+e.fieldname+"<="+s:""!==a.trim()?i=e.fieldname+">="+a:""!==s.trim()&&(i=e.fieldname+"<="+s);break;case ce.Contains:i=e.fieldname+":"+a;break;case ce.DoesNotContain:i="-"+e.fieldname+":"+a;break;case ce.Equals:i=e.fieldname+"="+a;break;case ce.GreaterThan:i=e.fieldname+">"+a;break;case ce.GreaterThanOrEqualTo:i=e.fieldname+">="+a;break;case ce.LessThan:i=e.fieldname+"<"+a;break;case ce.LessThanOrEqualTo:i=e.fieldname+"<="+a;break;case ce.NotEqual:i="-"+e.fieldname+"="+a}return{expr:i,isFilteringByDate:r}},e._parseManagedFieldValue=function(e,t){var n="";switch(t){case ue.e.DateTime:if("string"==typeof e&&me.isValidTodayToken(e)){var a=e.substr("[today]".length)||"";return a?"{Today"+a+"}":"{Today}"}var i=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(i)&&(isNaN(i.getTime())||(n='"'+i.toISOString()+'"'));break;case ue.e.Decimal:case ue.e.Double:var r=parseFloat(e.toString());isNaN(r)||(n=r.toString());break;case ue.e.Integer:var o=parseInt(e.toString(),10);isNaN(o)||(n=o.toString());break;case ue.e.Text:n="string"==typeof e&&me.isValidMeToken(e)?"{User}":'"'+e.toString().trim()+'"';break;case ue.e.YesNo:n=e?"true":"false"}return n},e}(),be=n("9G/9"),ge=function(){function e(e){var t=this;return this.id="Search",this.title=be.e,this.options=e,this.options.serviceScope.whenFinished(function(){t._spHttpClient=t.options.serviceScope.consume(i.SPHttpClient.serviceKey),t._pageContext=t.options.serviceScope.consume(a.PageContext.serviceKey),t._initVariables()}),this._searchAPIRequest=new ie.SearchAPIRequest(e.serviceScope,e.qosPrefix||""),u.Locale.language||(u.Locale.language="en-us"),this}return e.prototype.requestData=function(e){var t,n,a;if(null===(n=null===(t=e.searchOptions)||void 0===t?void 0:t.query)||void 0===n?void 0:n.managedPropertiesRefinerOptions)return a=he.generateSearchAPIQueryOptionsForManagedProperties(e.searchOptions),this._searchAPIRequest.getManagedPropertiesQueryResponse(a).catch(function(e){return Promise.reject(e)});if(e.returnCachedValues)return this._returnCachedResults();if(e.searchAPIQueryOptions)a=e.searchAPIQueryOptions;else if(e.searchOptions){var i=he.generateQuery(e.searchOptions,this._pageContext);a=he.generateSearchAPIQueryOptions(i.queryTemplate,i.timeZoneId,e.searchOptions)}return a?this._searchAPIRequest.getSearchQueryResponse(a).then(this._mapResponse).catch(function(e){return Promise.reject(e)}):Promise.resolve([])},e.prototype._initVariables=function(){},e.prototype._mapResponse=function(e){return Promise.resolve(e)},e.prototype._returnCachedResults=function(){return Promise.resolve([])},e}(),ve=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=C.extractNewsItemsFromSearch(e.rows,t._pageContext);return Promise.resolve(n)},t}return Object(V.__extends)(t,e),t._requestNewsData=function(e){var n=$()?"ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2 AND (NOT ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B00873E381CC9DD4F2E808A377A72C311BB*)":"ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2",a=[];return e.uniqueIdGuids?(a.push(n+" AND ("),e.uniqueIdGuids.forEach(function(e,t){0===t?a.push("UniqueID:"+e.toString()):a.push(" OR UniqueID:"+e.toString()),a.push(" OR UniqueID:{"+e.toString()+"}")}),a.push(")")):a.push("{searchterms} "+n),t._request(e,a.join(""))},t._request=function(e,n){return new t({serviceScope:e.serviceScope}).requestData({searchOptions:{query:{contentLocation:e.contentLocation}},searchAPIQueryOptions:{Properties:[{Name:"EnableDynamicGroups",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}},{Name:"EnableMultiGeoSearch",Value:{BoolVal:!0,QueryPropertyValueTypeIndex:3}}],Querytext:e.searchText||"",QueryTemplate:n,RowLimit:e.rowLimit,SelectProperties:["CreatedBy","AuthorOWSUSER","Description","PictureThumbnailURL","FirstPublishedDate","Title","FileName","ListItemId","OriginalPath","Path","SiteTitle","SPSiteURL","SPWebUrl","ViewCountLifetime","UniqueID","SiteID","WebId","ListId"],SortList:[{Property:"LastModifiedTime",Direction:ae.e.descending}],StartRow:e.startRow,TrimDuplicates:!0}})},t}(ge),ye=function(){function e(e){return this.id="MultiSiteNews",this.title=v.C,R.isNewsHaukAPIModelEnabled()&&!e.shouldUseMicroservice?this.instance=new Se(e):this.instance=new De(e),this.instance}return Object.defineProperty(e.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),e.prototype.requestData=function(e){return this.instance.requestData(e)},e}(),Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=v.C,t.getRequestBody=function(e){var t=[];return e.siteList.forEach(function(e){t.push(e.ItemReference.SiteId+","+e.ItemReference.WebId)}),{sites:t,filterByAudience:!!e.audienceTargetingEnabled,preferredLanguage:e.languageOverride}},t.getAPIPath=function(e){var n=u.UriEncoding.escapeUrlForCallback(t._pageContext.web.absoluteUrl),a="?$expand=analytics($expand=allTime),thumbnails&$top="+e.count;return t.isPaginationRequest(e)?t.nextLink:n+"/_api/v2.1/getMultiSiteNews"+a},t}return Object(V.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"VroomMultiSiteNewsDataProvider"},enumerable:!1,configurable:!0}),t}(W),De=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="MultiSiteNews",t.title=v.C,t.executeRequest=function(e){var n={alias:C.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[z.e.useStalePropName,!0]])};e.canCacheRequest||(n.cacheStrategy=i._CacheStrategy.NetworkOnly);var a=t._sphomeHttpClient.post(t.getMicroservicePath(e),t._getSiteListAndFilterBody(e.siteList,e.filterKQLQuery),void 0,void 0,n);return C._isHaukShadowcallsKillSwitchActivated()||t._compareNewAPIs(a,e),a},t}return Object(V.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MultiSiteNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.requestData=function(t){var n;return(null===(n=t.siteList)||void 0===n?void 0:n.length)?e.prototype.requestData.call(this,t):Promise.resolve(this._getNewsItemsWithPadding(t,0))},t.prototype.extractMicroserviceNewsItems=function(e){return C.extractMicroserviceNewsItems(e,this._pageContext,!0)},t.prototype.getMicroservicePath=function(e){var t="mainSiteUrl="+this._pageContext.site.absoluteUrl+"&",n="start="+e.skip+"&count="+e.count;return n+=h(e),n+=b(e),"news/sites/filtered?"+(this._shouldQueryCurrentSite(e.siteList||[])?t:"")+n},t.prototype._getNewsItemsWithPadding=function(e,t){var n=C.getPaddingCount(e,t);return C.getEmptyStateItems(e.emptyItemType,this.options.serviceScope,n,e.webpartWidth)},t.prototype._shouldQueryCurrentSite=function(e){var t=this._pageContext.site.id.toString(),n=this._pageContext.web.id.toString();return B.findIndex(e,function(e){return e.ItemReference.SiteId===t&&e.ItemReference.WebId===n})>-1},t.prototype._getSiteListAndFilterBody=function(e,t){return JSON.stringify({ReferenceList:this._getSiteListBody(e),FilterQuery:t})},t.prototype._getSiteListBody=function(e){return e.map(function(e){return{Type:"SiteReference",SiteId:e.ItemReference.SiteId,WebId:e.ItemReference.WebId}})},t.prototype._compareNewAPIs=function(e,t){var n=this;setTimeout(function(){if(n.canCompare){var a=e.then(function(e){if(!(e instanceof i.HttpClientResponse)&&e.serverResponse){var a=new s._QosMonitor("SPHomeQualityTest.getMultiSiteProcessedResponse");return n._processHttpClientResponsePromise(e.serverResponse,t,{},a,!0)}return[]}),o=new q("SPHomeMicroservice",r.Guid.parse("364f9d77-37e1-4060-b45c-d85d631f2ebf"),a),c=t;c.canCacheRequest=!1;var d=new s._QosMonitor("News.MultisiteVroom"),l=new Se(n.options).requestData(c).then(function(e){return d.writeSuccess(),e}).catch(function(e){return d.writeUnexpectedFailure("Error",e),[]});o.addApiPromise("VroomAPI",r.Guid.parse("3e2b65bb-803a-4b31-9189-4c88a3aa9836"),l),o.handleRacing()}},3e3)},t}(K),Ie=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="myNews",t.title=v.O,t.executeRequest=function(e){var n={alias:C.aliasPrefix+t.id,id:e.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[z.e.useStalePropName,!0]])};return e.canCacheRequest||(n.cacheStrategy=i._CacheStrategy.NetworkOnly),t._sphomeHttpClient.post(t.getMicroservicePath(e),C.getFilterQueryBody(e.filterKQLQuery),void 0,void 0,n)},t}return Object(V.__extends)(t,e),Object.defineProperty(t.prototype,"qosMonitorLabel",{get:function(){return"MyNewsDataSource"},enumerable:!1,configurable:!0}),t.prototype.getMicroservicePath=function(e){var t="start="+e.skip+"&count="+e.count;return"news/filtered?"+((t+=h(e))+b(e))},t}(K),xe=function(){function e(){}return e.ensureQueryableManagedProperties=function(){return e._loadedQueryableManagedPropertiesPromise||(e._loadedQueryableManagedPropertiesPromise=n.e(1).then(n.bind(null,"n9CK")).then(function(e){return e.default})),e._loadedQueryableManagedPropertiesPromise},e.ensureRetrievableManagedProperties=function(){return e._loadedRetrievableManagedPromise||(e._loadedRetrievableManagedPromise=n.e(2).then(n.bind(null,"oz+a")).then(function(e){return e.default})),e._loadedRetrievableManagedPromise},e}(),Ce=function(){function e(){}return e.prototype.getPerson=function(e,t){var n,a,i,r;if(!e&&t)(o=t.split(";")).length>0&&(a=o[o.length-1]);else if(e){var o;if((o=e.split(" | ")).length>=2&&(i=o[0],a=o[1]),o.length>=3&&o[2]){var s=o[2].split(" ");s.length>1&&s[1].length>1&&(r=this._getAccountNameFromClaim(s[1]))}}return n={name:a},r&&(n.profileImageSrc=p.SPUtility.getUserPhotoUrl(r)),i?(n.email=i,n.profileImageSrc||(n.profileImageSrc=p.SPUtility.getUserPhotoUrl(i))):a?n.initials=this._getEditorInitials(a):n.profileImageSrc||(n.profileImageSrc=p.SPUtility.getUserPhotoUrl()),n},e.prototype._getEditorInitials=function(e){var t;if(e){var n=e.split("(")[0].trim().split(" ");switch(n.length){case 1:t=n[0].substring(0,2);break;default:t=n[0].charAt(0)+n[n.length-1].charAt(0)}t=t.toUpperCase()}return t},e.prototype._getAccountNameFromClaim=function(e){if(e){var t=e.lastIndexOf("|");if(t>=0)return e.substr(t+1)}},e}();function Oe(e){if(!e)return"";var t=new RegExp('[*{}"]',"g");return e.replace(t," ")}var we=n("6ZIT"),Ee=function(){function e(){}return e.generateCAMLQuery=function(t,n){var a=this;(t=t||{}).documentTypes=t.documentTypes||[se.Any],t.fields=t.fields||["Editor","FileLeafRef","File_x0020_Type","ID","Modified","Title","UniqueID"],t.filters=t.filters||[],t.fieldDictionary=t.fieldDictionary||{};var i=[],r=[],o=!1;t.documentTypes.map(function(e){switch(e){case se.Any:o=!0;break;case se.Word:i.push(a._documentTypeCriteria(["doc","docm","docx"]));break;case se.Excel:i.push(a._documentTypeCriteria(["xls","xlsb","xlsm","xlsx"]));break;case se.PowerPoint:i.push(a._documentTypeCriteria(["pot","potx","ppt","pptm","pptx"]));break;case se.OneNote:i.push(a._documentTypeCriteria(["one","onepkg","ms-one-stub"]));break;case se.Visio:i.push(a._documentTypeCriteria(["vsd","vsdm","vsdx","vdw"]));break;case se.PDF:i.push(a._documentTypeCriteria(["pdf"]));break;case se.Video:i.push(a._documentTypeCriteria(Object(V.__spreadArrays)(p.spConstants.videoExtensions)))}}),o&&(i=[]),i.length&&(i=['<And><In><FieldRef Name="File_x0020_Type" /><Values>'].concat(i,"</Values></In>"),r.push("</And>")),o&&(i=['<And><And><Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+e._generateNotIn("File_x0020_Type",["onetoc","onetoc2"])+"</And>"],r.push("</And>")),t.contentTypes&&t.contentTypes.indexOf(oe.News)>-1&&(i.push('<And><Eq><FieldRef Name="PromotedState" /><Value Type="Integer">2</Value></Eq>'),r.push("</And>")),t.languageCode&&this._filterByLanguage(t,i,r);var s=t.sortField||"Modified",c="true";"Modified"===s&&(c="false");var d="";t.maxItemsPerPage&&(d='<RowLimit Paged="false">'+t.maxItemsPerPage+"</RowLimit>");var l=t.fields.map(function(e){return'<FieldRef Name="'+e+'" />'}).join("");return'<View Scope="RecursiveAll"><Query>'+e.generateCAMLFilter(t,i,r,n)+'<OrderBy><FieldRef Name="'+s+'" Ascending="'+c+'" /></OrderBy></Query><ViewFields>'+l+"</ViewFields>"+d+"</View>"},e.generateCAMLFilter=function(e,t,n,a){var i=this;if(t=t||[],n=n||[],e.filterGroup){var r=this._generateCriteriaFromFilterGroup(e.filterGroup,e.fieldDictionary,a);return"<Where>"+t.join("")+(r?"<And>":"")+r+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+(r?"</And>":"")+n.join("")+"</Where>"}var o=new Map;return e.filters.map(function(t){if(t){var n=i._generateFieldName(t),r=i._generateCriteria(t,e.fieldDictionary,a);n&&r&&(o.get(t.filterType)||o.set(t.filterType,new Map),o.get(t.filterType).get(n)||o.get(t.filterType).set(n,[]),o.get(t.filterType).get(n).push(r))}}),o.forEach(function(e){e.forEach(function(e){t.push("<And>"+i._combineCriteria(e,"Or")),n.push("</And>")})}),"<Where>"+t.join("")+'<Eq><FieldRef Name="FSObjType" /><Value Type="Integer">0</Value></Eq>'+n.join("")+"</Where>"},e._generateNotIn=function(e,t){return t.map(function(t){return'<Neq><FieldRef Name="'+e+'" /><Value Type="Text">'+t+"</Value></Neq>"}).reduceRight(function(e,t){return""===e?t:"<And>"+t+e+"</And>"},"")},e._generateCriteriaFromFilterGroup=function(t,n,a){var i=this,r="";return t.filters&&(r=t.filters.reduce(function(r,o){var s=i._generateCriteria(o,n,a);return e._appendCriteria(t.logicalOperator,r,s)},r)),t.filterGroups&&(r=t.filterGroups.reduce(function(a,r){var o=i._generateCriteriaFromFilterGroup(r,n);return e._appendCriteria(t.logicalOperator,a,o)},r)),r},e._appendCriteria=function(e,t,n){var a="AND"===e?"And":"Or";return t&&n?"<"+a+">"+t+n+"</"+a+">":t+n},e._generateFieldName=function(e){switch(e.filterType){case le.TitleContaining:return"Title";case le.CreatedBy:return"Author";case le.PageAuthorByline:return"_AuthorByline";case le.ModifiedBy:return"Editor";case le.RecentlyAdded:return"Created";case le.RecentlyChanged:return"Modified";case le.Field:return e.fieldname}return""},e._generateCriteria=function(e,t,n){var a=e.value?this._encodeUserEntryForXML(e.value.toString(),n):"";switch(e.filterType){case le.TitleContaining:return a?'<Contains><FieldRef Name="Title"/><Value Type="Text">'+a+"</Value></Contains>":"";case le.CreatedBy:return this._userTypeCriteria(e.userType,a,"Author",e.op);case le.PageAuthorByline:return this._userTypeCriteria(e.userType,a,"_AuthorByline",e.op);case le.ModifiedBy:return this._userTypeCriteria(e.userType,a,"Editor",e.op);case le.RecentlyAdded:return this._dateTimeTypeCriteria(e.value,"Created");case le.RecentlyChanged:return this._dateTimeTypeCriteria(e.value,"Modified");case le.Field:return this._fieldTypeCriteria(e,t,n)}return""},e._encodeUserEntryForXML=function(e,t){var n=document.createElement("div");return n.appendChild(document.createTextNode(e)),t?encodeURIComponent(n.innerHTML).replace(new RegExp("'","g"),"%27%27"):n.innerHTML},e._documentTypeCriteria=function(e){return e.map(function(e){return'<Value Type="Text">'+e+"</Value>"}).join("")},e._getISODateString=function(e){return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()},e._getDateTimeTypeComparisonValueElement=function(e,t,n){return["<And>",this._comparisonElement("Geq",e,'<Value Type="DateTime">'+this._getISODateString(t)+"</Value>"),this._comparisonElement("Leq",e,'<Value Type="DateTime">'+this._getISODateString(n)+"</Value>"),"</And>"].join("")},e._dateTimeTypeCriteria=function(e,t){var n=new Date;if("number"==typeof e)switch(e){case de.Today:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today /></Value>');case de.Yesterday:return this._comparisonElement("Eq",t,'<Value Type="DateTime"><Today OffsetDays="-1" /></Value>');case de.ThisWeek:var a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-n.getDay());return this._getDateTimeTypeComparisonValueElement(t,a,n);case de.ThisMonth:var i=new Date(n.getFullYear(),n.getMonth(),1),r=new Date(n.getFullYear(),n.getMonth()+1,0);return this._getDateTimeTypeComparisonValueElement(t,i,r);case de.LastMonth:var o=new Date(n.getFullYear(),n.getMonth()-1,1),s=new Date(n.getFullYear(),n.getMonth(),0);return this._getDateTimeTypeComparisonValueElement(t,o,s);case de.ThisYear:var c=new Date(n.getFullYear(),0,1),d=new Date(n.getFullYear(),11,31);return this._getDateTimeTypeComparisonValueElement(t,c,d);case de.LastYear:var l=new Date(n.getFullYear()-1,0,1),u=new Date(n.getFullYear()-1,11,31);return this._getDateTimeTypeComparisonValueElement(t,l,u)}return""},e._userTypeCriteria=function(e,t,n,a){switch(a){case ce.IsNull:return this._comparisonElement("IsNull",n,"");case ce.Equals:default:var i=this._comparisonElement("Eq",n,'<Value Type="Integer"><UserID Type="Integer" /></Value>');return e===pe.CurrentUser?i:e===pe.SpecificUser&&t?me.isValidMeToken(t)?i:this._comparisonElement("Eq",n,'<Value Type="User">'+t.toString()+"</Value>"):""}},e._criteriaElement=function(e,t,n,a){var i=a?this._encodeUserEntryForXML(n,a):n,r='<Value Type="'+t.TypeAsString+'">'+i+"</Value>";if(t.FieldTypeKind===we.a.User&&me.isValidMeToken(i))r='<Value Type="Integer"><UserID Type="Integer" /></Value>';else if(t.FieldTypeKind===we.a.DateTime&&me.isValidTodayToken(i)){var o=i.substr("[today]".length)||"0";r='<Value Type="DateTime"><Today OffsetDays="'+parseInt(o,0)+'" /></Value>'}return this._comparisonElement(e,t.InternalName,r)},e._comparisonElement=function(e,t,n){return"<"+e+'><FieldRef Name="'+t+'"/>'+n+"</"+e+">"},e._includeElement=function(e,t,n){var a=this,i=t.map(function(t){return t?a._criteriaElement("Eq",e,t,n):'<IsNull><FieldRef Name="'+e.InternalName+'"/></IsNull>'});return this._combineCriteria(i,"Or")},e._combineCriteria=function(e,t){if(!e||0===e.length)return"";for(var n="",a=1;a<e.length;a++)n+="<"+t+">";for(n+=e[0],a=1;a<e.length;a++)n+=e[a]+"</"+t+">";return n},e._fieldTypeCriteria=function(e,t,n){var a=this;if(!e.fieldInfo&&!t)return"";var i=e.fieldInfo||t[e.fieldname];if(!i)return"";var r=this._parseListFieldValue(e.value,i.FieldTypeKind);if(""===r.trim()&&e.op!==ce.Equals&&e.op!==ce.NotEqual&&e.op!==ce.Between)return"";var o="";switch(e.op){case ce.BeginsWith:o=this._criteriaElement("BeginsWith",i,r,n);break;case ce.Between:var s=this._parseListFieldValue(e.value2,i.FieldTypeKind);""!==r.trim()&&""!==s.trim()?o="<And>"+this._criteriaElement("Geq",i,r,n)+this._criteriaElement("Leq",i,s,n)+"</And>":""!==r.trim()?o=this._criteriaElement("Geq",i,r,n):""!==s.trim()&&(o=this._criteriaElement("Leq",i,s,n));break;case ce.Contains:o=this._criteriaElement("Contains",i,r,n);break;case ce.Equals:o=e.values&&e.values.length>0?this._includeElement(i,e.values.map(function(e){return a._parseListFieldValue(e,i.FieldTypeKind)}),n):this._criteriaElement("Eq",i,r,n);break;case ce.GreaterThan:o=this._criteriaElement("Gt",i,r,n);break;case ce.GreaterThanOrEqualTo:o=this._criteriaElement("Geq",i,r,n);break;case ce.LessThan:o=this._criteriaElement("Lt",i,r,n);break;case ce.LessThanOrEqualTo:o=this._criteriaElement("Leq",i,r,n);break;case ce.NotEqual:o=this._criteriaElement("Neq",i,r,n)}return o},e._parseListFieldValue=function(e,t){var n="";if(void 0===e)return n;switch(t){case we.a.DateTime:if("string"==typeof e&&me.isValidTodayToken(e)){n=e.trim();break}var a=new Date(e.toString());"[object Date]"===Object.prototype.toString.call(a)&&(isNaN(a.getTime())||(n=""+a.toISOString()));break;case we.a.Number:case we.a.Currency:var i=parseFloat(e.toString());isNaN(i)||(n=i.toString());break;case we.a.Integer:case we.a.Counter:var r=parseInt(e.toString(),10);isNaN(r)||(n=r.toString());break;case we.a.User:case we.a.Text:default:n=""+e.toString().trim()}return this._encodeUserEntryForXML(n)},e._filterByLanguage=function(e,t,n){var a=e.contentTypes&&e.contentTypes.indexOf(oe.All)>-1,i=!1,r=!1;if(e.contentTypes&&!a)for(var o=0;o<e.contentTypes.length;++o)switch(e.contentTypes[o]){case oe.Page:i=!0;break;case oe.News:r=!0}if(e.languageCode&&(a||i||r)){var s=e.languageCode,c='<Eq><FieldRef Name="_SPTranslationLanguage" /><Value Type="Choice">'+s+"</Value></Eq>",d='<Neq><FieldRef Name="_SPTranslatedLanguages" /><Value Type="MultiChoice">'+s+"</Value></Neq>";t.push("<And><Or>"+c+"<And>"+d+'<IsNull><FieldRef Name="_SPTranslationLanguage" /></IsNull></And></Or>'),n.push("</And>")}},e}(),Ae={List:1,Item:2,Field:3},Le=n("jnk8"),ke=n("YkpB"),Me=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="List",t.title=ke.t,t._logSource=s._LogSource.create("ListDataProvider"),t}return Object(V.__extends)(t,e),t.prototype.getItems=function(e){var t=this;switch(e.requestType){case Ae.List:return this._listDataSource||(this._listDataSource=new we.t({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listDataSource.getListsForWeb(this.baseEndPoint,Le.ODataQueryStringBuilder.generateQueryString(e));case Ae.Item:return this._listItemDataSource||(this._listItemDataSource=new we.i({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),e.viewId?(this._listViewDataSource||(this._listViewDataSource=new we.r({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listViewDataSource.updateViewXml(this.baseEndPoint,e.id,e.viewId,e.caml).then(function(){return t._listItemDataSource.getItemsForList(t.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,void 0,void 0,void 0,void 0,e.audienceTarget,e.viewId)})):this._listItemDataSource.getItemsForList(this.baseEndPoint,e.id,e.title,e.isDefaultDocumentLibrary,e.renderOptions,e.caml,void 0,void 0,void 0,e.audienceTarget);case Ae.Field:return this._listFieldDataSource||(this._listFieldDataSource=new we.n({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listFieldDataSource.getFieldsForList(this.baseEndPoint,e.id,Le.ODataQueryStringBuilder.generateQueryString(e));default:var n=new Error(ke.e);return s._TraceLogger.logError(this._logSource,n),Promise.reject(n)}},t.prototype.addView=function(e){return this._listViewDataSource||(this._listViewDataSource=new we.r({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._listViewDataSource.addView(this.baseEndPoint,e)},t}(o),Pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){for(var n=[],a=["aspx","html","htm"],i=0,r=e.rows;i<r.length;i++){var o=r[i],s=t._personaSettingsCache.getPerson(o.EditorOwsUser,o.ModifiedBy),c=a.indexOf(o.FileExtension)>-1?o.Path:p.SPUtility.getWebPathOfFile(o.DefaultEncodingURL?o.DefaultEncodingURL:o.Path),d=o.LastModifiedTimeForRetention,l=o.SitePath;l&&(l=l.split(";")[0]);var u=p.SPFormatDateTime.formatTimestampToDisplayDate(d,t._pageContext,{skeleton:"yMMMd"}),f=B.extend(o,{Name:s.name,Email:s.email,ProfileImageSrc:s.profileImageSrc,Initials:s.initials,InitialsColor:s.initials,WebPath:c,ModifiedDate:u,SitePath:l});f.SiteName&&(f.SiteName=encodeURI(f.SiteName)),n.push(f)}return new Promise(function(e,t){return e(n)})},t}return Object(V.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new Ce},t}(ge);function Te(e){var t=new Date(e);return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function Ue(e,t){return("\n    <View>\n      <ViewFields>\n        "+(X()?'<FieldRef Name="BannerUrl" />':"")+'\n        <FieldRef Name="Category" />\n        <FieldRef Name="EndDate" />\n        <FieldRef Name="EventDate" />\n        <FieldRef Name="ID" />\n        <FieldRef Name="Location" />\n        <FieldRef Name="Title" />\n        <FieldRef Name="fAllDayEvent" />\n        <FieldRef Name="_ModernAudienceTargetUserField" />\n      </ViewFields>\n      <Query>\n        <Where>\n          '+function(e){return r._SPFlight.isEnabled(1634)?"\n      <And>\n        "+e+'\n        <Neq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">1</Value>\n        </Neq>\n      </And>\n    ':"\n      <And>\n        "+e+'\n        <Eq>\n          <FieldRef Name="fRecurrence" />\n          <Value Type="Boolean">0</Value>\n        </Eq>\n      </And>\n    '}(function(e,t){var n=function(e){return e.category?"\n      <Eq>\n        <FieldRef Name='Category' />\n        <Value Type='Choice'>"+u.HtmlEncoding.encodeText(e.category)+"</Value>\n      </Eq>\n    ":""}(e),a=function(e,t){var n='\n      <Geq>\n        <FieldRef Name="EndDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+(e.startDate||"<Today />")+"\n        </Value>\n      </Geq>\n    ",a=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+Te(e.endDate)+"\n        </Value>\n      </Lt>\n    ":"",i=e.startDate?Fe(e.startDate,t):"<Today />",r=e.endDate?Fe(Te(e.endDate),t):"",o='\n        <Geq>\n          <FieldRef Name="EndDate" />\n          <Value IncludeTimeValue="True" Type="DateTime">\n            '+i+"\n          </Value>\n        </Geq>\n      ",s=e.endDate?'\n      <Lt>\n        <FieldRef Name="EventDate" />\n        <Value IncludeTimeValue="True" Type="DateTime">\n          '+r+"\n        </Value>\n      </Lt>\n    ":"",c='\n      <Neq>\n        <FieldRef Name="fAllDayEvent" />\n        <Value Type="Boolean">1</Value>\n      </Neq>\n    ';return a?"\n      <Or>\n        <And>\n          "+c+"\n          <And>\n            "+n+"\n            "+a+'\n          </And>\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          <And>\n            '+o+"\n            "+s+"\n          </And>\n        </And>\n      </Or>\n      ":"\n      <Or>\n        <And>\n          "+c+"\n          "+n+'\n        </And>\n        <And>\n          <Eq>\n            <FieldRef Name="fAllDayEvent" />\n            <Value Type="Boolean">1</Value>\n          </Eq>\n          '+o+"\n        </And>\n      </Or>"}(e,t);return n?"\n      <And>\n        "+a+"\n        "+n+"\n      </And>\n    ":a}(e,t))+"\n        </Where>\n      </Query>\n      "+function(e){return e.rowLimit?'<RowLimit Paged="FALSE">'+e.rowLimit+"</RowLimit>":""}(e)+"\n    </View>\n  ").replace(/" \/>/g,'"/>').split(/(?:\r\n|\r|\n)/).map(function(e){return e.trim()}).join("")}function Fe(e,t){var n=new Date(e);return n.setMinutes(n.getMinutes()-t.offset),n.toISOString()}var He=n("Ycni"),Re=function(){function e(){}return e.dateStringToUTCDate=function(t,n,a){if(e._allDayKillSwitch.isActivated())return new Date(t);var i=new Date(e.ensureISOTimestamp(t));if(!a)return i;var r=new He.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}),o=n?r.convertToUTC(n):r;return new Date(Date.UTC(o.fullYear,o.month,o.date,o.hours,o.minutes,o.seconds,o.milliseconds))},e.dateStringToLocalDate=function(t,n,a){var i=new Date(e.ensureISOTimestamp(t));if(!n)return i;var r=new He.SPDate({fullYear:i.getUTCFullYear(),month:i.getUTCMonth(),date:i.getUTCDate(),hours:i.getUTCHours(),minutes:i.getUTCMinutes(),seconds:i.getUTCSeconds(),milliseconds:i.getUTCMilliseconds()}),o=a?r:r.convertFromUTC(n);return new Date(o.fullYear,o.month,o.date,o.hours,o.minutes,o.seconds)},e.localToUtc=function(e,t){if(!t)return e;var n=new He.SPDate({fullYear:e.getFullYear(),date:e.getDate(),month:e.getMonth(),hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()}).convertToUTC(t);return new Date(Date.UTC(n.fullYear,n.month,n.date,n.hours,n.minutes,n.seconds))},e.ensureISOTimestamp=function(e){if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*Z$/i.test(e))return e;if(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?[0-9]*$/i.test(e))return e.substring(0,19)+"Z";throw new Error("EventTimeZoneUtilities: date time string "+e+" is not supported")},e._allDayKillSwitch=new p.KillSwitch("5a511229-1361-450b-a2ac-61bdf600d687"),e}(),Ne=n("fP0x");function Be(e,t){return{FieldName:e,FieldValue:t}}function je(e){return(e<10?"0":"")+e}function Ve(e){return e.getFullYear()+"-"+je(e.getMonth()+1)+"-"+je(e.getDate())+" "+je(e.getHours())+":"+je(e.getMinutes())+":"+je(e.getSeconds())}function ze(e,t,n){if(t){var a=e.getFullYear()+"-"+je(e.getMonth()+1)+"-"+je(e.getDate())+"T00:00:00.000Z";return Re.dateStringToLocalDate(a,n,!1)}return e}function Ge(e,t,n,a){var i={formValues:[Be("Title",e.title),Be("Category",e.category?e.category instanceof Array?JSON.stringify(e.category):e.category:""),Be("Description",e.description),Be("Location",e.location),Be("EventDate",Ve(ze(e.startTime,e.isAllDayEvent,n))),Be("EndDate",Ve(ze(e.endTime,e.isAllDayEvent,n))),Be("fAllDayEvent",e.isAllDayEvent?"true":"false"),Be("Workspace",e.linkUrl?e.linkUrl+", "+e.linkName:""),Be("BannerUrl",e.bannerUrl),Be("ParticipantsPicker",JSON.stringify(t.map(function(e){return{Key:e}}))),Be("Geolocation",e.geolocation?"Point ("+e.geolocation.longitude+" "+e.geolocation.latitude+")":"")],bNewDocumentUpdate:!1,checkInComment:null};return e.audiences&&i.formValues.push(Be("_ModernAudienceTargetUserField",JSON.stringify(e.audiences.map(function(e){return{Key:e}})))),a&&i.formValues.push(Be("BannerImageUrl",e.bannerImageUrl)),i}function Ke(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){throw Je(e.correlationId,e.status,t.error)})}function We(e){return e.status>=200&&e.status<300?Promise.resolve(!0):e.json().then(function(t){var n;if(400===e.status&&"string"==typeof(null===(n=t.error)||void 0===n?void 0:n.message)&&t.error.message.indexOf("7F759147-C861-4CD6-A11F-5AA3037D9634"))return Promise.resolve(!1);throw Je(e.correlationId,e.status,t.error)})}function qe(e){var t=new T._QosMonitor("EventDataProvider.GetBannerImageUrlField");return e.status>=200&&e.status<300?(t.writeSuccess(),Promise.resolve(!0)):e.json().then(function(n){var a=Je(e.correlationId,e.status,n.error);return t.writeUnexpectedFailure("Unexpected",void 0,Object(V.__assign)(Object(V.__assign)({},a),{name:"BannerImageUrlError"})),Promise.reject(!1)})}function Qe(e){var t=e.value.filter(function(e){return 0!==e.ErrorCode});if(t.length>0)throw{correlationId:r.Guid.empty,httpStatus:200,code:t[0].ErrorCode.toString(),message:t[0].ErrorMessage};return e.value.filter(function(e){return"Id"===e.FieldName})[0].FieldValue}function Ye(e){if(e)try{var t=new l._SPResourcePath(e).getQueryParameter("ar"),n=t?parseFloat(t):void 0;if(!n||isNaN(n)||!isFinite(n)||n<=0)return;return n}catch(e){return}}function Je(e,t,n){var a=n||{code:"UnknownErrorCode",message:Ne.t};return{correlationId:e,httpStatus:t,code:a.code,message:"string"==typeof a.message?a.message:a.message.value}}var Xe=function(){function e(t){var n=this;this.id="Event",this.title="EventDataProvider",this.extraData={},this.qosMonitorLabel="EventDataSource",this._eventToETag=new Map,this._fetchEventData=function(t){var a;return n._afterServiceScopeFinished().then(function(o){var s=o.pageContext,c=o.httpClient,d=r.UrlUtilities.removeEndSlash(s.web.absoluteUrl);a=n._getTimeZoneFromPageContext(s);var l=d+"/_api/web/Lists(guid'"+t.listId.toString()+"')/RenderListDataAsStream?"+n._buildQueryString(t),u=JSON.stringify({parameters:Object(V.__assign)({__metadata:{type:"SP.RenderListDataParameters"},DatesInUtc:!0,RenderOptions:3,ViewXml:Ue(t,a),AudienceTarget:t.audienceTarget},!!t.cdnRewriteBannerUrl&&{ImageFieldsToTryRewriteToCdnUrls:"BannerUrl"})}),f={alias:e.aliasPrefix+n.id,id:t.webpartId,expirationDuration:6e5,cacheStrategy:i._CacheStrategy.CacheAndNetwork,extraProps:new Map([[z.e.useStalePropName,!0]])};return c.fetch(l,i.SPHttpClient.configurations.v1,{body:u,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"},method:"POST"},f)})},this._parseSPHttpClientResponse=function(e,t,a){return n.extraData.correlationId=""+e.correlationId,n.extraData.responseStatus=""+e.status,n.extraData.message=e.statusMessage,n.extraData.cacheStatus="None",e.ok?204===e.status?Promise.resolve():e.json().then(function(e){return n._processRawData(e,t,a)}).catch(function(e){throw a.writeUnexpectedFailure("Unexpected",e),e}):e.json().then(function(t){var n=new Error(e.statusMessage);throw a.writeUnexpectedFailure("Unexpected",n),Je(e.correlationId,e.status,t.error)}).catch(function(e){throw e})},this._isRawData=function(e){return!!(e&&e.ListData&&e.ListData.Row instanceof Array)},this._processRawData=function(e,t,a){if(n._isRawData(e)){var i=e.ListData.Row.map(function(a){var i;return{id:a.ID,category:a.Category,title:n._htmlDecode(a.Title),description:void 0,startTime:Re.dateStringToLocalDate(a.EventDate,t.timeZone,"1"===a["fAllDayEvent.value"]),endTime:Re.dateStringToLocalDate(a.EndDate,t.timeZone,"1"===a["fAllDayEvent.value"]),allDay:"1"===a["fAllDayEvent.value"],location:n._htmlDecode(a.Location),attendees:void 0,containsAudiences:Boolean(null===(i=a._ModernAudienceTargetUserField)||void 0===i?void 0:i.length),prevPageQuery:n._constructPageQuery(e.ListData.PrevHref),nextPageQuery:n._constructPageQuery(e.ListData.NextHref),geolocation:void 0,linkUrl:"",linkName:"",bannerUrl:X()?String(a.BannerUrl):void 0,webName:"",webUrl:""}});return null==a||a.writeSuccess(n.extraData),i}throw new Error(Ne.e)},this._isEmptyResponse=function(e){return!(null==e?void 0:e.length)},this.options=t,this._serviceScope=t.serviceScope}return e.prototype.requestData=function(e){return e.listId?e.startDate&&e.endDate&&new Date(e.startDate)>new Date(e.endDate)?Promise.resolve([]):r._SPFlight.isEnabled(60402)||1===T._SPPerfExperiment.getVariantAndTrackExperiment(T._PerformanceExperiment.WEXMySiteCacheTCExpEvents)?this.executeRequest(e):this.executeRequest_legacy(e):Promise.resolve([])},e.prototype.executeRequest=function(e){var t,n=this;return this._afterServiceScopeFinished().then(function(a){var i=a.pageContext;t=t=n._getTimeZoneFromPageContext(i),e.timeZone=t;var r={parseHttpClientResponse:n._parseSPHttpClientResponse,isEmptyResponse:n._isEmptyResponse,isRawData:n._isRawData,processRawData:n._processRawData,qosMonitorLabel:n.qosMonitorLabel,onServerResponseResolvedWithCache:e.onServerResponseResolvedWithCache,onServerResponseResolved:e.onServerResponseResolved,onServerResponseFailed:e.onServerResponseFailed,onCacheResponseResolved:e.onCacheResponseResolved,onCacheResponseFailed:e.onCacheResponseFailed};return z.e.executeCacheStrategy(r,n._fetchEventData,e)})},e.prototype.executeRequest_legacy=function(e){var t,n=this;return this._afterServiceScopeFinished().then(function(a){var o=a.pageContext,s=a.httpClient,c=r.UrlUtilities.removeEndSlash(o.web.absoluteUrl);t=n._getTimeZoneFromPageContext(o);var d=c+"/_api/web/Lists(guid'"+e.listId.toString()+"')/RenderListDataAsStream?"+n._buildQueryString(e),l=JSON.stringify({parameters:Object(V.__assign)({__metadata:{type:"SP.RenderListDataParameters"},DatesInUtc:!0,RenderOptions:3,ViewXml:Ue(e,t),AudienceTarget:e.audienceTarget},!!e.cdnRewriteBannerUrl&&{ImageFieldsToTryRewriteToCdnUrls:"BannerUrl"})});return s.post(d,i.SPHttpClient.configurations.v1,{body:l,headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","Odata-Version":"3.0"}})}).then(Ke).then(function(e){if(e&&e.ListData&&e.ListData.Row instanceof Array)return e.ListData.Row.map(function(a){var i;return{id:a.ID,category:a.Category,title:n._htmlDecode(a.Title),description:void 0,startTime:Re.dateStringToLocalDate(a.EventDate,t,"1"===a["fAllDayEvent.value"]),endTime:Re.dateStringToLocalDate(a.EndDate,t,"1"===a["fAllDayEvent.value"]),allDay:"1"===a["fAllDayEvent.value"],location:n._htmlDecode(a.Location),attendees:void 0,containsAudiences:(null===(i=a._ModernAudienceTargetUserField)||void 0===i?void 0:i.length)>0,prevPageQuery:n._constructPageQuery(e.ListData.PrevHref),nextPageQuery:n._constructPageQuery(e.ListData.NextHref),geolocation:void 0,linkUrl:"",linkName:"",bannerUrl:X()?String(a.BannerUrl):void 0,bannerImageAspectRatio:Object(G.n)()?void 0:Ye(String(a.BannerUrl)),webName:"",webUrl:""}});throw new Error(Ne.e)})},e.prototype.requestEventItem=function(e,t){return this._requestEventItem(e,t,!1)},e.prototype.requestUTCEventItem=function(e,t,n){return this._requestEventItem(t,n,!0,e)},e.prototype.updateEventItem=function(e,t,n){var a,o=this;return this._afterServiceScopeFinished().then(function(s){var c=s.pageContext,d=s.httpClient,l=r.UrlUtilities.removeEndSlash(c.web.absoluteUrl);a=l+"/_api/web/Lists(guid'"+e.toString()+"')/items('"+t+"')/ValidateUpdateListItem()";var u={"If-Match":o._eventToETag.get(a),"Content-Type":"application/json;charset=utf-8"};return o._getEventPeopleIds(n.attendees).then(function(t){return o._getBannerImageUrlEnabledPromise(e,l).then(function(e){var r=JSON.stringify(Ge(n,t.map(function(e){return e.UserPrincipalName||e.LoginName}),o._getTimeZoneFromPageContext(c),e));return d.post(a,i.SPHttpClient.configurations.v1,{headers:u,body:r})})})}).then(function(e){return Ke(e).then(function(){return e})}).then(function(e){o._eventToETag.set(a,e.headers.get("ETag"))})},e.prototype.deleteEventItem=function(e,t){var n,a=this;return this._afterServiceScopeFinished().then(function(o){var s=o.pageContext,c=o.httpClient,d=r.UrlUtilities.removeEndSlash(s.web.absoluteUrl);n=d+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var l={"If-Match":a._eventToETag.get(n)};return c.fetch(n,i.SPHttpClient.configurations.v1,{headers:l,method:"DELETE"})}).then(Ke).then(function(){a._eventToETag.delete(n)}).catch(function(e){if("-2130575234, Microsoft.SharePoint.SPException"!==e.code)throw e;T._EngagementLogger.logEvent("EventDataProvider.DeleteEventItemFailure.HasSkypeLink")})},e.prototype.createEventItem=function(e,t){var n=this;return this._afterServiceScopeFinished().then(function(a){var o=a.pageContext,s=a.httpClient,c=r.UrlUtilities.removeEndSlash(o.web.absoluteUrl),d=c+"/_api/web/Lists(guid'"+e.toString()+"')/AddValidateUpdateItemUsingPath()",l={Accept:"application/json","Content-Type":"application/json;charset=utf-8"};return n._getEventPeopleIds(t.attendees).then(function(a){return n._getBannerImageUrlEnabledPromise(e,c).then(function(e){var r=JSON.stringify(Ge(t,a.map(function(e){return e.UserPrincipalName||e.LoginName}),n._getTimeZoneFromPageContext(o),e));return s.post(d,i.SPHttpClient.configurations.v1,{headers:l,body:r})})})}).then(Ke).then(Qe).then(function(t){return n.requestEventItem(e,t)})},e.prototype.getAllCategories=function(e){return Promise.all([this.getInUsedCategories(e),this.getPreDefinedCategories(e)]).then(function(e){var t=e[0],n=e[1];return Object(B.uniq)(Object(V.__spreadArrays)(t,n.categories)).sort()})},e.prototype.getPreDefinedCategories=function(e){return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,o=r.UrlUtilities.removeEndSlash(n.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/fields/GetByInternalNameOrTitle('Category')";return a.get(o,i.SPHttpClient.configurations.v1).then(Ke).then(function(e){return{categories:Object(V.__spreadArrays)(e.Choices),type:e.TypeAsString}})})},e.prototype.getInUsedCategories=function(e){var t=this;return this._afterServiceScopeFinished().then(function(n){var a=n.pageContext,i=n.httpClient,o=r.UrlUtilities.removeEndSlash(a.web.absoluteUrl);return t._getViewId(o,e.toString(),i).then(function(n){return t._getCategoriesFromView(o,e.toString(),i,n)})})},e.prototype.convertDisplayedDateToUTC=function(e){var t=this;return this._afterServiceScopeFinished().then(function(n){var a=n.pageContext;return Re.localToUtc(e,t._getTimeZoneFromPageContext(a))})},e.prototype.getAudienceTargetEnabledFlag=function(e){return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,o=r.UrlUtilities.removeEndSlash(n.web.absoluteUrl)+"/_api/web/Lists(guid'"+e.toString()+"')/Fields(guid'7F759147-C861-4CD6-A11F-5AA3037D9634')";return a.get(o,i.SPHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}).then(We)},e.prototype._getBannerImageUrlEnabledPromise=function(e,t){return Z()?this._afterServiceScopeFinished().then(function(n){var a=n.pageContext,o=n.httpClient,s=(t=t||r.UrlUtilities.removeEndSlash(a.web.absoluteUrl))+"/_api/web/Lists(guid'"+e.toString()+"')/Fields(guid'8A4BE162-151D-4A11-b9BE-E7DC05196D73')";return o.get(s,i.SPHttpClient.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}})}).then(qe).catch(function(){return!1}):Promise.resolve(!1)},e.prototype._getViewId=function(e,t,n){var a=e+"/_api/web/Lists/GetById('"+t+"')/Views?$select=Id&$filter=BaseViewId eq '1'";return n.get(a,i.SPHttpClient.configurations.v1).then(Ke).then(function(e){return e.value&&e.value.length>0?e.value[0].Id:Promise.reject(new Error("No view is found."))})},e.prototype._getCategoriesFromView=function(e,t,n,a){var r=this,o=e+"/_api/web/Lists/GetById('"+t+"')/RenderListFilterData?FieldInternalName='Category'&ViewId='"+a+"'";return n.post(o,i.SPHttpClient.configurations.v1,{}).then(function(e){if(e.ok)return e.text();throw new Error(JSON.stringify(e))}).then(function(e){var t=new RegExp('Value="([^"]*)',"g"),n=e.match(t).map(function(e){return e.replace(t,"$1")}).map(r._htmlDecode);return Object(B.uniq)(n)})},e.prototype._mapRESTResponseEvent=function(e,t,n){var i=this;return void 0===n&&(n=!1),this._getEventAttachments(e).then(function(r){return{id:e.ID.toString(),category:e.Category,title:e.Title,description:e.Description,startTime:n?Re.dateStringToUTCDate(e.EventDate,t,e.fAllDayEvent):Re.dateStringToLocalDate(e.EventDate,t,e.fAllDayEvent),endTime:n?Re.dateStringToUTCDate(e.EndDate,t,e.fAllDayEvent):Re.dateStringToLocalDate(e.EndDate,t,e.fAllDayEvent),location:e.Location,attendees:i._mapRESTResponsePeople(e.ParticipantsPicker),audiences:i._mapRESTResponseAudience(e.OData__ModernAudienceTargetUserField,e["OData__ModernAudienceTargetUserField@odata.navigationLink"]),bannerUrl:e.BannerUrl?e.BannerUrl.Url:"",attachments:r,linkName:e.Workspace?e.Workspace.Description:"",linkUrl:e.Workspace?e.Workspace.Url:"",isAllDayEvent:e.fAllDayEvent,geolocation:e.Geolocation?{latitude:e.Geolocation.Latitude,longitude:e.Geolocation.Longitude}:void 0,permission:new a.SPPermission(e.EffectiveBasePermissions),isRecurrence:e.fRecurrence,prevPageQuery:void 0,nextPageQuery:void 0,webName:"",webUrl:""}})},e.prototype._getEventAttachments=function(e){var t=this;return this._afterServiceScopeFinished().then(function(n){var a=n.pageContext,o=n.httpClient,s=r.UrlUtilities.removeEndSlash(a.web.absoluteUrl);if(e.Attachments){var c=o.beginBatch(),d=e.AttachmentFiles.map(function(e){return e.ServerRelativeUrl}).map(function(e){var t=s+"/_api/web/getFileByUrl('"+e+"')";return c.get(t,i.SPHttpClientBatch.configurations.v1,{headers:{Accept:"application/json","Content-Type":"application/json;charset=utf-8"}}).then(function(e){return Ke(e)})});return c.execute().then(function(){return Promise.all(d)}).then(t._mapRESTAttachments)}return Promise.resolve([])})},e.prototype._constructEventPayload=function(e,t,n){return this._getEventPeopleIds(e.attendees).then(function(e){return e.map(function(e){return e.Id})}).then(function(a){var i={Title:e.title,Category:e.category?e.category:null,Description:e.description,Location:e.location,EventDate:Re.localToUtc(e.startTime,t).toISOString(),EndDate:Re.localToUtc(e.endTime,t).toISOString(),fAllDayEvent:e.isAllDayEvent,Workspace:e.linkUrl?{Description:e.linkName,Url:e.linkUrl}:null,BannerUrl:e.bannerUrl?{Url:e.bannerUrl}:null,ParticipantsPickerId:a,Geolocation:e.geolocation?{Latitude:e.geolocation.latitude,Longitude:e.geolocation.longitude}:null,fRecurrence:e.isRecurrence};return n&&(i.BannerImageUrl=e.bannerImageUrl),i})},e.prototype._getEventPeopleIds=function(e){return(null==e?void 0:e.length)?this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,o=r.UrlUtilities.removeEndSlash(n.web.absoluteUrl),s=a.beginBatch(),c=e.map(function(e){var t=o+"/_api/web/ensureUser(@user)?@user='"+encodeURIComponent(e.id)+"'";return s.get(t,i.SPHttpClientBatch.configurations.v1).then(Ke).then(function(e){return e})});return s.execute().then(function(){return Promise.all(c)})}):Promise.resolve([])},e.prototype._requestEventItem=function(e,t,n,a){var o,s,c=this;return void 0===n&&(n=!1),this._afterServiceScopeFinished().then(function(n){var d=n.pageContext,l=n.httpClient;s=c._getTimeZoneFromPageContext(d),a=a||r.UrlUtilities.removeEndSlash(d.web.absoluteUrl);var f=["Attachments","BannerUrl","Category","Description","EffectiveBasePermissions","EndDate","EventDate","fAllDayEvent","ID","Location","ParticipantsPicker/Name","ParticipantsPicker/Title","Title","Workspace","fRecurrence","Geolocation"],p=["AttachmentFiles","ParticipantsPicker"];o=a+"/_api/web/Lists(guid'"+e.toString()+"')/items("+t+")";var m={Accept:"application/json","Content-Type":"application/json;charset=utf-8"},_=c.getAudienceTargetEnabledFlag(e),h=new u.Uri(a),b=new u.Uri(d.web.absoluteUrl),g=h.getScheme()+"://"+h.getHost();return(g===b.getScheme()+"://"+b.getHost()?Promise.resolve():i._AadTokenProviders.configurable._getTokenInternal(g,i._AadTokenProviders.preAuthorizedConfiguration).then(function(e){return m.Authorization="Bearer "+e,Promise.resolve()},function(){return Promise.resolve()})).then(function(){return _}).then(function(e){return e&&(f.push("OData__ModernAudienceTargetUserField/Name"),p.push("OData__ModernAudienceTargetUserField")),Promise.resolve(!0)},function(){return Promise.resolve(!0)}).then(function(){var e="$select="+f.join(",")+"&$expand="+p.join(","),t=o+"/?"+e;return l.get(t,i.SPHttpClient.configurations.v1,{headers:m})})}).then(Ke).then(function(e){return c._eventToETag.set(o,e["@odata.etag"]),c._mapRESTResponseEvent(e,s,n)})},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._buildQueryString=function(e){if(e.pageQuery)return e.pageQuery;var t=[];return e.orderBy&&t.push(["SortField",e.orderBy.field],["SortDir",e.orderBy.direction]),t.map(function(e){return e.join("=")}).join("&")},e.prototype._mapRESTResponsePeople=function(e){return e?e.map(function(e){return{id:e.Name,name:e.Title}}):[]},e.prototype._mapRESTResponseAudience=function(e,t){return e?e.map(function(e){return function(e){var t;return(null===(t=e.Name)||void 0===t?void 0:t.length)>=36?e.Name.substr(e.Name.length-36):""}(e)}):t?[]:void 0},e.prototype._mapRESTAttachments=function(e){return e?e.map(function(e){return{fileName:e.Name,fileSize:e.Length,filePreviewUrl:e.LinkingUri,fileRelativeUrl:e.ServerRelativeUrl}}):[]},e.prototype._constructPageQuery=function(e){return e?e.substr(1).replace("&View=00000000-0000-0000-0000-000000000000",""):""},e.prototype._getTimeZoneFromPageContext=function(e){return e.user.preferUserTimeZone?e.user.timeZoneInfo:e.web.timeZoneInfo},e.prototype._htmlDecode=function(e){return e?(new DOMParser).parseFromString(e,"text/html").body.innerText:e},e.aliasPrefix="FirstParty_EventsWebPart_",Object(V.__decorate)([Object(p.monitor)("EventDataProvider.RequestData")],e.prototype,"requestData",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.UpdateEventItem")],e.prototype,"updateEventItem",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.DeleteEventItem")],e.prototype,"deleteEventItem",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.CreateEventItem")],e.prototype,"createEventItem",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetPreDefinedCategories")],e.prototype,"getPreDefinedCategories",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetInUsedCategories")],e.prototype,"getInUsedCategories",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetAudienceTargetEnabledFlag")],e.prototype,"getAudienceTargetEnabledFlag",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetEventAttachments")],e.prototype,"_getEventAttachments",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetEventPeopleIds")],e.prototype,"_getEventPeopleIds",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.RequestEventItem")],e.prototype,"_requestEventItem",null),e}(),Ze=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=t._pageContext.user.preferUserTimeZone?t._pageContext.user.timeZoneInfo:t._pageContext.web.timeZoneInfo,a=e.rows.map(function(e){var t,a="true"===e.IsAllDayEvent,i=Re.dateStringToLocalDate(e.EventsRollUpStartDate.toString(),n,a),r=Re.dateStringToLocalDate(e.EventsRollUpEndDate.toString(),n,a),o="";return X()&&(e.PictureThumbnailURL?o=e.PictureThumbnailURL:e.BannerUrlOWSURLH&&(o=e.BannerUrlOWSURLH.split(",")[0])),{endTime:r,isAllDayEvent:a,startTime:i,id:e.ListItemID,attendees:void 0,audiences:void 0,bannerUrl:o,bannerImageAspectRatio:Object(G.n)()?void 0:Ye(String(null===(t=e.BannerUrlOWSURLH)||void 0===t?void 0:t.split(",")[0])),category:e.EventsRollUpCategory?e.EventsRollUpCategory.toString():"",description:void 0,geolocation:void 0,linkName:void 0,linkUrl:void 0,listId:e.ListID,location:e.Location?e.Location.toString():"",nextPageQuery:void 0,prevPageQuery:void 0,title:e.Title,webName:e.SiteTitle?e.SiteTitle:"",webUrl:e.SPWebUrl?e.SPWebUrl.toString():"",containsAudiences:Boolean(e.ModernAudienceAadObjectIds)}});return Promise.resolve(a)},t}return Object(V.__extends)(t,e),Object.defineProperty(t,"selectProperties",{get:function(){var e=["EventsRollUpCategory","EventsRollUpEndDate","EventsRollUpStartDate","IsAllDayEvent","ListID","ListItemID","Location","SiteTitle","SPWebUrl","Title"];return X()&&Z()&&(e.push("BannerUrlOWSURLH"),e.push("PictureThumbnailURL")),e},enumerable:!1,configurable:!0}),t}(ge),$e=[-2130575322,-2147024891],et=function(){function e(e){this._serviceScope=e}return e.prototype.getEventsLists=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,r=n.web.absoluteUrl+"/_api/web/Lists?$filter=BaseTemplate eq 106&$select=Id,Title";return a.get(r,i.SPHttpClient.configurations.v1).then(e._parseResponse).then(function(e){return e.value})})},e.prototype.ensureEventsList=function(){var e=this;return this._afterServiceScopeFinished().then(function(t){var n=t.pageContext,a=t.httpClient,r=n.web.absoluteUrl+"/_api/Lists/EnsureEventsList?$select=Title,Id";return a.post(r,i.SPHttpClient.configurations.v1,{}).then(e._parseResponse)})},e.prototype.getEventsListPermission=function(e){var t=this;return e?this._afterServiceScopeFinished().then(function(n){var r=n.pageContext,o=n.httpClient,s=r.web.absoluteUrl+"/_api/web/Lists(guid'"+e+"')/EffectiveBasePermissions";return o.get(s,i.SPHttpClient.configurations.v1).then(t._parseResponse).then(function(e){return new a.SPPermission(e)}).catch(function(e){return $e.forEach(function(t){if(-1!==e.code.indexOf(String(t)))throw new p.ExpectedFailure("SPErrorCode_"+e.code,e.message,{correlationId:e.correlationId?e.correlationId.toString():void 0})}),Promise.reject(e)})}):Promise.resolve(void 0)},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(a.PageContext.serviceKey),httpClient:e._serviceScope.consume(i.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(e){return e.status>=200&&e.status<300?204===e.status?Promise.resolve():e.json():e.json().then(function(t){var n=t.error||{code:"UnknownErrorCode",message:Ne.t};throw{correlationId:e.correlationId,httpStatus:e.status,code:n.code,message:"string"==typeof n.message?n.message:n.message.value}})},Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetEventsLists")],e.prototype,"getEventsLists",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.EnsureEventsList")],e.prototype,"ensureEventsList",null),Object(V.__decorate)([Object(p.monitor)("EventDataProvider.GetEventsListPermission")],e.prototype,"getEventsListPermission",null),e}(),tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getPageJsonBlob=function(e,t,n){return this.get(e,"_api/sitepages/pages/GetByUrl('"+u.UriEncoding.encodeRestUriStringToken(t)+"')",n,"PageDataSource","getPageJsonBlob").then(function(e){return[e]})},t.prototype.getPageCanvasContent=function(e){return this.get("/",e,"asjson=1","PageDataSource","getPageCanvasContent").then(function(e){return e.page.Content.CanvasContent1})},t}(Le.SPDataSource),nt=n("QRxg"),at=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="Page",t.title=nt.e,t}return Object(V.__extends)(t,e),t.prototype.getItems=function(e){return this._pageDataSource||(this._pageDataSource=new tt({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._pageDataSource.getPageCanvasContent(e.pageRelativeUrl).then(function(e){return[e]})},t}(o);function it(e){var t=e.pageRelativeUrl,n=e.webPartInstanceId,a=e.componentName,i=e.webPartAlias,r=e.defaultWebPartData,o=e.serviceScope,s=e.processWebPartDataCallback,c=new T._QosMonitor(a+".ParseWebPartDataFromPage");return new at({serviceScope:o}).requestData({pageRelativeUrl:t}).then(function(e){var t=null==e?void 0:e[0],n=t.CanvasJson1||t;return n||function(e,t){var n=new Error("StockContent");throw e.writeExpectedFailure(n.message,n,rt(t)),n}(c,i),JSON.parse(n)}).then(function(e){return function(e,t){if(t)for(var n=0,a=t;n<a.length;n++){var i=a[n];if(i.id===e)return i}}(n,e)}).then(function(e){var t;if(e&&(t=e.webPartData),!t){var a=new Error("NoInstanceDataFound");throw c.writeUnexpectedFailure(a.message,a,rt(i)),a}return t.instanceId=n,s&&(t=s(t)),c.writeSuccess(rt(i)),t}).catch(function(e){return c.hasEnded||c.writeUnexpectedFailure("FailedToParse",e,rt(i)),T._EngagementLogger.logEvent(a+".LoadDefaultWebPartData"),r}).then(function(e){return e})}function rt(e){return{webpart:e}}var ot,st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._mapResponse=function(e){var n=e.rows.map(function(e){return{id:r.Guid.tryParse(e.UniqueID),lastEditor:t._personaSettingsCache.getPerson(e.EditorOwsUser,e.ModifiedBy),lastModifiedDate:e.ModifiedOwsDate?new Date(e.ModifiedOwsDate):void 0,title:e.Title,url:e.DefaultEncodingURL}});return Promise.resolve(n)},t}return Object(V.__extends)(t,e),t.prototype._initVariables=function(){this._personaSettingsCache=new Ce},t}(ge),ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getPages=function(e){var t=new s._QosMonitor("TemplatePanelDataSource.getPages");return this.get(e,"_api/sitepages/pages/templates","asjson=1","TemplatePanelDataSource","getPages").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return 404===e.status?t.writeExpectedFailure("TemplatePanelError",Error(e.statusMessage||"getPage returned 404"),{correlationId:e.correlationId,status:e.status}):t.writeUnexpectedFailure("TemplatePanelError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(Le.SPDataSource),dt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getPage=function(e,t){var n=new s._QosMonitor("TemplateSelectedPageCopyDataSource.getPage");return this.get(e,"_api/sitepages/pages("+t+")","$select=CanvasContent1,LayoutWebpartsContent","TemplateCopyDataSource","getPage").then(function(e){return n.writeSuccess(),[e]}).catch(function(e){return n.writeUnexpectedFailure("TemplateSelectedPageCopyError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(Le.SPDataSource),lt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getPage=function(e){var t=new s._QosMonitor("TemplateSelectedPageAsJsonDataSource.getPage");return this.get(e,"","as=json","TemplateSelectedPageAsJsonDataSource","getPage").then(function(e){return t.writeSuccess(),[e]}).catch(function(e){return t.writeUnexpectedFailure("TemplateSelectedPageAsJsonError",Error(e.statusMessage||"Failed to getPage"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t}(Le.SPDataSource),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){var n=new s._QosMonitor(t._dataSourceName+".GetDefaultNewPageTemplateId");return this.get(e,"_api/web/DefaultNewPageTemplateId","",t._dataSourceName,"GetDefaultNewPageTemplateId",this._headers).then(function(e){var t=e.value;return n.writeSuccess(),t}).catch(function(e){return n.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to get DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),Promise.resolve(void 0)})},t.prototype.setDefaultNewPageTemplateId=function(e,n){var a=new s._QosMonitor(t._dataSourceName+".SetDefaultNewPageTemplateId",!0);return this.post(e,"_api/web/SetDefaultNewPageTemplateId","",JSON.stringify({defaultNewPageTemplateId:n}),t._dataSourceName,"SetDefaultNewPageTemplateId",this._headers,!0,!0).then(function(){return a.writeSuccess(),!0}).catch(function(e){return a.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to set DefaultNewPageTemplateId"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e},enumerable:!1,configurable:!0}),t._dataSourceName="DefaultNewPageTemplateIdDataSource",t._errorTag="DefaultNewPageTemplateIdError",t}(Le.SPDataSource),ft=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(V.__extends)(t,e),t.prototype.deleteTemplatePage=function(e,n){var a=new s._QosMonitor(t._dataSourceName+".deleteTemplatePage"),i=t._apiRelativePath+"('"+n+"')";return this.post(e,i+"/recycle()","","",t._dataSourceName,"deleteTemplatePage",this._headers,!0,!0).then(function(){return a.writeSuccess(),!0}).catch(function(e){return a.writeUnexpectedFailure(t._errorTag,Error(e.statusMessage||"Failed to delete template page"),{correlationId:e.correlationId,status:e.status}),!1})},Object.defineProperty(t.prototype,"_headers",{get:function(){var e=new Headers;return e.append("Content-Type","application/json; odata=verbose"),e.append("Accept","application/json; odata.metadata=minimal"),e.append("IF-MATCH","*"),e},enumerable:!1,configurable:!0}),t._apiRelativePath="_api/web/GetFileByServerRelativeUrl",t._dataSourceName="DeleteTemplatePageDataSource",t._errorTag="DeleteTemplatePageError",t}(Le.SPDataSource),pt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplates",t.title="Template Data Provider",t}return Object(V.__extends)(t,e),t.prototype.getItems=function(e){return this._templatePanelDataSource||(this._templatePanelDataSource=new ct({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templatePanelDataSource.getPages(e.webAbsoluteUrl)},t}(o),mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesCopy",t.title="Template Copy Data Provider",t}return Object(V.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageCopyDataSource||(this._templateSelectedPageCopyDataSource=new dt({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templateSelectedPageCopyDataSource.getPage(e.webAbsoluteUrl,e.page.Id)},t}(o),_t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="PageTemplatesAsJson",t.title="Template As Json Data Provider",t}return Object(V.__extends)(t,e),t.prototype.getItems=function(e){return this._templateSelectedPageAsJsonDataSource||(this._templateSelectedPageAsJsonDataSource=new lt({spHttpClient:this.spHttpClient,pageContext:this.pageContext})),this._templateSelectedPageAsJsonDataSource.getPage(e.page.AbsoluteUrl)},t}(o),ht=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DefaultNewPageTemplateId",t.title="Default New Page Template Id Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(V.__extends)(t,e),t.prototype.getDefaultNewPageTemplateId=function(e){return this._ensureDefaultNewPageTemplateIdDataSourceAsync().then(function(t){return t.getDefaultNewPageTemplateId(e.RequestingWebUrl)})},t.prototype.setDefaultNewPageTemplateId=function(e){return this._ensureDefaultNewPageTemplateIdDataSourceAsync().then(function(t){return t.setDefaultNewPageTemplateId(e.RequestingWebUrl,e.DefaultNewPageTemplateId)})},t.prototype._ensureDefaultNewPageTemplateIdDataSourceAsync=function(){var e=this;return this._defaultNewPageTemplateIdDataSourcePromise||(this._defaultNewPageTemplateIdDataSourcePromise=this.resolveServices().then(function(){return new ut({spHttpClient:e.spHttpClient,pageContext:e.pageContext})})),this._defaultNewPageTemplateIdDataSourcePromise},t}(o),bt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.id="DeleteTemplatePage",t.title="Delete Template Page Data Provider",t.getItems=function(){return Promise.resolve([])},t}return Object(V.__extends)(t,e),t.prototype.deleteTemplatePage=function(e){var t=this;return this._defaultDeleteTemplatePageDataSourcePromise||(this._defaultDeleteTemplatePageDataSourcePromise=this.resolveServices().then(function(){return new ft({spHttpClient:t.spHttpClient,pageContext:t.pageContext})})),this._defaultDeleteTemplatePageDataSourcePromise.then(function(t){return t.deleteTemplatePage(e.RequestingWebUrl,e.RelativePageUrl)})},t}(o),gt=function(){function e(e){this.id="RecentDocuments",this.title="Recent documents",this._pageContext=e}return e.prototype.requestData=function(e){var t=this,n=new T._QosMonitor("RecentDocumentsDataProvider.getRecentDocuments");return e.authToken.then(function(n){return fetch(t._getApiUrl(e),t._getHttpConfig(n))}).then(function(e){return n.writeSuccess(),e.json()}).catch(function(e){n.writeUnexpectedFailure("Unexpected",e)}).then(function(e){return e&&e.documents&&e.documents.items?e.documents.items.map(function(e){var t=new Date(e.time_stamp),n=e.url.substring(0,e.url.lastIndexOf("/")),a="OneNote"===e.app?"one":e.extension,i=new u.Uri(e.url);return i.setQueryParameter("web","1"),{fileName:e.title,fileUrl:i.toString(),filePathSegments:e.display_path,filePathUrl:n,fileType:e.app,fileExtension:a,lastAccessedRelative:t}}):[]})},e.prototype._getApiUrl=function(e){return this._pageContext.legacyPageContext.msMruEndpointUrl+"/ocs/v2/recent/docs?apps=Word,Excel,PowerPoint,Visio,OneNote,Sway,PdfViewer&show="+(e.numDocsToRequest||50)+"&sort=Date"},e.prototype._getHttpConfig=function(e){var t=new Headers;return t.set("Authorization","Bearer "+e),t.set("Content-Type","application/json"),t.set("X-Office-Application","120"),t.set("X-Office-Platform","Web"),t.set("X-Office-Version","aec61d34-20ca-455f-ba08-4fbe7e366f81"),t.set("X-CorrelationId",r.Guid.newGuid().toString()),{headers:t}},e}(),vt=function(){function e(e){this._httpClient=e.serviceScope.consume(i.HttpClient.serviceKey),this._cultureName=e.serviceScope.consume(a.PageContext.serviceKey).cultureInfo.currentUICultureName,this._qosPrefix=e.qosPrefix}return e.prototype.getLocationSuggestions=function(e,t){void 0===t&&(t=5);var n=new T._QosMonitor(this._qosPrefix+".BingLocationDataProvider.GetLocationSuggestions"),a=new u.Uri("https://www.bingapis.com/api/v6/Places/AutoSuggest");return a.setQueryParameter("q",e),a.setQueryParameter("appid","DEFC13FBC2E876A56E00AD5BDB9B690CD6B55B16"),a.setQueryParameter("structuredaddress","true"),a.setQueryParameter("setmkt",this._cultureName),a.setQueryParameter("setlang",this._cultureName),a.setQueryParameter("count",String(t)),"zh-cn"===this._cultureName.toLowerCase()?(a.setQueryParameter("localmapview","40.173091266970914,116.1689437866211,39.68604237738654,116.63105621337891"),a.setQueryParameter("localcircularview","39.9295,116.4,100")):"ja-jp"===this._cultureName.toLowerCase()&&(a.setQueryParameter("localmapview","36.266035662679684,139.24756548070306,35.10266624641582,140.5796577658593"),a.setQueryParameter("localcircularview","39.9785614013672,116.308280944824,100")),this._httpClient.get(a.toString(),i.HttpClient.configurations.v1).catch(function(e){return Promise.reject(new p.UnexpectedFailure("NetworkError",e))}).then(this._parseResponse).then(function(e){if(e&&e.value)return n.writeSuccess(),e.value.filter(function(e){return e.address});n.writeUnexpectedFailure("BingLocationDataProvider: value data does not exist in response.")})},e.prototype.getLocationInfo=function(e,t){void 0===t&&(t=1);var n=new T._QosMonitor(this._qosPrefix+".BingLocationDataProvider.GetLocationInfo"),a=new u.Uri("https://dev.virtualearth.net/REST/v1/Locations");return a.setQueryParameter("query",e),a.setQueryParameter("o","json"),a.setQueryParameter("c",this._cultureName),a.setQueryParameter("maxResults",t.toString()),a.setQueryParameter("key","AmOSPT8X9eXz5u_8hQauiEyLHFJOG522w2XBbewYRhDtcEAUpsVIbvpApHbDAtyA"),this._httpClient.get(a.toString(),i.HttpClient.configurations.v1).catch(function(e){return n.writeUnexpectedFailure("BingLocationDataProvider.getLocationInfo: network error."),Promise.reject(new p.UnexpectedFailure("NetworkError",e))}).then(this._parseResponse).then(function(e){try{var t=e.resourceSets[0].resources.map(function(e){return{name:e.name,coordinates:{latitude:e.point.coordinates[0],longitude:e.point.coordinates[1]}}});return n.writeSuccess(),t}catch(e){return n.writeUnexpectedFailure("BingLocationDataProvider.getLocationInfo: invalid response."),Promise.reject(e)}})},e.prototype._parseResponse=function(e){return e.ok?e.json().catch(function(t){return Promise.reject(new p.UnexpectedFailure("FailedToParseResponse",t,{statusCode:e.status}))}):e.json().catch(function(t){return Promise.reject(new p.UnexpectedFailure("FailedToParseError",t,{statusCode:e.status}))}).then(function(t){return Promise.reject(new p.UnexpectedFailure("RequestFailure",JSON.stringify(t),{statusCode:e.status}))})},e}();!function(e){e.GetFirstRunHTTPError403="GetFirstErrorHTTP403",e.GetFirstRunHTTPStatusError="GetFirstHTTPStatusError",e.GetFirstRunHTTPRequestError="GetFirstHTTPRequestError"}(ot||(ot={}));var yt,St=ot,Dt={true:!0,false:!1},It=function(){function e(){}return e.getIsFirstRun=function(e){var t=window.localStorage.getItem(e);return t?Dt[t]:void 0},e.setIsFirstRun=function(t,n){var a=window.localStorage.getItem(t),i=String(n);if(a!==i)try{window.localStorage.setItem(t,i)}catch(t){s._TraceLogger.logError(e._logSource,t)}},e._logSource=s._LogSource.create("CortexFirstRunCacheManager"),e}();!function(e){e.KnowledgeCenter="KnowledgeCenterFirstRun",e.KnowledgeManagementTopicPage="KnowledgeManagementTopicPageFirstRun"}(yt||(yt={}));var xt,Ct=yt,Ot=function(){function e(){}return e.topicFirstRun="CSIKM.FirstRun",e.topicFirstRunDPLogPrefix=e.topicFirstRun+".DP",e.topicFirstRunGetAPIDPPrefix=e.topicFirstRun+"GetAPI.DP",e.topicFirstRunSetAPIDPPrefix=e.topicFirstRun+"SetAPI.DP",e}(),wt=((xt={})[Ct.KnowledgeCenter]="sharePointKnowledgeCenterFirstRun",xt[Ct.KnowledgeManagementTopicPage]="sharePointKnowledgeManagementTopicPageFirstRun",xt),Et=function(){function e(e,t){this._spHttpClient=t,this._pageContext=e}return e._domainUrl=function(){return decodeURIComponent(window.location.protocol+"//"+window.location.host)},e._getErrorExtraData=function(e){var t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return{status:e.status,correlationId:t,spVersion:n}},e.prototype.getIsFirstRun=function(t){return Object(V.__awaiter)(this,void 0,void 0,function(){var n;return Object(V.__generator)(this,function(a){switch(a.label){case 0:return"boolean"!=typeof(n=It.getIsFirstRun(t))?[3,1]:(s._TraceLogger.logVerbose(e._logSource,Ot.topicFirstRun+" is "+n+" in the local storage"),[2,n]);case 1:return[4,this._getServerIsFirstRun(t)];case 2:return[2,a.sent()]}})})},e.prototype.setIsFirstRun=function(e,t){return Object(V.__awaiter)(this,void 0,void 0,function(){return Object(V.__generator)(this,function(n){switch(n.label){case 0:return[4,this.setServerIsFirstRun(e,t)];case 1:return n.sent(),this.setLocalIsFirstRun(e,t),[2]}})})},e.prototype.setServerIsFirstRun=function(t,n){return Object(V.__awaiter)(this,void 0,void 0,function(){var a,r,o,c,d;return Object(V.__generator)(this,function(l){switch(l.label){case 0:return a=!n,r=new T._QosMonitor(Ot.topicFirstRunGetAPIDPPrefix),(o={})[wt[t]]=a,[4,this._spHttpClient.post(this._bitRestUrl,i.SPHttpClient.configurations.v1,{body:JSON.stringify(o),headers:{Accept:"*/*, application/json; odata=minimalmetadata","X-HTTP-Method":"PATCH","Content-Type":"application/json; odata=minimalmetadata","X-ClientType":"PageAuthoring_SetFirstRunBit"}})];case 1:if(!(c=l.sent()).ok)throw d=new Error(c.statusText),s._TraceLogger.logError(e._logSource,d),r.writeUnexpectedFailure(Ot.topicFirstRunSetAPIDPPrefix,d,e._getErrorExtraData(c)),d;return s._TraceLogger.logVerbose(e._logSource,"Request successfully for setting page authoring first run, the status: "+a),r.writeSuccess(),[2]}})})},e.prototype.setLocalIsFirstRun=function(e,t){It.setIsFirstRun(e,t)},e.prototype._getServerIsFirstRun=function(t){return Object(V.__awaiter)(this,void 0,void 0,function(){var n,a,r,o,c,d,l;return Object(V.__generator)(this,function(u){switch(u.label){case 0:n=new T._QosMonitor(Ot.topicFirstRunGetAPIDPPrefix),u.label=1;case 1:return u.trys.push([1,6,,7]),[4,this._spHttpClient.get(this._retrieveBitRestUrl(t),i.SPHttpClient.configurations.v1,{headers:{"X-ClientType":"PageAuthoring_GetFirstRunBit"}})];case 2:return(a=u.sent()).ok?[4,a.json()]:[3,4];case 3:return r=u.sent(),o=r[wt[t]],s._TraceLogger.logVerbose(e._logSource,"Retrieving first run bit "+t+" successfully, the status: "+!o),n.writeSuccess(),[2,!o];case 4:return c=new Error(a.statusText),d=e._getErrorExtraData(a),403===a.status?(n.writeExpectedFailure(St.GetFirstRunHTTPError403,c,d),[2,!1]):(s._TraceLogger.logError(e._logSource,c),n.writeUnexpectedFailure(St.GetFirstRunHTTPStatusError,c,d),[2,Promise.reject(c)]);case 5:return[3,7];case 6:return l=u.sent(),s._TraceLogger.logError(e._logSource,l),n.writeUnexpectedFailure(St.GetFirstRunHTTPRequestError,l),[2,Promise.reject(l)];case 7:return[2]}})})},e.prototype._retrieveBitRestUrl=function(e){return this._bitRestUrl+"?$select="+wt[e]},Object.defineProperty(e.prototype,"_bitRestUrl",{get:function(){return e._domainUrl()+"/_api/SP.Directory.DirectorySession/GetGraphUser(principalName='"+u.UriEncoding.encodeURIComponent(this._pageContext.legacyPageContext.userLoginName)+"')"},enumerable:!1,configurable:!0}),e._logSource=s._LogSource.create(Ot.topicFirstRunDPLogPrefix),e}()},mBwh:function(e,t,n){e.exports=n.p+"icon_helpitemimg3_7f442b60.png"},mwqp:function(e,t,n){"use strict";n.r(t);var a=n("jrLr");n.d(t,"BaseDataProvider",function(){return a.t}),n.d(t,"BookmarksDataProvider",function(){return a.a}),n.d(t,"NewsUtilities",function(){return a.U}),n.d(t,"news",function(){return a.de}),n.d(t,"viewCounts",function(){return a._e}),n.d(t,"currentViewCounts",function(){return a.re}),n.d(t,"hubNews",function(){return a.oe}),n.d(t,"newsDigest",function(){return a.ue}),n.d(t,"multiSiteNews",function(){return a.se}),n.d(t,"myNews",function(){return a.ce}),n.d(t,"staleViewCounts",function(){return a.pe}),n.d(t,"NewsDataSource",function(){return a.L}),n.d(t,"newsDataSourceProp",function(){return a.le}),n.d(t,"_appendAudienceFilteringQueryParam",function(){return a.te}),n.d(t,"_appendLanguageOverrideQueryParam",function(){return a.ne}),n.d(t,"_getExtraDataForLogging",function(){return a.ae}),n.d(t,"NewsEmptyStateType",function(){return a.P}),n.d(t,"ExchangeViewCountsDataProvider",function(){return a.b}),n.d(t,"HubNewsDataProvider",function(){return a.S}),n.d(t,"MicroServiceNewsDataProvider",function(){return a.O}),n.d(t,"NewsDataProvider",function(){return a.A}),n.d(t,"NewsDigestDataProvider",function(){return a.k}),n.d(t,"NewsDigestUtilities",function(){return a.M}),n.d(t,"NewsSearchDataProvider",function(){return a.T}),n.d(t,"MultiSiteNewsDataProvider",function(){return a.w}),n.d(t,"MyNewsDataProvider",function(){return a.E}),n.d(t,"tryGetAuthoritativeSiteDetails",function(){return a.me}),n.d(t,"DocumentType",function(){return a.p}),n.d(t,"FilterOperator",function(){return a.g}),n.d(t,"FilterSince",function(){return a.v}),n.d(t,"FilterType",function(){return a.y}),n.d(t,"UserType",function(){return a.$}),n.d(t,"TokenUtilities",function(){return a.J}),n.d(t,"TieredCacheHelper",function(){return a.Y}),n.d(t,"ContentLocation",function(){return a.r}),n.d(t,"ContentType",function(){return a.s}),n.d(t,"DeferredManagedProperties",function(){return a.l}),n.d(t,"KQLQueryBuilder",function(){return a.D}),n.d(t,"AUDIENCE_TARGET_KQL_QUERY",function(){return a.e}),n.d(t,"ManagedDataType",function(){return a.C}),n.d(t,"SortType",function(){return a.V}),n.d(t,"SearchDataProvider",function(){return a.j}),n.d(t,"PersonaSettingsCache",function(){return a.N}),n.d(t,"sanitizeSearchQueryParameter",function(){return a.fe}),n.d(t,"CAMLQueryBuilder",function(){return a.i}),n.d(t,"ListRequestType",function(){return a.x}),n.d(t,"ListDataProvider",function(){return a.I}),n.d(t,"ContentRollupDataProvider",function(){return a.o}),n.d(t,"EventDataProvider",function(){return a.m}),n.d(t,"EventsSearchDataProvider",function(){return a.h}),n.d(t,"EventsListDataProvider",function(){return a._}),n.d(t,"PageDataProvider",function(){return a.F}),n.d(t,"PageDataSource",function(){return a.H}),n.d(t,"_getWebPartDataFromPage",function(){return a.ie}),n.d(t,"PageSearchDataProvider",function(){return a.R}),n.d(t,"TemplatePanelDataSource",function(){return a.G}),n.d(t,"TemplateSelectedPageCopyDataSource",function(){return a.Q}),n.d(t,"TemplateSelectedPageAsJsonDataSource",function(){return a.q}),n.d(t,"DefaultNewPageTemplateIdDataSource",function(){return a.d}),n.d(t,"DeleteTemplatePageDataSource",function(){return a.f}),n.d(t,"TemplatePanelDataProvider",function(){return a.z}),n.d(t,"TemplatePanelSelectedPageCopyDataProvider",function(){return a.W}),n.d(t,"TemplatePanelSelectedPageAsJsonDataProvider",function(){return a.K}),n.d(t,"DefaultNewPageTemplateIdDataProvider",function(){return a.c}),n.d(t,"DeleteTemplatePageDataProvider",function(){return a.u}),n.d(t,"RecentDocumentsDataProvider",function(){return a.B}),n.d(t,"BingLocationDataProvider",function(){return a.n}),n.d(t,"TopicFirstRunDataProvider",function(){return a.X}),n.d(t,"TopicFirstRunKeys",function(){return a.Z}),n.d(t,"ViewCountDataProvider",function(){return a.ee});var i=n("6ZIT");n.d(t,"ListDataSource",function(){return i.t}),n.d(t,"ListFieldDataSource",function(){return i.n}),n.d(t,"ListFieldType",function(){return i.a}),n.d(t,"ListItemDataSource",function(){return i.i}),n.d(t,"SPRenderListDataOptions",function(){return i.c}),n.d(t,"ListViewDataSource",function(){return i.r}),n.d(t,"BaseDataSource",function(){return i.e}),n.d(t,"ODataQueryStringBuilder",function(){return i.o}),n.d(t,"SPDataSource",function(){return i.s});var r=n("e+fh");n.d(t,"SPHomeHttpClient",function(){return r.e}),n.d(t,"SPHomeMicroserviceNotAvailableError",function(){return r.t});var o=n("JEu8");for(var s in o)["default","BaseDataProvider","BookmarksDataProvider","NewsUtilities","news","viewCounts","currentViewCounts","hubNews","newsDigest","multiSiteNews","myNews","staleViewCounts","NewsDataSource","newsDataSourceProp","_appendAudienceFilteringQueryParam","_appendLanguageOverrideQueryParam","_getExtraDataForLogging","NewsEmptyStateType","ExchangeViewCountsDataProvider","HubNewsDataProvider","MicroServiceNewsDataProvider","NewsDataProvider","NewsDigestDataProvider","NewsDigestUtilities","NewsSearchDataProvider","MultiSiteNewsDataProvider","MyNewsDataProvider","tryGetAuthoritativeSiteDetails","DocumentType","FilterOperator","FilterSince","FilterType","UserType","TokenUtilities","TieredCacheHelper","ContentLocation","ContentType","DeferredManagedProperties","KQLQueryBuilder","AUDIENCE_TARGET_KQL_QUERY","ManagedDataType","SortType","SearchDataProvider","PersonaSettingsCache","sanitizeSearchQueryParameter","CAMLQueryBuilder","ListRequestType","ListDataProvider","ContentRollupDataProvider","EventDataProvider","EventsSearchDataProvider","EventsListDataProvider","PageDataProvider","PageDataSource","_getWebPartDataFromPage","PageSearchDataProvider","TemplatePanelDataSource","TemplateSelectedPageCopyDataSource","TemplateSelectedPageAsJsonDataSource","DefaultNewPageTemplateIdDataSource","DeleteTemplatePageDataSource","TemplatePanelDataProvider","TemplatePanelSelectedPageCopyDataProvider","TemplatePanelSelectedPageAsJsonDataProvider","DefaultNewPageTemplateIdDataProvider","DeleteTemplatePageDataProvider","RecentDocumentsDataProvider","BingLocationDataProvider","TopicFirstRunDataProvider","TopicFirstRunKeys","ViewCountDataProvider","ListDataSource","ListFieldDataSource","ListFieldType","ListItemDataSource","SPRenderListDataOptions","ListViewDataSource","BaseDataSource","ODataQueryStringBuilder","SPDataSource","SPHomeHttpClient","SPHomeMicroserviceNotAvailableError"].indexOf(s)<0&&function(e){n.d(t,e,function(){return o[e]})}(s);var c=n("S/19");for(var s in c)["default","BaseDataProvider","BookmarksDataProvider","NewsUtilities","news","viewCounts","currentViewCounts","hubNews","newsDigest","multiSiteNews","myNews","staleViewCounts","NewsDataSource","newsDataSourceProp","_appendAudienceFilteringQueryParam","_appendLanguageOverrideQueryParam","_getExtraDataForLogging","NewsEmptyStateType","ExchangeViewCountsDataProvider","HubNewsDataProvider","MicroServiceNewsDataProvider","NewsDataProvider","NewsDigestDataProvider","NewsDigestUtilities","NewsSearchDataProvider","MultiSiteNewsDataProvider","MyNewsDataProvider","tryGetAuthoritativeSiteDetails","DocumentType","FilterOperator","FilterSince","FilterType","UserType","TokenUtilities","TieredCacheHelper","ContentLocation","ContentType","DeferredManagedProperties","KQLQueryBuilder","AUDIENCE_TARGET_KQL_QUERY","ManagedDataType","SortType","SearchDataProvider","PersonaSettingsCache","sanitizeSearchQueryParameter","CAMLQueryBuilder","ListRequestType","ListDataProvider","ContentRollupDataProvider","EventDataProvider","EventsSearchDataProvider","EventsListDataProvider","PageDataProvider","PageDataSource","_getWebPartDataFromPage","PageSearchDataProvider","TemplatePanelDataSource","TemplateSelectedPageCopyDataSource","TemplateSelectedPageAsJsonDataSource","DefaultNewPageTemplateIdDataSource","DeleteTemplatePageDataSource","TemplatePanelDataProvider","TemplatePanelSelectedPageCopyDataProvider","TemplatePanelSelectedPageAsJsonDataProvider","DefaultNewPageTemplateIdDataProvider","DeleteTemplatePageDataProvider","RecentDocumentsDataProvider","BingLocationDataProvider","TopicFirstRunDataProvider","TopicFirstRunKeys","ViewCountDataProvider","ListDataSource","ListFieldDataSource","ListFieldType","ListItemDataSource","SPRenderListDataOptions","ListViewDataSource","BaseDataSource","ODataQueryStringBuilder","SPDataSource","SPHomeHttpClient","SPHomeMicroserviceNotAvailableError"].indexOf(s)<0&&function(e){n.d(t,e,function(){return c[e]})}(s)},n1Om:function(e,t){},nJGZ:function(e,t,n){"use strict";var a=n("17wl"),i=n("hiL/"),r=n("UWqr"),o=n("ut3N"),s=function(){function e(){}return e.applyCacheAndNetwork=function(t,n,a,r){var s=new o._QosMonitor(a.qosMonitorLabel+".getProcessedResponseInSmartRace"),c=t.serverResponse.then(function(e){return a.parseHttpClientResponse(e,n,s)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t}),d=new o._QosMonitor(a.qosMonitorLabel+".getProcessedCachedResponseInSmartRace"),l=[{raceablePromise:e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,d).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onCacheResponseResolved,n),t}).catch(function(t){throw d.writeUnexpectedFailure("ParseCacheResultsFailed",t),e._executeIfDefined(a,a.onCacheResponseFailed,t),t}),raceId:e._cachedDataPromiseId},{raceablePromise:c,raceId:e._serverDataPromiseId}];return i.SmartRace.race(l).then(function(t){return t.raceId===e._cachedDataPromiseId&&c.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){}),r.writeSuccess({cacheStatus:t.raceId===e._cachedDataPromiseId?"WonRace":"LostRace"}),t.raceablePromise}).catch(function(e){throw r.writeUnexpectedFailure("SmartRaceFailed",e),e})},e.applyCacheThenNetwork=function(t,n,a,i){var r,s=t.cachedResponse?e.processResponseRawData(t.cachedResponse,a.isRawData,a.processRawData,n,i):void 0,c=new o._QosMonitor(a.qosMonitorLabel+".getProcessedResponse"),d=null===(r=t.serverResponse)||void 0===r?void 0:r.then(function(e){return a.parseHttpClientResponse(e,n,c)}).then(function(t){var n=a.isEmptyResponse(t);return e._executeIfDefined(a,a.onServerResponseResolved,n),t}).catch(function(t){throw e._executeIfDefined(a,a.onServerResponseFailed,t),t});return s?(s.then(function(t){var n=a.isEmptyResponse(t);e._executeIfDefined(a,a.onCacheResponseResolved,n),d?(e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,d,!0,n),d.then(function(t){e._executeIfDefined(a,a.onServerResponseResolvedWithCache,t)}).catch(function(){})):e._executeIfDefined(a,a.onCacheThenNetworkServerDataNotReturned,!0,n)}).catch(function(t){e._executeIfDefined(a,a.onCacheResponseFailed,t)}),s):(i.writeSuccess(),e._executeIfDefined(a,a.onCacheThenNetworkServerDataReturned,d,!1,!0),d)},e.executeCacheStrategy=function(t,n,a){var i=new o._QosMonitor(t.qosMonitorLabel+".getData");return n(a).then(function(n){var r;if(n instanceof Response||(null===(r=n)||void 0===r?void 0:r.nativeResponse)instanceof Response)return t.parseHttpClientResponse(n,a,i);var o=n;return o.serverResponse&&o.cachedResponse?e.applyCacheAndNetwork(o,a,t,i):o.cachedResponse||o.serverResponse?e.applyCacheThenNetwork(o,a,t,i):e.processResponseRawData(Promise.resolve(n),t.isRawData,t.processRawData,a).then(function(n){return i.writeSuccess(),e._executeIfDefined(t,t.onCacheResponseResolved,!!n),n}).catch(function(n){throw i.writeUnexpectedFailure("Error Processing cached data",n),e._executeIfDefined(t,t.onCacheResponseFailed,n),n})}).catch(function(e){throw i.hasEnded||i.writeUnexpectedFailure("Excecute Request failed",e),e})},e.processResponseRawData=function(e,t,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r];return e.then(function(e){return t(e)?n.apply(void 0,Object(a.__spreadArrays)([e],i)):e})},e.useStalePropName="useStale",e.parentKeyOverride="parentKeyOverride",e.onlyIndexedDB="onlyIndexedDB",e.onlyMySiteCache="onlyMySiteCache",e.cacheKeyOverride="cacheKeyOverride",e._cachedDataPromiseId=r.Guid.parse("9b794e3a-a041-4fb4-870d-a1121ca57ca7"),e._serverDataPromiseId=r.Guid.parse("4d757517-a42f-4546-a76a-8d0da7dd2a07"),e._executeIfDefined=function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];if(t)return t.apply(e,n)},e}();t.e=s},o7e7:function(e,t){},rOX9:function(e,t,n){"use strict";var a=n("vlQI"),i=n("X+PM"),r=n("2q6Q"),o=n("ut3N"),s=function(){function e(e,t){void 0===t&&(t=""),this._serviceScope=e,this._qosPrefix=t}return e.prototype.getSearchQueryResponse=function(e){var t=this,n=this._qosPrefix?new r._QosMonitor(this._qosPrefix+".SearchDataProviderGetResponse"):new r._QosMonitor("SearchDataProviderGetResponse");return this._getRawSearchQueryResponse(e).then(function(e){var a=t._simplifyResultForTemplating(e);return n.writeSuccess(),a}).catch(function(e){return n.writeUnexpectedFailure("FailedSearchPOST",e,{correlationId:e.correlationId}),Promise.reject(e)})},e.prototype.getManagedPropertiesQueryResponse=function(e){var t=new r._QosMonitor("ManagedPropertiesRequest");return this._getRawSearchQueryResponse(e).then(function(e){var n,a,i=(null===(a=null===(n=e.PrimaryQueryResult)||void 0===n?void 0:n.RefinementResults)||void 0===a?void 0:a.Refiners)||[],r=(i.length>0?i[0].Entries:[]).map(function(e){return e.RefinementName});return t.writeSuccess(),Promise.resolve(r)}).catch(function(e){return t.writeUnexpectedFailure("ManagedPropertiesRequestFailed",e),Promise.reject(e)})},e.prototype._getRawSearchQueryResponse=function(e){var t=this;e.ClientType=e.ClientType||"ModernWebPart";var n='{ "request": '+(e?JSON.stringify(e):"{}")+" }",i=new Headers;return i.append("Accept","application/json;odata=nometadata"),i.append("Content-type","application/json;charset=utf-8"),i.append("OData-Version","3.0"),this._afterServiceScopeFinished().then(function(e){var r=e.pageContext,o=e.spHttpClient,s=r.web.absoluteUrl+"/_api/search/postquery";return o.post(s,a.SPHttpClient.configurations.v1,{body:n,headers:i}).then(t._parseResponse)})},e.prototype._simplifyResultForTemplating=function(e){var t,n,a,i={};try{var r=[],o=null===(a=null===(n=null===(t=e.PrimaryQueryResult)||void 0===t?void 0:t.RelevantResults)||void 0===n?void 0:n.Table)||void 0===a?void 0:a.Rows;if(!o)throw new Error("Did not receive response rows.");for(var s=0;s<o.length;s++){for(var c={},d=o[s].Cells,l=0;l<d.length;l++){var u=d[l];c[u.Key]=u.Value}r.push(c)}i.rows=r}catch(e){i.rows=[]}return i},e.prototype._afterServiceScopeFinished=function(){var e=this;return new Promise(function(t){e._serviceScope.whenFinished(function(){t({pageContext:e._serviceScope.consume(i.PageContext.serviceKey),spHttpClient:e._serviceScope.consume(a.SPHttpClient.serviceKey)})})})},e.prototype._parseResponse=function(t){return t.status>=200&&t.status<300?t.json():t.json().then(function(n){var a="BadSearchResponse: statusMessage="+t.statusMessage;throw o._TraceLogger.logVerbose(e._LogSource,a+", response inner error="+JSON.stringify(n)),{message:a,status:t.status,correlationId:t.correlationId?t.correlationId.toString():"",innerError:n}})},e._LogSource=o._LogSource.create("SearchAPIRequest"),e}();t.e=s},ui8f:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={Text:1,Integer:2,Decimal:3,DateTime:4,YesNo:5,Binary:6,Double:7}},ukKy:function(e,t,n){"use strict";n.d(t,"e",function(){return c});var a=n("17wl"),i=n("vlQI"),r=n("UWqr"),o=n("RSuL"),s=n("6DSs"),c=function(e){function t(t){var n=e.call(this,t)||this;return n._spHttpClient=t.spHttpClient,n}return Object(a.__extends)(t,e),t.prototype.get=function(e,t,n,a,r,o,s,c){var d=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.get(d,i.SPHttpClient.configurations.v1,{headers:o}),a,r,s,c)},t.prototype.post=function(e,t,n,a,r,o,s,c,d){var l=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.post(l,i.SPHttpClient.configurations.v1,{body:a,headers:s}),r,o,c,d)},t.prototype.patch=function(e,t,n,a,r,o,s,c,d){var l=this.buildUrl(e,t,n);return this._getResponse(this._spHttpClient.fetch(l,i.SPHttpClient.configurations.v1,{body:a,headers:s,method:"PATCH"}),r,o,c,d)},t.prototype._getResponse=function(e,t,n,a,i){return e.then(function(e){if(e.ok)return i?{}:e.json();var o=r.Text.format(s.e,t,n,e.status,e.statusMessage);if(a)throw e;return e.json().then(function(t){throw{message:o,status:e.status,correlationId:e.correlationId?e.correlationId.toString():"",innerError:t}})})},t}(o.e)},urBa:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a={HighlightedContent:1,SiteActivity:2,Sites:3,RecentDocuments:4,OfficeFeed:5,MyTopics:6,Other:999}},ut3N:function(e,t){e.exports=f},vlQI:function(e,t){e.exports=p},y88i:function(e,t){e.exports=m},zDft:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a=function(){function e(){}return e.ascending=0,e.descending=1,e}()}})});