(window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0=window.webpackJsonp_764afdc3_183e_47f5_8d20_a62aff2b0881_0_1_0||[]).push([[5],{"2pHE":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("K9kD"),r=function(e){function t(t){var n=e.call(this,{dataSourceName:"RecentFilesGraphDataSource",id:"RecentFilesGraphDataSource"},{pageContext:t})||this;return n._parseFilesResponse=function(e,t){var r,o,s,c;if(e){var d,l=!1;n._isCachedResultWithStatistic(e)?(d=e.data,l=!0):d=e;var u=null===(s=null===(o=null===(r=d)||void 0===r?void 0:r.data)||void 0===o?void 0:o.me)||void 0===s?void 0:s.recent;if(null!=u){if(!u||0===u.length)return t?{data:[],cacheStats:{lastModified:Date.now(),lastRead:Date.now(),reads:0}}:[];var f=null===(c=u=n._sortByAccessTime(u.filter(function(e){var t,n=e.remoteItem;return n.name&&(null===(t=n.sharepointIds)||void 0===t?void 0:t.siteUrl)&&(i.Killswitch.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?n.webUrl:n.webDavUrl)})))||void 0===c?void 0:c.slice(0,n._maxNumber).map(function(e){var t,n,r,o,s,c,d=e.remoteItem,l=null,u=d.name;if("oneNote"===(null===(t=d.package)||void 0===t?void 0:t.type))s="one",c=u;else{var f=u.lastIndexOf(".");s=u.substr(f+1),c=u.substr(0,f)}var p=d.sharepointIds.siteUrl,m=document.createElement("a");if(m.href=d.webDavUrl,"documentLibrary"===d.parentReference.driveType){var _=p.substr(p.lastIndexOf("/")+1);p=null===(n=d.webDavUrl)||void 0===n?void 0:n.substr(0,d.webDavUrl.lastIndexOf("/"));var h=m.pathname,b=h.substr(h.indexOf(_)+_.length+1),g=decodeURI(b).split("/");g.pop(),l=g.length>=3?_+" > ... > "+g[g.length-1]:Object(a.__spreadArrays)([_],g).join(" > ")}else{var v=null===(o=null===(r=d.createdBy)||void 0===r?void 0:r.user)||void 0===o?void 0:o.displayName;l=v&&v.length>0?"OneDrive > "+v:"OneDrive > Documents"}return{name:c,url:i.Killswitch.isActivated("7c90522e-4460-4492-9407-5e098008f98c","5/17/2021","switch to oneup view")?d.webUrl:d.webDavUrl+"?web=1",path:l,extension:s,siteurl:p}});return l?Object(a.__assign)(Object(a.__assign)({},e),{data:f}):f}}},n._sortByAccessTime=function(e){if(!e||e.length<=1)return e;var t=e.length,n={},a=-1;n[t-1]=new Date(e[t-1].remoteItem.fileSystemInfo.lastAccessedDateTime);for(var i=t-2;i>=0;i--){var r=new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime);n[i]=r,r<n[i+1]&&i+1>a&&(a=i+1)}var o=function(t,n,a){if(t===n)return t;if(new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<a)return t;if(new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>a)return n+1;if(t===n-1)return n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?s(i,n,a):s(t,i,a)},s=function(t,n,a){if(t===n)return t;if(t===n-1)return new Date(e[t].remoteItem.fileSystemInfo.lastAccessedDateTime)<a?t:new Date(e[n].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?n+1:n;var i=Math.floor((t+n)/2);return new Date(e[i].remoteItem.fileSystemInfo.lastAccessedDateTime)>a?s(i,n,a):s(t,i,a)},c=[];for(i=0;i<a;i++)c.push(e.shift());for(i=0;i<c.length;i++){var d=o(0,t-a-1+i,new Date(c[i].remoteItem.fileSystemInfo.lastAccessedDateTime));e.splice(d,0,c[i])}return e},n._isCachedResultWithStatistic=function(e){return!!e.cacheStats},n._recentFilesGraphCacheKey="recentFiles_"+t.aadUserId,n.pageContext=t,n}return Object(a.__extends)(t,e),t.prototype.getRecentFiles=function(e){var t=this;return this._maxNumber=e.maxItems,this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/v2.1/graphql",qosName:"RecentFilesGraph",method:"POST",contentType:"application/graphql",additionalPostData:"{ me { recent { remoteItem { name webUrl webDavUrl parentReference { driveType } package { type } sharepointIds { siteUrl } fileSystemInfo { lastAccessedDateTime } createdBy { user { displayName } } } } } }",cachingStrategy:e.cachingStrategy,cacheRequestKey:this._recentFilesGraphCacheKey+"recent",cacheTimeoutTime:e.cacheTimeoutTime?e.cacheTimeoutTime:864e5,returnStatistics:e.returnStatistics}).then(function(n){return t._parseFilesResponse(n,e.returnStatistics)})},t}(n("1tKF").e)},"7l4e":function(e,t,n){"use strict";n.d(t,"t",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"n",function(){return o}),n.d(t,"e",function(){return s});var a=function(e,t){return e.replace("spappbarwebpack/spappbarwebpack.js","odsp-media/images/spappbar/"+t)},i=function(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp(e+"=([^&]*)").exec(t);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},r={"ftp:":"21","gopher:":"70","http:":"80","https:":"443","ws:":"80","wss:":"443"},o=function(e){var t=document.createElement("a");t.href=e;var n=t.hostname,a=t.origin,i=t.port,o=t.protocol;return a||(r.hasOwnProperty(o)?i&&r[o]!==i?o+"//"+n+":"+i:o+"//"+n:"null")},s=function(e,t,n){return e<768?"lists"===n?3:t?10:5:e<1024?"lists"===n?9:t?15:10:"lists"===n?14:t?20:15}},PltX:function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("17wl"),i=n("K9kD"),r=function(e){function t(t){var n=e.call(this,{dataSourceName:"SPHomeDataSource",id:"SPHomeDataSource"},{pageContext:t})||this;return n.isMicroserviceToken=function(e){return!!e.access_token},n._isDataSourceParam=function(e){return!!e.spHomeClientContext},n._spHomeCacheKey="spHome_"+t.aadUserId,n}return Object(a.__extends)(t,e),t.prototype.getFrequentSites=function(e,t,n,a,i,r,o,s){var c,d,l;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var u=e;d=u.spHomeClientContext,t=u.spHomeCachedItem,r=u.returnStatistics,o=u.cachingStrategy,s=u.cacheTimeoutTime}else d=e,o=0,a?o=3:i&&(o=2);return l=(null===(c=d)||void 0===c?void 0:c.Urls)&&d.Urls[0]?d.Urls[0]+"/api/v1/sites/feed?start=0&count=30&acronyms=true":"",this.getSPHomeData({spHomeClientContext:d,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFrequentSites",cacheRequestKey:this._spHomeCacheKey+"frequent",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getFollowedSites=function(e,t,n,a,i,r,o,s){var c,d,l;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var u=e;d=u.spHomeClientContext,t=u.spHomeCachedItem,r=u.returnStatistics,o=u.cachingStrategy,s=u.cacheTimeoutTime}else d=e,o=0,a?o=3:i&&(o=2);return l=(null===(c=d)||void 0===c?void 0:c.Urls)&&d.Urls[0]?d.Urls[0]+"/api/v1/sites/followed?mostRecentFirst=true&start=0&count=100&fillSiteData=true&fillSiteCount=10":"",this.getSPHomeData({spHomeClientContext:d,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetFollowedSites",cacheRequestKey:this._spHomeCacheKey+"followed",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getNews=function(e,t,n,a,i,r,o,s){var c,d,l;if(void 0===n&&(n=!0),this._isDataSourceParam(e)){var u=e;d=u.spHomeClientContext,t=u.spHomeCachedItem,r=u.returnStatistics,o=u.cachingStrategy,s=u.cacheTimeoutTime}else d=e,o=0,a?o=3:i&&(o=2);return l=(null===(c=d)||void 0===c?void 0:c.Urls)&&d.Urls[0]?d.Urls[0]+"/api/v1/news?start=0&count=30":"",this.getSPHomeData({spHomeClientContext:d,spHomeSitesCachedData:t,url:l,qosName:"spAppBarGetNews",cacheRequestKey:this._spHomeCacheKey+"news",returnStatistics:!!r,cachingStrategy:o,cacheTimeoutTime:s})},t.prototype.getHomeContext=function(){var e={url:this._pageContext.webAbsoluteUrl+"/_api/sphomeservice/context?$expand=Token,Payload",qosName:"spAppBarGetSPHomeToken",method:"GET",additionalHeaders:{accept:"application/json","SPHome-ClientType":"WebAppBar","Service-Worker-Navigation-Preload":"true"},cachingStrategy:3,cacheRequestKey:this._spHomeCacheKey+"token"};return this.getDataUtilizingPersistentCache(e)},t.prototype.shouldShowPostNewsTip=function(){return this.getDataUtilizingPersistentCache({url:this._pageContext.webAbsoluteUrl+"/_api/sitepages/pages/feed?promotedstate=2&published=true&$top=3",qosName:"GetFeedCount",method:"GET",cachingStrategy:3,parseResponse:function(e){var t,n,a;try{return(null===(a=null===(n=null===(t=JSON.parse(e))||void 0===t?void 0:t.d)||void 0===n?void 0:n.results)||void 0===a?void 0:a.length)<2}catch(e){return!0}}})},t.prototype.getSPHomeData=function(e){var t=e.cachingStrategy,n={url:e.url,qosName:e.qosName,method:"GET",additionalHeaders:{"sphome-apicontext":e.spHomeClientContext.Payload,"sphome-cachecontext":e.spHomeSitesCachedData.cacheContext,"sphome-clienttype":"WebAppBar"},cacheRequestKey:e.cacheRequestKey,cachingStrategy:t,returnStatistics:e.returnStatistics},a=e.spHomeClientContext.Token;return a&&(this.isMicroserviceToken(a)?n.authToken=a.access_token:n.authToken=a.AccessToken),e.url&&0!==e.url.length||(n.getData=function(){return i.Promise.resolve()}),e.cacheTimeoutTime&&(n.cacheTimeoutTime=e.cacheTimeoutTime),this.getDataUtilizingPersistentCache(n)},t}(n("1tKF").e)},X15L:function(e,t,n){"use strict";n.d(t,"e",function(){return i});var a=n("17wl"),i=function(e){function t(t){var n=e.call(this,{dataSourceName:"SharePointDataSource",id:"SharePointDataSource"},{pageContext:t})||this;return n._isCachedResultWithStatistic=function(e){return!!e.cacheStats},n._parseCreatePageRespose=function(e){var t,i=!1,r=!1;return n._isCachedResultWithStatistic(e)?(t=e.data,i=!0):t=e,t&&t.d&&(r=t.d.CanCreatePage),i?Object(a.__assign)(Object(a.__assign)({},e),{data:r}):r},n._parseCreatePromotedPageResponse=function(e){var t,i=!1,r=!1;return n._isCachedResultWithStatistic(e)?(t=e.data,i=!0):t=e,t&&t.d&&(r=t.d.CanCreatePromotedPage),i?Object(a.__assign)(Object(a.__assign)({},e),{data:r}):r},n._parseRecentListsFeedResponse=function(e){var t,i,r=!1;return n._isCachedResultWithStatistic(e)?(t=e.data,r=!0):t=e,i=t&&t.value?t.value.map(function(e){var t=e.color,n=e.icon,a=e.listId,i=e.listUrl,r=e.listTitle,o=e.siteId,s=e.siteTitle,c=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:a,listUrl:i,listTitle:r,siteId:o,siteTitle:s,siteUrl:c}}):[],r?Object(a.__assign)(Object(a.__assign)({},e),{data:i}):i},n._parseFavoriteListsFeedResponse=function(e){var t,i,r=!1;return n._isCachedResultWithStatistic(e)?(t=e.data,r=!0):t=e,i=t&&t.d.GetListsBy.results?t.d.GetListsBy.results.map(function(e){var t=e.color,n=e.icon,a=e.listId,i=e.listUrl,r=e.title,o=e.siteId,s=e.siteTitle,c=e.siteUrl;return{listColor:Number(t),listIcon:Number(n),listId:a,listUrl:i,listTitle:r,siteId:o,siteTitle:s,siteUrl:c}}):[],r?Object(a.__assign)(Object(a.__assign)({},e),{data:i}):i},n._cacheKey="sharepointAppBar_"+t.aadUserId,n.pageContext=t,n}return Object(a.__extends)(t,e),t.prototype.canCreatePage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e.siteUrl+"/_api/sitepages/cancreatepage"},qosName:"canCreatePage",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_canCreatePage_"+e.siteCache,cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseCreatePageRespose(e)})},t.prototype.canCreatePromotedPage=function(e){var t=this;return this.getDataUtilizingPersistentCache({getUrl:function(){return e.siteUrl+"/_api/sitepages/cancreatepromotedpage"},qosName:"canCreatePromotedPage",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_canCreatePromotedPage_"+e.siteCache,cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return t._parseCreatePromotedPageResponse(e)})},t.prototype.getRecentLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/sp.RecentListProxy.GetRecentListsProxy/",qosName:"getRecentLists",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getRecentLists",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseRecentListsFeedResponse(e):[]})},t.prototype.getFavoriteLists=function(e){var t=this;return this.getDataUtilizingPersistentCache({url:this.pageContext.webAbsoluteUrl+"/_api/SP.FavoriteLists.GetListsBy",qosName:"getFavoriteLists",method:"GET",noRedirect:!0,cacheRequestKey:this._cacheKey+"_getFavoriteLists",cachingStrategy:e.cachingStrategy,cacheTimeoutTime:e.cacheTimeoutTime,returnStatistics:e.returnStatistics}).then(function(e){return e?t._parseFavoriteListsFeedResponse(e):[]}).catch(function(e){var t;if(e&&"-1, System.NotSupportedException"===(null===(t=e)||void 0===t?void 0:t.code))return[]})},t}(n("1tKF").e)},rEuA:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("cDcd"),r=n("KL1q"),o=n("7l4e"),s=n("u61L"),c=n("2pHE"),d=n("jidH"),l=n("PltX"),u=n("X15L"),f=n("K9kD");function p(e){return function(e){return!!e&&"object"==typeof e&&"default"in e}(e)?e.default:e}var m=i.lazy(function(){return n.e(19).then(n.bind(null,"ApqP"))}),_=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(21)]).then(n.bind(null,"fPGQ"))}),h=i.lazy(function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"wbrr"))}),b=i.lazy(function(){return Promise.all([n.e(0),n.e(16)]).then(n.bind(null,"Qlsk"))}),g=i.lazy(function(){return Promise.all([n.e(0),n.e(18)]).then(n.bind(null,"/g7a"))}),v=i.lazy(function(){return Promise.all([n.e(0),n.e(14)]).then(n.bind(null,"ssIs"))}),y=i.lazy(function(){return Promise.all([n.e(0),n.e(17)]).then(n.bind(null,"OHOp"))}),S=i.lazy(function(){return Promise.all([n.e(0),n.e(3),n.e(20)]).then(n.bind(null,"at/T"))}),D=i.lazy(function(){return Promise.all([n.e(0),n.e(3)]).then(n.bind(null,"/b/M"))}),I=i.lazy(function(){return Promise.all([n.e(0),n.e(13)]).then(n.bind(null,"+zdj"))}),x=i.lazy(function(){return Promise.all([n.e(0),n.e(1),n.e(15)]).then(n.bind(null,"J707"))}),C=i.lazy(function(){return Promise.all([n.e(0),n.e(4),n.e(22)]).then(n.bind(null,"o6Ee"))}),O=i.lazy(function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"D4Sx"))}),w={ODB:60124},E={ODB:60357},A=function(){return f.Killswitch.isActivated("c92e40dc-3388-4078-a457-9b15495593d2","8/12/2021","window event listener mem leak fix")},L=function(e){function t(t){var a,i=e.call(this,t)||this;i.componentData={},i.receivedNewData=function(e,t){var n,a;if(e&&t)if(i._determineIfNavLinkGroup(e))i.componentData[t]=e;else{var r=i.componentData[t];(null===(a=null===(n=r)||void 0===n?void 0:n.cacheStats)||void 0===a?void 0:a.lastModified)?e.cacheStats.lastModified>r.cacheStats.lastModified?i.componentData[t]=e:isNaN(e.cacheStats.lastModified)&&(e.cacheStats.lastModified=Date.now(),i.componentData[t]=e):i.componentData[t]=e}},i._isTokenExpired=function(e){var t;return!(null===(t=e)||void 0===t?void 0:t.Token)||i._getExpirationTimeLeft(e.Token)<=0},i._getExpirationTimeLeft=function(e){return i.dataSource.isMicroserviceToken(e)?1e3*parseInt(e.expires_on,10)-Date.now():1e3*parseInt(e.ExpiresOn,10)-Date.now()},i._clearClientContext=function(){Object(s.m)()||i.state.clientContext||null===i.state.clientContext||i.setState({clientContext:null})},i._setTimeoutAndGetHomeContext=function(e){(Object(s.m)()||e>0)&&(i.tokenRefreshTimer=i.tokenRefreshAsync.setTimeout(function(){i.dataSource.getHomeContext().then(function(e){i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},e))},i._checkAndSetContext=function(e,t){if(e.Token){var n=e.Token,a=i._getExpirationTimeLeft(n);a>=3e4&&(t||i.setState({clientContext:e}),i._setTimeoutAndGetHomeContext(a-3e4))}else i._clearClientContext()},i._shouldPrewarm=function(e){return!i.hasGottenFreshData&&("blank"===e.workload&&"blank"!==i.state.workload||!i._isFetchTokenKSActivated()&&"teams"===i.state.workload)},i._determineIfNavLinkGroup=function(e){return!!e.name},i._handleWorkloadMessages=function(e){if(e.origin===i.windowOrigin&&e.data&&e.data.type)if("spAppBarWorkload"===e.data.type){var t=Object(o.a)("workload",e.data.payload);i.setState({workload:t})}else if("setRTL"===e.data.type){var n=e.data.isRTL?"rtl":"ltr";document.documentElement.setAttribute("dir",n)}else"spAppBarWorkloadBlank"===e.data.type&&i.setState({workload:"blank"})},i._messageParentAppStarted=function(){window.postMessage({type:"spAppBarPanelStarted"},i.windowOrigin)},i._isFetchTokenKSActivated=function(){return f.Killswitch.isActivated("e58df739-96ea-4281-82b1-61ce8550c069","4/12/2021","fetch token if expired in prewarm")},i._setUpAndPrewarm=function(e){i._isFetchTokenKSActivated()||i._fetchTokenIfExpired(),i.hasGottenFreshData=!0,i.filesDataSource=new c.e(i.pageContext),i.globalnavDataSource=new d.e(i.pageContext),i.sharePointDataSource=new u.e(i.pageContext),i._prewarmDataClick(e)},i._fetchTokenIfExpired=function(){i._isTokenExpired(i.state.clientContext)&&i.dataSource.getHomeContext().then(function(e){i.tokenRefreshTimer&&i.tokenRefreshAsync.clearTimeout(i.tokenRefreshTimer),i._checkAndSetContext(e)}).catch(function(){i._clearClientContext()})},i._prewarmDataClick=function(e){n.e(6).then(n.bind(null,"0eCT")).then(p).then(function(t){var n,a;"files"!==e&&(t.logData({name:"SPAppBar.Files.DataClick"}),i._getFilesNetwork()),"globalnav"!==e&&(null===(n=i.pageContext.appBarParams)||void 0===n?void 0:n.isGlobalNavEnabled)&&(null===(a=i.pageContext.companyPortalReference)||void 0===a?void 0:a.SiteId)&&(t.logData({name:"SPAppBar.GlobalNav.DataClick"}),i.globalnavDataSource.getGlobalNav(!1).catch()),"news"!==e&&(t.logData({name:"SPAppBar.News.DataClick"}),i._getSPHomeNetwork(i.dataSource.getNews.bind(i.dataSource),s.c,s.o,"news")),"sites"!==e&&(t.logData({name:"SPAppBar.Frequent.DataClick"}),i._getSPHomeNetwork(i.dataSource.getFrequentSites.bind(i.dataSource),s.d,s.i,"frequent"),t.logData({name:"SPAppBar.Followed.DataClick"}),i._getSPHomeNetwork(i.dataSource.getFollowedSites.bind(i.dataSource),s.d,s.a,"followed")),"lists"!==e&&f.FeatureOverrides.isFeatureEnabled(E)&&(t.logData({name:"SPAppBar.Lists.Recent.DataClick"}),i._getRecentListsNetwork(),t.logData({name:"SPAppBar.Lists.Favorite.DataClick"}),i._getFavoriteListsNetwork())})},i._getFilesNetwork=function(){i.filesDataSource.getRecentFiles({cachingStrategy:1,returnStatistics:!0,maxItems:s.t}).then(function(e){i.receivedNewData(e,"files")}).catch()},i._getRecentListsNetwork=function(){i.sharePointDataSource.getRecentLists({cachingStrategy:0,cacheTimeoutTime:s.r,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"recentLists")}).catch()},i._getFavoriteListsNetwork=function(){i.sharePointDataSource.getFavoriteLists({cachingStrategy:0,cacheTimeoutTime:s.r,returnStatistics:!0}).then(function(e){i.receivedNewData(e,"favoriteLists")}).catch()},i._getSPHomeNetwork=function(e,t,n,a){var r=i.state.cachedData&&i.state.cachedData.find(function(e){return e.Key===n}),o=null;if(r&&i.state.clientContext?o=e({cachingStrategy:1,spHomeCachedItem:r.Value,spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t}):i.state.clientContext&&i.state.clientContext.Token&&(o=e({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:i.state.clientContext,returnStatistics:!0,cacheTimeoutTime:t})),o){switch(a){case"news":i.needsNewsData=!1;break;case"frequent":i.needsFrequentData=!1;break;case"followed":i.needsFollowedData=!1}o.then(function(e){i.receivedNewData(e,a)}).catch()}else switch(a){case"news":i.needsNewsData=!0;break;case"frequent":i.needsFrequentData=!0;break;case"followed":i.needsFollowedData=!0}};var r=Object(o.a)("workload",t.query);return i.state={workload:r,cachedData:void 0,clientContext:void 0},i.pageContext=i.props.spPageContextInfo?i.props.spPageContextInfo:window._spPageContextInfo,i.windowOrigin=f.Killswitch.isActivated("d8afff78-f409-446a-9a1f-2d573b688a46","5/14/2021","use window origin")?Object(o.n)(null===(a=i.pageContext.appBarParams)||void 0===a?void 0:a.portalUrl):window.location.origin,i.dataSource=new l.e(i.pageContext),i.tokenRefreshTimer=0,i.tokenRefreshAsync=new f.Async,A()&&(window.addEventListener("message",i._handleWorkloadMessages.bind(i)),i._messageParentAppStarted()),i}return Object(a.__extends)(t,e),t.prototype.componentDidUpdate=function(e,t){!t.clientContext&&this.state.clientContext&&(this.needsNewsData&&this._getSPHomeNetwork(this.dataSource.getNews.bind(this.dataSource),s.c,s.o,"news"),this.needsFrequentData&&this._getSPHomeNetwork(this.dataSource.getFrequentSites.bind(this.dataSource),s.d,s.i,"frequent"),this.needsFollowedData&&this._getSPHomeNetwork(this.dataSource.getFollowedSites.bind(this.dataSource),s.d,s.a,"followed")),this._fetchTokenIfExpired(),this._shouldPrewarm(t)&&f.FeatureOverrides.isFeatureEnabled(w)&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentDidMount=function(){A()||(window.addEventListener("message",this._handleWorkloadMessages),this._messageParentAppStarted()),"blank"!==this.state.workload&&f.FeatureOverrides.isFeatureEnabled(w)&&this._setUpAndPrewarm(this.state.workload)},t.prototype.componentWillUnmount=function(){A()||window.removeEventListener("message",this._handleWorkloadMessages)},t.prototype.render=function(){var e;switch(this.state.workload){case"globalnav":if(this.componentData.globalnav){var t=this.componentData.globalnav;e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(h,{rawNavData:t,useRouterNavigation:!1,pageContext:this.pageContext,onDismissAppBarPanel:this.props.onDismissAppBarPanel}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(_,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext}));break;case"sites":if(this.componentData.frequent&&this.componentData.followed){var a=this.componentData.frequent,r=this.componentData.followed;e=Object(s.p)(a.cacheStats.lastModified,s.d)&&Object(s.p)(r.cacheStats.lastModified,s.d)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(g,{frequentSites:Object(s.g)(a.data),followedSites:Object(s.g)(r.data),useRouterNavigation:!1,hideFrequentSites:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!1)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(b,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!1)}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(b,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!1)}));break;case"news":if(this.componentData.news){var c=this.componentData.news;e=Object(s.p)(c.cacheStats.lastModified,s.c)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(y,{news:Object(s.b)(c.data),useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(v,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!0)}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(v,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!0)}));break;case"files":if(this.componentData.files){this.initializedIcons||(this.initializedIcons=!0,n.e(7).then(n.bind(null,"2dTS")).then(p).then(function(e){e.initializeFileTypeIcons()}));var d=this.componentData.files;e=Object(s.p)(d.cacheStats.lastModified,s.n)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(D,{files:d.data,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!0)})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!0)}))}else this.initializedIcons||(this.initializedIcons=!0,n.e(7).then(n.bind(null,"2dTS")).then(p).then(function(e){e.initializeFileTypeIcons()})),e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(S,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,countToRender:Object(o.e)(window.innerHeight,!0)}));break;case"teams":e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(x,{useRouterNavigation:!0,clientContext:this.state.clientContext,cachedData:this.state.cachedData,pageContext:this.pageContext}));break;case"create":this.initializedIcons||(this.initializedIcons=!0,n.e(7).then(n.bind(null,"2dTS")).then(p).then(function(e){e.initializeFileTypeIcons()})),this.componentData.frequent&&this.componentData.followed?(a=this.componentData.frequent,r=this.componentData.followed,e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(I,{clientContext:this.state.clientContext,pageContext:this.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,frequentSites:Object(s.g)(a.data),followedSites:Object(s.g)(r.data),countToRender:Object(o.e)(window.innerHeight,!1)}))):e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(I,{clientContext:this.state.clientContext,pageContext:this.pageContext,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel}));break;case"lists":if(this.componentData.recentLists&&this.componentData.favoriteLists){var l=this.componentData.recentLists,u=this.componentData.favoriteLists;e=Object(s.p)(l.cacheStats.lastModified,s.r)&&Object(s.p)(u.cacheStats.lastModified,s.r)?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(O,{recentLists:l.data,favoriteLists:u.data,useRouterNavigation:!1,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,maxItems:Object(o.e)(window.innerHeight,!1,"lists")})):i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,maxItems:Object(o.e)(window.innerHeight,!1,"lists")}))}else e=i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(C,{useRouterNavigation:!1,sendUpdatedDataToParent:this.receivedNewData,clientContext:this.state.clientContext,cachedData:this.state.cachedData,onDismissAppBarPanel:this.props.onDismissAppBarPanel,pageContext:this.pageContext,maxItems:Object(o.e)(window.innerHeight,!1,"lists")}));break;case"blank":default:e=null}return e?i.createElement(i.Suspense,{fallback:i.createElement("div",null)},i.createElement(m,{content:e})):null},t}(i.PureComponent),k=function(e){function t(t){var n=e.call(this,t)||this;return n._handleEventFromAppBar=function(e){e.origin===window.location.origin&&e.data&&e.data.type&&("spAppBarWorkload"===e.data.type?e.data.payload!==n.state.appbarQueryString?n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload}):n.state.showAppBarCallout||(n.state.firstClose?n.setState({firstClose:!1}):n.setState({showAppBarCallout:!0,appbarQueryString:e.data.payload})):"CLOSE_CALLOUT"!==e.data.type&&"spAppBarCreateSite"!==e.data.type||n.state.showAppBarCallout&&n.setState({showAppBarCallout:!1}))},n._dismissAppBarPanel=function(e){var t;if(n.state.showAppBarCallout&&(!e||!e.target||"sp-appBar-link"!==e.target.className)){if("focus"===(null===(t=e)||void 0===t?void 0:t.type))return;n.setState({showAppBarCallout:!1}),window.postMessage({type:"CLOSE_CALLOUT"},window.location.origin),window.postMessage({type:"spAppBarWorkloadBlank"},window.location.origin)}},window.addEventListener("message",n._handleEventFromAppBar),n.state={showAppBarCallout:!1,appbarQueryString:"/_layouts/15/spappbar.aspx?workload=blank",firstClose:!1},n}return Object(a.__extends)(t,e),t.prototype.render=function(){var e=document.getElementById("sp-appBar").classList.contains("sp-appBar-mobile"),t={root:{height:"100%",display:"flex",flexDirection:"column",minWidth:e?"100vw":"320px",maxWidth:e?"unset":"320px",borderRadius:0,boxShadow:"10px 5.4px 14.4px -10px rgb(0 0 0 / 13%), 10px 0.2px 3.6px -10px rgb(0 0 0 / 11%)",animation:"none",bottom:"0px !important"},container:{height:"100%",zIndex:10},calloutMain:{display:"flex",flexDirection:"column",height:"100%",borderRadius:0},beak:{height:"97%"},beakCurtain:{height:"96%"}};return i.createElement(r.Callout,{className:"spappbar-callout",id:"sp-appBar-callout",gapSpace:0,target:".sp-appBar",isBeakVisible:!1,directionalHint:r.DirectionalHint.topCenter,setInitialFocus:!0,styles:t,doNotLayer:!0,minPagePadding:-1,hidden:!this.state.showAppBarCallout,onDismiss:this._dismissAppBarPanel,shouldUpdateWhenHidden:!0,dismissOnTargetClick:!0},i.createElement(L,{query:this.state.appbarQueryString,onDismissAppBarPanel:this._dismissAppBarPanel,spPageContextInfo:this.props.spPageContextInfo}))},t}(i.Component);t.default=k},u61L:function(e,t,n){"use strict";n.d(t,"s",function(){return r}),n.d(t,"e",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"d",function(){return c}),n.d(t,"n",function(){return d}),n.d(t,"r",function(){return l}),n.d(t,"o",function(){return u}),n.d(t,"i",function(){return f}),n.d(t,"a",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"m",function(){return _}),n.d(t,"f",function(){return h}),n.d(t,"h",function(){return b}),n.d(t,"p",function(){return g}),n.d(t,"_",function(){return v}),n.d(t,"y",function(){return y}),n.d(t,"u",function(){return S}),n.d(t,"b",function(){return D}),n.d(t,"g",function(){return I}),n.d(t,"l",function(){return x}),n.d(t,"v",function(){return C});var a=n("K9kD"),i=n("KL1q"),r="_spAppBarNewsSitesCachedData",o="_spAppBarHomeClientContext",s=36e5,c=144e5,d=9e5,l=36e5,u="SPHomeWeb:news",f="SPHomeWeb:sites/feed",p="SPHomeWeb:sites/followed",m=30,_=function(){return a.Killswitch.isActivated("05b7fa9c-b894-4890-baa4-8276069fb1a0","8/26/2021","error states on token fetch error")},h=function(e,t,n,i,r,o,s,c,d){if(e)return t({cachingStrategy:2,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:{Urls:[""],Token:{AccessToken:"",ExpiresOn:""}},returnStatistics:!0}).then(function(e){var t,r;return e&&(a.Killswitch.isActivated("bfe78ae3-ed54-4f77-b63b-e91d3ae8c0ff","11/17/2020","Only send data to parent if exists")||(null===(r=null===(t=e)||void 0===t?void 0:t.data)||void 0===r?void 0:r.Items)&&e.data.Items.length>0)?(d(e,i),g(e.cacheStats.lastModified,n)?{data:c(e.data),stale:!1,date:e.cacheStats.lastModified}:{data:c(e.data),stale:!0,date:e.cacheStats.lastModified}):{data:[],stale:!0,date:0}});var l=o&&o.find(function(e){return e.Key===s}),u=null;return l&&r?u=t({cachingStrategy:1,spHomeCachedItem:l.Value,spHomeClientContext:r,returnStatistics:!0,cacheTimeoutTime:n}):r&&r.Token&&(u=t({cachingStrategy:1,spHomeCachedItem:{cacheContext:null,cacheValue:""},spHomeClientContext:r,returnStatistics:!0,cacheTimeoutTime:n})),u?u.then(function(e){var t,n;return a.Killswitch.isActivated("bfe78ae3-ed54-4f77-b63b-e91d3ae8c0ff","11/17/2020","Only send data to parent if exists")||(null===(n=null===(t=e)||void 0===t?void 0:t.data)||void 0===n?void 0:n.Items)&&e.data.Items.length>0?(d(e,i),{data:c(e.data),stale:!1,date:Date.now()}):{data:[],stale:!0,date:0}}):Promise.resolve({data:[],stale:!0,date:0})},b=function(e,t){try{if(e){var n=JSON.parse(e);if(n)return t(n)}}catch(e){}},g=function(e,t){return Date.now()-e<=t},v=function(e){return function(t){1!==t.button&&2!==t.button||a.Engagement.logData({name:e})}},y=function(e){return e.which===Object(i.getRTLSafeKeyCode)(i.KeyCodes.right)},S=function(e){return function(t){var n;t.which===i.KeyCodes.enter&&(null===(n=document.getElementById(e))||void 0===n||n.click())}},D=function(e){return e.Items.map(function(e){var t=e.Author,n=e.Description,a=e.ImageUrl,i=e.Title,r=e.IsAuthoritativeNews,o=e.OriginalUrl||e.Url,s=new Date(e.FirstPublishedDate),c=e.Site,d=c.ItemReference;return{author:t,description:n,isAuthoritative:r,publishDate:s,site:{id:d.WebId,siteCollectionId:d.SiteId,title:c.Title,isExternal:c.IsExternalContent,serverRelativeUrl:c.OriginalUrl||c.Url,icon:c.BannerImageUrl,color:c.BannerColor,acronym:c.Acronym,indexId:d.IndexId,itemReference:d,weight:c.Weight||0,pinOrder:c.PinOrder,webTemplateId:0,allowPinning:!!d&&!!d.SiteId&&!!d.WebId},title:i,url:o,image:a}})},I=function(e){return e.Items.map(function(e){var t=e.ItemReference,n=t.WebId,a=t.SiteId,i=t.IndexId,r=e.Title,o=e.IsExternalContent,s=e.ItemReference,c=e.BannerImageUrl,d=e.BannerColor,l=e.Acronym,u=e.Weight,f=e.PinOrder,p=e.WebTemplate;return{id:n,siteCollectionId:a,title:r,isExternal:o,serverRelativeUrl:e.OriginalUrl||e.Url,icon:c,color:d,acronym:l,indexId:i,itemReference:s,weight:u||0,pinOrder:f,allowPinning:!!s&&!!s.SiteId&&!!s.WebId,webTemplateId:0,WebTemplate:p}})},x=function(e,t,n,a){var i=(a?t.filter(function(e){return e.serverRelativeUrl!==a}):t).slice(0,n);return[e.filter(function(e){return a?e.serverRelativeUrl!==a:i.reduce(function(t,n){return t&&n.serverRelativeUrl!==e.serverRelativeUrl},!0)}),i]},C=function(){return a.Killswitch.isActivated("5f63801e-33ab-4a4f-b625-bf3d487f6798","4/21/2021","Teams panel should stop using post messaging for routing")}}}]);