(window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0=window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0||[]).push([[1],{gbBp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return W});var a=n("Pk8u");function i(e,t,n){return void 0===n&&(n=!1),function(a,i,r,o,s){void 0===r&&(r=!1),void 0===o&&(o=""),void 0===s&&(s=!1);var c,d,l=0,u=function(){return s&&l>0&&l<=2};return a.withPeriodicRefresh(e,(c=function(){return(r?a.fetchSharePointDigestV2({endpoint:i,overrideDigest:o,tokenProvider:function(){return Promise.resolve("")}}):a.fetchSharePointDigest({endpoint:i,forceDigestRefresh:u})).then(function(e){return JSON.parse(e.xhr.responseText).d.GetContextWebInformation.FormDigestValue}).then(function(e){return a.fetchAcquireToken({portalUrl:i,resourceUrl:t,digest:e,useSTI:n})}).then(function(e){var t=JSON.parse(e.xhr.responseText).access_token;return l=0,t}).catch(function(e){throw e&&e.status&&403===e.status&&s&&l++,new Error("Failed to retrieve a valid token")})},d=void 0,function(e){return!e.attempt&&d?d:d=c()}))}}var r,o=Object(a.once)(i("bingSerpTokenProvider","https://www.bing.com")),s=Object(a.once)(i("lokiAadSearchBoxTokenProvider","https://loki.delve.office.com")),c=Object(a.once)(i("stiSubstrateTokenProvider","https://substrate.office.com",!0)),d=Object(a.once)(i("aadSubstrateTokenProvider","https://outlook.office365.com/search",!1)),l=Object(a.once)(i("aadGallatinSubstrateTokenProvider","https://partner.outlook.cn/search",!1)),u=n("K9kD"),f=n("UWqr");function p(e){return function(){return f._SPFlight.isEnabled(e)}}var m,_,h=p(1407),b=p(1369),g=p(1323),v=p(1324),y=(p(1356),p(1574)),S=p(1575),D=(p(1102),p(1260),p(218),p(1433),p(1411),p(1571)),I=p(1572),x=(p(1240),p(1810),p(1291),p(1565),p(1563),p(1579)),C=p(1580),O=(p(1598),p(1313)),w=p(1321),E=(p(1055),p(1228),p(1421),p(1422),p(1166),p(1682)),A=p(1720),L=(p(1721),p(1062)),k=p(1103),M=p(1853),P=p(1888),T=(p(1823),p(60095),p(9410),n("rHDF")),U=n("I6WN"),F=n("zLqp"),H=Object(a.once)(function(){m=new F.Dispatcher,_=[],m.register(function(e){return _.push(e)}),Object(U.t)(m)}),R=!1;function N(e,t,n,a,i,o,s,c){return void 0===o&&(o=.5),void 0===s&&(s=!0),void 0===c&&(c=!1),function(d){var l=r;if(!l)throw new Error("checking experiment "+e+" before calling initSearchExperiments");if(R||(u.ABExperiment.Init(l),R=!0),!s&&Object(T.e)(l))return!1;if(t())return!0;if(n()){var f=new u.ABExperiment({name:a,startDate:i,segmentPopulation:o}).IsExperimentOn();return c&&(H(),Object(U.e)()).dispatch({eventType:"USAGE",nameDetail:"searchux."+a,name:"experiments",properties:{inTreatment:f}}),d&&d.sets&&d.sets("searchux."+e+"Experiment",f),f}return!1}}var B,j,V=N("aadTokenForSubstrate",x,C,"AadTokenForSubstrateExperiment","06/01/2019"),z=(N("digestV2",O,w,"DigestV2Experiment","06/25/2019"),N("enableQueryRules",D,I,"EnableQueryRulesExperiment","08/05/2019"),N("answerBlock",h,b,"showAnswerBlock","03/26/2019"),N("useSubstrateSearch",g,v,"SubstrateSearchExperiment","15/05/2019",.5,!1),N("use3SAnswers",y,S,"Use3SAnswersExperiment","05/01/2019"),N("use3SFileSuggestions",function(){return!1},function(){return!1},"3SFileSuggestionsExperiment","10/01/2019"),N("use3SPeopleSuggestions",function(){return!1},function(){return!1},"3SPeopleSuggestionsExperiment","16/01/2019"),N("use3SSiteSuggestions",function(){return!1},function(){return!1},"3SSiteSuggestionsExperiment","10/01/2019"),N("use3SEarlyWarmup",E,A,"3SEarlyWarmupExperiment","11/10/2019"),N("useUnifiedPrefetch",L,k,"unifiedPrefetchExperiment","09/12/2019"),N("personalizedSpeller",M,P,"personalizedSpellerExperiment","01/03/2020",.5,!0,!0),n("Gcel")),G=n("/pCg"),K=n("6bZ6");function W(e,t,n,a){var i;z.t(a),i=t.legacyPageContext,r=i;var u=function(e,t){return B||(B={BingForBusiness:o(G,t),Loki:s(G,t),Substrate:(n=G,a=V(),i=t,void 0===r&&(r=!1),void 0===u&&(u="Prod"),a?function(e){switch(e){case"Gallatin":return l;default:return d}}(u)(n,i,r,void 0,void 0):c(n,i,r,void 0,void 0)),SharePointSites:function(n){return!n.attempt&&j||(j=function(e){return K.e({url:e+"/_api/sphomeservice/context?$expand=Token,Payload",method:"GET",headers:{Accept:"application/json","SPHome-ClientType":"Web"}}).then(function(e){var t=e.responseText;return JSON.parse(t)})}(t).then(function(t){var n=t.Payload,a=t.Token,i=a.access_token,r=a.resource;if(!e||!e.Search)throw new Error("No search shim available.");return e.Search.SetSharePointHomeApiRequestInfo({url:r+"/api/v1",context:JSON.parse(n)}),i}))}});var n,a,i,r,u}(e,t.web.absoluteUrl);return n.markHeaderBoot(),{tokenProviders:u}}}}]);