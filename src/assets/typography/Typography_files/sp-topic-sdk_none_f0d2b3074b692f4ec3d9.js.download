define("a68dd513-949e-48c1-b210-23ad37dbbe13_0.1.0",["tslib","@microsoft/sp-loader","@microsoft/sp-core-library","@ms/sp-component-utilities","@microsoft/sp-diagnostics"],function(n,a,i,r,o){return function(e){function t(t){for(var n,i,r=t[0],o=t[1],s=0,c=[];s<r.length;s++)i=r[s],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&c.push(a[i][0]),a[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(d&&d(t);c.length;)c.shift()()}var n={},a={1:0};function i(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.e=function(t){for(var n=[],o=function(e){return{0:[{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.1.176",m:"K9kD"}]}[e]||[]}(t),s=0;s<o.length;s++)e[o[s].m]||function(t){n.push(r.SPComponentLoader.loadComponentById(t.i,t.v).then(function(n){e[t.m]=function(e){e.exports=n}}))}(o[s]);var c=a[t];if(0!==c)if(c)n.push(c[2]);else{var d=new Promise(function(e,n){c=a[t]=[e,n]});n.push(c[2]=d);var l,u=document.createElement("script");u.charset="utf-8",u.timeout=120,i.nc&&u.setAttribute("nonce",i.nc),u.src=function(e){return i.p+"chunk."+({0:"odsp-datasources-loki"}[e]||e)+"_"+"none"+"_"+{0:"c559c4f1d38ae643f0a5",2:"4878d2f4a492f90a44ac"}[e]+".js"}(t),0!==u.src.indexOf(window.location.origin+"/")&&(u.crossOrigin="anonymous");var f=new Error;l=function(e){u.onerror=u.onload=null,clearTimeout(p);var n=a[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),r=e&&e.target&&e.target.src;f.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",f.name="ChunkLoadError",f.type=i,f.request=r,n[1](f)}a[t]=void 0}};var p=setTimeout(function(){l({type:"timeout",target:u})},12e4);u.onerror=u.onload=l,document.head.appendChild(u)}return Promise.all(n)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var r=i("I6O9");i.oe=function(e){throw console.error(e),e};var o=window.webpackJsonpa68dd513_949e_48c1_b210_23ad37dbbe13_0_1_0=window.webpackJsonpa68dd513_949e_48c1_b210_23ad37dbbe13_0_1_0||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var d=s;return function(){var e,t=document.getElementsByTagName("script"),n="undefined"!=typeof spScriptNamePattern?spScriptNamePattern:/sp-topic-sdk_none_f0d2b3074b692f4ec3d9\.js/i;if(t&&t.length)for(var a=0;a<t.length;a++)if(t[a]){var r=t[a].getAttribute("src");if(r&&r.match(n)){e=r.substring(0,r.lastIndexOf("/")+1);break}}if(!e)for(var o in window.__setWebpackPublicPathLoaderSrcRegistry__)if(o&&o.match(n)){e=o.substring(0,o.lastIndexOf("/")+1);break}i.p=e}(),i(i.s="mwqp")}({"17wl":function(e,t){e.exports=n},I6O9:function(e,t){e.exports=a},UWqr:function(e,t){e.exports=i},"hiL/":function(e,t){e.exports=r},ixFB:function(e,t,n){"use strict";function a(){for(var e=function(){return"object"==typeof window&&window.crypto&&(e=new Uint8Array(31),window.crypto.getRandomValues(e),e)||function(){for(var e=new Array(31),t=0;t<31;t++)e[t]=Math.floor(16*Math.random());return e}();var e}(),t=0,n="",a=0;a<36;a++)switch(a){case 8:case 13:case 18:case 23:t+=1,n+="-";break;case 14:t+=1,n+="4";break;case 19:n+=(e[a-t]%4+8).toString(16);break;default:n+=(e[a-t]%16).toString(16)}return n}n.d(t,"e",function(){return a})},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"initializeTopicsSDK",function(){return be}),n.d(t,"getTopicsSDKAsync",function(){return _e}),n.d(t,"tryGetTopicsSDK",function(){return he}),n.d(t,"TopicCache",function(){return de});var a={};n.r(a),n.d(a,"getMyTopics",function(){return I}),n.d(a,"getTopicAnnotations",function(){return C}),n.d(a,"getTopicById",function(){return w}),n.d(a,"getTopicsByIds",function(){return E}),n.d(a,"getTopicsByName",function(){return L}),n.d(a,"getLokiConfiguration",function(){return P}),n.d(a,"fetchTopicsCapabilities",function(){return T}),n.d(a,"createTopicLite",function(){return U}),n.d(a,"createQosEvent",function(){return v}),n.d(a,"QosEvent",function(){return g}),n.d(a,"logEvent",function(){return y}),n.d(a,"retrieveTopicsCapabilities",function(){return V}),n.d(a,"isTopicsEnabled",function(){return z}),n.d(a,"canUserEditTopics",function(){return G}),n.d(a,"canUserManageTopics",function(){return K}),n.d(a,"canUserViewTopics",function(){return W}),n.d(a,"isPreviewUser",function(){return q}),n.d(a,"getKnowledgeCenter",function(){return Q}),n.d(a,"getKnowledgeCenterInfo",function(){return Y}),n.d(a,"getTopicsCapabilities",function(){return J}),n.d(a,"getTopicsCapabilitiesCache",function(){return X}),n.d(a,"getTopicUrl",function(){return Z}),n.d(a,"initialize",function(){return ne}),n.d(a,"TopicCache",function(){return de});var i=n("17wl"),r=n("ut3N"),o=n("hiL/"),s=n("ixFB"),c={initialized:!1};function d(e,t){c[e]=t}function l(e){return c[e]}var u,f,p=function(){return(p=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},m=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},_=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};function h(){return m(this,void 0,void 0,function(){var e;return _(this,function(t){switch(t.label){case 0:return f?[3,2]:[4,n.e(2).then(n.bind(null,"6lB+")).then(function(e){return e.AWTLogManager})];case 1:(e=t.sent()).initialize("8f7cccc3c534426e8894f45b76e666b9-b80f2549-ddb1-4588-8602-f54037a070e7-7552"),f=e.getLogger("8f7cccc3c534426e8894f45b76e666b9-b80f2549-ddb1-4588-8602-f54037a070e7-7552"),t.label=2;case 2:return[2,f]}})})}function b(e,t,n,a){return null==u?void 0:u.then(function(){!function(e,t,n,a){var i,r,o,s,c,d,u,m;if(!f)throw new Error("Logger is not initialized.");var _=t.EventId.match(/Cortex.(\w+)\.(\w+)\.(\w+)/);if(!_||4!==_.length)throw new Error('EventId "'+t.EventId+'" is not valid. Format is "Cortex.<Area>.<Scenario>.<Operation>');var h=p({},t),b=l("bootstrapperConfig"),g=l("lokiConfig");h.EventId=_[0],h.nameDetail=_[0],h.Area=_[1],h.Scenario=_[2],h.Operation=_[3],b&&(h.ClientCorrelationId=b.clientCorrelationId,h.Environment=b.region,h.Workload=b.clientType),h.UserAadObjectId=null!==(r=null!==(i=null==b?void 0:b.UserAadObjectId)&&void 0!==i?i:null==g?void 0:g.UserAadObjectId)&&void 0!==r?r:"",h.UserPuid=null!==(s=null!==(o=null==b?void 0:b.UserPuid)&&void 0!==o?o:null==g?void 0:g.UserPuid)&&void 0!==s?s:"",h.TenantAadObjectId=null!==(d=null!==(c=null==b?void 0:b.TenantAadObjectId)&&void 0!==c?c:null==g?void 0:g.TenantAadObjectId)&&void 0!==d?d:"",h.SiteSubscriptionId=null!==(m=null!==(u=null==b?void 0:b.TenantAadObjectId)&&void 0!==u?u:null==g?void 0:g.TenantAadObjectId)&&void 0!==m?m:"",h.IsIntentional=(null==a?void 0:a.isIntentional)||!1,h.SdkVersion="1.20210825.9.0",h.AccountType="Business",n&&Object.keys(n).forEach(function(e){var t=n[e];null!=t&&("string"==typeof t?(t=t.trim())&&(h["CustomData_"+e]=n[e]):h["CustomData_"+e]=n[e])}),f.logEvent({name:e,properties:h})}(e,t,n,a)})}var g=function(){function e(e,t){this._qosName=e,this._options=t,this._startTime=window.performance.now(),this._endTime=void 0}return e.prototype.logSuccess=function(e){this.logQos("Success",e)},e.prototype.logExpectedFailure=function(e,t,n){this.logQos("ExpectedFailure",n,e,t)},e.prototype.logUnexpectedFailure=function(e,t,n){this.logQos("UnexpectedFailure",n,e,t)},e.prototype._logUnexpectedFailureAsync=function(e,t,n){return this.logQos("UnexpectedFailure",n,e,t)},e.prototype.logQos=function(e,t,n,a){var i;if(this._endTime)return Promise.resolve();this._endTime=window.performance.now();var r={EventId:this._qosName,ResultType:e,Duration:this._endTime-this._startTime};n&&(r.ResultCode=n),a&&(r.Error=a.message);var o=[b("cortex_qos_event",r,t,this._options)];return(null===(i=this._options)||void 0===i?void 0:i.logEngagement)&&o.push(b("cortex_engagement_event",r,t,this._options)),Promise.all(o).then(function(){})},e}();function v(e,t){return new g(e,t)}function y(e,t,n){b("cortex_engagement_event",{EventId:e},t,n)}function S(e,t){var n,a,i,r=l("bootstrapperConfig");return r?(n=r.authToken,a=r.getAuthToken,i=e.apiName,new Promise(function(e,t){var r=function(e){if(e){var t=function(e){if(e)try{var t=e.split(".")[1],n=atob(t),a=JSON.parse(n).exp;return a?1e3*a:void 0}catch(e){return}}(e);return t&&t>Date.now()+24e4?e:void 0}}(l("lokiAuthToken")||n);if(r)return e(r);var o=v("Cortex.TopicsSDK."+i+".GetAuthToken");a(function(n,a){if(!n){var i=new Error("Returned auth token is empty.");return o.logUnexpectedFailure("EmptyAuthToken",i,{correlationId:a}),t(i)}d("lokiAuthToken",n),e(n)},function(e,n,a){var i=new Error(e);o.logUnexpectedFailure("GetAuthTokenError",i,{correlationId:null!=n?n:"",isExpectedError:!!a}),t(i)})})).then(function(n){return new Promise(function(a,i){var o=v("Cortex.TopicsSDK."+e.apiName+".API"),c=new XMLHttpRequest,d=function(){if(0===e.url.indexOf("https"))return e.url;var t=l("lokiConfig");if(!t)throw new Error("SDK has not been initialized yet.");var n=t.LokiUrl;return new URL(e.url,n).href}();c.open(e.method||"GET",function(e,t){var n=(t||{}).useTest,a=new URL(e);return void 0!==n&&a.searchParams.append("useTest",String(n)),a.href}(d,t),!0),c.setRequestHeader("Authorization","Bearer "+n),c.setRequestHeader("Accept","application/json"),c.setRequestHeader("Content-Type","application/json");var u=Object(s.e)();c.setRequestHeader("X-RootCorrelationId",u),c.setRequestHeader("X-CorrelationId",u),c.setRequestHeader("X-ClientCorrelationId",r.clientCorrelationId),c.setRequestHeader("X-ClientType",r.clientType),c.setRequestHeader("X-ClientFeature","TopicSDK"),c.addEventListener("load",function(){if(200===c.status)try{a(JSON.parse(c.response)),o.logSuccess()}catch(e){D(o,{reject:i,resultCode:"MalformedResponse",error:e,customData:{correlationId:u}})}else D(o,{reject:i,resultCode:"HttpError_"+c.status,error:new Error("Request failed with status code "+c.status),customData:{correlationId:u,httpStatus:c.status,errorDetails:c.responseText}})}),c.addEventListener("error",function(){D(o,{reject:i,resultCode:"RequestError",error:new Error('Request to url "'+e.url+'" failed to complete.'),customData:{correlationId:u}})}),c.addEventListener("timeout",function(){D(o,{reject:i,resultCode:"Timeout",error:new Error('Request to url "'+e.url+'" timed out after 60000 ms.'),customData:{correlationId:u}})}),c.timeout=6e4,c.send(JSON.stringify(e.body))})}):Promise.reject(new Error("SDK has not been initialized yet."))}function D(e,t){var n=t.reject,a=t.resultCode,i=t.error,r=t.customData;e.logUnexpectedFailure(a,i,r),n(i)}function I(){return S({apiName:"GetMyTopics",method:"POST",url:"api/v1/topic/myTopics"})}var x=function(){return(x=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function C(e,t){return S({apiName:"GetTopicAnnotations",method:"POST",url:"/api/v1/topic/annotations",body:e},x({useTest:!1},t))}var O=function(){return(O=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function w(e,t){return S({apiName:"GetTopicById",method:"GET",url:"/api/v1/topic/getTopicById?topicId="+e},O({useTest:!1},t)).then(function(e){return e.value[0]})}function E(e,t){return S({apiName:"GetTopicsByIds",method:"POST",url:"/api/v1/topic/getTopicsByIds",body:{TopicsIds:e}},t).then(function(e){return e.value})}var A=function(){return(A=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function L(e,t){return S({apiName:"GetTopicsByName",method:"GET",url:"/api/v1/topic/getTopicsByPrefix?topicPrefix="+encodeURIComponent(e)},A({useTest:!1},t)).then(function(e){return e.value})}var k,M=n("vRW7");function P(){var e=l("bootstrapperConfig");if(!e)return Promise.reject(new Error("SDK has not been initialized yet."));var t=function(e,t){var n=function(e){return"df"===e?k.Dogfood:"msit"===e?k.MSIT:void 0}(e);return n||(n=function(e){switch(e){case"Df":return k.Dogfood;case"Msit":return k.MSIT;case"Blackforest":return k.Blackforest;case"GccModerate":return k.GccModerate;case"GccHigh":return k.GccHigh;case"DoD":return k.DOD;case"Gallatin":return k.Gallatin;case"Prod":return k.TopLevel;case"AG08":return k.AG08;case"AG09":return k.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return Object(M.e)(e)}}(t)),n}(e.region,e.complianceEnvironment);return S({apiName:"GetLokiConfig",method:"GET",url:new URL("/api/v2/configuration",t).href})}function T(){return S({apiName:"GetCapabilities",method:"POST",url:"/api/v1/topic/capabilities"})}function U(e){var t;return e.ClientType||(e.ClientType=(null===(t=l("bootstrapperConfig"))||void 0===t?void 0:t.clientType)||""),S({apiName:"CreateTopicLite",method:"POST",url:"/api/v2/topicLite/create",body:e})}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(k||(k={}));var F=window.sessionStorage,H=function(){return(H=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function R(e,t,n){e||v("Cortex.TopicsSDK.Cache.Get").logUnexpectedFailure(t,n)}var N,B=new(function(){function e(){this.cacheProvider=F}return e.prototype.setCacheProvider=function(e){this.cacheProvider=e},e.prototype.setItem=function(e,t,n){var a=H({},t);if(void 0!==n){var i=new Date;i.setTime(i.getTime()+n),a.expiresOn=i.toISOString()}this.cacheProvider.setItem(e,JSON.stringify(a))},e.prototype.getItem=function(e,t){void 0===t&&(t=!1);var n=!1,a=void 0,i=this.cacheProvider.getItem(e);if(i)try{if(a=JSON.parse(i))if(a.expiresOn){var r=new Date(a.expiresOn).getTime();!isNaN(r)&&(new Date).getTime()<r?n=!0:R(t,"CacheExpired",new Error("Cached item for "+e+" is expired."))}else n=!0}catch(e){R(t,"CacheInvalid",e)}else R(t,"CacheMissing",new Error("Failed to find the cached item for "+e+"."));return{value:a,valid:n}},e}());function j(e){var t=J();if(t)return t.hasTenantLicense&&t.hasUserLicense&&t.permission.indexOf(e)>-1}function V(){var e,t=null===(e=l("bootstrapperConfig"))||void 0===e?void 0:e.cacheProvider;return t&&B.setCacheProvider(t),T().then(function(e){var t;return t=e,B.setItem("Cortex.TopicsCapabilities",t,864e5),e})}function z(){var e=J();if(e)return e.hasTenantLicense&&e.hasUserLicense}function G(){return j("Edit")}function K(){return j("Manage")}function W(){return j("Read")}function q(){var e;return null===(e=J())||void 0===e?void 0:e.isPreviewUser}function Q(){return Y()}function Y(){var e;return null===(e=J())||void 0===e?void 0:e.knowledgeCenterInfo}function J(){var e=X();return e.valid||N||(N=V().then(function(){N=void 0}).catch(function(){setTimeout(function(){N=void 0},3e5)})),e.value}function X(e){return B.getItem("Cortex.TopicsCapabilities",e)}function Z(e,t){var n,a,i,r,o="";return o="Url"in e?e.Url:(n=e.topicId,a=e.topicName,(r=null===(i=Q())||void 0===i?void 0:i.url)&&a&&n?r+"/_layouts/15/TopicPagePreview.aspx?topicId="+n+"&topicName="+encodeURIComponent(a):""),t&&o&&(o=function(e,t){var n=new URL(e);return n.searchParams.append("ls",t),n.href}(o,t)),o}var $,ee=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},te=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};function ne(e,t){return void 0===t&&(t=!1),l("initializationPromise")&&!t||d("initializationPromise",function(e){return ee(this,void 0,void 0,function(){var t,n,a,i,r;return te(this,function(o){switch(o.label){case 0:t=v("Cortex.TopicsSDK.Bootstrapper.Initialize"),d("bootstrapperConfig",e),n=e.logOnly,a=void 0!==n&&n,o.label=1;case 1:return o.trys.push([1,6,,8]),[4,(u||(u=function(){return m(this,void 0,void 0,function(){var e,t,n;return _(this,function(a){switch(a.label){case 0:return f?[3,2]:[4,h()];case 1:e=a.sent(),(t=l("bootstrapperConfig"))&&((n=e.getSemanticContext()).setAppId(t.clientType),n.setAppLanguage(t.culture),t.hostAppVersion&&n.setAppVersion(t.hostAppVersion),e.setContext("AppInfo.Session",t.clientCorrelationId)),a.label=2;case 2:return[2]}})})}()),u)];case 2:return o.sent(),[4,ae()];case 3:return o.sent(),i=X(!0).valid,a||i?[3,5]:[4,V()];case 4:o.sent(),o.label=5;case 5:return d("initialized",!0),t.logSuccess({logOnly:a,hasValidCapabilities:i}),[3,8];case 6:return r=o.sent(),[4,t._logUnexpectedFailureAsync(void 0,r)];case 7:throw o.sent(),c={initialized:!1},r;case 8:return[2]}})})}(e)),l("initializationPromise")}function ae(){return ee(this,void 0,void 0,function(){return te(this,function(e){switch(e.label){case 0:return[4,P()];case 1:return d("lokiConfig",e.sent()),function(){m(this,void 0,void 0,function(){var e,t;return _(this,function(n){switch(n.label){case 0:return[4,h()];case 1:return e=n.sent(),(t=l("lokiConfig"))&&e.getSemanticContext().setUserId(t.UserPuid),[2]}})})}(),[2]}})})}function ie(e){return new Promise(function(t,n){e.onsuccess=function(){return t(e.result)},e.onerror=function(){return n(e.error)}})}function re(e){return new Promise(function(t,n){e.oncomplete=function(){return t()},e.onerror=function(){return n(e.error)}})}function oe(){return $||($=function(e,t,n){var a=window.indexedDB.open("topics-db",void 0);a.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains("topics")||t.createObjectStore("topics")};var i=ie(a);return function(e){return i.then(function(t){return t.transaction("topics",e).objectStore("topics")})}}()),$}var se=function(){function e(){}return e.prototype.get=function(e){var t=this;return oe()("readonly").then(function(n){return ie(n.get(e)).then(function(n){if(n){if(n.ExpireTimeStamp&&n.ExpireTimeStamp>Date.now())return n.TopicEntity;t.remove(e)}})})},e.prototype.set=function(e){return oe()("readwrite").then(function(t){return e.forEach(function(e){t.put({TopicEntity:e.topicEntity,ExpireTimeStamp:Date.now()+864e5},e.key)}),re(t.transaction)})},e.prototype.remove=function(e){return oe()("readwrite").then(function(t){return ie(t.delete(e))})},e.prototype.removeAllExpired=function(){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,oe()("readwrite")];case 1:return(e=n.sent()).openCursor().onsuccess=function(){if(this.result){var t=this.result.value;t&&t.ExpireTimeStamp&&t.ExpireTimeStamp<=Date.now()&&e.delete(this.result.key),this.result.continue()}},[2,re(e.transaction)];case 2:return t=n.sent(),[2,Promise.reject(t)];case 3:return[2]}})})},e}(),ce=function(){function e(){this._cache=new Map}return e.prototype.get=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return[2,this._cache.get(e)]})})},e.prototype.set=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t=this;return Object(i.__generator)(this,function(n){return e.forEach(function(e){t._cache.set(e.key,e.topicEntity)}),[2]})})},e.prototype.remove=function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){return this._cache.delete(e),[2]})})},e}(),de=new(function(){function e(){var e,t;this._cacheProvider=window.indexedDB?(e=new se,t=!1,window.requestIdleCallback?window.requestIdleCallback(function n(a){for(;a.timeRemaining()>0&&!t;)e.removeAllExpired(),t=!0;!t&&window.requestIdleCallback&&window.requestIdleCallback(n)}):window.requestAnimationFrame(function(){return e.removeAllExpired()}),e):new ce}return e.prototype.setCacheProvider=function(e){this._cacheProvider=e},e.prototype.get=function(e){return this._cacheProvider.get(e)},e.prototype.set=function(e){var t=[];return e.forEach(function(e){var n;t.push({topicEntity:e,key:e.Id}),null===(n=e.AncestorIds)||void 0===n||n.forEach(function(n){t.push({topicEntity:e,key:n})})}),this._cacheProvider.set(t)},e.prototype.remove=function(e){return this._cacheProvider.remove(e)},e}()),le=n("UWqr");function ue(){return le._SPFlight.isEnabled(60429)}var fe,pe=r._LogSource.create("TopicsSDKLoader"),me=!1;function _e(e){return be(e).then(function(){return a})}function he(){return me?a:void 0}function be(e){return(le._SPKillSwitch.isActivated("6c77a32d-5167-444f-9003-406030801c5a")?Object(o.isRunCortexTAB)():"true"===sessionStorage.getItem("_isRunningTABTest"))?Promise.reject("SDK initialization is suppressed on purpose."):(fe||(fe=function(e){return n.e(0).then(n.bind(null,"ji4s")).then(function(t){return new t.Loki(e).getBootstrapperConfig()})}(e).then(function(t){return ne(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},t),{logOnly:!ue()}),!le._SPKillSwitch.isActivated("ff91959e-7f6a-4886-9ff6-11f8319fe33c")&&{TenantAadObjectId:e.aadTenantId,UserAadObjectId:e.aadUserId}))}).then(function(){me=!0}).catch(function(e){throw r._TraceLogger.logError(pe,e),ue()||(fe=void 0),e})),fe)}},ut3N:function(e,t){e.exports=o},vRW7:function(e,t,n){"use strict";function a(e){return e}n.d(t,"e",function(){return a})}})});