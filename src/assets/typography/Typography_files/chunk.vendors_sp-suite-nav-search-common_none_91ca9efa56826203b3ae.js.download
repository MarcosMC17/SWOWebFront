(window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0=window.webpackJsonpf8a8ad94_4cf3_4a19_a76b_1cec9da00219_0_1_0||[]).push([[5],{"/pCg":function(e,t,n){"use strict";n.r(t),n.d(t,"createAsyncTokenProvider",function(){return a.e}),n.d(t,"fetch",function(){return i.e}),n.d(t,"fetchAcquireToken",function(){return T}),n.d(t,"fetchAndParseSearchConfiguration",function(){return ve}),n.d(t,"fetchCustomVerticals",function(){return fe}),n.d(t,"fetcher",function(){return Z}),n.d(t,"fetchBingConsumer",function(){return Se}),n.d(t,"fetchFileShareConnectorSettings",function(){return xe}),n.d(t,"fetchHubSites",function(){return Oe}),n.d(t,"fetchPersonalData",function(){return Ee}),n.d(t,"fetchPersonalRankingContext",function(){return Le}),n.d(t,"fetchSearchCenterUrl",function(){return Ue}),n.d(t,"fetchRawSearchCenterUrl",function(){return Me}),n.d(t,"fetchSearchConfiguration",function(){return me}),n.d(t,"fetchTellMeSearchResults",function(){return Fe}),n.d(t,"fetchParsedCustomVerticals",function(){return ge}),n.d(t,"fetchSearchConfigurationFromEcs",function(){return He}),n.d(t,"fetchConfigFromEcsWithCacheAndMonitor",function(){return Re}),n.d(t,"fetchSpHomeNews",function(){return Ve}),n.d(t,"fetchSpHomePrefetch",function(){return je}),n.d(t,"fetchSiteNewsSuggestions",function(){return qe}),n.d(t,"fetchSiteActivities",function(){return Je}),n.d(t,"siteActivitiesCacheKeyExtractor",function(){return Ye}),n.d(t,"fetchSharePointDigest",function(){return Xe}),n.d(t,"fetchSharePointDigestV2",function(){return et}),n.d(t,"fetchSitesFromSubstrate",function(){return bt}),n.d(t,"generateGuid",function(){return tt.e}),n.d(t,"cache",function(){return c.e}),n.d(t,"init",function(){return c.t}),n.d(t,"puid",function(){return c.n}),n.d(t,"statusOk",function(){return nt.e}),n.d(t,"substrateIframeProxy",function(){return ut}),n.d(t,"toTokenDetail",function(){return gt}),n.d(t,"warmupMsb",function(){return St}),n.d(t,"resolveBingUrl",function(){return It}),n.d(t,"resolveLokiEnvironment",function(){return xt}),n.d(t,"resolveSubstrateUrl",function(){return Ct}),n.d(t,"warmupSubstrateSearch",function(){return wt}),n.d(t,"withBasicMonitor",function(){return C}),n.d(t,"withMonitor",function(){return L}),n.d(t,"withImportMonitor",function(){return At}),n.d(t,"withPeriodicRefresh",function(){return Mt}),n.d(t,"withRefresh",function(){return kt});var a=n("Pgy2"),i=n("6bZ6");function r(e){if(!o(e))throw new Error("Key argument must be an object.");for(var t=Object.keys(e).sort(),n=t.length,a=[],i=0;i<n;i++){var r=t[i],s=e[r];void 0===s||o(s)||"function"==typeof s||a.push(r+":"+s)}return a.join(",")}function o(e){return"object"==typeof e&&null!==e}var s,c=n("Gcel"),d=n("I6WN"),l=!1,u=!1;function f(e,t,n){var a;_(n);var i=p();try{var r=i.getItem(e);if(!r)return null;a=JSON.parse(r)}catch(e){return!l&&Object(d.e)().dispatch({eventType:"ERROR",name:"StorageCache",detail:"Failed to read from storage."}),l=!0,null}return a?a.cacheVersion!==t?(i.removeItem(e),null):a.puid&&a.puid===n?a:(i.removeItem(e),null):null}var p=function(){return s||(s={getItem:function(e){return sessionStorage.getItem(m(e))},removeItem:function(e){return sessionStorage.removeItem(m(e))},setItem:function(e,t){return sessionStorage.setItem(m(e),t)}})};function m(e){return"mssearchux-cache-"+e}function _(e){!e&&Object(c.a)("Puid not set.")}var h=function(){return(h=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=function(e,t,n){_(n);var a=g(e);return a&&a.puid!==n&&(a=null),a||v(e,{puid:n,cacheItems:y(e,t,n)||{}})},g=function(e){return Object(c.e)().caches[e]},v=function(e,t){return Object(c.e)().caches[e]=t};function y(e,t,n){var a=f(e,t,n);if(!a)return null;var i=a.cacheItems;return Object.keys(i).reduce(function(e,t){return e[t]={value:Promise.resolve({xhr:{responseText:i[t].value,status:i[t].status||0}}),expiryTime:i[t].expiryTime,cacheItemType:"storage",cacheItemResolved:!0},e},{})}function S(e,t){return Object(c.e)().caches[e]?Object(c.e)().caches[e].cacheItems[t]=null:null}var D=function(e,t,n){return e[t]=n};function I(e){return function(t){return function(n){var a=t.cacheKeyExtractor(n)||{};return!(t.forceRefresh&&t.forceRefresh())&&function(e,t,n,a){void 0===a&&(a={});var i=r(a),o=b(e,t,n).cacheItems[i];if(o){if(Date.now()<o.expiryTime)return o.value.then(function(e){return h(h({},e),{cacheItemType:o.cacheItemType,cacheItemResolved:o.cacheItemResolved,expiryTime:o.expiryTime})});S(e,i)}return null}(t.cacheId,t.cacheVersion,Object(c.n)(),a)||function(e,t,n,a){var i=e.cacheId,o=e.cacheVersion,s=e.cacheItemLifetime;void 0===a&&(a={}),_(t);var c=r(a),l=b(i,o,t).cacheItems,m=D(l,c,{value:n,expiryTime:Date.now()+s,cacheItemType:"memory",cacheItemResolved:!1});return n.then(function(e){return D(l,c,h(h({},m),{cacheItemResolved:!0})),function(e,t,n,a,i,r,o){_(n);var s=f(e,t,n)||{cacheCreationTime:Date.now(),cacheVersion:t,puid:n,cacheItems:{}};s.cacheItems[a]={value:i,expiryTime:r,status:o};try{p().setItem(e,JSON.stringify(s))}catch(t){!u&&Object(d.e)().dispatch({eventType:"ERROR",name:"StorageCache",nameDetail:e,detail:"Failed to write to session storage."}),u=!0}}(i,o,t,c,e.xhr.responseText,m.expiryTime,e.xhr.status),h(h({},e),{cacheItemResolved:!1,cacheItemType:null,expiryTime:m.expiryTime})},function(e){throw S(i,c),e})}(t,Object(c.n)(),e(n),a)}}}var x=function(){return(x=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function C(e,t){var n=e.monitorType,a=e.monitorName,i=e.monitorOnce,r=e.samplingOptions,o=e.successPropExtractor,s=e.failurePropExtractor,c=!1;return function(e){if(i&&c)return t(e);if(r&&function(e,t){return e.sampleRate>=0&&e.sampleRate<=1&&void 0!==e.sampleIdExtractor&&O(e.sampleIdExtractor(t))%1e3/1e3>=e.sampleRate}(r,e))return t(e);c=!0;var l,u=Math.round(performance.now()),f=Object(d.e)();function p(e,t){f.dispatch({eventType:"QOSSTOP",name:n,result:e,nameDetail:a,startTimestamp:u,totalTime:Math.round(performance.now())-u,properties:r?x(x({},t),{sampleRate:r.sampleRate}):t})}f.dispatch({eventType:"QOSSTART",name:n,nameDetail:a,timestamp:u});try{l=t(e)}catch(e){return p("FAILURE",{promiseFactoryFailed:!0}),Promise.reject(e)}return l.then(function(e){return p("SUCCESS",w(e,o,{successExtractorFailed:!0})),e},function(e){return p("FAILURE",w(e,s,{failureExtractorFailed:!0})),Promise.reject(e)})}}var O=function(e){for(var t=0,n=e.length-1;n>=0;n--){var a=e.charCodeAt(n),i=n%8;t^=(a<<i)+(a>>8-i)}return t},w=function(e,t,n){try{return(t||E)(e)}catch(e){return n}},E=function(){return{}},A=function(){return(A=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function L(e,t){var n=e.monitorName,a=e.monitorType,i=void 0===a?"prefetch_request":a,r=e.additionalSuccessPropsExtractor,o=e.additionalFailurePropsExtractor;return C({monitorName:n,monitorType:i,successPropExtractor:function(e){var t=e.xhr,n=e.tokenAttemptCount,a=e.tokenFetchDuration,i=e.cacheItemResolved,o=e.cacheItemType;return A(A(A(A({},k(t)),n?{tokenAttemptCount:n,tokenFetchDuration:Math.round(a)}:{}),{cacheItemResolved:i,cacheItemType:o}),null==r?void 0:r(t))},failurePropExtractor:function(e){var t;return A(A(A({},null==o?void 0:o(e)),k(e)),{errorCode:null===(t=e.status)||void 0===t?void 0:t.toString()})}},function(e){return void 0===e?Promise.reject("undefined options"):t(e)})}function k(e){if(!e||!e.getAllResponseHeaders)return{};var t=function(e,t){var n={};if(e.getAllResponseHeaders){var a=e.getAllResponseHeaders();["sprequestduration","spclientservicerequestduration","sprequestguid"].forEach(function(t){e.getResponseHeader&&-1!==a.indexOf(t)&&(n[t]=e.getResponseHeader(t)||"")})}return n}(e),n={};return n.sprequestguid=t.sprequestguid,n.sprequestduration=t.sprequestduration||t.spclientservicerequestduration||void 0,n}var M=function(){return(M=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},P=["https://substrate.office.com","https://loki.delve.office.com","https://www.bing.com","https://partner.outlook.cn/search","https://outlook.office365.com/search"],T=L({monitorName:"prefetchAcquireToken",additionalSuccessPropsExtractor:function(e){var t=e&&e.responseText&&JSON.parse(e.responseText);return M({},t&&{resource:U(t.resource)?t.resource:"",expires_on:t.expires_on})},additionalFailurePropsExtractor:function(e){var t,n,a;try{a=e&&e.responseText&&JSON.parse(e.responseText)}catch(e){}var i=null===(t=null==a?void 0:a.error)||void 0===t?void 0:t.code;return{resource:null===(n=null==e?void 0:e.requestLogData)||void 0===n?void 0:n.resource,properties:JSON.stringify({responseErrorCode:isNaN(i)?"0":i})}}},I(function(e){var t=e.digest,n=e.portalUrl,a=e.resourceUrl,r={resource:a};return e.useSTI&&(r.tokenType="STI"),Object(i.e)(M({url:n+"/_api/SP.OAuth.Token/Acquire",method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","Odata-Version":"4.0",Accept:"application/json;odata.metadata=minimal","X-RequestDigest":t},body:JSON.stringify(r),timeoutMs:7e3},U(a)&&{requestLogData:{resource:a}})).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1,cacheItemType:null}})})({cacheId:"psst",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{resource:e.resourceUrl}}})),U=function(e){return-1!==P.indexOf(e)};function F(e){var t=window&&window.location&&window.location.search||window.location.hash||"";return decodeURIComponent(t.replace(new RegExp("^(?:.*[&\\?]"+encodeURIComponent(e).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}function H(e,t){var n=e,a=Object.keys(t);return a.length&&(n+="?",n+=a.map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")),n}function R(e,t){return t}function N(e,t,n){throw function(e,t,n){var a;return t&&t.safeToLog?(a=new Error(e+" "+t.message)).innerError=t:a=new Error(e),a.safeToLog=!0,a.logProperties=n,Object.freeze(a),a}(e,t,n)}var B=function(){return(B=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},j=function(e){var t=e.complianceEnvironment,n=e.clientWorkload,a=e.component,i=e.userId,r=e.tenantId,o=e.ring,s=e.isGuestUser;return"https://"+function(e){switch(e){case"GccHigh":return"config.ecs.gov.teams.microsoft.us";case"DoD":return"config.ecs.dod.teams.microsoft.us";case"AG08":return"config.ecs.teams.eaglex.ic.gov";case"AG09":return"config.ecs.teams.microsoft.scloud";case"Blackforest":case"Df":case"Gallatin":case"GccModerate":case"Msit":case"Unknown":case"Prod":return"ecs.office.com";default:return R(0,"ecs.office.com")}}(t)+"/config/v1/LokiService/1.0.0.0?agents=MicrosoftSearch&ecsserviceinformation=true&ClientWorkload="+n+"&id="+i+"&TenantID="+r+"&ring="+o+"&ApEnvironment="+function(e){switch(e){case"Blackforest":return"BlackForest";case"GccModerate":return"Gcc";default:return e&&"Unknown"!==e?e:"Prod"}}(t)+"&IsGuestUser="+String(s)+(a?"&MsSearch_Component="+a:"")};function V(e){var t,n={};if(e){var a=JSON.parse(e);if(a.ecsConfigIds&&a.ecsEtag){n.ecsConfigIds=((t=a.ecsConfigIds)?t.filter(function(e){return e.indexOf("31828")>-1}).join()||t.join():void 0)||"",n.ecsEtag=a.ecsEtag.replace(/"/g,"");var i={},r="searchux.".length;a.ecsSettings&&Object.keys(a.ecsSettings).filter(function(e){return"boolean"==typeof a.ecsSettings[e]&&"searchux."===e.substr(0,r)}).forEach(function(e){return i[e.substr(r)]=a.ecsSettings[e]}),n.ecsSettings=JSON.stringify(i)}}return n}function z(e,t,n){return Object.keys(e).filter(function(n){return n.indexOf(t)>-1&&e[n]}).sort(function(t,n){return K(e[t])-K(e[n])}).map(function(t){try{return n(t,e[t])}catch(e){Object(d.e)().dispatch({name:"generic_error",nameDetail:"ecsUtils.convertSettingsWithKeyToArray",eventType:"ERROR",detail:"Mapper failed on key: "+t})}}).filter(function(e){return e})}function G(e,t,n){var a=F(t);a&&"true"===a.toLowerCase()&&(n={});var i=decodeURIComponent(F(e));return i?function e(t,n){if(!W(t))return t;var a=B({},t);return W(n)&&Object.keys(n).forEach(function(i){W(n[i])?a[i]=i in t?e(t[i],n[i]):n[i]:a[i]=n[i]}),a}(n,JSON.parse(i)):n}function K(e){var t;return null!==(t=e.position)&&void 0!==t?t:Number.MAX_VALUE}function W(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}var q,Q,Y=function(){return(Y=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function J(e){return!!e&&(401===e.status||0===e.status)}function X(e,t,n,a){if(!n.token&&!n.tokenProvider)return Promise.reject(new Error("Token or token provider must be specified."));var i=-1;return n.token?a(Y(Y({},n),{token:n.token})).then(function(e){return{tokenAttemptCount:0,tokenFetchDuration:0,xhr:e}}):n.tokenProvider({attempt:e}).then(function(e){return i=performance.now()-t,a(Y(Y({},n),{token:e}))}).then(function(t){return{tokenAttemptCount:e+1,tokenFetchDuration:i,xhr:t}})}function Z(e,t){return L(t,I((n=e,function(e){var t=performance.now();return X(0,t,e,n).catch(function(a){return J(a)?X(1,t,e,n).catch(function(e){return function(e,t,n){if(J(e)){var a=e;throw a.tokenAttemptCount=2,a.tokenFetchDuration=n,a}throw e}(e,0,performance.now()-t)}):Promise.reject(a)})}))(t));var n}function $(e){switch(e){case"Df":return q.Dogfood;case"Msit":return q.MSIT;case"Blackforest":return q.Blackforest;case"GccModerate":return q.GccModerate;case"GccHigh":return q.GccHigh;case"DoD":return q.DOD;case"Gallatin":return q.Gallatin;case"Prod":return q.TopLevel;case"AG08":return q.AG08;case"AG09":return q.AG09;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}!function(e){e.TopLevel="https://loki.delve.office.com",e.Blackforest="https://loki.delve.office.de",e.GccModerate="https://gcc.loki.delve.office.com",e.GccHigh="https://gcchigh.loki.office365.us",e.DOD="https://dod.loki.office365.us",e.Gallatin="https://loki.office365.cn",e.Dogfood="https://df.loki.delve.office.com",e.LegacyDogfood="https://sfdf.loki.delve.office.com",e.MSIT="https://msit.loki.delve.office.com",e.LegacyMSIT="https://sfmsit.loki.delve.office.com",e.AG08="https://loki.officenet.eaglex.ic.gov",e.AG09="https://loki.officenet.microsoft.scloud"}(q||(q={})),function(e){e.SearchComponent="X-MSSearchComponent",e.SearchScenario="X-MSSearchScenario",e.VerticalsCacheClear="X-Cache-Mode"}(Q||(Q={}));var ee=n("a8rS"),te=function(){return(te=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ne(e){return"string"==typeof e?e.replace(/\/+$/,""):e}var ae=function(e){return ne(e)+"/api/v1/search/configuration"};function ie(e,t,n){return void 0===t&&(t=""),function(e,t){var n=$(e);return n===e&&(n=$("Prod")),t(n)}(e,n)+(t?"/"+t:"")}function re(e,t){return void 0===t&&(t=""),ie(e,t,ae)}function oe(e,t,n){var a;return te(te(te({},t),((a={"X-MSSearchVersion":ee.e,"X-ClientFeature":"Search"})["X-ClientType"]=e,a)),n?{Authorization:"Bearer "+n}:{})}function se(e){return(ne(e)||"")+"/api/v1/search/configuration/verticals"}function ce(e,t){void 0===t&&(t=!1);var n={};return e&&(n.siteCollectionId=e.toUpperCase()),t&&(n.verticalState="all"),F("ecsOverrides")&&(n.ecsOverrides=F("ecsOverrides")),n}function de(){var e;return"true"===F("cacheClear")?((e={})[Q.VerticalsCacheClear]="uncached",e):{}}var le,ue=function(){return(ue=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},fe=Z(function(e){var t=e.lokiUrl,n=e.token,a=e.clientType,r=e.scope,o=e.previewDisabledVerticals,s=e.useSimpleRequest,c=void 0!==s&&s,d=oe(a,de(),n),l=r&&r.siteId?r.siteId:"";return c?Object(i.e)({url:H(se(t),ue(ue({},ce(l,o)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(d)}):Object(i.e)({url:H(se(t),ce(l,o)),method:"GET",headers:d})},{monitorName:"customVerticals",cacheId:"customVerticals",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return{url:e.lokiUrl,showDisabled:e.previewDisabledVerticals,clientType:e.clientType,scope:e.scope&&e.scope.siteId&&e.scope.siteId.toUpperCase()||null}},additionalSuccessPropsExtractor:function(){return{cacheClear:F("cacheClear")}},forceRefresh:function(){return"true"===F("cacheClear")}}),pe=function(){return(pe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},me=Z(function(e){var t=e.token,n=e.clientType,a=e.environment,r=e.culture,o=e.additionalHeaders,s=e.siteId,c=void 0===s?"":s,d=e.useSimpleRequest,l=void 0!==d&&d,u=oe(n,pe(pe({},o),de()),t);return l?Object(i.e)({url:H(re(a,r),pe(pe({},ce(c,!1)),{ConvertGetPost:"true"})),method:"POST",body:JSON.stringify(u)}):Object(i.e)({url:H(re(a,r),ce(c,!1)),method:"GET",headers:u})},{monitorName:"searchConfiguration",cacheId:"searchConfiguration",cacheVersion:"0",cacheItemLifetime:6e5,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["token"]),n=t.additionalHeaders&&t.additionalHeaders["X-MSSearchScenario"]||"";return pe(pe({},t),{msSearchScenario:n})},additionalSuccessPropsExtractor:function(e){return pe(pe({},V(e.responseText)),{cacheClear:F("cacheClear")})},forceRefresh:function(){return"true"===F("cacheClear")}}),_e=function(){return(_e=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function he(){return le||be(),le}function be(e){if(!le||!le.isPending||le.isRejected){le={};var t=new Promise(function(e,t){le.promiseResolver=function(t){le.isPending=!1,e(t)},le.promiseRejector=function(){le.isRejected=!0,le.isPending=!1,t()}});le.promiseObj=t,le.isRejected=!1,t.catch(function(){})}le.isPending=!0,e&&(le.option=e)}function ge(e){var t,n,a,i=le&&le.option&&le.option.siteId||"";if(le&&(!e.scope&&!i||(null===(n=null===(t=e.scope)||void 0===t?void 0:t.siteId)||void 0===n?void 0:n.toUpperCase())===i.toUpperCase())&&!le.isRejected){var r=le.option;return be(r),me(r).then(function(e){var t,n,a=e.xhr;if(a.responseText){var i=JSON.parse(a.responseText).verticalConfig;null===(t=le.promiseResolver)||void 0===t||t.call(le,i)}else null===(n=le.promiseRejector)||void 0===n||n.call(le)}).catch(function(e){var t;console.error(e),null===(t=le.promiseRejector)||void 0===t||t.call(le,e),N("CUSTOM_VERTICAL_FETCH_FAILED")}),le.promiseObj}var o=e.lokiUrl,s=null===(a=null==le?void 0:le.option)||void 0===a?void 0:a.environment;return("Df"===s||"Msit"===s&&-1!==(null==o?void 0:o.toLowerCase().indexOf("df")))&&(o=ie(s,le.option.culture,function(e){return e})),fe(_e(_e({},e),{lokiUrl:o})).then(function(e){var t=e.xhr;return t.responseText?JSON.parse(t.responseText):[]}).catch(function(e){console.error(e),N("CUSTOM_VERTICAL_FETCH_FAILED")})}function ve(e){var t,n;F("sid")&&(e.siteId=F("sid")),e.siteId&&(e.siteId=e.siteId.toUpperCase());var a=null===(n=null===(t=e.additionalHeaders)||void 0===t?void 0:t[Q.SearchComponent])||void 0===n?void 0:n.toLowerCase();return"serp"===a&&be(e),me(e).then(function(e){var t=e.xhr,n=JSON.parse(t.responseText),i=null==n?void 0:n.ecsSettings;n.ecsSettings=function(e){var t={},n={};for(var a in e)if(e.hasOwnProperty(a))if(0===a.indexOf("searchux.killSwitches.")){var i=a.slice("searchux.killSwitches.".length),r=Boolean(e[a]);n[i]=r}else t[a]=e[a];return t["searchux.killSwitches"]=n,t}(G("ecsOverrides","wipeEcsConfig",i));var r=he();return"serp"===a&&(n.verticalConfig?(null==r?void 0:r.promiseResolver)&&r.promiseResolver(n.verticalConfig):(null==r?void 0:r.promiseRejector)&&r.promiseRejector()),n}).catch(function(){var e,t=null===(e=he())||void 0===e?void 0:e.promiseRejector;t&&t()})}var ye,Se=function(e){return L({monitorName:"bing-consumer-prefetch"},I(function(e){var t=e.url;return Object(i.e)({url:t,method:"GET",withCredentials:!0}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"bing-consumer-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)},De=function(){return(De=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ie=["AllVerticalContent","FilesVerticalContent"],xe=Z(function(e){var t=e.endpoint,n=e.token;return Object(i.e)({url:t+"/_api/web/AllProperties?$select="+Ie.join(","),method:"GET",headers:De({Accept:"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{}),timeoutMs:5e3})},{monitorName:"prefetchFileShareConnectorsInfo",cacheId:"fileshareconnectorsettings",cacheVersion:"0",cacheItemLifetime:216e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),Ce=function(){return(Ce=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Oe=Z(function(e){var t=e.clientId,n=e.endpoint,a=e.token;return Object(i.e)({url:n+"/_api/search/query?querytext='IsHubSite=1%20contentclass:STS_Site'&selectproperties='DepartmentId,Title'&rowlimit=1000&ClientType='"+t+"'&Properties='ClientFunction:SpoHubSitesInfo,FetchSpoHubSitesInfo:true,EnableDynamicGroups:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=spohubsitesinfo",method:"GET",headers:Ce({Accept:"application/json;odata=verbose"},a?{Authorization:"Bearer "+a}:{}),timeoutMs:5e3})},{monitorName:"prefetchSpoHubSitesInfo",cacheId:"spohubsitesinfo",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(e){return{endpoint:e.endpoint}}}),we=function(){return(we=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ee=Z(function(e){var t=e.url,n=e.token;return Object(i.e)({url:t,method:"GET",headers:we({Accept:"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{}),timeoutMs:5e3})},{monitorName:"fetchPersonalAccountName",cacheId:"personalaccountname",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}}),Ae=function(){return(Ae=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Le=Z(function(e){var t=e.endpoint,n=e.clientId,a=e.token;return Object(i.e)({url:t+"?querytext='*'&ClientType='"+n+"'&Properties='ClientFunction:PersonalRelevanceContext,FetchPersonalRelevanceContext:true'&EnableQueryRules=false&ProcessBestBets=false&BypassResultTypes=true&ProcessPersonalFavorites=false&SourceId='8413cd39-2156-4e00-b54d-11efd9abdb89'&suxrid=ms-oil-datasource-spopersonalcontext",method:"GET",headers:Ae({Accept:"application/json;odata=verbose"},a?{Authorization:"Bearer "+a}:{}),timeoutMs:7e3})},{monitorName:"prefetchPersonalRelevance",cacheId:"prctx",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}}),ke=function(){return(ke=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Me(e){var t=e.siteRoot,n=e.tokenProvider;return Te({siteRoot:t,tokenProvider:n}).then(function(e){if(e.cacheItemResolved&&ye)return ye;var t=JSON.parse(e.xhr.responseText),n=t&&t.d&&t.d.searchcenterurl||"";return ye=n,n})}var Pe,Te=Z(function(e){var t=e.siteRoot;return(0,e.tokenProvider)({attempt:0}).then(function(e){return Object(i.e)({url:t+"/_api/search/searchcenterurl",method:"GET",headers:ke({Accept:"application/json;odata=verbose"},e?{Authorization:"Bearer "+e}:{}),timeoutMs:5e3})})},{monitorName:"fetchSearchCenterUrl",cacheId:"searchcenterurl",cacheVersion:"0",cacheItemLifetime:864e5,cacheKeyExtractor:function(){return""}}),Ue=function(e){return Me({siteRoot:e.siteRoot,tokenProvider:e.tokenProvider}).then(function(e){return(n=(t=e).lastIndexOf("/search/"))<0?"":t.substring(0,n+"/search/".length).replace(/\/$/,"");var t,n})},Fe=function(e){return L({monitorName:"tell-me-search-service-prefetch"},I(function(t){var n=t.url;return Object(i.e)({url:n,method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-Office-Application":e.application,"X-Office-Platform":"Web","X-TellMe-SuggestionTypes":e.searchTypes.join(),"X-TellMe-Culture":e.marketValue},body:JSON.stringify({Query:e.searchText,TemplateInfo:{Application:e.templateTypes.join(),MaxTemplate:e.numberOfResultsToFetch}})}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"tell-me-search-service-prefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return{query:e.searchText}}}))(e)},He=function(e){if(!e)throw new Error("missing options for ECS call");return Object(i.e)({url:j(e),method:"GET"})},Re=C({monitorName:"searchConfigurationFromEcs",monitorType:"prefetch_request",successPropExtractor:function(e){return V(function(e){var t,n,a,i,r;if(!e)return"";try{var o=JSON.parse(e),s=(i=z(a=G("ecsSbOverrides","wipeSbEcsConfig",null==o?void 0:o.MicrosoftSearch),"searchBoxPluginConfiguration.",function(e,t){return{id:"searchux.searchBoxPlugin."+e.split(".")[1],position:K(t)}}),r=z(a,"suggestionProviderGroups.",function(e,t){return{id:e.split(".")[1],optimalCount:t.optimalCount,maxCount:t.maxCount,component:t.component,ariaLabel:t.ariaLabel,heading:t.heading,providers:(n=t,z(n,"providers.",function(e){return"searchux.suggestionProvider.provider."+e.split(".")[1]}))};var n}),B(B(B({},a),{searchBoxPluginConfiguration:{plugins:i}}),{searchBoxSuggestionProviderConfiguration:{groups:r,streamPolicy:a["searchux.suggestionGroupStreamPolicy"]}})),c=null===(t=null==o?void 0:o.Headers)||void 0===t?void 0:t.ETag,d=[null===(n=null==o?void 0:o.ConfigIDs)||void 0===n?void 0:n.MicrosoftSearch];return JSON.stringify({ecsSettings:s,ecsConfigIds:d,ecsEtag:c})}catch(e){N("Failed to parse ECS config")}}(null==e?void 0:e.xhr.responseText))},failurePropExtractor:function(e){return{errorCode:(null==e?void 0:e.status)||-1}}},I(function(e){return He(e).then(function(e){return{xhr:e}})})({cacheId:"searchConfigurationFromEcs",cacheVersion:"0",cacheItemLifetime:3e5,cacheKeyExtractor:function(e){return function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,[])}})),Ne=function(){return(Ne=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Be=(Pe=function(e){var t=e.clientId,n=e.token,a=e.fetcher,r=(0,e.requestDataProvider)(),o=r.endpoint,s=r.context,c=r.microserviceFlights,d={url:o,method:"GET",headers:Ne(Ne({Accept:"application/json;odata=verbose","SPHome-ClientType":t,"SPHome-ApiContext":JSON.stringify(s)},n?{Authorization:"Bearer "+n}:{}),c&&{"SPHome-MicroserviceFlights":c.join(";")})};return a?a(o,d).then(function(e){return e.json()}).then(function(e){return{responseText:JSON.stringify(e)}}):Object(i.e)(d)},function(e){return Z(Pe,{monitorName:e,cacheId:e,cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(){return{}}})}),je=Be("sphome-rawsprefetch"),Ve=Be("sphome-rawnews"),ze=function(){return(ze=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Ge(e,t,n){return n.sitePath+"/_api/search/query?QueryText='*'"+function(e){var t=e.departmentId;return"&QueryTemplate='({searchterms}) ContentTypeId:0x0101009D1CB255DA76424F860D91F20E6C4118* AND PromotedState:2 AND "+(e.isHubSite&&t?We:Ke)(e)+"'"}(n)+"&HitHighlightedProperties='Title'&StartRow=0&RowLimit=100&Properties='ClientFunction:News,EnableMultiGeoSearch:"+(e?"true":"false")+"'&sortlist='LastModifiedTime:descending'&SelectProperties='ContentClass,ContentTypeId,DefaultEncodingURL,DocId,EditorOWSUSER,FileExtension,GeoLocationSource,LastModifiedTime,ModifiedBy,Path,SPWebUrl,SecondaryFileExtension,ServerRedirectedUrl,SiteId,Title,UniqueId,WebId'&ClientType='"+t+"'&EnableQueryRules=false"}function Ke(e){return'Path:"'+e.sitePath+'"'}function We(e){var t=e.departmentId;return"(DepartmentId:"+t+" OR DepartmentId:"+t.replace(/[{}]/g,"")+")"}var qe=Z(function(e){var t=e.clientId,n=e.site,a=e.token;return Object(i.e)({url:Ge(!0,t,n),method:"GET",headers:ze({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},a?{Authorization:"Bearer "+a}:{})})},{monitorName:"sitenews-rawPrefetch",cacheId:"sitenews-rawPrefetch",cacheVersion:"0",cacheItemLifetime:9e5,cacheKeyExtractor:function(e){return{sitePath:e.site.sitePath}}}),Qe=function(){return(Qe=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Ye(e){return{scope:e&&e.map(function(e){return e&&e.siteId&&e.siteId.toLowerCase()}).join(",")||""}}var Je=Z(function(e){var t=e.clientId,n=e.token,a=e.requestDataProvider,r=e.sites,o=a(),s=o.endpoint,c=o.microserviceFlights,d={url:s,method:"POST",headers:Qe(Qe({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose","SPHome-ClientType":t},n?{Authorization:"Bearer "+n}:{}),c&&{"SPHome-MicroserviceFlights":c.join(";")}),body:JSON.stringify(r.slice(0,30).map(function(e){return{IndexId:e.id,SiteId:e.siteId,WebId:e.webId,Type:"SiteReference"}}))};return Object(i.e)(d)},{monitorName:"site-activities-rawsprefetch",cacheId:"site-activities-rawsprefetch",cacheVersion:"0",cacheItemLifetime:18e5,cacheKeyExtractor:function(e){return Ye(e.sites.slice(0,30))}}),Xe=function(e){var t=e.endpoint,n=e.forceDigestRefresh;return L({monitorName:"prefetchSharepointDigest"},I(function(e){var t=e.endpoint;return Object(i.e)({url:t+"/_api/contextinfo",method:"POST",headers:{Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},timeoutMs:5e3}).then(function(e){return{xhr:e,tokenAttemptCount:-1,tokenFetchDuration:-1}})})({cacheId:"pspd",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint+"/_api/contextinfo"}},forceRefresh:n}))({endpoint:t,forceDigestRefresh:n})},Ze=function(){return(Ze=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},$e=!1,et=Z(function(e){var t=e.endpoint,n=e.token,a=e.overrideDigest;return a&&!$e?($e=!0,new Promise(function(e){e({responseText:JSON.stringify({d:{GetContextWebInformation:{FormDigestValue:a}}})})})):Object(i.e)({url:t+"/_api/contextinfo",method:"POST",headers:Ze({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"},n?{Authorization:"Bearer "+n}:{}),timeoutMs:5e3})},{monitorName:"fetchSharepointDigest",cacheId:"fetchSharepointDigest",cacheVersion:"0",cacheItemLifetime:179e4,cacheKeyExtractor:function(e){return{url:e.endpoint}}}),tt=n("N4oQ"),nt=n("CRMH"),at=function(e,t,n,a){return new Promise(function(i,r){return it(function o(s){if(s.source===e&&s.origin===t){var c=void 0,d=!1;try{c=n(s)}catch(e){return rt(o),void r(e)}try{d=a(c,s)}catch(e){return rt(o),void r(e)}d&&(rt(o),i(c))}})})},it=function(e){return addEventListener("message",e,!1)},rt=function(e){return removeEventListener("message",e,!1)};function ot(e){return function(e){return!!e&&(0===e.toLocaleLowerCase().indexOf("http://")||0===e.toLocaleLowerCase().indexOf("https://"))}(e)?e:"https://"+e}var st=function(){return(st=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ct={},dt={},lt={};function ut(e){return void 0===e&&(e="https://substrate.office.com"),e=ot(e),void 0===dt[e]&&(dt[e]=ft(e).ready),dt[e].then(function(){return lt[e]=!0,function(t){return mt(t,e)}})}function ft(e){return ct[e]?ct[e]:function(e,t,n){if(e){var a=document.getElementById("ms-searchux-3s-proxy"),i=function(e,t){return e&&e.src===t&&e.ready&&e.postMessage?{postMessage:e.postMessage,iframe:e,ready:e.ready,initialize:function(){return e}}:null}(a,t);ct[n]=i||pt(!a,t,n)}else ct[n]=pt(!1,t,n);return ct[n]}((t=window).mssearchux&&t.mssearchux.reuseIframe||!1,e+"/search/api/v2/resources",e);var t}function pt(e,t,n){var a=function(e,t){var n=document.createElement("iframe");return{iframe:n,initialize:function(){return document.body.contains(n)||(n.src=e,n.style.display="none",document.body.appendChild(n)),n},postMessage:function(a,i,r){var o=function(e,a){return at(n.contentWindow,t,e,a)}(i,r);return n.contentWindow&&n.contentWindow.postMessage(a,e),o}}}(t,n),i=a.initialize(),r=at(i.contentWindow,n,function(e){return e.data},function(e){return"loaded"===e});return e&&(i.id="ms-searchux-3s-proxy",i.postMessage=a.postMessage,i.ready=r),st(st({},a),{ready:r})}function mt(e,t){var n=Object(tt.e)(),a=e.action,i=e.token,r=e.prefix,o=e.cvid,s=e.additionalInfo,c=e.headers;return ft(t).postMessage(JSON.stringify({requestId:n,action:a,token:i,prefix:r,cvid:o,additionalInfo:s,headers:c}),_t,function(e){return e.requestId===n})}function _t(e){try{return JSON.parse(e.data)}catch(e){return N("Failed to parse substrate API JSON response.")}}var ht=function(){return(ht=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},bt=Z(function(e){var t=e.token,n=e.prefix;return ut(e.substrateUrl).then(function(e){return e({action:"queryv2",token:t,prefix:n,cvid:Object(tt.e)()}).then(function(e){if(!Object(nt.e)(e.statusCode))throw{status:e.statusCode};return{status:e.statusCode,responseText:e.qfResponse}})})},{monitorName:"fetchSitesFromSubstrate",cacheId:"fetchSitesFromSubstrate",cacheVersion:"0",cacheItemLifetime:108e5,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["token"]);return ht({},t)}});function gt(e){var t,n=Number.MAX_VALUE,a=e&&e.split(".");if(a&&3===a.length){var i=JSON.parse(function(e){var t=(e=e.trim()).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^\-_a-zA-Z0-9]/.test(e))&&function(e){throw new Error(e).name="InvalidCharacterError",new Error(e)}("Invalid character: the string to be decoded is not correctly encoded.");for(var n,a=0,i=0,r="",o=-1;++o<t;)n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e.charAt(o)),i=a%4?64*i+n:n,a++%4&&(r+=String.fromCharCode(255&i>>(-2*a&6)));return r}(a[1]));i&&i.exp&&(n=1e3*i.exp),i&&i.puid&&(t=i.puid)}return{token:e,expEpoch:n,userPuid:t}}function vt(e){return!(!e||e.expEpoch-Date.now()<12e4)}var yt=function(){return(yt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},St=Z(function(e){var t=e.msbUrl,n=e.clientType;"https://business.bing.com"===t&&(t+="/work/api");var a=t+"/v3/user/init",r={Authentication:e.token,clientContext:{clientType:n}};return Object(i.e)({url:a,method:"POST",body:JSON.stringify(r)})},{monitorName:"warmupMsb",cacheId:"warmupMsb",cacheVersion:"0",cacheItemLifetime:5e3,cacheKeyExtractor:function(e){e.token;var t=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["token"]);return yt({},t)}});function Dt(e){switch(e){case"dev":return"https://localhost:18101/api";case"test":return"https://bingatwork.asgfalcon-test.io/api";case"prod":return"https://business.bing.com/api";case"prod_generic":return"https://business.bing.com/work/api";case"prod_gcc":return"https://usgov.business.bing.com/api";case"dev_bing":return"https://localhost/work/api";case"staging_bing":return"https://www.staging-bing-int.com/work/api";default:return e}}function It(e){switch(e){case"test":return Dt(e);case"gcc":return Dt("prod_gcc");default:return Dt("prod_generic")}}function xt(e){switch(e){case"o365test":case"onebox":case"edog":case"spdf":case"test":return"Df";case"prodbubble":return"Msit";case"":case"prod":return"Prod";case"blackforest":return"Blackforest";case"gallatin":return"Gallatin";case"pathfinder":return"DoD";case"trailblazer":return"GccHigh";case"gcc":return"GccModerate";case"ag08":return"AG08";case"ag09":return"AG09";default:return R(0,"Prod")}}function Ct(e){switch(e){case"Blackforest":return"https://substrate.office.de";case"GccHigh":return"https://substrate.office365.us";case"DoD":return"https://substrate-dod.office365.us";case"Gallatin":return"https://partner.outlook.cn";case"AG08":return"https://substrate.exo.eaglex.ic.gov";case"AG09":return"https://substrate.exo.microsoft.scloud";case"Df":case"Msit":case"Prod":case"GccModerate":case"Unknown":return"https://substrate.office.com";default:return R(0,"https://substrate.office.com")}}var Ot=function(){return(Ot=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},wt=Z(function(e){var t=e.token,n=e.queryStringParameters,a=e.headers,i=e.postAction,r=void 0===i?"init":i,o=e.cvid,s=e.makeSubstrateRequest,c=e.substrateUrl,d=n?Ot({},n):{},l={action:r,token:t,prefix:void 0,cvid:o||Object(tt.e)(),additionalInfo:Ot(Ot({},d),{diagnostics:"1"}),headers:a};return(s?s(l):function(e,t){return void 0===t&&(t="https://substrate.office.com"),t=ot(t),lt[t]?mt(e,t):ut(t).then(function(t){return t(e)})}(l,c)).then(function(e){var t={};try{t=JSON.parse(e.responseHeaders)}catch(e){}if(e.diagnostics)try{var n=function(e){var t=JSON.parse(e)[0];return t.name,function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(t,["name"])}(e.diagnostics);n&&n.duration&&(t["Substrate-DiagnosticsDuration"]=""+n.duration)}catch(e){}var a={status:e.statusCode,responseText:e.qfResponse,getResponseHeader:function(e){return t[e]}};if(!Object(nt.e)(e.statusCode))throw a;return a})},{monitorName:"warmupSubstrateSearch",cacheId:"warmupSubstrateSearch",cacheVersion:"0",cacheItemLifetime:5e3,additionalSuccessPropsExtractor:Et,additionalFailurePropsExtractor:Et,cacheKeyExtractor:function(e){e.token,e.makeSubstrateRequest,e.cvid;var t=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["token","makeSubstrateRequest","cvid"]);return Ot({},t)}});function Et(e){return e.getResponseHeader?{correlationID:e.getResponseHeader("request-id")||"",properties:JSON.stringify({serverLatency:e.getResponseHeader("x-end2endlatencyms")||"",diagnosticsDuration:e.getResponseHeader("Substrate-DiagnosticsDuration")||""})}:{}}function At(e,t){return C({monitorType:"chunk_load",monitorName:e+"_chunk_load",monitorOnce:!0},t)}var Lt=function(){return(Lt=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function kt(e,t){var n,a=null,i=!1,r=function(){return i||(i=!0,n=t({attempt:1}).then(function(e){return a=gt(e),i=!1,e}).catch(function(e){throw i=!1,e})),n};return function(n,i,o){void 0===o&&(o=!0);var s,c,l,u=o?(s=e+"_withRefresh",c=performance.now(),(l=Object(d.e)()).dispatch({name:"generic_qos",nameDetail:s,timestamp:c,eventType:"QOSSTART"}),function(e,t,n){var a=performance.now();l.dispatch({name:"generic_qos",nameDetail:s,startTimestamp:c,totalTime:a-c,eventType:"QOSSTOP",result:e,properties:{customLogProps:JSON.stringify(t)},error:n})}):function(){};if(!t)return u("FAILURE",Lt({cacheItemResolved:!1,tokenProviderNull:!0},i)),Promise.reject("token provider is null");if(!a||!vt(a)||n.attempt>0)return r().then(function(e){return u("SUCCESS",Lt({cacheItemResolved:!1,expires:a&&new Date(a.expEpoch),didRefresh:!0},i)),e}).catch(function(e){throw u("FAILURE",Lt({cacheItemResolved:!1,tokenProviderNull:!1},i)),e.reason||e});var f,p=!!vt(f=a)&&Date.now()>f.expEpoch-24e4;return p&&r(),u("SUCCESS",Lt({cacheItemResolved:!0,expires:a&&new Date(a.expEpoch),backgroundRefresh:p},i)),Promise.resolve(a.token)}}function Mt(e,t,n){var a,i,r=0,o=kt(e,t);return function(e){return r++,i||(i=window.setInterval(function(){r++,o({attempt:0},{invokedByPeriodicRefresh:!0,invocationCounter:r},!1),Date.now()-a>864e5&&(window.clearInterval(i),i=void 0)},n||3e5)),a=Date.now(),o(e,{invokedByPeriodicRefresh:!1,invocationCounter:r},!0)}}},"6bZ6":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var a=n("CRMH"),i=function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function r(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.requestLogData=i({},e.requestLogData),r.open(e.method,e.url,!0),e.timeoutMs&&(r.timeout=e.timeoutMs),e.withCredentials&&(r.withCredentials=e.withCredentials);var o=e.headers||{};Object.keys(o).map(function(e){r.setRequestHeader(e,o[e])}),r.onload=function(){4===r.readyState&&(Object(a.e)(r.status)?t(r):n(r))},r.onerror=function(){n(r)},r.ontimeout=function(){n(r)};var s=e.body||null;r.send(s)})}},CRMH:function(e,t,n){"use strict";function a(e){return e>=200&&e<=300||0===e}n.d(t,"e",function(){return a})},Gcel:function(e,t,n){"use strict";n.d(t,"t",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"n",function(){return s}),n.d(t,"e",function(){return c});var a,i=n("a8rS");function r(e){a&&o("Can not set initial state more than once.")||(e.cache.participants.push(i.e),a=e)}function o(e){throw new Error(e)}var s=d("puid"),c=d("cache");function d(e){return function(){return a&&a[e]||o("Trying to get "+e+" before it is set.")}}},I6WN:function(e,t,n){"use strict";function a(){return""}n.d(t,"t",function(){return o}),n.d(t,"e",function(){return s});var i={register:a,unregister:a,dispatch:a},r=["register","unregister","dispatch"];function o(e){if(!e)throw new Error("Dispatcher argument must be a dispatcher instance.");if(!r.every(function(t){return"function"==typeof e[t]}))throw new Error("Dispatcher argument must implement dispatcher interface.");i={register:e.register.bind(e),unregister:e.unregister.bind(e),dispatch:function(t){var n=t.dispatchTime;t.dispatchTime="number"==typeof n?n:function(){try{return Math.round(performance.now())}catch(e){return 0}}(),e.dispatch(t)}}}function s(){return i}},a8rS:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var a="1.20210813.4.8"},mqVB:function(e,t,n){"use strict";t.__esModule=!0;var a=n("yeHm"),i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return e.prototype.register=function(e){var t="ID_"+this._lastID++;return this._callbacks[t]=e,t},e.prototype.unregister=function(e){this._callbacks[e]||a(!1),delete this._callbacks[e]},e.prototype.waitFor=function(e){this._isDispatching||a(!1);for(var t=0;t<e.length;t++){var n=e[t];this._isPending[n]?this._isHandled[n]||a(!1):(this._callbacks[n]||a(!1),this._invokeCallback(n))}},e.prototype.dispatch=function(e){this._isDispatching&&a(!1),this._startDispatching(e);try{for(var t in this._callbacks)this._isPending[t]||this._invokeCallback(t)}finally{this._stopDispatching()}},e.prototype.isDispatching=function(){return this._isDispatching},e.prototype._invokeCallback=function(e){this._isPending[e]=!0,this._callbacks[e](this._pendingPayload),this._isHandled[e]=!0},e.prototype._startDispatching=function(e){for(var t in this._callbacks)this._isPending[t]=!1,this._isHandled[t]=!1;this._pendingPayload=e,this._isDispatching=!0},e.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},e}();e.exports=i},yeHm:function(e,t,n){"use strict";e.exports=function(e,t,n,a,i,r,o,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,a,i,r,o,s],l=0;c=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return d[l++]}))}throw c.framesToPop=1,c}}},zLqp:function(e,t,n){e.exports.Dispatcher=n("mqVB")}}]);