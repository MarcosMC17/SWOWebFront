(window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0=window.webpackJsonpb6917cb1_93a0_4b97_a84d_7cf49975d4ec_0_2_0||[]).push([[89],{"67N2":function(e,t,n){"use strict";n.d(t,"i",function(){return i}),n.d(t,"a",function(){return r}),n.d(t,"o",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"e",function(){return c}),n.d(t,"s",function(){return d}),n.d(t,"t",function(){return l}),n.d(t,"n",function(){return u}),n.d(t,"r",function(){return f});var a=n("UWqr");function i(){return a._SPKillSwitch.isActivated("b08d62b9-3c21-4a8f-b136-e7d7b525e924")}function r(){return a._SPKillSwitch.isActivated("bafad34d-40e9-478d-b565-5c812b80031f")}function o(){return a._SPKillSwitch.isActivated("61be9ad0-f47c-405d-9c28-92f9142430a9")}function s(){return a._SPKillSwitch.isActivated("d9407616-7ba4-4b30-8e26-64e6c81cddcc")}function c(){return a._SPKillSwitch.isActivated("cb5d7cee-5511-4928-bf2e-ed9d5a967e01")}function d(){return a._SPKillSwitch.isActivated("74843650-4b21-403f-a76b-dfe9d4230bd2")}function l(){return a._SPKillSwitch.isActivated("a0cc773e-4b78-4e4f-ba45-deb0cfc86ba1")}function u(){return a._SPKillSwitch.isActivated("1771ca0a-b7a0-4a00-ac4f-33cce7b5a8d8")}function f(){return a._SPKillSwitch.isActivated("04bd07f9-dd48-4d0d-bfbd-9e5ea9272558")}},Fn15:function(e,t,n){"use strict";var a=n("hiL/"),i=n("jyrw"),r=function(){function e(){}return e.pageSaved=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.Saved,e._moduleName,"SPPageSetPageSaved",{SPPageStatus:a.PageSaveStatus.Saved.toString()})},e.pageDirty=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.NotSaved,e._moduleName,"SPPageSetPageDirty",{SPPageStatus:a.PageSaveStatus.NotSaved.toString()})},e.pageCheckedOut=function(){i.e._dispatchAction("SET_SAVESTATUS",a.PageSaveStatus.UnPublished,e._moduleName,"SPPageSetPageUnPublished",{SPPageStatus:a.PageSaveStatus.UnPublished.toString()})},e._moduleName="[PageStatusStoreAction]",e}();t.e=r},IKdF:function(e,t,n){"use strict";n.r(t);var a=n("17wl"),i=n("ut3N"),r=n("2q6Q"),o=n("hiL/"),s=n("y88i"),c=n("0SGS"),d=n("q+wp"),l=function(){function e(){}return e.insert=function(e,t){var n=new r._QosMonitor("PageCacheInsert");try{var a=JSON.stringify(t);window.sessionStorage.setItem(e,a),n.writeSuccess()}catch(e){n.writeUnexpectedFailure("PageCacheInsert",e)}},e.insertPage=function(e,t,n){e=this._normalize(e),this.insert("page-cache://"+e,{route:e,preloadedData:t,version:n})},e.get=function(e){var t=new r._QosMonitor("PageCacheGet");try{var n=window.sessionStorage.getItem(e),a=JSON.parse(n);return t.writeSuccess(),a}catch(e){t.writeUnexpectedFailure("PageCacheGet",e)}},e.getPage=function(e){return e=this._normalize(e),this.get("page-cache://"+e)},e.remove=function(e){var t=new r._QosMonitor("PageCacheDelete");try{window.sessionStorage.removeItem(e),t.writeSuccess()}catch(e){t.writeUnexpectedFailure("PageCacheDelete",e)}},e.removePage=function(e){e=this._normalize(e),this.remove("page-cache://"+e)},e._normalize=function(e){return d.e.relativizeUrl(d.e.removeQueryString(e.toLowerCase()))},e}(),u=n("onFi"),f=n("lmp7"),p=n("7plR"),m=n("ExwJ"),_=n("UF/m"),h=n("xs0R"),b=n("0IsF"),g=n("M+LP"),v=n("XdGY"),y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._logSource=i._LogSource.create("SPPageDataProvider"),t}return Object(a.__extends)(t,e),t.convertSitePageFlagArrayToString=function(e){return Object(v.Be)()?"string"==typeof e?e:void 0:Array.isArray(e)&&(null==e?void 0:e.length)>0?";#"+e.join(";#")+";#":void 0},t.prototype.getPageUrlAsync=function(e){var t=this,n=this._restSitePagesEndPointUrl+"("+e+")/FileName";f.e.appCacheHit=!1;var a=new r._QosMonitor("GetPageUrlAPI");return this._fetchJson(n).then(function(e){return a.writeSuccess(),e.value}).catch(function(e){return i._TraceLogger.logError(t._logSource,e),404===e.status?a.writeExpectedFailure("FailedResponseNotFound",e):403===e.status?a.writeExpectedFailure("FailedResponseForbidden",e):406===e.status?a.writeExpectedFailure("FailedResponseNotAcceptable",e):a.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.getListItemModerationStatusAsync=function(e){var t=this._webServerRelativeUrl+"/_api/web/lists(guid'"+this._pageContext.list.id+"')/Items("+e+")?$select=OData__ModerationStatus";return this._fetchJson(t).then(function(e){if(void 0===e.OData__ModerationStatus)throw"Invalid Moderation Status";return e.OData__ModerationStatus})},t.prototype.getPageTemplates=function(){var e="PageTemplates_"+this._webServerRelativeUrl,t=l.get(e);if(t)return Promise.resolve(t);var n=this._restSitePagesEndPointUrl+"/templates";return this._fetchJson(n).then(function(t){var n=t.value;return l.insert(e,n),n}).catch(function(e){throw e})},t.prototype.savePageToServerAsync=function(e,t,n,a){if(!Object.keys(t).length){var r=new Error("should not save empty page content");return i._TraceLogger.logError(this._logSource,r,a),Promise.reject(r)}var s=t[m.e.PreviewImageUrl];o.ThumbnailUrlGenerator.isStockImage(s)&&(t[m.e.PreviewImageUrl]=this._defaultSitePageThumbnail);var c=n?"SavePageAsDraft":"SavePage",d=this._restSitePagesEndPointUrl+"("+e+")/"+c,l=new _.t(t);return i._TraceLogger.logVerbose(this._logSource,a+" ("+e+")"),this._savePage(d,l,a,new _.n("POST"))},t.prototype.createBlankPageAsync=function(e,n,a,i){var o=new r._QosMonitor("CreateBlankPageAPI"),s=h.t.isSpace?this._restSpacesEndPointUrl:this._restSitePagesEndPointUrl,c=new _.t({PromotedState:e||void 0,PageLayoutType:n||void 0,ContentTypeId:a||void 0,SitePageFlags:t.convertSitePageFlagArrayToString(i)});return this.createOrCopyPage(s,new _.n("POST"),c.toString(),o,"createBlankPageAsync")},t.prototype.createTopicPageAsync=function(){var e=new r._QosMonitor("CreateTopicPageAPI"),t=this._restTopicsEndPointUrl,n=h.t.fields.EntityId,a=new _.t({Title:h.t.fields.Title,EntityId:n!==o.NULL_TOPIC_ENTITY.Id?n:"",EntityType:"Project",EntityRelations:o.EntityRelationsService.getRelationsAsString(p.e.instance.serviceScope),LayoutWebpartsContent:c.e.serializeLayoutWebPartData(h.t.fields.LayoutWebPartsDataMap),CanvasContent1:JSON.stringify(h.t.fields.CanvasContent1),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:b.e.Topic});return this.createOrCopyPage(t,new _.n("POST"),a.toString(),e,"createTopicPageAsync")},t.prototype.copyPage=function(e,n){var a=new r._QosMonitor("CopyPageAPI"),i="",o=this._shouldCreateNewsCopy();!Object(v.f)()&&Object(g.e)(60228)?(i="CopyWithConfiguration",o&&(p.e.instance.promoteOnPublish=!1)):o?(i="CreateNewsCopy",p.e.instance.promoteOnPublish=!1):i="Copy";var s=this._restSitePagesEndPointUrl+"("+e+")/"+i;return this.createOrCopyPage(s,new _.n("POST"),!Object(v.f)()&&Object(g.e)(60228)?JSON.stringify({sitePageFlags:t.convertSitePageFlagArrayToString(n),isNews:o}):new _.t({SitePageFlags:t.convertSitePageFlagArrayToString(n)}).toString(),a,"copyPage")},t.prototype.savePageAsTemplate=function(e){var t="PageTemplates_"+this._webServerRelativeUrl;l.remove(t);var n=new r._QosMonitor("SavePageAsTemplateAPI"),a=this._restSitePagesEndPointUrl+"("+e+")/SavePageAsTemplate";return this.createOrCopyPage(a,new _.n("POST"),(new _.t).toString(),n,"savePageAsTemplate")},t.prototype.getTemplateFolderUrl=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary/GetSpecialFolderUrl",t=new r._QosMonitor("GetTemplateFolderUrl");return this._fetchJson(e,new _.n("POST"),JSON.stringify({type:9,bForceCreate:!1})).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingTemplateFolderUrl",e),Promise.reject(e)})},t.prototype.createOrCopyPage=function(e,n,a,r,o){var s=this;i._TraceLogger.logVerbose(this._logSource,o);var c=window._isInitiatedByPageApp?"FromPageApp":"FromRouter";return this._fetchJson(e,n,a).then(function(e){if(!e||!e.Id)throw t._getOdataRestApiError(e)||new u.e;return s._processCreateOrCopyResponse(o,r,e)}).catch(function(e){throw e instanceof u.e?403===e.status?r.writeExpectedFailure("FailedResponseForbidden",e,{pageCreationEntryPoint:c}):r.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}):(r.writeUnexpectedFailure("FailedResponseStatus",e,{pageCreationEntryPoint:c}),i._TraceLogger.logError(s._logSource,e,c)),e})},t.prototype.checkOutAndReloadPageAsync=function(e){var t=this,n=this._restSitePagesEndPointUrl+"("+e+")/checkoutpage",a=new r._QosMonitor("CheckOutPageAPI");return i._TraceLogger.logVerbose(this._logSource,"checkOutAndReloadPageAsync"),this._fetchJson(n,new _.n("POST")).then(function(e){if(!e||!e.IsPageCheckedOutToCurrentUser)throw new u.e;var n=c.e.tryLoadFromSitePagesOdata(e);return i._TraceLogger.logVerbose(t._logSource,"checkOutAndReloadPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof u.e?(t._handleOdataError(e,e.status,a,"CheckOutPageAPI"),i._TraceLogger.logError(t._logSource,e,"CheckOutPageAPI")):(a.writeUnexpectedFailure("FailedToCheckoutPageError2",e),i._TraceLogger.logError(t._logSource,e)),e})},t.prototype.publishPageAsync=function(e){var t=this,n=this._restSitePagesEndPointUrl+"("+e+")/publish",a=new r._QosMonitor("PublishPageAPI");i._TraceLogger.logVerbose(this._logSource,"publishPageAsync");var o=Object(v.ke)()?void 0:{alias:h.t.fields.PageLayoutType};return this._fetchJson(n,new _.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new u.e);a.writeSuccess(o)}).catch(function(e){return e.isUnknown?(a.writeUnexpectedFailure("PublishPageAPI",e,o),i._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,a,"PublishPageAPI",o),Promise.reject(e)})},t.prototype.schedulePageAsync=function(e){var t=this,n=new r._QosMonitor("SchedulePublishAPI"),a=this._restSitePagesEndPointUrl+"("+e+")/schedulepublish";return i._TraceLogger.logVerbose(this._logSource,"schedulePageAsync"),this._fetchJson(a,new _.n("POST"),JSON.stringify({})).then(function(e){return n.writeSuccess(),e.value}).catch(function(e){return"-2146232832, Microsoft.SharePoint.SPFeatureDependencyNotActivatedException"===(null==e?void 0:e.code)&&(n.writeExpectedFailure("SchedulePublishAPI",e),i._TraceLogger.logError(t._logSource,e)),e.isUnknown?(n.writeUnexpectedFailure("SchedulePublishAPI",e),i._TraceLogger.logError(t._logSource,e)):t._handleOdataError(e,e.status,n,"SchedulePublishAPI"),Promise.reject(e)})},t.prototype.discardPageAsync=function(e){var t=this,n=Object(v.Oe)()?this._restSitePagesEndPointUrl+"("+e+")/discardPage":this._restSitePagesEndPointUrl+"("+e+")/discardPage?$expand=VersionInfo",a=new r._QosMonitor("DiscardPageAPI");return i._TraceLogger.logVerbose(this._logSource,"discardPageAsync"),this._fetchJson(n,new _.n("POST")).then(function(e){if(!e)throw new u.e;var n=c.e.tryLoadFromSitePagesOdata(e);return i._TraceLogger.logVerbose(t._logSource,"discardPageAsync success"),a.writeSuccess(),n}).catch(function(e){throw e instanceof u.e&&!e.isUnknown?t._handleOdataError(e,e.status,a,"DiscardPageAPI"):(a.writeUnexpectedFailure("FailedToDiscardPageError22",e),i._TraceLogger.logError(t._logSource,e)),e})},t.prototype.promotePageToNewsAsync=function(e){var t=this,n=this._restSitePagesEndPointUrl+"("+e+")/PromoteToNews",a=new r._QosMonitor("PromotePageToNewsAPI");return i._TraceLogger.logVerbose(this._logSource,"promotePageToNewsAsync"),this._fetchJson(n,new _.n("POST")).then(function(e){if(!0!==e.value)return Promise.reject(new u.e);a.writeSuccess()}).catch(function(e){return e.isUnknown?(i._TraceLogger.logError(t._logSource,e,"PromotePageToNewsAPI"),a.writeUnexpectedFailure("PromotePageToNewsAPI",e)):t._handleOdataError(e,e.status,a,"PromotePageToNewsAPI"),Promise.reject(e)})},t.prototype.checkInFileAsync=function(e,t){var n=this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('"+this._pageContext.list.serverRelativeUrl+"/"+t+"')/checkin("+e+")",a=new r._QosMonitor("CheckinFileAPI");return this._fetchJson(n,new _.n("POST"),JSON.stringify({})).then(function(){return a.writeSuccess()}).catch(function(e){return a.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getFileEtagAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForEtag,this._pageServerRelativeUrl),t=new r._QosMonitor("GetFileEtagAPI");return this._fetchJson(e).then(function(e){if(!e.ETag)throw new u.e;return t.writeSuccess(),e.ETag}).catch(function(e){throw t.writeUnexpectedFailure("FailedGettingFileEtag",e),e})},t.prototype.getFileCheckinCommentsAsync=function(){var e=s.StringHelper.format(this._restWebEndPointForCheckInComments,this._pageServerRelativeUrl),t=new r._QosMonitor("GetFileCheckInComments");return this._fetchJson(e).then(function(e){return t.writeSuccess(),e.CheckInComment}).catch(function(e){return t.writeUnexpectedFailure("FailedCheckingInFile",e),Promise.reject(e)})},t.prototype.getUserById=function(e){var t=this._webServerRelativeUrl+"/_api/web/GetUserById("+e+")",n=new r._QosMonitor("GetUserById");return this._fetchJson(t).then(function(t){return n.writeSuccess(),{id:e,email:t.Email,name:t.Title}}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getPagePublishStartDate=function(e){var t=this._restSitePagesEndPointUrl+"("+e+")?$select=PublishStartDate",n=new r._QosMonitor("GetPublishStartDate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.PublishStartDate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingUser",e),Promise.reject(e)})},t.prototype.getListMetadataAsync=function(){var e=this._webServerRelativeUrl+"/_api/lists/EnsureClientRenderedSitePagesLibrary?$select=EnableModeration,EnableMinorVersions,Id",t=new r._QosMonitor("GetListMetadataAPI");return this._fetchJson(e,new _.n("POST"),JSON.stringify({})).then(function(e){return t.writeSuccess(),{EnableMinorVersions:e.EnableMinorVersions,EnableModeration:e.EnableModeration,Id:e.Id}}).catch(function(e){return t.writeUnexpectedFailure("FailedGettingModerationStatus",e),Promise.reject(e)})},t.prototype.getIsTemplate=function(e){var t=this._restSitePagesEndPointUrl+"("+e+")?$select=IsTemplate",n=new r._QosMonitor("GetIsTemplate");return this._fetchJson(t).then(function(e){return n.writeSuccess(),e.IsTemplate}).catch(function(e){return n.writeUnexpectedFailure("FailedGettingFileEtag",e),Promise.reject(e)})},t.prototype.setListItemModerationStatus=function(e,t,n,a){var i=this._webServerRelativeUrl+"/_api/SP.APIHubConnector.SetApprovalStatus",o=new r._QosMonitor("SetModerationStatusAPI"),s={action:n,comments:t,etag:a,itemId:e.toString(),listName:this._pageContext.list?this._pageContext.list.id.toString():"Site Pages"};return this._fetchJson(i,new _.n("POST"),JSON.stringify(s)).then(function(){return o.writeSuccess()}).catch(function(e){return o.writeUnexpectedFailure("FailedSettingModerationStatusAPI",e),Promise.reject(e)})},t.prototype.getClassicHomepageUrlAsync=function(){var e=this,t=l.get("ClassicHomepageUrl_"+this._webServerRelativeUrl);if(t)return i._TraceLogger.logVerbose(this._logSource,"get classic homepage url from cache"),Promise.resolve(t);var n=s.Uri.concatenate(this._webServerRelativeUrl,"_api/Web?$select=ClassicWelcomePage,IsRevertHomepageLinkHidden"),a=new r._QosMonitor("GetClassicHomepageUrl");return this._fetchJson(n).then(function(t){var n=t.ClassicWelcomePage,r=t.IsRevertHomepageLinkHidden?"":n;return i._TraceLogger.logVerbose(e._logSource,"getClassicHomepageUrlAsync success"),a.writeSuccess(),l.insert("ClassicHomepageUrl_"+e._webServerRelativeUrl,r),r}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetClassicHomepageUrl",t),""):(a.writeUnexpectedFailure("GetClassicHomepageUrl",t),i._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.removeClassicHomepageUrl=function(){var e=this,t=this._webServerRelativeUrl+"/_api/Web",n=new r._QosMonitor("RemoveClassicHomepageUrl");return this._fetchJson(t,new _.n("PATCH"),JSON.stringify({__metadata:{type:"SP.Web"},IsRevertHomepageLinkHidden:!0})).then(function(){n.writeSuccess(),l.remove("ClassicHomepageUrl_"+e._webServerRelativeUrl)}).catch(function(e){return n.writeUnexpectedFailure("RemoveClassicHomepageUrl",e),Promise.reject(e)})},t.prototype.getHomePageUrlAsync=function(){var e=this,t=l.get("HomePage_"+this._webServerRelativeUrl);if(t)return i._TraceLogger.logVerbose(this._logSource,"get home page url from cache"),Promise.resolve(t);var n=s.Uri.concatenate(this._webServerRelativeUrl,"_api/web/rootfolder?$select=welcomepage"),a=new r._QosMonitor("GetHomePageUrl");return this._fetchJson(n).then(function(t){var n=s.Uri.concatenate(e._webServerRelativeUrl,t.WelcomePage);return i._TraceLogger.logVerbose(e._logSource,"getHomePageUrlAsync success"),a.writeSuccess(),l.insert("HomePage_"+e._webServerRelativeUrl,n),n}).catch(function(t){return 403===t.status?(a.writeExpectedFailure("GetHomePageUrl",t),""):(a.writeUnexpectedFailure("GetHomePageUrl",t),i._TraceLogger.logError(e._logSource,t),Promise.reject(t))})},t.prototype.getPreviousPageVersionInfoAsync=function(e){var t=this,n=this._restSitePagesEndPointUrl+"("+e+")/VersionInfo",a=new r._QosMonitor("VersionInfoPageAPI");return i._TraceLogger.logVerbose(this._logSource,"getPreviousPageVersionInfoAsync"),this._fetchJson(n,new _.n("POST")).then(function(e){if(!e)throw new u.e;return a.writeSuccess(),e}).catch(function(e){throw e instanceof u.e?e.isUnknown?(a.writeUnexpectedFailure("FailedResponseStatus",e),i._TraceLogger.logError(t._logSource,e,"VersionInfoPageAPI")):t._handleOdataError(e,e.status,a,"VersionInfoPageAPI"):(a.writeUnexpectedFailure("FailedToGetPageVersion",e),i._TraceLogger.logError(t._logSource,e)),e})},t.prototype.deletePageAsync=function(){var e=this,t=new r._QosMonitor("DeletePageAPI"),n=s.Uri.concatenate(this._webServerRelativeUrl,"/_api/web/lists(guid'"+this._pageContext.list.id+"')/Items("+(h.t.fields.Id||d.e.spPageContextInfo.pageItemId)+")/recycle");return this._fetchJson(n,new _.n("POST")).then(function(e){if(!(null==e?void 0:e.value))throw new u.e;t.writeSuccess()}).catch(function(n){throw n instanceof u.e?n.isUnknown?(t.writeUnexpectedFailure("FailedResponseStatus",n),i._TraceLogger.logError(e._logSource,n,"DeletePageAPI")):e._handleOdataError(n,n.status,t,"DeletePageAPI"):(t.writeUnexpectedFailure("FailedToDeletePage",n),i._TraceLogger.logError(e._logSource,n)),n})},t.prototype.addPageToQuickLaunchAsync=function(e,t){var n=this,a=this._webServerRelativeUrl+"/_api/web/navigation/QuickLaunch",o=new r._QosMonitor("AddPageToQuickLaunchAPI"),s=new _.t({__metadata:{type:"SP.NavigationNode"},IsExternal:!0,Title:e,Url:t});return this._fetchJson(a,new _.n("POST"),s.toString()).then(function(e){return o.writeSuccess(),i._TraceLogger.logVerbose(n._logSource,"addPageToQuickLaunchAsync success"),{key:e.Id.toString(),name:e.Title,url:e.Url,target:d.e.isRelativeUrl(e.Url)?"_self":"_blank"}}).catch(function(e){return o.writeUnexpectedFailure("FailedResponseStatus",e),e instanceof u.e?i._TraceLogger.logError(n._logSource,e,"AddPageToQuickLaunchAPI"):i._TraceLogger.logError(n._logSource,e),Promise.reject(e)})},t.prototype.getClassicPubNavProviderTypeAsync=function(e){var t=new r._QosMonitor("GetClassicPublishingNavProviderAPI"),n=this._webServerRelativeUrl+"/_api/navigation/GetPublishingNavigationProviderType?mapProviderName=%27";return n+=e,n+="%27",this._fetchJson(n).then(function(e){return t.writeSuccess(),e.value}).catch(function(e){return t.writeUnexpectedFailure("FailedResponseStatus",e),Promise.reject(e)})},t.prototype.ensureTitleResourceAsync=function(){var e=this,t=this._restSitePagesEndPointUrl+"/EnsureTitleResource";return this._fetchJson(t,new _.n("POST"),JSON.stringify({})).then(function(){}).catch(function(t){throw i._TraceLogger.logError(e._logSource,t),t})},t.prototype.getVersion=function(e,t){var n=this._restSitePagesEndPointUrl+"("+e+")/getversion("+t+")",a=new r._QosMonitor("GetVersionAPI");return this._fetchJson(n).then(function(e){if(!e)throw new u.e;var t=c.e.tryLoadFromSitePagesOdata(e);return a.writeSuccess(),t}).catch(function(e){throw a.writeUnexpectedFailure("FailedGetVersion",e),e})},t.prototype.getDashboardPage=function(){var e=this._restSitePagesEndPointUrl+"?$filter=PageLayoutType eq '"+b.e.Dashboard+"'&$top=1&$select=FileName",t=new r._QosMonitor("GetDashboardPage");return this._fetchJson(e).then(function(e){return e&&e.value&&e.value.length>0?(t.writeSuccess({exist:!0}),e.value[0].FileName):void t.writeSuccess({exist:!1})}).catch(function(e){t.writeUnexpectedFailure(e)})},t.prototype._savePage=function(e,t,n,a){var o=this,s=new r._QosMonitor(n),c=Object(v.ke)()?void 0:{alias:h.t.fields.PageLayoutType};return this._fetchJson(e,a,t.toString(),this._isSaveSuccessful).then(function(e){return s.writeSuccess(c),i._TraceLogger.logVerbose(o._logSource,n+"success"),e.value}).catch(function(e){return e instanceof u.e?e.isUnknown?(s.writeUnexpectedFailure(Object(v.F)()?"FailedResponseStatus":"FailedResponseUnknown",e,c),i._TraceLogger.logError(o._logSource,e,n)):o._handleOdataError(e,e.status,s,n,c):(s.writeUnexpectedFailure("FailedToSavePageError2",e,c),i._TraceLogger.logError(o._logSource,e)),Promise.reject(e)})},t.prototype._processCreateOrCopyResponse=function(e,t,n){i._TraceLogger.logVerbose(this._logSource,e+" ("+n.Id+")");var a=c.e.tryLoadFromSitePagesOdata(n);return d.e.updatePageContextItemId(n.Id),t.writeSuccess(),a},t.prototype._shouldCreateNewsCopy=function(){return p.e.instance.promoteOnPublish},t}(_.e);t.default=y},"UF/m":function(e,t,n){"use strict";n.d(t,"n",function(){return p}),n.d(t,"t",function(){return m}),n.d(t,"e",function(){return _});var a=n("ut3N"),i=n("Pk8u"),r=n("vlQI"),o=n("UWqr"),s=n("y88i"),c=n("EMa1"),d=n("onFi"),l=n("q+wp"),u=n("xs0R"),f=n("XdGY"),p=function(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e},m=function(){function e(e){var t;t=u.t.isSpace?"SP.Publishing.SitePage3D":l.e.isNewTopicPage()?"SP.Publishing.TopicSitePage":"SP.Publishing.SitePage",this.__metadata={type:t},e&&Object(i.assign)(this,e)}return e.prototype.toString=function(){return JSON.stringify(this)},e}(),_=function(){function e(t,n){this._pageContext=t,this._spHttpClient=n,this._spHttpClientFetch=this._spHttpClient.fetch.bind(this._spHttpClient),this._spHttpClientGet=this._spHttpClient.get.bind(this._spHttpClient),this._spHttpClientPost=this._spHttpClient.post.bind(this._spHttpClient),this._isResponseSuccessful=l.e.isResponseSuccessful.bind(l.e),this._isSaveSuccessful=e._isSaveResponseSuccessful}return e._getOdataRestApiError=function(e,t,n){void 0===t&&(t=500);var a=e["odata.error"],i=n&&n.message||"unknown";return a&&a.message?new d.e("Inner-Message: "+a.message.value+" Exception-Message: "+i,t,a.code):void 0},e._encodeAndSanitizeURIComponent=function(e){return(e=encodeURIComponent(e).replace(/'/g,"''")).replace(/[~!*()']/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},e._isSaveResponseSuccessful=function(e){return l.e.isResponseSuccessful(e)||413===e},Object.defineProperty(e.prototype,"_webServerRelativeUrl",{get:function(){return o.UrlUtilities.removeEndSlash(this._pageContext.legacyPageContext.webServerRelativeUrl)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSitePagesEndPointUrl",{get:function(){return this._webServerRelativeUrl+"/_api/sitepages/pages"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restSpacesEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/spaces"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForEtag",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=ETag"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restWebEndPointForCheckInComments",{get:function(){return this._webServerRelativeUrl+"/_api/web/getfilebyserverrelativeurl('{0}')?$select=CheckInComment"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_restTopicsEndPointUrl",{get:function(){return this._restSitePagesEndPointUrl+"/topics"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_defaultSitePageThumbnail",{get:function(){return s.Uri.concatenate("/",this._pageContext.legacyPageContext.layoutsUrl,"/images/sitepagethumbnail.png")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_pageServerRelativeUrl",{get:function(){var t="/"+e._encodeAndSanitizeURIComponent(l.e.url(!0).replace(l.e.domainUrl(),""));return l.e.doesUrlHaveFileName?t:l.e.spPageContextInfo.serverRequestPath},enumerable:!1,configurable:!0}),e.prototype._fetch=function(e,t,n,a){var i=this._spHttpClientPost,o={body:n,headers:t};return t?"GET"===t["X-HTTP-Method"]&&(i=this._spHttpClientFetch):(o=void 0,i=this._spHttpClientGet),i(e,r.SPHttpClient.configurations.v1,o).catch(function(e){return Promise.reject({error:new d.e})}).then(function(e){if(!a(e.status)){var t=new d.e(l.e.getStatusMessage(e),e.status);throw t.response=e,{error:t,isResponseSuccessful:!1}}return e})},e.prototype._fetchJson=function(t,n,a,i){var r;return this._fetch(t,n,a||(new m).toString(),i||this._isResponseSuccessful).catch(function(e){if(!1===e.isResponseSuccessful)return r=e.error,e.error.response;throw e.error}).then(function(e){return e.ok&&204===e.status?e:e.json()}).then(function(t){var n=e._getOdataRestApiError(t,r&&r.status,r)||r;if(n)throw n;return t})},e.prototype._handleOdataError=function(e,t,n,i,r){if(e){if(400!==t||e.message!==c.t.exceedStreamLimitationErrorMessage&&e.message!==c.t.requestMessageTooBigErrorMessage)if(409===t){var o=new d.e("File checked out by another user",409);n.writeExpectedFailure("FailedResponsePageConflict",o,r)}else if(404===t){var s=new d.e("Page is not found",404);n.writeExpectedFailure("FailedResponseNotFound",s,r)}else 406===t?n.writeExpectedFailure("FailedResponseNotAcceptable",e,r):Object(f.F)()||403!==t?n.writeUnexpectedFailure("FailedResponseStatus",e,r):n.writeExpectedFailure("FailedResponseForbidden",e,r);else n.writeUnexpectedFailure("FailedResponseExceedStreamLimitation",e,r);throw a._TraceLogger.logError(this._logSource,e,i),e}},e}()},pfXd:function(e,t,n){"use strict";var a=n("ut3N"),i=n("jyrw"),r=n("E7/L");function o(){return n.e(67).then(n.bind(null,"+Mf1")).then(function(e){return e.default})}var s=n("xs0R"),c=n("q+wp"),d=function(){function e(){}return e.setIsTemplate=function(t){i.e._dispatchAction("FIELDS_SET_TEMPLATE_STATUS",t,e._moduleName,"set page template flag")},e.setNumMissingRequiredProps=function(t){i.e._dispatchAction("FIELDS_SET_MISSING_PROPS",t,e._moduleName,"set missing required properties")},e.setCategories=function(t){i.e._dispatchAction("FIELDS_SET_CATEGORIES",t,e._moduleName,"set categories")},e.addFieldsToUpdate=function(t){e._dispatchAction("FIELDS_UPDATE",t,"SPPageFieldStoreSetFields")},e.addFieldToUpdate=function(t,n){if(!t)throw new Error("fieldName is undefined");var a={};a[t]=n,e.addFieldsToUpdate(a)},e.setPromotedState=function(t){e._dispatchAction("FIELDS_SET_PROMOTEDSTATE",t,"SPPageFieldStoreSetFields")},e.setFields=function(t){e._dispatchAction("FIELDS_SET",t,"SPPageFieldStoreSetFields")},e.createNewPage=function(t,n,i,o){return o&&(t.bannerImageUrl=s.t.fields.BannerImageUrl),(t.pageFieldData?Promise.resolve(t.pageFieldData):Object(r.e)().then(function(e){return e.createNewPageStub(t,n,i,o)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&c.e.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.createNewPageDeprecated=function(t,n,i,o,d,l,u,f,p,m,_,h){return p&&(_=s.t.fields.BannerImageUrl),(i?Promise.resolve(i):Object(r.e)().then(function(e){return e.createNewPageStubDeprecated(t,n,o,d,l,u,f,p,m,_)})).then(function(t){e._dispatchAction("PAGE_CREATE_STUB",t,"SPPageFieldStoreCreatePageStub"),t&&c.e.logUserEngagementForPage(t,!0,"NewButton")}).catch(function(t){a._TraceLogger.logError(e._logSource,t)})},e.scheduleNewMajorVersionToServerAsync=function(){return o().then(function(e){return e.scheduleNewMajorVersionToServerAsync()})},e.publishNewMajorVersionToServerAsync=function(){return o().then(function(e){return e.publishNewMajorVersionToServerAsync()})},e.publishTopicPageMajorVersionToServerAsync=function(){return o().then(function(e){return e.publishTopicPageMajorVersionToServerAsync()})},e.discardPageOnServerAsync=function(){return o().then(function(e){return e.discardPageOnServerAsync()})},e.getPreviousPageVersionInfoAsync=function(){return o().then(function(e){return e.getPreviousPageVersionInfoAsync()})},e.setListItemModerationStatusAsync=function(e,t){return o().then(function(n){return n.setListItemModerationStatusAsync(e,t)})},e.setFileCheckInCommentsAsync=function(){return o().then(function(e){return e.setFileCheckInCommentsAsync()})},e.checkOutFieldsFromServerAsync=function(){return o().then(function(e){return e.checkOutFieldsFromServerAsync()})},e.saveDraftToServerAsync=function(){return o().then(function(e){return e.saveDraftToServerAsync()})},e.saveFieldsToServerAsync=function(e){return void 0===e&&(e=!1),o().then(function(t){return t.saveFieldsToServerAsync(e)})},e.getPageUrlFromServerAsync=function(){return o().then(function(e){return e.getPageUrlFromServerAsync()})},e.checkInFileAsync=function(e,t,n){return o().then(function(a){return a.checkInFileAsync(e,t,n)})},e.ensureValidPageTitleAsync=function(){return o().then(function(e){return e.ensureValidPageTitle()})},e.promotePageToNewsAsync=function(){return o().then(function(e){return e.promotePageToNewsAsync()})},e.cacheClientForm=function(t,n){void 0===n&&(n=!1),e._dispatchAction("FIELDS_CACHE_CLIENTFORM",{clientForm:t,forceCanvasUpdate:n},"SPPageCacheClientForm")},e.ensurePageExistsAsync=function(){return s.t.doesPageExistOnServer?(a._TraceLogger.logVerbose(e._logSource,"Page already Exists"),Promise.resolve()):(a._TraceLogger.logVerbose(e._logSource,"Page does not Exists, calling createNewPageOnServerAsync"),o().then(function(e){return e.createNewPageOnServerAsync()}))},e.commitTitle=function(){e._dispatchAction("FIELDS_COMMIT_TITLE",void 0,"SPPageFieldStoreCommitTitle")},e.deletePageAsync=function(){return o().then(function(e){return e.deletePageAsync()})},e.setIsCanvasWizardOpen=function(t){e._dispatchAction("FIELDS_SET_IS_CANVAS_WIZARD_OPEN",t,"SPPageFieldStoreCommitTitle")},e._dispatchAction=function(t,n,a){return i.e._dispatchAction(t,n,e._moduleName,a,void 0,e._logSource)},e._moduleName="[PageFieldStoreAction]",e._logSource=a._LogSource.create("PageFieldStoreActionCreator"),e}();t.e=d},s2tg:function(e,t,n){"use strict";n.r(t);var a=n("jyrw"),i=function(){function e(){}return e.load=function(t){a.e._dispatchAction("CHROME_CONFIG_LOAD",t,e._moduleName,"SPPageConfigChrome")},e._moduleName="[ChromeConfigurationAction]",e}(),r=n("2q6Q"),o=n("7plR"),s=n("n1SJ"),c=n("LjAQ"),d=function(){function e(){}return e.addQuickLaunchNode=function(t){var n=new r._QosMonitor("SPPageNavigationUpdateQuickLaunch");try{o.e.instance.getPageDataProviderAsync().then(function(e){return e.addPageToQuickLaunchAsync(t.name,t.url)}).then(function(t){a.e._dispatchAction("QUICKLAUNCH_ADDONE",t,e._moduleName,"SPPageNavigationUpdateQuickLaunch",void 0,void 0,n)}).catch(function(e){s.e.showError(c.e,c.t)})}catch(e){throw n.writeUnexpectedFailure("SPPageNavigationUpdateQuickLaunch",e),e}},e._moduleName="[NavigationAction]",e}(),l=n("17wl"),u=n("pfXd"),f=n("ut3N"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(l.__extends)(t,e),t.undo=function(){a.e._dispatchAction("FIELDS_UNDO",{},t._undoableModuleName,"Undo",void 0,t.LOG_SOURCE,new f._QosMonitor("Undo"))},t.redo=function(){a.e._dispatchAction("FIELDS_REDO",{},t._undoableModuleName,"Redo",void 0,t.LOG_SOURCE,new f._QosMonitor("Redo"))},t.clearHistory=function(){a.e._dispatchAction("FIELDS_CLEAR_HISTORY",{},t._undoableModuleName,"ClearHistory",void 0,t.LOG_SOURCE,new f._QosMonitor("ClearHistory"))},t.disableUndo=function(){a.e._dispatchAction("FIELDS_DISABLE_UNDO",{},t._undoableModuleName,"DisableUndo")},t.enableUndo=function(){a.e._dispatchAction("FIELDS_ENABLE_UNDO",{},t._undoableModuleName,"EnableUndo")},t.LOG_SOURCE=f._LogSource.create("UndoablePageFieldStoreActionCreator"),t._undoableModuleName="[UndoablePageFieldStoreAction]",t}(u.e),m=function(){function e(){}return e.loadPageLayoutMapping=function(t){a.e._dispatchAction("PAGELAYOUTMAPPING_LOAD",t,e._moduleName,"SPPageLayoutMapping",{Mapping:t.toString()})},e.addPageLayoutMapping=function(t,n){a.e._dispatchAction("PAGELAYOUTMAPPING_ADD",{key:t,pageLayout:n},e._moduleName,"SPPageAddPageLayoutMapping",{key:t})},e._moduleName="[PageFieldStoreAction]",e}(),_=n("Fn15"),h=function(){function e(){}return e.load=function(t){a.e._dispatchAction("PAGE_TEMPLATE_LOAD",t,e._moduleName,"SPPageTemplatesLoad")},e._moduleName="[PageTemplateAction]",e}(),b=function(){function e(){}return e.setListSettings=function(t){a.e._dispatchAction("SET_LIST_SETTINGS",t,e._moduleName,"set list settings")},e._moduleName="[ListActionCreator]",e}(),g=n("hiL/"),v=n("q+wp"),y=n("sSDQ"),S=n("UWqr"),D=n("I6O9"),I=n("EMa1"),x=n("ExwJ"),C=n("0IsF"),O=n("XdGY"),w=n("9sBY"),E=n("M+LP"),A=n("67N2"),L=function(){function e(){}return e.createNewPage=function(t,n){var a=n.canvasContent1?e._extractWebPartIdsFromCanvasContent(n.canvasContent1):[];return(Object(g.isCortexEnabled)(o.e.instance.pageContext)?e._loadComponentManifests(a):Promise.resolve()).then(function(){return o.e.instance.autoSaverPromise.then(function(a){return o.e.instance.getPageDataProviderAsync().then(function(i){var r,c,d,l=Object(A.a)()?Boolean(!n.isPreview&&(null===(c=n.pageFieldData)||void 0===c?void 0:c.EntityType)):(null===(r=n.pageFieldData)||void 0===r?void 0:r.PageLayoutType)===C.e.Topic,u=n.pageLayoutType===C.e.Space||(null===(d=n.pageFieldData)||void 0===d?void 0:d.PageLayoutType)===C.e.Space;return i.getListMetadataAsync().then(function(i){b.setListSettings(i),a.resetAutoSaveAttempts();var r=i.EnableMinorVersions?"0.1":"1.0";return Object(A.e)()?e._dispatchNewPageActionsDeprecated(t,n.source,n.promotedState,n.pageTemplateId,n.pageFieldData,n.canvasContent1,n.spaceContent,n.serverWebPartsDataMap,i.EnableModeration?g.SPModerationStatusType.Draft:void 0,r,n.templateFolderName,n.pageLayoutType,n.isPreview,n.previewPageFileName,n.bannerImageUrl,n.publishStartDate):e._dispatchNewPageActions(n,t,i.EnableModeration?g.SPModerationStatusType.Draft:void 0,r)}).then(function(){return n.isPreview?Promise.resolve():s.e.setDisplayModeEditAsync().then(function(){!Object(A.a)()&&l?document.title=w.a:document.title=w.n})}).then(function(){var e,t;if(l)if(Object(A.t)())(a=new URL(v.e.url())).searchParams.append("isNewTopicPage","true"),v.e.pushUrl(Object(A.o)()?a.toString():a.href,void 0,!0);else{var a=v.e.url(),i=v.e.appendUrlParam("isNewTopicPage","true",a);a!==i&&v.e.pushUrl(i,void 0,!0)}else if(S._SPFlight.isEnabled(943)&&u){var r=null===(e=n.pageFieldData)||void 0===e?void 0:e.Title,s=null===(t=n.pageFieldData)||void 0===t?void 0:t.Description;r&&(o.e.actions.fieldActions.addFieldToUpdate(x.e.Title,r),o.e.actions.fieldActions.commitTitle()),s&&o.e.actions.fieldActions.addFieldToUpdate(x.e.Description,s)}}).catch(function(e){s.e.showError(e.message)})})})})},e.createNewCrossSitePage=function(e,t){return S.Validate.isNonemptyString(t.crossSiteUrl,"crossSiteUrl"),this.createNewPage(e,t)},e._dispatchNewPageActions=function(e,t,n,a){var i=!!e.templateFolderName;return o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),u.e.createNewPage(e,n,a,e.templateFolderName).then(function(){if(s.e.setSaveStatus(g.PageSaveStatus.Draft),u.e.setIsTemplate(i),Object(E.e)(1743)&&u.e.setNumMissingRequiredProps(-1),t){var n=!Object(O.T)()&&e.templateFolderName?"SitePages/"+e.templateFolderName:"SitePages",a=S.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/"+n+"/"+(e.isPreview?e.previewPageFileName||I.t.previewPageStubFileName:I.t.newPageStubFileName+"?Mode=Edit")+(e.source?"&source="+encodeURIComponent(e.source):"");t.push(a,{isNewPage:!0})}})},e._dispatchNewPageActionsDeprecated=function(e,t,n,a,i,r,c,d,l,f,p,m,_,h,b,v){var y=!!p;return o.e.instance.autoSaver&&o.e.instance.autoSaver.resetAutoSaveAttempts(),u.e.createNewPageDeprecated(n,a,i,r,c,d,l,f,p,m,b,v).then(function(){s.e.setSaveStatus(g.PageSaveStatus.Draft),u.e.setIsTemplate(y),Object(E.e)(1743)&&u.e.setNumMissingRequiredProps(-1);var n=!Object(O.T)()&&p?"SitePages/"+p:"SitePages";if(e){var a=S.UrlUtilities.removeEndSlash(o.e.instance.pageContext.legacyPageContext.webServerRelativeUrl)+"/"+n+"/"+(_?h||I.t.previewPageStubFileName:I.t.newPageStubFileName+"?Mode=Edit")+(t?"&source="+encodeURIComponent(t):"");e.push(a,{isNewPage:!0})}})},e._extractWebPartIdsFromCanvasContent=function(e){return("string"==typeof e?JSON.parse(e):e).reduce(function(e,t){return t.controlType===y.CanvasControlType.WebPartZone&&e.push({id:t.webPartId}),e},[])},e._loadComponentManifests=function(e){return e&&e.length?new D._ManifestProvider(o.e.instance.serviceScope,o.e.instance.pageContext.legacyPageContext.webAbsoluteUrl).tryGetManifests(e).then(function(e){D._ManifestStore.instance.registerManifests(e,!1)}).catch(function(t){var n=f._LogSource.create("PageCreationActionCreator");f._TraceLogger.logError(n,new Error("Failed to load one or more manifests ["+e.join()+"]"))}):Promise.resolve()},e}();t.default=function(){this.actions={coreActions:s.e,chromeActions:i,navActions:d,fieldActions:p,layoutMappingActions:m,statusActions:_.e,templateActions:h,listActions:b,pageCreationActions:L}}}}]);